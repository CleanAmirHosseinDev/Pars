






(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }
  
    function saveCustomer(e) {

        $(e).attr("disabled", "");

        AjaxCallAction("POST", "/api/customer/Customers/Save_BasicInformationCustomers", JSON.stringify({

            tel: $("#Tel").val(),
            AddressCompany: $("#AddressCompany").val(),
            CompanyName: $("#CompanyName").val(),
            CeoName: $("#CeoName").val(),
            EconomicCode: $("#EconomicCode").val(),
            NationalCode: $("#NationalCode").val(),
            CeoMobile: $("#CeoMobile").val(),
            AgentMobile:$("#AgentMobile").val(),
            AgentName: $("#AgentName").val(),
            NamesAuthorizedSignatories:$("#NamesAuthorizedSignatories").val(),
            AmountOsLastSaels:$("#AmountOsLastSaels").val(),
            CountOfPersonal: $("#CountOfPersonal").val(),
            Email: $("#Email").val(),
            Tel: $("#Tel").val(),
            PostalCode: $("#PostalCode").val(),
            HowGetKnowCompanyId:$("#howGetKnowCompany").val(),
            KindOfCompanyId:$("#KindOfCompany").val(),
            TypeServiceRequestedId: $("#TypeServiceRequestedId").val()

        }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                alertB("ثبت", res.message, "success");
              //  goToUrl("/Customer/Customer/EditCustomer");

            } else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function systemSeting_Combo(resSingle) {

        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63,27,56",  PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';
                var strHowGetKnowCompany = '<option value="">انتخاب کنید</option>';
                var strTypeServiceRequestedId = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].parentCode == 56) {
                        strHowGetKnowCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 63) {
                        strTypeServiceRequestedId += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 27) {
                        strKindOfCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }                    
                }

                $("#KindOfCompany").html(strKindOfCompany);
                $("#HowGetKnowCompany").html(strHowGetKnowCompany);
                $("#TypeServiceRequestedId").html(strTypeServiceRequestedId);

                $("#HowGetKnowCompany").val(resSingle.howGetKnowCompanyId);
                $("#KindOfCompany").val(resSingle.kindOfCompanyId);
                $("#TypeServiceRequestedId").val(resSingle.typeServiceRequestedId);

                

            }
        }, true);
    }

    function initCustomer(dir = 'rtl') {

        ComboBoxWithSearch('.select2', dir);
       
        AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {            
                

                if (res != null) {
                    $("#AddressCompany").val(res.addressCompany);
                    $("#CompanyName").val(res.companyName);
                    $("#CeoName").val(res.ceoName);
                    $("#EconomicCode").val(res.economicCode);
                    $("#NationalCode").val(res.nationalCode);
                    $("#CeoMobile").val(res.ceoMobile);
                    $("#AgentMobile").val(res.agentMobile);
                    $("#AgentName").val(res.agentName);
                    $("#NamesAuthorizedSignatories").val(res.namesAuthorizedSignatories);
                    $("#AmountOsLastSaels").val(res.amountOsLastSaels);
                    $("#CountOfPersonal").val(res.countOfPersonal);
                    $("#Email").val(res.email);
                    $("#Tel").val(res.tel);
                    $("#PostalCode").val(res.postalCode);

                    systemSeting_Combo(res);

                }
                           

            }, true);       

    }

    web.Customer = {
        TextSearchOnKeyDown: textSearchOnKeyDown,       
        SaveCustomer: saveCustomer,
        InitCustomer: initCustomer,
        SystemSeting_Combo: systemSeting_Combo
    };

})(Web, jQuery);






(function (web, $) {

    //Document Ready              

    function signOutForExitToLogin() {

        dellstor("token");        
        dellstor("fullName");
        dellstor("customerID");
        dellstor("userID");

        goToUrl("/Account/LoginC");

    }

    function initLayout() {

        if (isEmpty(getlstor("token"))) goToUrl("/Account/LoginC");
        else {

            $(".fullNameInLayout").html(getlstor("fullName"));            

        }

    }

    web.Layout = {

        SignOutForExitToLogin: signOutForExitToLogin,
        InitLayout: initLayout

    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {

               

                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    var detailbtn = "";
                    var contractbtn = "";
                    var documentbtn = "";
                    if (res.data[i].status == 0) {
                         detailbtn = "<a style='margin-right:5px' title='مشاهده جزییات' " + "onclick = 'Web.RequestForRating.Get_Detail("+res.data[i].requestId+");'"
                             +" class='btn btn-detail fontForAllPage'> <i class='fa fa-eye'></i></a>"
                    }
                    if (res.data[i].status==1) {
                        contractbtn = "<a style='margin-right:5px' title='مشاهده قرارداد' href='/Customer/RequestForRating/ContractPrinting?id=" +
                            res.data[i].requestId + "' class='btn btn-print fontForAllPage'> <i class='fa fa-print'></i></a>"
                    }
                    if (res.data[i].status == 1) {
                        documentbtn = "<a style='margin-right:5px' title='ثبت اطلاعات تکمیلی' href='/Customer/RequestForRating/EditRequestForRating?id=" +
                            res.data[i].requestId + "' class='btn btn-info fontForAllPage'> <i class='fa fa-file-text-o'></i></a>"
                    }

                    strM += "<tr><td>" + (i + 1) + "</td><td>"
                        + res.data[i].kindOfRequest + "</td><td>"
                        + (res.data[i].kindOfRequestNavigation != null ?res.data[i].kindOfRequestNavigation.label:'') + "</td><td>"
                        + res.data[i].statusStr + "</td><td>"
                        + detailbtn
                        + contractbtn
                        + documentbtn
                        + "</td></tr>";
                }

                $("#tBodyList").html(strM);
            }

        }, true);

    }


    function get_Detail(id = null) {
        try {

           // debuggerWeb();
            //InitModal('جزییات درخواست', "/api/customer/RequestForRating/Get_RequestForRatings/", { id: id }, "Web.RequestForRating.Get_Detail_Post(" + id + ");", false, true);
            InitModal_Withot_Par("Mobin ast", "<h1>Monire ast</h1>", "", true, "width:100%;", "Sabt");

        } catch (e) {

        }

       
    }
    function get_Detail_Post(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/RequestForRating/Get_RequestForRatings/" + JSON.stringify({ RequestID: id, PageIndex: 0, PageSize: 0 }), true, function (res) {

                if (res != null) {
                    //  $("#CityId").val(res.cityId);
                    //  $("#CityName").val(res.cityName);                   
                }
            }, true);

        }
    }
    function saveRequestForRating(e) {

        $(e).attr("disabled", "");       

        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_Request", JSON.stringify({ Request: { KindOfRequest: $("#TypeServiceRequestedId").val() } }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                alertB("ثبت", res.message, "success");

            }

        }, true);

    }

    function systemSeting_ComboRequestForRating() {

        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strTypeServiceRequestedId = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {                   
                        strTypeServiceRequestedId += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";                    
                }
                $("#TypeServiceRequestedId").html(strTypeServiceRequestedId);
                // $("#TypeServiceRequestedId").val(resSingle.typeServiceRequestedId);
            }
        }, true);
    }

    function initRequestForRating() {

       
        ComboBoxWithSearch('.select2', 'dir');
        //AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {

        //        if (res != null) {
                  
        //            //
        //            //
        //        }

        //    }, true);  
        systemSeting_ComboRequestForRating();

    }

    web.RequestForRating = {
        TextSearchOnKeyDown: textSearchOnKeyDown,       
        SaveRequestForRating: saveRequestForRating,
        InitRequestForRating: initRequestForRating,
        Get_Detail_Post: get_Detail_Post,
        FilterGrid: filterGrid,
        Get_Detail: get_Detail,
        SystemSeting_ComboRequestForRating: systemSeting_ComboRequestForRating
    };

})(Web, jQuery);







(function (web, $) {


    function systemSeting_Combo(parentCodeArr = null, labelCode = null, ComboName = "") {

        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: parentCodeArr, LabeCode: labelCode , PageIndex: 0, PageSize:0 }), true, function (res) {

            if (res.isSuccess) {
                var strM = '<option value="">انتخاب کنید</option>';
                for (var i = 0; i < res.data.length; i++) {

                    strM += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].value + "</option>";
                }
                $("#" + ComboName).html(strM);
        }
        }, true);
}


   
    web.SystemSeting = {       
        SystemSeting_Combo: systemSeting_Combo
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }
  
   

    function systemSeting_Combo(dir = 'rtl') {


        var current_fs, next_fs, previous_fs; //fieldsets
        var opacity;

        $(".next").click(function () {

            current_fs = $(this).parent();
            next_fs = $(this).parent().next();

            //Add Class Active
            $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

            //show the next fieldset
            next_fs.show();
            //hide the current fieldset with style
            current_fs.animate({ opacity: 0 }, {
                step: function (now) {
                    // for making fielset appear animation
                    opacity = 1 - now;

                    current_fs.css({
                        'display': 'none',
                        'position': 'relative'
                    });
                    next_fs.css({ 'opacity': opacity });
                },
                duration: 600
            });
        });

        $(".previous").click(function () {

            current_fs = $(this).parent();
            previous_fs = $(this).parent().prev();

            //Remove class active
            $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

            //show the previous fieldset
            previous_fs.show();

            //hide the current fieldset with style
            current_fs.animate({ opacity: 0 }, {
                step: function (now) {
                    // for making fielset appear animation
                    opacity = 1 - now;

                    current_fs.css({
                        'display': 'none',
                        'position': 'relative'
                    });
                    previous_fs.css({ 'opacity': opacity });
                },
                duration: 600
            });
        });

        $('.radio-group .radio').click(function () {
            $(this).parent().find('.radio').removeClass('selected');
            $(this).addClass('selected');
        });

        $(".submit").click(function () {
            return false;
        })

        ComboBoxWithSearch('.select2', dir);

        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "5,9,20,30,125",  PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strMemberPostID = '<option value="">انتخاب کنید</option>';
                var strMemberEductionID = '<option value="">انتخاب کنید</option>';
                var strUniversityID = '<option value="">انتخاب کنید</option>';
                var strCompanyDocument = '';
                var strOtherDocument = '';
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].parentCode == 5) {
                        strMemberPostID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 9) {
                        strMemberEductionID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 20) {
                        strUniversityID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                     else if (res.data[i].parentCode == 30) {
                        strCompanyDocument += " <tr><td>" + " <div class='form-group'><label class='control-label col-md-4' for=''>" + res.data[i].label + "<span class='RequiredLabel'>*</span></label><div class='col-md-8'><input type='file'  class='form-control'/></div></div></td> <td><a href='#'>مشاهده </a></td></tr>";
                    }
                    else if (res.data[i].parentCode == 125) {
                       
                        strOtherDocument += " <tr><td>" + " <div class='form-group'><label class='control-label col-md-4' for=''>" + res.data[i].label + "<span class='RequiredLabel'>*</span></label><div class='col-md-8'><input type='file'  class='form-control'/></div></div></td> <td><a href='#'>مشاهده </a></td></tr>";
                    }

                }
                

                $("#MemberPostID").html(strMemberPostID);
                $("#MemberEductionID").html(strMemberEductionID);
                $("#UniversityID").html(strUniversityID);
                $("#CompanyDocument").html(strCompanyDocument);
                $("#OtherDocument").html(strOtherDocument);

              //  $("#HowGetKnowCompany").val(resSingle.howGetKnowCompanyId);
              //  $("#KindOfCompany").val(resSingle.kindOfCompanyId);
              //  $("#TypeServiceRequestedId").val(resSingle.typeServiceRequestedId);

                

            }
        }, true);
    }

   // $('.OpenUpload').click(function () { $('#CustomeFileupload').trigger('click'); });

    function initFurtherInfo(dir = 'rtl') {

        ComboBoxWithSearch('.select2', dir);
       
        //AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {            
                

        //        if (res != null) {
        //            $("#AddressCompany").val(res.addressCompany);
        //            $("#CompanyName").val(res.companyName);
        //            $("#CeoName").val(res.ceoName);
        //            $("#EconomicCode").val(res.economicCode);
        //            $("#NationalCode").val(res.nationalCode);
        //            $("#CeoMobile").val(res.ceoMobile);
        //            $("#AgentMobile").val(res.agentMobile);
        //            $("#AgentName").val(res.agentName);
        //            $("#NamesAuthorizedSignatories").val(res.namesAuthorizedSignatories);
        //            $("#AmountOsLastSaels").val(res.amountOsLastSaels);
        //            $("#CountOfPersonal").val(res.countOfPersonal);
        //            $("#Email").val(res.email);
        //            $("#Tel").val(res.tel);
        //            $("#PostalCode").val(res.postalCode);

                    systemSeting_Combo();

           //     }
                           

          //  }, true);       

    }

    web.FurtherInfo = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        initFurtherInfo: initFurtherInfo,
        SystemSeting_Combo: systemSeting_Combo
    };

})(Web, jQuery);

(function (web, $) {

    //Document Ready              


    $("#frmFormMain input,textarea").on("focusout", function () {

        $(this).valid();

    });

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function saveCustomer(e) {

        $("#btnOpperationRun").attr("disabled", "");

        RemoveAllCharForPrice("AmountOsLastSales");
        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/Customers/Save_BasicInformationCustomers", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), true, function (res) {

            $("#btnOpperationRun").removeAttr("disabled");

            if (res.isSuccess) {
              
                /*alertB("ثبت", res.message, "success");*/
                /*$("SeeAllRequest").show();*/
                setlstor("fullName", $("#CompanyName").val());

                if ($("#TypeServiceRequestedId").val() == null) {
                    $(".fullNameInLayout").html(getlstor("fullName"));
                    $("#AmountOsLastSales").val(moneyCommaSepWithReturn($("#AmountOsLastSales").val()));
                    /*alertB("ثبت", "پروفایل شما ویرایش شد.", "success");*/
                    alertB("ثبت", "پروفایل شما ویرایش شد", "success", "بله متوجه شدم", function () {
                        goToUrl("/Customer/RequestForRating/Index");
                    });
                   
                } else {
                    alertB("ثبت", "پروفایل شما ویرایش شد", "success", "بله متوجه شدم", function () {

                        goToUrl("/Customer/RequestForRating/Index");

                    });
                   
                }

            }
            else {

                $("#AmountOsLastSales").val(moneyCommaSepWithReturn($("#AmountOsLastSales").val()));

                alertB("خطا", res.message, "error");
            }

        }, true);



    }

    function saveMobileUser(e) {

        $("#btnSaveMobileUser").attr("disabled", "");
       
        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/Customers/Save_BasicInformationCustomers", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), true, function (res) {

            $("#btnSaveMobileUser").removeAttr("disabled");

            if (res.isSuccess) {

                alertB("ثبت", res.message, "success");
             

            }
            else {
                alertB("خطا", res.message, "error");
            }

        }, true);


    }


    function systemSeting_Combo(resSingle, showdrp) {


        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "126,63,27,56,221", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';
                var strHowGetKnowCompany = '<option value="">انتخاب کنید</option>';
                var strTypeServiceRequestedId = '<option value="">انتخاب کنید</option>';
                var strCustomerPersonalityType = '<input type="hidden" name="CustomerPersonalityType" id="CustomerPersonalityType">';
                var strTypeGroupCompanies = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].parentCode == 56) {
                        strHowGetKnowCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                    else if (res.data[i].parentCode == 63) {
                        strTypeServiceRequestedId += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                    else if (res.data[i].parentCode == 27) {
                        strKindOfCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                    else if (res.data[i].parentCode == 221 && isEmpty(resSingle.customerPersonalityType)) {
                        strCustomerPersonalityType += "<input type='radio' value=" + res.data[i].systemSetingId + " name='CustomerPersonalityTypeStr' id='CustomerPersonalityTypeStr' onchange='Web.Customer.OnChangeCustomerPersonalityType(this);' style='margin-right: 30px;'>" + res.data[i].label;
                    }
                    else if (res.data[i].parentCode == 126) {
                        strTypeGroupCompanies += "<option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                }


                $("#divCustomerPersonalityTypeRadio").html(strCustomerPersonalityType);
                $("#CustomerPersonalityTypeStr[value='" + resSingle.customerPersonalityType + "']").prop("checked", true);

                $("#CustomerPersonalityType").val(resSingle.customerPersonalityType);

                if (!isEmpty(resSingle.customerPersonalityType)) $("#divCustomerPersonalityType").hide();

                temp_OnChangeCustomerPersonalityType(resSingle.customerPersonalityType);


                $("#TypeGroupCompanies").html(strTypeGroupCompanies);
                $("#TypeGroupCompanies").val(resSingle.typeGroupCompanies);

                $("#KindOfCompanyId").html(strKindOfCompany);
                $("#HowGetKnowCompanyId").html(strHowGetKnowCompany);

                $("#HowGetKnowCompanyId").val(resSingle.howGetKnowCompanyId);
                $("#KindOfCompanyId").val(resSingle.kindOfCompanyId);

                if (showdrp) {
                    $("#TypeServiceRequestedId").html(strTypeServiceRequestedId);
                    $("#TypeServiceRequestedId").val('66');
                }

                validate();

                $("#CountOfPersonal").keyup();
                $("#AmountOsLastSales").keyup();
            }
        }, true);
    }

    function validate() {

        $.validator.addMethod(
            "CeoMobileValidation",
            function (value, element) {
                return CheckMobile(value);
            },
            "موبایل مدیر عامل خود را به درستی وارد نمایید"
        );
        $.validator.addMethod(
            "AgentMobileValidation",
            function (value, element) {
                return CheckMobile(value);
            },
            function () {
                return $("#Span_Label_AgentMobile").text() + " " + ($("#CustomerPersonalityType").val() != "223" ? "شرکت/مشاور " : " ") + " خود را به درستی وارد نمایید";
            }
        );
        $.validator.addMethod(
            "TelValidation",
            function (value, element) {
                return CheckTel(value);
            },
            function () {
                return "شماره تلفن ثابت خود را به درستی وارد نمایید";
            }
        );

        $.validator.addMethod(
            "AmountOsLastSalesValidation",
            function (value, element) {
                return value.indexOf("/") !== -1 ? false: true;
            },
            function () {
                return "مبلغ وارد شده نامعتبر می باشد لطفا مبلغ را دستی وارد کنید";
            }
        );

        $("form[id='frmFormMain']").validate({
            // Specify validation rules
            rules: {
                "CompanyName": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },
                "CeoMobile": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 11,
                    maxlength: 11,
                    CeoMobileValidation: $("#CeoMobile").val(),
                },
                "CeoName": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 5,
                    maxlength: 50
                },
                "CeoNationalCode": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 10,
                    maxlength: 10
                },
                "EconomicCode": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 3,
                    maxlength: 50
                },
                "NationalCode": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 10,
                    maxlength: 11
                },
                "NationalCodeRepresentative": {
                    minlength: 10,
                    maxlength: 10
                },
                "AgentName": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },
                "EmailRepresentative": {
                    minlength: 5,
                    maxlength: 50,
                    email: true
                },
                "AgentMobile": {
                    required: function () {
                        return true;
                    },
                    minlength: 11,
                    maxlength: 11,
                    AgentMobileValidation: $("#AgentMobile").val(),
                },
                "AddressCompany": {
                    required: function () {
                        return true;
                    },
                },
                "CountOfPersonal": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    maxlength: 9
                },
                "HowGetKnowCompanyId": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                },
                "KindOfCompanyId": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                },
                "TypeGroupCompanies": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                },
                "Email": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50,
                    email: true
                },
                "Tel": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 11,
                    maxlength: 11,
                    TelValidation: $("#Tel").val(),
                },
                "PostalCode": {
                    required: function () {
                        return true;
                    },
                    minlength: 10,
                    maxlength: 10
                },
                "EconomicCodeReal": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 10,
                    maxlength: 12
                },
                "AmountOsLastSales": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    maxlength: 18,
                    AmountOsLastSalesValidation: $("#AmountOsLastSales").val(),
                },
            },
            // Specify validation error messages
            messages: {
                "CompanyName": {
                    required: function () {
                        return "لطفا " + $("#LabelCompanyName").text() + " را وارد کنید";
                    },
                    minlength: $("#LabelCompanyName").text() + " باید حداقل 5 حرف باشد",
                    maxlength: $("#LabelCompanyName").text() + " باید حداکثر 50 حرف باشد"
                },
                "CeoMobile": {
                    required: function () {
                        return "لطفا موبایل مدیر عامل را وارد کنید";
                    },
                    minlength: "موبایل مدیر عامل باید حداقل 11 حرف باشد",
                    maxlength: "موبایل مدیر عامل باید حداکثر 11 حرف باشد",
                },
                "CeoName": {
                    required: function () {
                        return "لطفا نام مدیر عامل را وارد کنید";
                    },
                    minlength: "نام مدیر عامل باید حداقل 5 حرف باشد",
                    maxlength: "نام مدیر عامل باید حداکثر 50 حرف باشد"
                },
                "CeoNationalCode": {
                    required: function () {
                        return "لطفا کد ملی مدیر عامل را وارد کنید";
                    },
                    minlength: "کد ملی مدیر عامل باید حداقل 10 حرف باشد",
                    maxlength: "کد ملی مدیر عامل باید حداکثر 10 حرف باشد"
                },
                "EconomicCode": {
                    required: function () {
                        return "لطفا " + $("#LabelEconomicCode").text() + " را وارد کنید";
                    },
                    minlength: $("#LabelEconomicCode").text() + " باید حداقل 3 حرف باشد",
                    maxlength: $("#LabelEconomicCode").text() + " باید حداکثر 50 حرف باشد"
                },
                "NationalCode": {
                    required: function () {
                        return "لطفا شناسه ملی  شرکت را وارد کنید";
                    },
                    minlength: "شناسه ملی  شرکت باید حداقل 10 حرف باشد",
                    maxlength: "شناسه ملی  شرکت باید حداکثر 11 حرف باشد"
                },
                "NationalCodeRepresentative": {
                    minlength: "کد ملی نماینده شرکت/ مشاور باید حداقل 10 حرف باشد",
                    maxlength: "کد ملی نماینده شرکت/ مشاور باید حداکثر 10 حرف باشد"
                },
                "AgentName": {
                    required: function () {
                        return "لطفا نام نماینده شرکت/ مشاور شرکت را وارد کنید";
                    },
                    minlength: "نام نماینده شرکت/ مشاور شرکت باید حداقل 5 حرف باشد",
                    maxlength: "نام نماینده شرکت/ مشاور شرکت باید حداکثر 50 حرف باشد"
                },
                "EmailRepresentative": {
                    minlength: "ایمیل نماینده شرکت/ مشاور باید حداقل 5 حرف باشد",
                    maxlength: "ایمیل نماینده شرکت/ مشاور باید حداکثر 50 حرف باشد",
                    email: "لطفا ایمیل نماینده شرکت/ مشاور معتبر وارد کنید"
                },
                "AgentMobile": {
                    required: function () {
                        return "لطفا " + $("#Span_Label_AgentMobile").text() + ($("#CustomerPersonalityType").val() != "223" ? "شرکت/مشاور " : " ") + " را وارد کنید";
                    },
                    minlength: function () {
                        return $("#Span_Label_AgentMobile").text() + " " + ($("#CustomerPersonalityType").val() != "223" ? "شرکت/مشاور " : "") + " باید حداقل 11 حرف باشد";
                    },
                    maxlength: function () {
                        return $("#Span_Label_AgentMobile").text() + " " + ($("#CustomerPersonalityType").val() != "223" ? "شرکت/مشاور " : "") + " باید حداکثر 11 حرف باشد";
                    }
                },
                "AddressCompany": {
                    required: function () {
                        return "لطفا آدرس را وارد کنید";
                    },
                },
                "CountOfPersonal": {
                    required: function () {
                        return "لطفا تعداد کارکنان " + ($("#CustomerPersonalityType").val() != "223" ? "شرکت " : " ") + " را وارد کنید";
                    },
                    maxlength: function () {
                        return "تعداد کارکنان " + ($("#CustomerPersonalityType").val() != "223" ? "شرکت " : "") + " باید حداکثر 9 حرف باشد";
                    }
                },
                "HowGetKnowCompanyId": {
                    required: function () {
                        return "لطفا نحوه آشنایی با شرکت را انتخاب کنید";
                    },
                },
                "KindOfCompanyId": {
                    required: function () {
                        return "لطفا نوع  فعالیت شرکت را انتخاب کنید";
                    },
                },
                "TypeGroupCompanies": {
                    required: function () {
                        return "لطفا " + $("#LabelTypeGroupCompanies").text() + " را انتخاب کنید";
                    },
                },
                "Email": {
                    required: function () {
                        return "لطفا ایمیل شرکت را وارد کنید";
                    },
                    minlength: "ایمیل شرکت باید حداقل 5 حرف باشد",
                    maxlength: "ایمیل شرکت باید حداکثر 50 حرف باشد",
                    email: "لطفا ایمیل شرکت معتبر وارد کنید"
                },
                "Tel": {
                    required: function () {
                        return "لطفا شماره تلفن ثابت را وارد کنید";
                    },
                    minlength: "شماره تلفن ثابت باید حداقل 11 حرف باشد",
                    maxlength: "شماره تلفن ثابت باید حداکثر 11 حرف باشد"
                },
                "PostalCode": {
                    required: function () {
                        return "لطفا کد پستی را وارد کنید";
                    },
                    minlength: "کد پستی باید حداقل 10 حرف باشد",
                    maxlength: "کد پستی باید حداکثر 10 حرف باشد"
                },
                "EconomicCodeReal": {
                    required: function () {
                        return "لطفا کد اقتصادی را وارد کنید";
                    },
                    minlength: "کد اقتصادی باید حداقل 10 حرف باشد",
                    maxlength: "کد اقتصادی باید حداکثر 12 حرف باشد"
                },
                "AmountOsLastSales": {
                    required: function () {
                        return "لطفا درآمد عملیاتی بر اساس صورت های مالی حسابرسی شده را وارد کنید";
                    },
                    maxlength: "درآمد عملیاتی بر اساس صورت های مالی حسابرسی شده باید حداکثر 18 رقم باشد"                    
                },
            },
            // Make sure the form is submitted to the destination defined
            // in the "action" attribute of the form when valid
            submitHandler: function (form) {

                if ($("#divTypeServiceRequestedId:hidden").length === 0) {

                    confirmB("", "مشتری محترم در نظر داشته باشید چون معیار و مبنای شروع ارزیابی بر اساس اطلاعات پایه شما می باشد لذا در صورت اطمینان از صحت ورود اطلاعات تایید کنید پس از تایید امکان ویرایش وجود ندارد", "warning", function () {

                        Web.Customer.SaveCustomer(this);

                    }, function () {

                    }, ["انصراف از ثبت", "بله مطمئنم"]);

                }
                else {

                    Web.Customer.SaveCustomer(this);

                }




            }
        });

    }

    function checkForFirstRequest(resSingle) {
        Web.RequestForRating.RegistingFirstRequest(function (res) {

            if (res.isSuccess) {
                if (res.data.length > 0) {
                    $("#divTypeServiceRequestedId").hide();
                    systemSeting_Combo(resSingle, false);
                }

                else {
                    $("#divTypeServiceRequestedId").show();
                    systemSeting_Combo(resSingle, true);
                }
            }

        });
    }

    function initCustomer(dir = 'rtl') {

        ComboBoxWithSearch('.select2', dir);

        AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {


            if (res != null) {
                $("#AddressCompany").val(res.addressCompany);
                $("#CompanyName").val(res.companyName);
                $("#CeoName").val(res.ceoName);
                $("#EconomicCode").val(res.economicCode);
                $("#EconomicCodeReal").val(res.economicCodeReal);
                $("#NationalCode").val(res.nationalCode);
                $("#CeoNationalCode").val(res.ceoNationalCode);
                $("#CeoMobile").val(res.ceoMobile);
                $("#AgentMobile").val(res.agentMobile);
                $("#AgentName").val(res.agentName);
                $("#NamesAuthorizedSignatories").val(res.namesAuthorizedSignatories);
                Tagsinput("NamesAuthorizedSignatories");

                $("#CountOfPersonal").val(res.countOfPersonal);

                $("#Email").val(res.email);
                $("#Tel").val(res.tel);
                $("#PostalCode").val(res.postalCode);
                $("#AmountOsLastSales").val(moneyCommaSepWithReturn(!isEmpty(res.amountOsLastSales) ? res.amountOsLastSales.toString() : ''));

                $("#EmailRepresentative").val(res.emailRepresentative);
                $("#NationalCodeRepresentative").val(res.nationalCodeRepresentative);

                $("input[name='AuditedFinancialStatements']").val(res.auditedFinancialStatements);
                $("input[name='LastInsuranceList']").val(res.lastInsuranceList);

                $("input[name='ScanCustomerNationalCard']").val(res.scanCustomerNationalCard);
                $("input[name='ScanManagerNationalCard']").val(res.scanManagerNationalCard);
                if (res.scanCustomerNationalCard != null && res.scanCustomerNationalCard != "") {
                    $("#divDownload_ScanCustomerNationalCard").html("<a class='btn btn-success' href='" + res.scanCustomerNationalCardFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                }
                if (res.scanManagerNationalCard != null && res.scanManagerNationalCard != "") {
                    $("#divDownload_ScanManagerNationalCard").html("<a class='btn btn-success' href='" + res.scanManagerNationalCardFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                }

                if (res.lastInsuranceList != null && res.lastInsuranceList != "") {
                    $("#divDownload").html("<a class='btn btn-success' href='" + res.lastInsuranceListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                }
                if (res.auditedFinancialStatements != null && res.auditedFinancialStatements != "") {
                    $("#divDownload_AuditedFinancialStatements").html("<a class='btn btn-success' href='" + res.auditedFinancialStatementsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                }
                checkForFirstRequest(res);
                // systemSeting_Combo(res);



            }
            else {
                Tagsinput("NamesAuthorizedSignatories");
            }

        }, true);

    }

    function onChangeCustomerPersonalityType(e) {

        temp_OnChangeCustomerPersonalityType($(e).val());

    }

    function temp_OnChangeCustomerPersonalityType(val) {

        $("label[class='error']").text('');

        if (val == "223") {

            $(".form-group").hide();
            $(".form-group.FormIsShow").show();
            $(".NotShowRequiredLabel").hide();
            $("#LabelTypeGroupCompanies").html("نوع فعالیت");
            $("#LabelEconomicCode").html("شماره کارت بازرگانی");
            $("#LabelCompanyName").html("نام و نام خانوادگی");
            $("#Span_Label_AgentMobile").html("شماره موبایل / شماره موبایل نماینده ");
            $("#LabelAgentName").html("نام نماینده ");

            $("#spanScanCustomerNationalCardReq").show();
            $("#spanScanManagerNationalCardReq").hide();
        }
        else {

            $(".form-group").show();
            $(".NotShowRequiredLabel").show();
            $("#LabelTypeGroupCompanies").html("نوع فعالیت شرکتها");
            $("#LabelEconomicCode").html("شماره ثبت");
            $("#LabelCompanyName").html("نام شرکت");
            $("#Span_Label_AgentMobile").html("شماره نماینده");

            $("#spanScanCustomerNationalCardReq").hide();
            $("#spanScanManagerNationalCardReq").hide();
        }

        $("#CustomerPersonalityType").val(val);

    }

    function onKeyPressInCountOfPersonal(event) {

        if ($(event).val() == "0") {
            $("#spanListLastBimeReq").hide();
        }
        else {
            $("#spanListLastBimeReq").show();
        }

    }

    function onkeuUpInAmountOsLastSales(e) {

        if ($(e).val() == "0") {

            $("#Span_Label_Result_Final_AuditedFinancialStatements").hide();

        }
        else {
            $("#Span_Label_Result_Final_AuditedFinancialStatements").show();
        }

        TextBoxOnlyPrice(e);

    }

    web.Customer = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        SaveCustomer: saveCustomer,
        InitCustomer: initCustomer,
        SystemSeting_Combo: systemSeting_Combo,
        CheckForFirstRequest: checkForFirstRequest,
        OnChangeCustomerPersonalityType: onChangeCustomerPersonalityType,
        OnKeyPressInCountOfPersonal: onKeyPressInCountOfPersonal,
        OnkeuUpInAmountOsLastSales: onkeuUpInAmountOsLastSales,
        SaveMobileUser: saveMobileUser
    };

})(Web, jQuery);






(function (web, $) {

    //Document Ready              

    function signOutForExitToLogin() {

        AjaxCallActionWithotHeading("POST", "/api/Securitys/SignOutForExitToLogin", JSON.stringify({ Userid: getlstor("customerID"), AreaName: "مشتری" }), true, function (res) {
            debugger;
            if (res.isSuccess) {

                localStorage.removeItem("token");

                dellstor("fullName");
                dellstor("customerID");
                dellstor("userID");
                dellstor("loginName");


                goToUrl("/Account/Login");

            }

        }, false);

    }

    function initLayout() {

        if (isEmpty(localStorage.getItem("token"))) goToUrl("/Account/Login");
        else {

            $(".fullNameInLayout").html(getlstor("fullName"));

        }

    }

    web.Layout = {

        SignOutForExitToLogin: signOutForExitToLogin,
        InitLayout: initLayout

    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {

                var strM = '';

                for (var i = 0; i < res.data.length; i++) {
                    var st = "", st2 = "";
                    if (res.data[i].kindOfRequest == 254) {
                        if (res.data[i].destLevelStepAccessRole == "10" && res.data[i].destLevelStepIndex == "7") {

                            st2 = "<span style='font-size:1.5em'> &#128194;</span> ";
                        }
                        strM += "<tr><td>" + (i + 1) + "</td><td>"
                            + res.data[i].kindOfRequestName + "</td><td>"
                            + res.data[i].dateOfRequestStr + "</td>";
                        if (res.data[i].sendUser != null) {
                            strM += "<td style='font-size:x-small'>" + (res.data[i].comment == null ? "" : res.data[i].comment) + "</td>";
                        } else {
                            strM += "<td></td>";
                        }

                        if (res.data[i].levelStepSettingIndexID == "29") {
                            strM += "<td>" + "<span style='color:red'>&#10060;" + "عدم تایید قرارداد" + "</span>" + "</td><td>";
                        } else if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                            strM += "<td>" + "<span style='color:red'> &#10060; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
                        }
                        else {
                            strM += "<td>" + st2
                                + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                                + res.data[i].levelStepStatus + "</td><td>";
                        }
                        strM += "<a style='margin-right:5px;color:black' href='/Customer/RequestForRating/RequestReferences?id=" + res.data[i].requestId + "'" + " class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title='مشاهده گردش کار'> </a>";
                        if (getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                            if (res.data[i].destLevelStepIndex == 4) {
                                strM += "<a style='margin-right:5px;' title='تایید قرارداد و بارگذاری قرارداد ' class='btn btn-success fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward'></i> تایید قرارداد و بارگذاری قرارداد </a>";

                            }

                            if (res.data[i].destLevelStepIndex == 11 && getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                                strM += "<a style='margin-right:5px;color:black' title='بارگذاری سند تسویه نهایی ' class='btn btn-info fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward' style='color:black'></i> بارگذاری سند تسویه نهایی </a>";

                            }
                        }
                        if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                            strM += "<a style='margin-right:5px;color:black' title='اصلاح/ تکمیل اطلاعات'  class='btn btn-edit fontForAllPage' href='/Customer/Customer/EditCustomer/" + res.data[i].requestId + "'><i class='fa fa-edit'></i> اصلاح/ تکمیل اطلاعات اولیه</a>";
                            strM += "<button style='margin-right:5px;color:black' class='btn btn-info fontForAllPage' type='button'  onclick='Web.RequestForRating.SaveReferralRequestForRatingAgain(this," + res.data[i].requestId + ");'>ارسال مجدد </button >";

                        }
                        if (res.data[i].destLevelStepIndex == 105) {
                            //   strM += "<button type='button' style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-success fontForAllPage'  onclick='Web.RequestForRating.ShowFurtherInfo(this," + res.data[i].requestId + ");'><i class='fa fa-edit'></i> اطلاعات تکمیلی</button>";
                            strM += "<a style='margin-right:5px;color:black' title='پرسشنامه' class='btn btn-success fontForAllPage' href='/Customer/Corporate/index/" + res.data[i].requestId + "'><i class='fa fa-edit'></i>پرسشنامه</a>";

                        } else if (res.data[i].destLevelStepIndex >= 105 || res.data[i].destLevelStepIndexButton === "ارجاع به کارشناس ارزیاب جهت مشاهده پرسشنامه") {
                            strM += "<a style='margin-right:5px;color:black' title='اپرسشنامه' class='btn btn-default fontForAllPage' href='/Customer/Corporate/index/" + res.data[i].requestId + "'><i class='fa fa-eye'></i> پرسشنامه </a>";

                        }
                        if (res.data[i].contractDocument != null && res.data[i].contractDocument != "") {
                            strM += "<a style='margin-right:5px;color:black' title='اسناد مشتری' class='btn btn-default fontForAllPage' href='/Customer/RequestForRating/RequestDocument/" + res.data[i].requestId + "'><i class='fa fa-file-pdf-o'></i> </a>";
                        }

                        strM += "</td></tr>";
                    }
                    else if (res.data[i].kindOfRequest == 66) {
                        if (res.data[i].destLevelStepAccessRole == "10" && res.data[i].destLevelStepIndex == "7") {

                            st2 = "<span style='font-size:1.5em'> &#128194;</span> ";
                        }
                        strM += "<tr><td>" + (i + 1) + "</td><td>"
                            + res.data[i].kindOfRequestName + "</td><td>"
                            + res.data[i].dateOfRequestStr + "</td>";
                        if (res.data[i].sendUser != null) {
                            strM += "<td style='font-size:x-small'>" + (res.data[i].comment == null ? "" : res.data[i].comment) + "</td>";
                        } else {
                            strM += "<td></td>";
                        }

                        if (res.data[i].levelStepSettingIndexID == "29") {
                            strM += "<td>" + "<span style='color:red'>&#10060;" + "عدم تایید قرارداد" + "</span>" + "</td><td>";
                        } else if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                            strM += "<td>" + "<span style='color:red'> &#10060; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
                        }
                        else {
                            strM += "<td>" + st2
                                + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                                + res.data[i].levelStepStatus + "</td><td>";
                        }
                        strM += "<a style='margin-right:5px;color:black' href='/Customer/RequestForRating/RequestReferences?id=" + res.data[i].requestId + "'" + " class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title='مشاهده گردش کار'> </a>";
                        if (getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                            if (res.data[i].destLevelStepIndex == 4) {
                                strM += "<a style='margin-right:5px;' title='تایید قرارداد و بارگذاری قرارداد ' class='btn btn-success fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward'></i> تایید قرارداد و بارگذاری قرارداد </a>";

                            }

                            if (res.data[i].destLevelStepIndex == 11 && getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                                strM += "<a style='margin-right:5px;color:black' title='بارگذاری سند تسویه نهایی ' class='btn btn-info fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward' style='color:black'></i> بارگذاری سند تسویه نهایی </a>";

                            }
                        }
                        if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                            strM += "<a style='margin-right:5px;color:black' title='اصلاح/ تکمیل اطلاعات'  class='btn btn-edit fontForAllPage' href='/Customer/Customer/EditCustomer/" + res.data[i].requestId + "'><i class='fa fa-edit'></i> اصلاح/ تکمیل اطلاعات اولیه</a>";
                            strM += "<button style='margin-right:5px;color:black' class='btn btn-info fontForAllPage' type='button'  onclick='Web.RequestForRating.SaveReferralRequestForRatingAgain(this," + res.data[i].requestId + ");'>ارسال مجدد </button >";

                        }
                        if (res.data[i].destLevelStepIndex == 7) {
                            //   strM += "<button type='button' style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-success fontForAllPage'  onclick='Web.RequestForRating.ShowFurtherInfo(this," + res.data[i].requestId + ");'><i class='fa fa-edit'></i> اطلاعات تکمیلی</button>";
                            strM += "<a style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-success fontForAllPage' href='/Customer/FurtherInfo/index/" + res.data[i].requestId + "'><i class='fa fa-edit'></i> اطلاعات تکمیلی</a>";

                        } else if (res.data[i].destLevelStepIndex >= 7 || res.data[i].destLevelStepIndexButton === "ارجاع به کارشناس ارزیاب جهت مشاهده اطلاعات تکمیلی") {
                            strM += "<a style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-default fontForAllPage' href='/Customer/FurtherInfo/index/" + res.data[i].requestId + "'><i class='fa fa-eye'></i> اطلاعات تکمیلی</a>";

                        }
                        if (res.data[i].contractDocument != null && res.data[i].contractDocument != "") {
                            strM += "<a style='margin-right:5px;color:black' title='اسناد مشتری' class='btn btn-default fontForAllPage' href='/Customer/RequestForRating/RequestDocument/" + res.data[i].requestId + "'><i class='fa fa-file-pdf-o'></i> </a>";
                        }

                        strM += "</td></tr>";
                    }

                    
                    //if (res.data[i].destLevelStepAccessRole == "10" && res.data[i].destLevelStepIndex == "7") {

                    //    st2 = "<span style='font-size:1.5em'> &#128194;</span> ";
                    //}
                    //strM += "<tr><td>" + (i + 1) + "</td><td>"
                    //    + res.data[i].kindOfRequestName + "</td><td>"
                    //    + res.data[i].dateOfRequestStr + "</td>";
                    //if (res.data[i].sendUser!=null  ) {
                    //    strM += "<td style='font-size:x-small'>" + (res.data[i].comment == null ? "" : res.data[i].comment) + "</td>";
                    //} else {
                    //    strM += "<td></td>";
                    //}
                    
                    //if (res.data[i].levelStepSettingIndexID == "29") {
                    //    strM += "<td>" + "<span style='color:red'>&#10060;" + "عدم تایید قرارداد" + "</span>" + "</td><td>";
                    //} else if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                    //    strM += "<td>" + "<span style='color:red'> &#10060; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
                    //}
                    //else {
                    //    strM += "<td>" + st2
                    //        + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                    //        + res.data[i].levelStepStatus + "</td><td>";
                    //}
                    //strM += "<a style='margin-right:5px;color:black' href='/Customer/RequestForRating/RequestReferences?id=" + res.data[i].requestId + "'" + " class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title='مشاهده گردش کار'> </a>";
                    //if (getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                    //    if (res.data[i].destLevelStepIndex == 4) {
                    //        strM += "<a style='margin-right:5px;' title='تایید قرارداد و بارگذاری قرارداد ' class='btn btn-success fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward'></i> تایید قرارداد و بارگذاری قرارداد </a>";

                    //    }

                    //    if (res.data[i].destLevelStepIndex == 11 && getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                    //        strM += "<a style='margin-right:5px;color:black' title='بارگذاری سند تسویه نهایی ' class='btn btn-info fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward' style='color:black'></i> بارگذاری سند تسویه نهایی </a>";

                    //    }
                    //}
                    //if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                    //    strM += "<a style='margin-right:5px;color:black' title='اصلاح/ تکمیل اطلاعات'  class='btn btn-edit fontForAllPage' href='/Customer/Customer/EditCustomer/" + res.data[i].requestId + "'><i class='fa fa-edit'></i> اصلاح/ تکمیل اطلاعات اولیه</a>";
                    //    strM += "<button style='margin-right:5px;color:black' class='btn btn-info fontForAllPage' type='button'  onclick='Web.RequestForRating.SaveReferralRequestForRatingAgain(this," + res.data[i].requestId + ");'>ارسال مجدد </button >";

                    //}
                    //if (res.data[i].destLevelStepIndex == 7) {
                    // //   strM += "<button type='button' style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-success fontForAllPage'  onclick='Web.RequestForRating.ShowFurtherInfo(this," + res.data[i].requestId + ");'><i class='fa fa-edit'></i> اطلاعات تکمیلی</button>";
                    //    strM += "<a style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-success fontForAllPage' href='/Customer/FurtherInfo/index/" + res.data[i].requestId + "'><i class='fa fa-edit'></i> اطلاعات تکمیلی</a>";

                    //} else if (res.data[i].destLevelStepIndex >= 7 || res.data[i].destLevelStepIndexButton === "ارجاع به کارشناس ارزیاب جهت مشاهده اطلاعات تکمیلی") {
                    //    strM += "<a style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-default fontForAllPage' href='/Customer/FurtherInfo/index/" + res.data[i].requestId + "'><i class='fa fa-eye'></i> اطلاعات تکمیلی</a>";

                    //}
                    //if (res.data[i].contractDocument != null && res.data[i].contractDocument!="") {
                    //    strM += "<a style='margin-right:5px;color:black' title='اسناد مشتری' class='btn btn-default fontForAllPage' href='/Customer/RequestForRating/RequestDocument/" + res.data[i].requestId + "'><i class='fa fa-file-pdf-o'></i> </a>";
                    //}
                  
                    //strM += "</td></tr>";
                }

                $("#tBodyList").html(strM);
            }

        }, true);

    }

    function checkIsfinish(id = null) {
        var isFinish = false;
        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1, RequestId: id }), true, function (res) {

            if (res.isSuccess) {
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].isFinished) {
                        isFinish = true;
                    }
                }
            }

        }, false);
        return isFinish;

    }

    function registingFirstRequest(successCallback = null) {
        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1 }), true, function (res) {

            if (successCallback == null) {

                if (res.isSuccess) {

                    if (res.data.length == 0) {
                        goToUrl("/Customer/Customer/EditCustomer");

                    }
                }

            }
            else {

                successCallback(res);

            }
        }, false);

    }

    function dashboardInformation() {
        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1 }), true, function (res) {

            if (res.isSuccess) {

                if (res.data.length == 0) {
                    goToUrl("/Customer/Customer/EditCustomer");

                } else
                {
                    var IsFinishCount = 0;
                    for (var i = 0; i < res.data.length; i++) {
                        if (res.data[i].isFinished == true) {
                            IsFinishCount++;
                        }
                    }
                    $("#RequestCount").text("(" + res.data.length + ")");
                    $("#RequestIsFinishedCount").text("("+IsFinishCount+")");
                }
            }
        }, true);

    }

    function get_Detail(id = null) {
        try {

            AjaxCallAction("GET", "/api/customer/RequestForRating/InitReferral/" + id, null, true, function (res) {

                getU("/css/GlobalAreas/Views/Customer/RequestForRating/P_Referral.html", function (resG) {

                    InitModal_Withot_Par("مشاهده جزییات", resG, "", true, "width:100%;");

                    $("#sdklsslks3498sjdkxhjsd_823sb").val(encrypt(id.toString(), keyMaker()));


                    if (res.isSuccess) {

                        var htmlB = "<div class='form-group'><label for='ReferralExplanation'>توضیح ارجاع</label><textarea class='form-control' id='ReferralExplanation' rows='5'></textarea></div>";
                        for (var i = 0; i < res.data.length; i++) {

                            htmlB += "<button type='button' id='btnReference' class='btn btn-warning ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "'>" + res.data[i].destLevelStepIndexButton + "</button>";

                        }

                        $("#bLLSS").html(htmlB);

                    }
                    else {

                        $("#bLLSS").html("");

                    }

                });

            }, true);

        } catch (e) {

        }


    }

    function saveRequestForRating(e) {

        $(e).attr("disabled", "");

        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_Request", JSON.stringify({ Request: { KindOfRequest: isEmpty($("#TypeServiceRequestedId").val()) ? null : $("#TypeServiceRequestedId").val() } }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                //  alertB("پیام", res.message, "success");

                goToUrl("/Customer/RequestForRating/Index");

            }
            else {

                alertB("هشدار", res.message, "warning");

            }

        }, true);

    }

    function saveContractAndFinancialDocument(e) {
        if ($("#EvaluationFile").val() != null && $("#EvaluationFile").val() != "") {

            if (document.getElementById("LastFinancialDocument").files.length == 0) {
                alertB("هشدار", "فایل  سند تسویه را انتخاب نکرده اید!.", "warning");
            }
            else {
                $(e).attr("disabled", "");
                $("#EditStatuse").val("12");
                AjaxCallActionPostSaveFormWithUploadFile("/api/customer/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), true, function (res) {
                   
                    $(e).removeAttr("disabled");

                    if (res.isSuccess) {
                        $("#btnreq").click();
                        // alertB("ثبت", "مدارک با موفقیت ثبت شد.", "success");
                        /*$("SeeAllRequest").show();*/
                        //  goToUrl("/Customer/RequestForRating/Index");

                    } else {

                        $("#AmountOsLastSales").val(moneyCommaSepWithReturn($("#AmountOsLastSales").val()));

                        alertB("خطا", res.message, "error");
                    }

                }, true);

            }
        }
        else if (document.getElementById("ContractDocument").files.length == 0 || document.getElementById("FinancialDocument").files.length == 0) {
            alertB("هشدار", "فایل قرارداد یا سند پرداخت را انتخاب نکرده اید!.", "warning");
        }
        else {
            $(e).attr("disabled", "");
            $("#EditStatuse").val("5");
            AjaxCallActionPostSaveFormWithUploadFile("/api/customer/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), true, function (res) {

                $(e).removeAttr("disabled");

                if (res.isSuccess) {
                    $("#btnreq").click();
                    // alertB("ثبت", "مدارک با موفقیت ثبت شد.", "success");
                    /*$("SeeAllRequest").show();*/
                    //  goToUrl("/Customer/RequestForRating/Index");

                } else {

                    $("#AmountOsLastSales").val(moneyCommaSepWithReturn($("#AmountOsLastSales").val()));

                    alertB("خطا", res.message, "error");
                }

            }, true);

        }

    }

    function systemSeting_ComboRequestForRating() {

        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strTypeServiceRequestedId = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strTypeServiceRequestedId += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                }
                $("#TypeServiceRequestedId").html(strTypeServiceRequestedId);
                // $("#TypeServiceRequestedId").val(resSingle.typeServiceRequestedId);
            }
        }, true);
    }

    function initRequestForRating() {


        ComboBoxWithSearch('.select2', 'dir');
        systemSeting_ComboRequestForRating();

    }

    function initRequestReferences(id = null) {

        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1, RequestId: id }), true, function (res) {

            if (res.isSuccess) {
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].isFinished) {
                        createTimeLine(id, true);
                    } else {
                        createTimeLine(id, false);
                    }
                }
            }

        }, true);


    }

    function createTimeLine(id = null, isFinish) {

        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestReferencessService", JSON.stringify({ RequestId: id }), true, function (res) {

            if (res != null) {
                var strTimeLine = '';
                var left = false;

                for (var i = 0; i < res.data.length; i++) {
                    if ((res.data[i].levelStepAccessRole == "10" || res.data[i].sendUser == null) && i!=1) {
                        var bgColor = i == 0 ? "bg-secondary" : "bg-info";

                        strTimeLine += "<article class='timeline-entry " + (left ? " left-aligned" : "") + "'>";
                        strTimeLine += "<div class='timeline-entry-inner'>";

                        strTimeLine += "<time class='timeline-time' datetime=''>";
                       // strTimeLine += "<span class='date'>" + res.data[i].sendTimeStr + "</span>";
                       // strTimeLine += "<span class='LTRDirection'>" + res.data[i].sendTimeTimeStr + "</span>";
                        strTimeLine += "</time>";

                        strTimeLine += "<div class='timeline-icon " + bgColor + "'>";
                        strTimeLine += "<i class='entypo-feather'></i>";
                        strTimeLine += "</div>";

                        strTimeLine += "<div class='timeline-label'>";
                        if (i == 0) {
                            strTimeLine += "<span class='smallFontSize' style='font-weight:bold'>";
                            strTimeLine += (res.data[i].agentName == null ? res.data[i].companyName : res.data[i].agentName) + " : [" + res.data[i].kindOfRequestName + "]</span >";

                            strTimeLine += "<div style='float:left;color:green'><span class='date smallFontSize'>( تاریخ: " + res.data[i].sendTimeStr + "</span>";
                            strTimeLine += "<span class='LTRDirection smallFontSize'> ساعت: " + res.data[i].sendTimeTimeStr + " )</span></div>";
                           
                        }
                        else {
                            if (res.data[i].sendUser == null) {
                                strTimeLine += "<span class='boxCounter'>" + i.toString() + "</span>"
                                    + (res.data[i].levelStepSettingIndexID == "29" ? " &#x274C; " : "")
                                    + (res.data[i].levelStepSettingIndexID == "7" ? " &#x2705; " : "")
                                    + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                                    + "<span class='sender'>ارجاع از: مشتری" + (res.data[i].agentName == null ? " (" + res.data[i].companyName + ")" : " (" + res.data[i].agentName + ")") + "</span><br/>";
                                strTimeLine += " <span>به: " + res.data[i].roleDesReciver + " </span>";
                                strTimeLine += "<span class='sender'>" + " (" + res.data[i].reciverName + ")" + "</span>";
                            }
                            else if (res.data[i].reciverName == null) {
                                strTimeLine += "<span class='boxCounter'>" + i.toString() + "</span>"
                                    + (res.data[i].levelStepSettingIndexID == "4" ? " &#x1F4DD;" : "")
                                    + (res.data[i].levelStepSettingIndexID == "11" ? " &#x1F4C2;" : "")
                                    + " <span> ارجاع از:  " + res.data[i].userRoleDes + " (" + res.data[i].realName + ")"                                    
                                    + " </span><br/>";
                                strTimeLine += " <span>به: " + "مشتری" + " </span>";
                                strTimeLine += "<span class='sender'>" + (res.data[i].agentName == null ? " (" + res.data[i].companyName + ")" : " (" + res.data[i].agentName + ")") + "</span>";
                            }
                            else {
                                strTimeLine += "<span class='boxCounter'>" + i.toString() + "</span>"

                                    + (res.data[i].roleDesReciver != null ? " <span> ارجاع از:  " + res.data[i].userRoleDes + " (" + res.data[i].realName + ")"
                                        + " </span><br/>" : "");
                                strTimeLine += " <span>به: " + res.data[i].roleDesReciver + " </span>";
                                strTimeLine += "<span class='sender'>" + " (" + res.data[i].reciverName + ")" + "</span>";
                            }
                            strTimeLine += "<br/>";
                            strTimeLine += "<span class='smallFontSize'>";
                            strTimeLine += "[" + res.data[i].destLevelStepIndexButton + "]";
                            // strTimeLine += "[ جهت اقدام] <span >[ خوانده شده ] </span><span class='greenColor'>1401/09/21  3:34</span>";
                            strTimeLine += "</span>";
                            strTimeLine += "<div style='float:left;color:green'><span class='date smallFontSize'>( تاریخ: " + res.data[i].sendTimeStr + "</span>";
                            strTimeLine += "<span class='LTRDirection smallFontSize'> ساعت: " + res.data[i].sendTimeTimeStr + ")</span></div>";


                        }
                        strTimeLine += "<span></span>";
                        if (i != 0)
                        {
                            if (res.data[i].comment != null && res.data[i].comment!="") {

                                strTimeLine += "<div class='customDiv'>توضیحات<br/>";
                                strTimeLine += "<span class='Transcript'>" + res.data[i].comment + "</span>";
                                strTimeLine += "</div>";
                            }
                        }
                        strTimeLine += "</div>";
                        //res.data[i].kindOfRequestName

                        strTimeLine += "</div>";
                        strTimeLine += "</article>";
                        left = !left;
                    }

                }
                if (isFinish) {
                    strTimeLine += "<article class='timeline-entry " + (left ? " left-aligned" : "") + "'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";
                    strTimeLine += "<time class='timeline-time' datetime='2014-01-10T03:45'><span>اختتام درخواست</span></time>";
                    strTimeLine += "<div class='timeline-icon bg-secondary'><i class='entypo-feather'></i></div>";
                    strTimeLine += "<div class='timeline-label'>";
                    strTimeLine += "<h2>";
                    strTimeLine += "<span>اختتام درخواست </span>";
                    // strTimeLine += "<span class='sender''>مهندس</span>";
                    strTimeLine += "</h2>";
                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                } else {
                    strTimeLine += "<article class='timeline-entry begin'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";
                    strTimeLine += "<div class='timeline-icon' style='-webkit-transform: rotate(-90deg); -moz-transform: rotate(-90deg);'>";
                    strTimeLine += "<i class='entypo-flight'></i>";
                    strTimeLine += "</div>";
                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                }

                $("#TimeLine").html(strTimeLine);

            }

        }, true);

    }

    function initReferral(id = null) {

        AjaxCallAction("GET", "/api/Customer/RequestForRating/InitReferral/" + id, null, true, function (res) {

            if (res.isSuccess) {

                getU("/css/GlobalAreas/Views/Customer/RequestForRating/P_Referral.html", function (resG) {

                    $("#divMAS").html(resG);
                    $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(id.toString(), keyMaker()));
                    $("#sdklsslks3498sjdkxhjsd_823sdel").val(res.data[0].sendUser);
                    $("#phch").show();

                    var htmlB = "";
                    for (var i = 0; i < res.data.length; i++) {

                        htmlB += "<button type='button' id='btnreq' style='margin:5px' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);' " + "data-SIndex='" + res.data[i].levelStepSettingIndexId +"' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "' data-SC='" + encrypt(res.data[i].smsContent, keyMaker()) + "' data-ST='" + res.data[i].smsType + "' data-DLSIB='" + encrypt(res.data[i].destLevelStepIndexButton, keyMaker()) + "'>" + res.data[i].destLevelStepIndexButton + "</button>";

                    }

                    $("#bLLSS").html(htmlB);
                    showContract();
                    // Ckeditor("ReferralExplanation");
                });
            }
            else {

                $("#divMAS").html("<div class='alert alert-error text-center' style='font-size: 20px;'>شما اجازه انجام این عملیات را ندارید</div>");
                $("#phch").hide();
                $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt('0', keyMaker()));
                $("#bLLSS").html("");
                Ckeditor("ReferralExplanation");
            }

        }, true);

    }

    function getContractInfo(id = null) {

        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {

                    getU("/css/GlobalAreas/Views/customer/RequestForRating/P_Contract.html", function (resG) {

                        $("#contractInfo").html(resG);
                        $("#RequestId").val(id);
                        for (var i = 0; i < res.data.length; i++) {

                            initContract(res.data[i].requestId);
                        }

                    });

                }

            }, true);
        }
    }

    function getDocument(id = null) {
        if (id==null) {
            var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        }
        
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    if (res.data.contractCode == null) {
                        $("#LoadContractCustomer").remove();

                    } else {
                        $("#frmOkContract").remove();
                        $("#ContractCusmerMsg").remove();
                        $("#FinancialID").val(res.data.financialId);
                        $("#RequestID").val(res.data.requestID);

                             if ((res.data.committeeEvaluationFile != null && res.data.committeeEvaluationFile != "") || (res.data.evaluationFile != null && res.data.evaluationFile != "")) {
                                 $("#FirstDoc").remove();
                                 $("#upcontract").remove();
                                 $("#EvaluationFile").val(res.data.evaluationFile);
                        }
                        else {
                            $("#UpLastFinancialDocument").remove();
                        }

                        if (res.data.financialDocument != null && res.data.financialDocument != "") {
                            $("#divDownloadFinancialDocument").html("<a class='btn btn-success' href='" + res.data.financialDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else {
                            $("#divDownloadFinancialDocument").html("<p style='color:silver'></p>");
                        }
                        if (res.data.financialDocument2 != null && res.data.financialDocument2 != "") {
                            $("#divDownloadFinancialDocument2").html("<a class='btn btn-success' href='" + res.data.financialDocument2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else {
                            $("#divDownloadFinancialDocument2").html("<p style='color:silver'></p>");
                        }
                        if (res.data.contractDocument != null && res.data.contractDocument != "") {
                            $("#divDownload_ContractDocument").html("<a class='btn btn-success' href='" + res.data.contractDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else {
                            $("#divDownload_ContractDocument").html("<p style='color:silver'></p>");
                        }
                        if (res.data.lastFinancialDocument != null && res.data.lastFinancialDocument != "") {
                            $("#divDownload_LastFinancialDocument").html("<a class='btn btn-success' href='" + res.data.contractDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else {
                            $("#divDownload_LastFinancialDocument").html("<p style='color:silver'></p>");
                        }
                    }

                }

            }, true);
        }
    }

    function showDocument() {

        getU("/css/GlobalAreas/Views/customer/RequestForRating/P_Document.html", function (resG) {

            $("#showDocumentRep").html(resG);
            getDocument();

        });
    }

    function initContract(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    if (res.data.contractCode != null) {
                        if ((res.data.committeeEvaluationFile != null && res.data.committeeEvaluationFile != "") || (res.data.evaluationFile != null && res.data.evaluationFile != "")) {
                            var strhtml = "<div class='bc'><p> قرارداد نمایش متن</p><div id='divDownloadContractDocumentCustomer' ></div ><br/><br/>";

                            $("#divDownloadContract").html(strhtml);
                            $("#divDownloadContract").show();
                            var PreFact = (res.data.canSeePreFactor == true? "<a style='margin-right:5px' href='/customer/RequestForRating/PrintFactor/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintPerFactor(this)' > <i class='fa fa-print'></i> پیش  فاکتور  </a >":"");
                            $("#divDownloadContractDocumentCustomer").html("<a style='margin-left:5px' href='/customer/RequestForRating/ContractPrint/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintContract(this)' > <i class='fa fa-print'></i>   نمایش قرارداد  </a>" + PreFact);

                        } else {

                            var strhtml = "<div class='bc'><p>لطفا تمام صفحات مهر و امضا در سربرگ شرکت پارس کیان انجام شود و اصل قرارداد با مهر و امضای همه صفحات به شرکت پارس کیان ارسال گردد</p><div id='divDownloadContractDocumentCustomer' ></div ><br/><br/>";

                            strhtml += "<br/><p>" + " نکته: هنگام چاپ حتما اندازه کاغذ را روی A4 تنظیم کنید و گزینه Background graphics  را انتخاب کنید." + "</p></div>";
                            $("#divDownloadContract").html(strhtml);
                            $("#divDownloadContract").show();
                            $("#divDownloadContractDocumentCustomer").html("<a style='margin-left:5px' href='/customer/RequestForRating/ContractPrint/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintContract(this)' > <i class='fa fa-print'></i>   نمایش قرارداد  </a ><a href='/customer/RequestForRating/PrintFactor/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintPerFactor(this)' > <i class='fa fa-print'></i> پیش  فاکتور  </a ><br/><br/><br/><span>علت عدم تایید</span><input type='text' id='Comment2' name='Comment2' class='form-control' /><button style='margin-right:5px' class='btn btn-edit fontForAllPage' onclick='Web.RequestForRating.SaveReferralRequestForRatingCancel(this," + id + ")'>عدم تایید </button>");

                        }

                    } else {

                        $("#FinancialID").val(res.data.financialId);                       

                        var PreFact = (res.data.canSeePreFactor == true ? "<a style='margin-right:5px' href='/customer/RequestForRating/PrintFactor/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintPerFactor(this)' > <i class='fa fa-print'></i> پیش  فاکتور  </a >" : "");

                        var strhtml = "<div class='bc'><a href='/customer/RequestForRating/ContractPrint/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintContract(this)' > <i class='fa fa-print'></i> پیش نمایش نمونه قرارداد  </a >" + PreFact+"<br/><br/>";
                        strhtml += "<p>آیا قرارداد را تایید می کنید؟ در صورت عدم تایید قرارداد، در خواست شما به کارشناس ارسال خواهد شد </p><input type = 'hidden' id ='RequestId' name ='RequestId' value='" + id + "' />";
                        strhtml += " <button type='button' style='margin-left:5px' class='btn btn-success fontForAllPage' onclick='Web.RequestForRating.OkContract(this," + id + ")'>تایید  قرارداد</button><br/><br/><span>علت عدم تایید</span><input type='text' id='Comment2' name='Comment2' class='form-control' /><button style='margin-left:5px' class='btn btn-edit fontForAllPage' onclick='Web.RequestForRating.SaveReferralRequestForRatingCancel(this," + id + ")' type='button'>عدم تایید قرارداد </button><br /></div>";
                        $("#divOkContract").html(strhtml);
                    }
                   
                }

            }, true);
        }


    }

    //function okContract(e) {

    //    var id = $("#RequestId").val();
    //    if (!isEmpty(id) && id != 0) {

    //        var objJ = {};
    //        //objJ.Values = [];
    //        //objJ.Values.push({ Text: "test1", ValueObj:"12345"});;
    //        objJ.FinancialId = 46;

    //        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_ContractAndFinancialDocumentsNoForm", JSON.stringify(objJ), true, function (res) {

    //            if (res.isSuccess) {

    //                if (res.data.contractMainCode != null && res.data.contractMainCode != "") {
    //                    $("#divOkContract").remove();
    //                    var strhtml = "<div class='bc'><p> قرارداد زیر را دانلود و سپس آن را امضاء کنید و سپس آن را از تب <span style='color: forestgreen; font - weight: bolder'>بارگذاری اسناد قرارداد و پرداخت</span> به همراه سند تسویه بارگذاری کنید.</p><div id='divDownloadContractDocumentCustomer' ></div ></div>";
    //                    $("#divDownloadContract").html(strhtml);

    //                    $("#divDownloadContract").show();

    //                    $("#divDownloadContractDocumentCustomer").html("<a class='btn btn-info' href='" + res.data.contractDocumentCustomerFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
    //                }
    //            }

    //        }, true);
    //    }
    //}

    function okContract(e, id = null) {


        $(e).removeAttr("disabled");
        $("#EditStatuse").val("4");
        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmOkContract"), true, function (res) {

            if (res.isSuccess) {

                $("#divOkContract").remove();
                var strhtml = "<div class='bc'><p> قرارداد زیر را چاپ و سپس همه صفحات آن <span style='color:red; font-size:1.5em;'>امضاء شود</span> و سپس آن را از تب <span style='color: forestgreen; font - weight: bolder'>بارگذاری اسناد قرارداد و پرداخت</span> به همراه سند تسویه بارگذاری کنید.</p><div id='divDownloadContractDocumentCustomer' ></div ><br/><br/>";
               
                strhtml += "<br/><br/><br/><span>علت عدم تایید</span><input type='text' id='Comment2' name='Comment2' class='form-control' /><button style='margin-right:5px' class='btn btn-edit fontForAllPage' onclick='Web.RequestForRating.SaveReferralRequestForRatingCancel(this," + id + ")'>عدم تایید </button><br/><p>" + " نکته: هنگام چاپ حتما اندازه کاغذ را روی A4 تنظیم کنید و گزینه Background graphics  را انتخاب کنید." + "</p></div>";
                $("#divDownloadContract").html(strhtml);
                $("#divDownloadContract").show();
                $("#divDownloadContractDocumentCustomer").html("<a href='/customer/RequestForRating/ContractPrint/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintContract(this)' > <i class='fa fa-print'></i>   نمایش قرارداد  </a ><a style='margin-right:5px;' href='/customer/RequestForRating/PrintFactor/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintPerFactor(this)' > <i class='fa fa-print'></i> پیش  فاکتور  </a >");

            } else {
                alertB("خطا", res.message, "error");
            }

        }, true);




    }

    function cancelContract(e) {
        var m = $("#Comment2").val()
        $("#Comment").val(m);
        $("#btnreq").click();
    }
    function cancelContracAfterConfirm(e) {
        $("#Comment").val(" درخواست اصلاح قرارداد");
        $("#btnreq").click();
    }

    function printContract(e) {

        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        goToUrl("/customer/RequestForRating/ContractPrint/" + id);
    }
    function printPerFactor(id = null) {
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                 
                    $("#SaveDate").html(res.data.saveDateStr);
                    $("#PriceFee1").html(moneyCommaSepWithReturn(res.data.finalPriceContract.toString()));
                    $("#PriceFee2").html(moneyCommaSepWithReturn(res.data.finalPriceContract.toString()));
                    $("#PriceFee3").html(moneyCommaSepWithReturn(res.data.finalPriceContract.toString()));
                    $("#TaxPrice1").html(moneyCommaSepWithReturn(res.data.tax.toString()));
                    $("#TaxPrice2").html(moneyCommaSepWithReturn(res.data.tax.toString()));
                    $("#TotalPrice").html(moneyCommaSepWithReturn((res.data.finalPriceContract + res.data.tax).toString()));
                    $("#TotalPrice2").html(moneyCommaSepWithReturn((res.data.finalPriceContract + res.data.tax).toString()));
                    $("#TotalPrice3").html(moneyCommaSepWithReturn((res.data.finalPriceContract + res.data.tax).toString()));
  initCustomer();

                }

            }, true);
        }
    }
    function initCustomer() {

        AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {

            if (res != null) {
                $("#CustomerName2").html(res.companyName);
                $("#CustomerName").html(res.companyName);
                $("#EconomicCode").html(res.economicCode);
                $("#NationalCode").html(res.nationalCode);
                $("#PostalCode").html(res.postalCode);
                $("#AddressCompany").html(res.addressCompany);
                $("#Tel").html(res.tel);
            }
        }, true);

    }

    function printContracting(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#ContractShow").html(res.data.contentContract);
                    if (res.data.contractCode != null && res.data.contractCode != "") {
                        $('.PageContractFirst').find('input[name=SaveDate]').val(res.data.saveDateStr);
                        $('.PageContractFirst').find('input[name=ContractCode]').val(res.data.contractCode);


                    } else {
                        $("#ptr").html("<p> این نسخه قرارداد اصلی نمی باشد.</p>");
                    }

                    $("#ContractCode").html(res.data.contractCode);
                    $('input[type="text"], textarea').each(function () {
                        //  $(this).attr('readonly', 'readonly');
                        // var text_classname = $(this).attr('name');
                        var value = $(this).val();
                        var new_html = ('<storang>' + value + '</storang>');
                        $(this).replaceWith(new_html);
                    });
                    if (res.data.contentContract != null && res.data.contentContract != "") {
                        $("#ptr").show();
                    } else {
                        $("#ptr").hide();
                    }

                }

            }, true);
        }
    }
    function printDiv() {
        $("#ptr").hide();
        window.print();
    }

    function showContract() {

        getContractInfo(decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker()));
    }



    function saveReferralRequestForRating(e, Comment = null) {

        $(".ButtonOpperationLSSlss").attr("disabled", "");
        var commenttxt = $("#Comment").val() == null ? Comment : $("#Comment").val();
        var objJ = {};
        objJ.DestLevelStepIndex = decrypt($(e).attr("data-DLSI"), keyMaker());
        objJ.Comment = commenttxt;// Comment; // $("#Comment").val();// getDataCkeditor("ReferralExplanation");
        objJ.LevelStepAccessRole = decrypt($(e).attr("data-LSAR"), keyMaker());
        objJ.LevelStepStatus = decrypt($(e).attr("data-LSS"), keyMaker());
        objJ.Request = {};
        objJ.Request.Requestid = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        objJ.Request.KindOfRequest = '0';
        objJ.SmsContent = decrypt($(e).attr("data-SC"), keyMaker());
        objJ.SmsType = !isEmpty($(e).attr("data-ST")) ? $(e).attr("data-ST") === 'true' : null;
        objJ.DestLevelStepIndexButton = decrypt($(e).attr("data-DLSIB"), keyMaker());
        objJ.ReciveUser = $("#sdklsslks3498sjdkxhjsd_823sdel").val();
        objJ.LevelStepSettingIndexID = $(e).attr("data-SIndex");
        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_Request", JSON.stringify(objJ), true, function (res) {

            $(".ButtonOpperationLSSlss").removeAttr("disabled");

            if (res.isSuccess) {
                goToUrl("/Customer/RequestForRating/Index");

            }
            else {

                alertB("هشدار", res.message, "warning");

            }

        }, true);

    }

    function saveReferralRequestForRatingAgain(e, Requestid = null) {


        var objJ = {};
        objJ.DestLevelStepIndex = "3";
        objJ.Comment = "اطلاعات اصلاح شد";// getDataCkeditor("ReferralExplanation");
        objJ.LevelStepAccessRole = "4";
        objJ.LevelStepStatus = "در انتظار بررسی مشخصات اولیه مشتری توسط کارشناس امور قراردادها";
        objJ.Request = {};
        objJ.Request.Requestid = Requestid;
        objJ.Request.KindOfRequest = '0';
        objJ.SmsContent = null;
        objJ.SmsType = null;
        objJ.DestLevelStepIndexButton = "در انتظار بررسی مشخصات اولیه مشتری توسط کارشناس امور قراردادها";
        objJ.ReciveUser = "146";// $("#sdklsslks3498sjdkxhjsd_823sdel").val();
        objJ.LevelStepSettingIndexID = "1"
        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_Request", JSON.stringify(objJ), true, function (res) {

            if (res.isSuccess) {

                alertB("ثبت", "درخواست شما ارسال مجدد ارسال شد", "success");
                goToUrl("/Customer/RequestForRating/Index");
            }
            else {

                alertB("هشدار", res.message, "warning");

            }

        }, true);

    }

    function saveReferralRequestForRatingCancel(e, Requestid = null) {

        var objJ = {};
        objJ.DestLevelStepIndex = "3";
        objJ.Comment = $("#Comment2").val();
        objJ.LevelStepAccessRole = "4";
        objJ.LevelStepStatus = "در انتظار تنظیم و اصلاح قرارداد توسط کارشناس امور قراردادها";
        objJ.Request = {};
        objJ.Request.Requestid = Requestid;
        objJ.Request.KindOfRequest = '0';
        objJ.SmsContent = null;
        objJ.SmsType = null;
        objJ.DestLevelStepIndexButton = "ارجاع به کارشناس امور قراردادها جهت بررسی عدم تاییدمشتری";
        objJ.LevelStepSettingIndexID = "29"
        objJ.ReciveUser = $("#sdklsslks3498sjdkxhjsd_823sdel").val();
        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_Request", JSON.stringify(objJ), true, function (res) {


            if (res.isSuccess) {

                alertB("ثبت", "درخواست شما به مسئول قرارداد ارسال شد منتظر تماس ما باشید", "success", "بله متوجه شدم", function () {

                    goToUrl("/Customer/RequestForRating/Index");

                });

            }
            else {

                alertB("هشدار", res.message, "warning");

            }

        }, true);

    }

    function copyFurtherInfo(id=null,preReq = null) {       
        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("GET", "/api/customer/FurtherInfo/Copy_FurtherInfo/" + id + "-" + preReq, null, true, function (res) {

                if (res.isSuccess) {
                    alertB("ثبت", "کپی انجام شد", "success", "بله متوجه شدم", function () {
                        goToUrl("/Customer/FurtherInfo/index/" + id);
                    });
                }

            }, true);
        }

    }


    

    function showFurtherInfo(e, RequestId) {
       
        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestHistory", JSON.stringify({ RequestId: RequestId, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

            if (res.isSuccess) {
                if (res.data.length > 0) {

                    alertB("ثبت", "به دلیل وجود سابقه اطلاعاتی یک کپی از اطلاعات درست می شود تا شما بتوانید آنها را ویرایش کنید", "success", "بله متوجه شدم", function () {
                        copyFurtherInfo(RequestId,res.data[0].requestId);
                        // tempSaveRFR(e);
                    });
                }
                else {
                    goToUrl("/Customer/FurtherInfo/index/" + RequestId);
                }
            }

        }, true);

    }


    web.RequestForRating = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        SaveRequestForRating: saveRequestForRating,
        InitRequestForRating: initRequestForRating,
        FilterGrid: filterGrid,
        Get_Detail: get_Detail,
        SystemSeting_ComboRequestForRating: systemSeting_ComboRequestForRating,
        SaveReferralRequestForRating: saveReferralRequestForRating,
        RegistingFirstRequest: registingFirstRequest,
        InitRequestReferences: initRequestReferences,
        InitReferral: initReferral,
        CheckIsfinish: checkIsfinish,
        CreateTimeLine: createTimeLine,
        InitContract: initContract,
        GetContractInfo: getContractInfo,
        ShowContract: showContract,
        PrintContract: printContract,
        SaveContractAndFinancialDocument: saveContractAndFinancialDocument,
        ShowDocument: showDocument,
        GetDocument: getDocument,
        PrintContracting: printContracting,
        OkContract: okContract,
        CancelContract: cancelContract,
        PrintDiv: printDiv,
        CancelContracAfterConfirm: cancelContracAfterConfirm,
        SaveReferralRequestForRatingAgain: saveReferralRequestForRatingAgain,
        PrintPerFactor: printPerFactor,
        InitCustomer: initCustomer,
        SaveReferralRequestForRatingCancel: saveReferralRequestForRatingCancel,
        DashboardInformation: dashboardInformation,       
        CopyFurtherInfo: copyFurtherInfo,
        ShowFurtherInfo: showFurtherInfo
        
    };

})(Web, jQuery);

(function (web, $) {

    //Document Ready   
    function initCorporate(id = null) {
        PersianDatePicker(".DatePicker");
        $("#RequestIdForms").val(id);
       // initReferral(id);        
        intiTab(1);
        initCustomer();
    }

    function initCustomer(dir = 'rtl') {

        ComboBoxWithSearch('.select2', dir);

        AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {


            if (res != null) {
                $("#CutomerName").html("<h4> فرم پرسشنامه حاکمیت شرکتی " + res.companyName + "</h4>");
            }

        }, true);

    }

    function intiForm(FormID = null, RequestId = null) {

        AjaxCallAction("POST", "/api/customer/Corporate/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var strFormId = '';
                var Filename = 1;
                for (var i = 0; i < res.data.length; i++) {
                    if (i == 0) {
                        strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";
                    }

                    if (i == 0) {
                        strFormId += "<div class='col-lg-6'>";
                         } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
                        strFormId += "</div><div class='col-lg-6'>";
                    }

                    strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
                    if (res.data[i].questionType == 'select') {
                        var options = combo(res.data[i].dataFormQuestionId);
                        strFormId += "<select name='question" + res.data[i].dataFormQuestionId + "' id='question" + res.data[i].dataFormQuestionId + "' class='form-control select2' >" + options + "</select>";
                    } else if (res.data[i].questionType == 'textarea') {
                        strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
                    }
                    else if (res.data[i].questionType == 'checkbox') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
                    } else if (res.data[i].questionType == 'file') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";
                        Filename++;
                    }
                    else if (res.data[i].questionType == 'yesNo') {
                        strFormId += "<br/><lable>بله</label><input type='radio' name='Form" + FormID + "' id='" + FormID + res.data[i].dataFormQuestionId + "Yes' />";
                        strFormId += "<lable>خیر</label><input type='radio' name='Form" + FormID + "' id='" + FormID + res.data[i].dataFormQuestionId + "No' />";
                        Filename++;


                    }
                    else {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
                    }
                    strFormId += "</div>";
                    strFormId += "</div>";
                    if (i == res.data.length && res.data.length > 1) {
                        strFormId += "</div>";
                    }

                }
                $("#FormDetail" + FormID).html(strFormId);
                ComboBoxWithSearch('.select2', 'rtl');
           }
        }, true);
    }

    function combo(QuestionID = null) {
        let strM = '<option value="">انتخاب کنید</option>';
        AjaxCallAction("POST", "/api/customer/Corporate/Get_Options", JSON.stringify({ DataFormQuestionsId: QuestionID, PageIndex: 0, PageSize: 0 }), false, function (res) {
            if (res.isSuccess) {
                strM = '<option value="">انتخاب کنید</option>';
                for (var i = 0; i < res.data.length; i++) {
                    strM += " <option value=" + res.data[i].id + ">" + res.data[i].text + "</option>";
                }
            }
        }, true);
        return strM;
    }

    function intiTab(TabId = null) {
        var ID = $("#RequestIdForms").val();

        switch (TabId) {
            case 1:
                intiForm(26, RequestId = ID);
               // intiFormShow(1, "1,2,7,8", ID);
                break;
        }

    }

    
    web.Corporate = {
        IntiForm: intiForm,
        InitCorporate: initCorporate,
        InitCustomer: initCustomer,
        IntiTab: intiTab,
        Combo: combo
    };

})(Web, jQuery);







(function (web, $) {


    function systemSeting_Combo(parentCodeArr = null, labelCode = null, ComboName = "") {

        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: parentCodeArr, LabeCode: labelCode , PageIndex: 0, PageSize:0 }), true, function (res) {

            if (res.isSuccess) {
                var strM = '<option value="">انتخاب کنید</option>';
                for (var i = 0; i < res.data.length; i++) {

                    strM += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].value + "</option>";
                }
                $("#" + ComboName).html(strM);
        }
        }, true);
}


   
    web.SystemSeting = {       
        SystemSeting_Combo: systemSeting_Combo
    };

})(Web, jQuery);

(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    var current_fs, next_fs, previous_fs; //fieldsets
    var opacity;

    $(".next").click(function () {

        var countform = Number($("#FormLoadCode").val()) + 1;
        $("#FormLoadCode").val(countform);
        intiTab(countform);

        current_fs = $(this).parent();
        next_fs = $(this).parent().next();

        //Add Class Active
        $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

        //show the next fieldset
        next_fs.show();
        //hide the current fieldset with style
        current_fs.animate({ opacity: 0 }, {
            step: function (now) {
                // for making fielset appear animation
                opacity = 1 - now;

                current_fs.css({
                    'display': 'none',
                    'position': 'relative'
                });
                next_fs.css({ 'opacity': opacity });
            },
            duration: 600
        });
    });

    

    $(".previous").click(function () {

        var countform = Number($("#FormLoadCode").val()) - 1;
        $("#FormLoadCode").val(countform);

        current_fs = $(this).parent();
        previous_fs = $(this).parent().prev();

        //Remove class active
        $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

        //show the previous fieldset
        previous_fs.show();

        //hide the current fieldset with style
        current_fs.animate({ opacity: 0 }, {
            step: function (now) {
                // for making fielset appear animation
                opacity = 1 - now;

                current_fs.css({
                    'display': 'none',
                    'position': 'relative'
                });
                previous_fs.css({ 'opacity': opacity });
            },
            duration: 600
        });
    });

    $('.radio-group .radio').click(function () {
        $(this).parent().find('.radio').removeClass('selected');
        $(this).addClass('selected');
    });

    $(".submit").click(function () {
        return false;
    });



    function intiTab(TabId = null) {
        var ID = $("#RequestIdForms").val();
        
        switch (TabId) {
            case 1:
                intiFormShow(1, "1,2,7,8", ID);
                getFurtherInfo(ID);
                intiFormShow(26, '1,2,3,4,11,12', ID);
                
                break;
            case 2:
                intiFormShow(3, "1,3,11", ID);
                
                break;
            case 3:
                getCorporateGovernance(ID);
                intiFormShow(16, "1,2,3", ID);
                intiFormShow(17, "1,2,3", ID);
               
                break;
            case 4:
                intiForm(11);
                intiFormSingelAnswer(11, ID);
               
                break;
            case 5:
                intiFormShow(13, "1,2,3,11", ID);
              
                break;
            case 7:
                getValueChain(ID);
                //intiFormQuestion(7, "D");
                //intiFormSingelAnswer(7, ID);
                //intiFormQuestion(18, "D");
                //intiFormSingelAnswer(18, ID);
                //intiFormQuestion(19, "D");
                //intiFormSingelAnswer(18, ID);
                //intiFormQuestion(20, "D");
                //intiFormSingelAnswer(20, ID);
                
            case 9:
                intiFormShow(9, '1,2,11', ID);
                intiFormShow(10, '1,11', ID);
                
                break;
            case 14:

                //intiForm(14);
                //intiFormSingelAnswer(14, ID);
                getPublicActivities(ID);
                intiFormShow(15, '1,2,11', ID);
                intiFormShow(22, '1,11', ID);
                intiFormShow(24, '1,11', ID);
               
                break;

        }

    }

    function systemSeting_Combo(FormId = null) {

        if (FormId == 1 || FormId == 3 || FormId == 16 || FormId == 9 || FormId == 13) {
            var PC = '';
            switch (FormId) {
                case 1:
                    PC = '9,20,30,125';
                    break;
                case 3:
                    PC = '250';
                    break;
                case 16:
                    PC = '9';
                    break;
                case 9:
                    PC = '9';
                    break;
               
            }

            AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: PC, PageIndex: 0, PageSize: 0 }), true, function (res) {

                if (res.isSuccess) {
                    if (FormId == 1) {
                        var strMemberPostID = '<option value="">انتخاب کنید</option>';
                        var strMemberEductionID = '<option value="">انتخاب کنید</option>';
                        var strUniversityID = '<option value="">انتخاب کنید</option>';
                        var strCompanyDocument = 'option value="">انتخاب کنید</option>';

                        for (var i = 0; i < res.data.length; i++) {
                            if (res.data[i].parentCode == 9) {
                                strMemberEductionID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                            } else if (res.data[i].parentCode == 20) {
                                strUniversityID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                            }

                        }
                        $("#MemberEductionID").html(strMemberEductionID);
                        $("#UniversityID").html(strUniversityID);
                        $("#CompanyDocument").html(strCompanyDocument);

                    }
                    else if (FormId == 3) {
                        var strIsGuideLineOrProcess = '<option value="">انتخاب کنید</option>';

                        for (var i = 0; i < res.data.length; i++) {
                            strIsGuideLineOrProcess += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                        }

                        $("#IsGuideLineOrProcess").html(strIsGuideLineOrProcess);

                    }
                    else if (FormId == 16 || FormId == 9) {
                        var strDegreeOfEducation = strDegreeOfEducation2 = '<option value="">انتخاب کنید</option>';

                        for (var i = 0; i < res.data.length; i++) {
                            strDegreeOfEducation += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                        }

                        $("#DegreeOfEducation").html(strDegreeOfEducation);
                        $("#DegreeOfEducation2").html(strDegreeOfEducation);
                    }
                   
                }
            }, true);

            ComboBoxWithSearch('.select2', 'rtl');
        }
    }

    //function getCustomer() {

    //    AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {
    //        if (res != null) {               
    //            $("#CanSeeFurtherInfo").val(res.tel);
    //        }
    //    }, true);
    //}

    function initFurtherInfo(id = null) {
        PersianDatePicker(".DatePicker");
        $("#RequestIdForms").val(id);
        initReferral(id);        
        intiTab(1);
        initCustomer();
    }

    function intiFormShow(Id = null, Columns = null, RequestId = null) {

        intiForm(Id, RequestId);
        intiFormAnswer(Id, Columns, RequestId);


    }


    function intiForm(FormID = null, RequestId = null) {

        //AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

        //    if (res.isSuccess) {

        //        var strFormId = '';
        //        var Filename = 1;
        //        for (var i = 0; i < res.data.length; i++) {
        //            if (i == 0) {
        //                strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";
        //            }

        //            if (i == 0) {
        //                strFormId += "<div class='col-lg-6'>";
        //            } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
        //                strFormId += "</div><div class='col-lg-6'>";
        //            }

        //            strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
        //            if (res.data[i].questionType == 'select') {
        //                strFormId += "<select name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control select2' ></select>";
        //            } else if (res.data[i].questionType == 'textarea') {
        //                strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
        //            }
        //            else if (res.data[i].questionType == 'checkbox') {
        //                strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
        //            } else if (res.data[i].questionType == 'file') {
        //                strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";
        //                Filename++;
        //            }

        //            else {
        //                strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
        //            }
        //            strFormId += "</div>";
        //            strFormId += "</div>";
        //            if (i == res.data.length && res.data.length > 1) {
        //                strFormId += "</div>";
        //            }
        //        }
        //        $("#FormDetail" + FormID).html(strFormId);
           systemSeting_Combo(FormID);
        //    }
        //}, true);
    }

    function intiFormQrid(FormID = null, Name = null, RequestId = null) {

        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var strFormId = '';
                var Filename = 1;

                for (var i = 0; i < res.data.length; i++) {

                    if (i == 0) {
                        strFormId += "<div class='col-lg-6'>";
                    } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
                        strFormId += "</div><div class='col-lg-6'>";
                    }

                    strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><form id='frmFrom" + Name + (i) + "'> <input type='hidden' id='FormID' name='FormID' value='" + FormID + "' />";
                    strFormId += "<input type='hidden' id='DataFormQuestionID' name='DataFormQuestionID' value='" + res.data[i].dataFormQuestionId + "' />";

                    strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";


                    strFormId += "<label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
                    if (res.data[i].questionType == 'select') {
                        strFormId += "<select name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control select2' ></select>";
                    } else if (res.data[i].questionType == 'textarea') {
                        strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
                    }
                    else if (res.data[i].questionType == 'checkbox') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
                    } else if (res.data[i].questionType == 'file') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";

                    }

                    else {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
                    }
                    strFormId += "<button title='ثبت' class='btn btn-default fontForAllPage' type='button' onclick='Web.FurtherInfo.SavesingleForm(this," + '"' + Name + (i) + '"' + ")'> ثبت </button ></form>";

                    strFormId += "</div>";
                    strFormId += "</div>";
                    if (i == res.data.length && res.data.length > 1) {
                        strFormId += "</div>";
                    }


                }
                $("#FormDetail" + FormID).html(strFormId);
                systemSeting_Combo(FormID);
            }
        }, true);
    }

    function getCorporateGovernance(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/FurtherInfo/Get_CorporateGovernances/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    $("#CorporateGovernanceId").val(res.data.corporateGovernanceId);
                    $("#RequestId").val(res.data.requestId);
                    $("#CompanyWebSite").val(res.data.companyWebSite);
                    $("#HighProductKnowledge").val(res.data.highProductKnowledge);
                    $("#HaveRepresentativeStr").prop("checked", res.data.haveRepresentative);
                   // $("#HaveRepresentative").val(res.data.haveRepresentative);
                    $("#HaveAuditCommitteeStr").prop("checked",res.data.haveAuditCommittee);
                   
                    if (res.data.organazationChart != null && res.data.organazationChart != "") {
                        $("#DivOrganazationChart").html("<a class='btn btn-info' href='" + res.data.organazationChartFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.organizationalDuties != null && res.data.organizationalDuties != "") {
                        $("#DivOrganizationalDuties").html("<a class='btn btn-info' href='" + res.data.organizationalDutiesFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.riskManagementGuidelines != null && res.data.riskManagementGuidelines != "") {
                        $("#DivRiskManagementGuidelines").html("<a class='btn btn-info' href='" + res.data.riskManagementGuidelinesFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.transactionRegulations != null && res.data.transactionRegulations != "") {
                        $("#DivTransactionRegulations").html("<a class='btn btn-info' href='" + res.data.transactionRegulationsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.deductionTaxAccount != null && res.data.deductionTaxAccount != "") {
                        $("#DivDeductionTaxAccount").html("<a class='btn btn-info' href='" + res.data.deductionTaxAccountFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.crmSoftwareContract != null && res.data.crmSoftwareContract != "") {
                        $("#DivCrmSoftwareContract").html("<a class='btn btn-info' href='" + res.data.crmSoftwareContractFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.crmSoftwareContract != null && res.data.crmSoftwareContract != "") {
                        $("#DivCrmSoftwareContract").html("<a class='btn btn-info' href='" + res.data.crmSoftwareContractFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.representativeFile != null && res.data.representativeFile != "") {
                        $("#DivRepresentativeFile").html("<a class='btn btn-info' href='" + res.data.representativeFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.letterOfCommendation != null && res.data.letterOfCommendation != "") {
                        $("#DivLetterOfCommendation").html("<a class='btn btn-info' href='" + res.data.letterOfCommendationFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.proceedings != null && res.data.proceedings != "") {
                        $("#DivProceedings").html("<a class='btn btn-info' href='" + res.data.proceedingsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.inovationFile != null && res.data.inovationFile != "") {
                        $("#DivInovationFile").html("<a class='btn btn-info' href='" + res.data.inovationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    
                }

            }, true);
        }
    }

    function getValueChain(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/FurtherInfo/Get_ValueChain/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    $("#ValueChainId").val(res.data.valueChainId);
                    $("#ValueChainId1").val(res.data.valueChainId);
                    $("#ValueChainId2").val(res.data.valueChainId);
                    $("#ValueChainId3").val(res.data.valueChainId);
                    $("#RequestId").val(res.data.requestId);
                   

                    if (res.data.vc1 != null && res.data.vc1 != "") {
                        $("#DivVc1").html("<a class='btn btn-info' href='" + res.data.vc1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc2 != null && res.data.vc2 != "") {
                        $("#DivVc2").html("<a class='btn btn-info' href='" + res.data.vc2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc3 != null && res.data.vc3 != "") {
                        $("#DivVc3").html("<a class='btn btn-info' href='" + res.data.vc3Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc4 != null && res.data.vc4 != "") {
                        $("#DivVc4").html("<a class='btn btn-info' href='" + res.data.vc4Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc4 != null && res.data.vc4 != "") {
                        $("#DivVc4").html("<a class='btn btn-info' href='" + res.data.vc4Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc5 != null && res.data.vc5 != "") {
                        $("#DivVc5").html("<a class='btn btn-info' href='" + res.data.vc5Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc6 != null && res.data.vc6 != "") {
                        $("#DivVc6").html("<a class='btn btn-info' href='" + res.data.vc6Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc7 != null && res.data.vc7 != "") {
                        $("#DivVc7").html("<a class='btn btn-info' href='" + res.data.vc7Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc8 != null && res.data.vc8 != "") {
                        $("#DivVc8").html("<a class='btn btn-info' href='" + res.data.vc8Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc9 != null && res.data.vc9 != "") {
                        $("#DivVc9").html("<a class='btn btn-info' href='" + res.data.vc9Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc10 != null && res.data.vc10 != "") {
                        $("#DivVc10").html("<a class='btn btn-info' href='" + res.data.vc10Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc11 != null && res.data.vc11 != "") {
                        $("#DivVc11").html("<a class='btn btn-info' href='" + res.data.vc11Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc12 != null && res.data.vc12 != "") {
                        $("#DivVc12").html("<a class='btn btn-info' href='" + res.data.vc12Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc13 != null && res.data.vc13 != "") {
                        $("#DivVc13").html("<a class='btn btn-info' href='" + res.data.vc13Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc14 != null && res.data.vc14 != "") {
                        $("#DivVc14").html("<a class='btn btn-info' href='" + res.data.vc14Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc15 != null && res.data.vc15 != "") {
                        $("#DivVc15").html("<a class='btn btn-info' href='" + res.data.vc15Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc16 != null && res.data.vc16 != "") {
                        $("#DivVc16").html("<a class='btn btn-info' href='" + res.data.vc16Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc17 != null && res.data.vc17 != "") {
                        $("#DivVc17").html("<a class='btn btn-info' href='" + res.data.vc17Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc18 != null && res.data.vc18 != "") {
                        $("#DivVc18").html("<a class='btn btn-info' href='" + res.data.vc18Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc19 != null && res.data.vc19 != "") {
                        $("#DivVc19").html("<a class='btn btn-info' href='" + res.data.vc19Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc20 != null && res.data.vc20 != "") {
                        $("#DivVc20").html("<a class='btn btn-info' href='" + res.data.vc20Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc21 != null && res.data.vc21 != "") {
                        $("#DivVc21").html("<a class='btn btn-info' href='" + res.data.vc21Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc22 != null && res.data.vc22 != "") {
                        $("#DivVc22").html("<a class='btn btn-info' href='" + res.data.vc22Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc23 != null && res.data.vc23 != "") {
                        $("#DivVc23").html("<a class='btn btn-info' href='" + res.data.vc23Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc24 != null && res.data.vc24 != "") {
                        $("#DivVc24").html("<a class='btn btn-info' href='" + res.data.vc24Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc25 != null && res.data.vc25!= "") {
                        $("#DivVc25").html("<a class='btn btn-info' href='" + res.data.vc25Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                }

            }, true);
        }
    }



    function getFurtherInfo(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/FurtherInfo/Get_FurtherInfo/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#FurtherInfoId").val(res.data.furtherInfoId);

                    if (res.data.lastAuditingTaxList != null && res.data.lastAuditingTaxList != "") {
                        $("#divDownloadLastAuditingTaxList").html(GetFullFilePath(res.data.lastAuditingTaxListFull));
                    }
                    if (res.data.statementTaxList != null && res.data.statementTaxList != "") {
                        $("#divDownloadStatementTaxList").html(GetFullFilePath(res.data.statementTaxListFull));
                    }
                    if (res.data.lastChangeOfficialNewspaper != null && res.data.lastChangeOfficialNewspaper != "") {
                        $("#divDownloadLastChangeOfficialNewspaper").html(GetFullFilePath(res.data.lastChangeOfficialNewspaperFull));
                    }
                    if (res.data.statuteDoc != null && res.data.statuteDoc != "") {
                        $("#divDownloadStatuteDoc").html(GetFullFilePath(res.data.statuteDocFull));
                    }
                    if (res.data.officialNewspaper != null && res.data.officialNewspaper != "") {
                        $("#divDownloadOfficialNewspaper").html(GetFullFilePath(res.data.officialNewspaperFull));
                    }
                }

            }, true);
        }
    }


    function getPublicActivities(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/FurtherInfo/Get_PublicActivities/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#IsPublicActivityFileStr").prop("checked", res.data.isPublicActivityFile);
                    $("#Investment").val(res.data.investment);
                    $("#EmploymentDisabled").val(res.data.employmentDisabled);
                    $("#PublicActivitiesID").val(res.data.publicActivitiesID);
                   
                }

            }, true);
        }
    }

    function intiFormQuestion(FormID = null, Name = null, RequestId = null) {

        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var strFormId = '';
                var Filename = 1;

                for (var i = 0; i < res.data.length; i++) {

                    if (i == 0) {
                        strFormId += "<div class='col-lg-6'>";
                    } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
                        strFormId += "</div><div class='col-lg-6'>";
                    }

                    strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><form id='frmFrom" + Name + (i) + "'> <input type='hidden' id='FormID' name='FormID' value='" + FormID + "' />";
                    strFormId += "<input type='hidden' id='DataFormQuestionID' name='DataFormQuestionID' value='" + res.data[i].dataFormQuestionId + "' />";

                    strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";


                    strFormId += "<label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
                    if (res.data[i].questionType == 'select') {
                        strFormId += "<select name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control select2' ></select>";
                    } else if (res.data[i].questionType == 'textarea') {
                        strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
                    }
                    else if (res.data[i].questionType == 'checkbox') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
                    } else if (res.data[i].questionType == 'file') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";

                    }

                    else {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
                    }
                    strFormId += "<button title='ثبت' class='btn btn-default fontForAllPage' type='button' onclick='Web.FurtherInfo.SavesingleForm(this," + '"' + Name + (i) + '"' + ")'> ثبت </button ></form>";

                    strFormId += "</div>";
                    strFormId += "</div>";
                    if (i == res.data.length && res.data.length > 1) {
                        strFormId += "</div>";
                    }


                }
                $("#FormDetail" + FormID).html(strFormId);
                systemSeting_Combo(FormID);
            }
        }, true);
    }

    function intiFormSingelAnswer(FormID = null, Id = null) {
        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFromAnswerss", JSON.stringify({ FormId: FormID, RequestId: Id, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                if (FormID == 14) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 87:
                                $("#IsPublicActivityFile").prop("checked", res.data[i].answer == "false" ? false : true);
                                break;
                            case 91:
                                $("#Investment").val(res.data[i].answer);
                                break;
                            case 94:
                                $("#EmploymentDisabled").val(res.data[i].answer);
                                break;
                        }
                    }

                }
                if (FormID == 11) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 79:
                                if (res.data[i].fileName != "" && res.data[i].fileName!=null) {
                                    $("#DivHumanResourcesFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivHumanResourcesFile").html("");
                                }
                                break;
                        }
                    }

                }
                if (FormID == 7) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 47:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1!=null) {
                                    $("#DivVc1").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc1").html("");
                                }
                                break;
                            case 48:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc2").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc2").html("");
                                }
                                break;
                            case 49:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc3").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc3").html("");
                                }
                                break;
                            case 50:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc4").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc4").html("");
                                }
                                break;

                        }
                    }

                }
                if (FormID == 18) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 51:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc5").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc5").html("");
                                }
                                break;
                            case 52:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc6").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc6").html("");
                                }
                                break;
                            case 53:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc7").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc7").html("");
                                }
                                break;
                            case 54:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc8").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc8").html("");
                                }
                                break;
                            case 55:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc9").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc9").html("");
                                }
                                break;
                            case 56:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc10").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc10").html("");
                                }
                                 break;
                            case 57:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc11").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc11").html("");
                                }
                                break;
                            case 58:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc12").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc12").html("");
                                }
                                break;

                        }
                    }

                }
                if (FormID == 19) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 59:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc13").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc13").html("");
                                }
                                break;
                            case 60:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc14").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc14").html("");
                                }
                                break;
                            case 61:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc15").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc15").html("");
                                }
                                break;
                            case 62:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc16").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc16").html("");
                                }
                                break;
                            case 63:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc17").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc17").html("");
                                }
                                break;
                            case 64:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc18").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc18").html("");
                                }
                                break;
                            case 65:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc19").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc19").html("");
                                }
                                break;
                            case 66:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc20").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc20").html("");
                                }
                               break;
                            case 67:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc21").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc21").html("");
                                }
                                break;

                        }
                    }

                }
                if (FormID == 20) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 68:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc22").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc22").html("");
                                }
                                 break;
                            case 69:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc23").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc23").html("");
                                }
                               break;
                            case 70:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc24").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc24").html("");
                                }
                                break;
                            case 71:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc25").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc25").html("");
                                }
                                break;
                        }
                    }

                }
                if (FormID == 25) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 28:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivOrganazationChart").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivOrganazationChart").html("");
                                }
                                break;
                            case 29:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivOrganizationalDuties").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivOrganizationalDuties").html("");
                                }
                                //  $("#DivOrganizationalDuties").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 30:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivRiskManagementGuidelines").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivRiskManagementGuidelines").html("");
                                }
                                break;
                            case 31:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivTransactionRegulations").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivTransactionRegulations").html("");
                                }
                               break;
                            case 31:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivTransactionRegulations").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                break;
                            case 32:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivDeductionTaxAccount").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivDeductionTaxAccount").html("");
                                }
                               break;
                            case 33:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivCrmSoftwareContract").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivCrmSoftwareContract").html("");
                                }
                                break;
                            case 35:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivRepresentativeFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivRepresentativeFile").html("");
                                }
                                break;
                            case 36:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivletterOfCommendation").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivletterOfCommendation").html("");
                                }
                                break;
                            case 37:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivInovationFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivInovationFile").html("");
                                }
                                break;
                            case 40:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivProceedings").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivProceedings").html("");
                                }
                                 break;
                            //
                        }
                    }

                }
                if (FormID == 2) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 97:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivLastAuditingTaxList").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivLastAuditingTaxList").html("");
                                }
                                // $("#DivLastAuditingTaxList").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 98:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivLastChangeOfficialNewspaper").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                } else {
                                    $("#DivLastChangeOfficialNewspaper").html("");
                                }
                                // $("#DivLastChangeOfficialNewspaper").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 99:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivstatuteDoc").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                } else {
                                    $("#DivstatuteDoc").html("");
                                }
                                // $("#DivstatuteDoc").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 100:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivOfficialNewspaper").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                } else {
                                    $("#DivOfficialNewspaper").html("");
                                }
                                // $("#DivOfficialNewspaper").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;

                        }
                    }

                }
            }

        }, true);
    }

    function intiFormAnswer(FormID = null, ColumNum = null, RequestId = null) {

        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormAnswerTabless", JSON.stringify({ FormId: FormID, RequestId: RequestId, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var separatedArray = ColumNum.split(',');
                let strFormAnswer = '';
                for (let i = 0; i < res.data.length; i++) {

                    strFormAnswer += "<tr><td>" + (i + 1) + "</td><td>";

                    for (var j = 0; j < separatedArray.length; j++) {

                        switch (separatedArray[j]) {
                            case "1":
                                strFormAnswer += res.data[i].answer1 + "</td><td>";
                                break;
                            case "2":
                                strFormAnswer += res.data[i].answer2 + "</td><td>";
                                break;
                            case "3":
                                strFormAnswer += res.data[i].answer3 + "</td><td>";
                                break;
                            case "4":
                                strFormAnswer += res.data[i].answer4 + "</td><td>";
                                break;
                            case "5":
                                strFormAnswer += res.data[i].answer5 + "</td><td>";
                                break;
                            case "6":
                                strFormAnswer += res.data[i].answer6 + "</td><td>";
                                break;
                            case "7":
                                strFormAnswer += res.data[i].answer7 + "</td><td>";
                                break;
                            case "8":
                                strFormAnswer += res.data[i].answer8 + "</td><td>";
                                break;
                            case "9":
                                strFormAnswer += res.data[i].answer6 + "</td><td>";
                                break;
                            case "10":
                                strFormAnswer += res.data[i].answer6 + "</td><td>";
                                break;
                            case "11":
                               
                                strFormAnswer += ((res.data[i].fileName1 != null && res.data[i].fileName1 !="") ? "<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>" : "") + "</td><td>";
                              
                                break;
                            case "12":
                                strFormAnswer += ((res.data[i].fileName2 != null && res.data[i].fileName1 != "")? "<a href='" + res.data[i].fileName2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>" : "") + "</td><td>";
                              break;
                        }
                    }

                    strFormAnswer += "<button title='ویرایش' class='btn btn-warring fontForAllPage' type='button' onclick='Web.FurtherInfo.GetFormAnswer(" + FormID + "," + res.data[i].answerTableId + ")' ><i class='fa fa-edit'></i></button>";
                    if ($("#sdfcddf").val()=="1") {
                        strFormAnswer += "<button style='margin-right:5px' type='button' title='حذف' class='btn btn-warrnig fontForAllPage changeData' onclick='Web.FurtherInfo.Delete_DataFormAnswerTables(" + FormID + ',"' + ColumNum + '",' + res.data[i].answerTableId + ");'><i class='fa fa-remove'></i></button>";
                    }
                    strFormAnswer += "</td></tr>";
                }
                $("#FormDetailAnswer" + FormID).html(strFormAnswer);
            }
        }, true);
    }

    function getFormAnswer(FormID = null, AnswerTableId = null) {
        var RequestId = $("#RequestIdForms").val();

        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormAnswerTabless", JSON.stringify({ FormId: FormID, AnswerTableId: AnswerTableId, RequestId: RequestId, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                // $("#RequestId").val(res.data[0].requestId);
                for (var i = 0; i < res.data.length; i++) {

                    $('#frmFrom' + FormID).find('input[name=AnswerTableId]').val(res.data[0].answerTableId);
                    if (FormID == 1) {

                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);

                        $('#MemberPostID').val(res.data[0].answer2Val);
                        comboBoxWithSearchUpdateText("MemberPostID", res.data[0].answer2);

                        $('#MemberEductionID').val(res.data[0].answer3Val);
                        comboBoxWithSearchUpdateText("MemberEductionID", res.data[0].answer3);

                        $('#UniversityID').val(res.data[0].answer4Val);
                        comboBoxWithSearchUpdateText("UniversityID", res.data[0].answer4);

                       
                        if (res.data[0].answer6!=null) {
                            if (res.data[0].answer6 == "on") {
                                $('#frmFrom' + FormID).find('input[name=Answer6]').prop("checked", true);
                            } else {
                                $('#frmFrom' + FormID).find('input[name=Answer6]').prop("checked", false);
                            }
                        } else {
                            $('#frmFrom' + FormID).find('input[name=Answer6]').prop("checked", false);
                        }
                        $('#frmFrom' + FormID).find('input[name=Answer5]').val(res.data[0].answer5);
                        $('#frmFrom' + FormID).find('input[name=Answer6]').val(res.data[0].answer6);
                        $('#frmFrom' + FormID).find('input[name=Answer7]').val(res.data[0].answer7);
                        $('#frmFrom' + FormID).find('input[name=Answer8]').val(res.data[0].answer8);
                        $('#frmFrom' + FormID).find('input[name=Answer9]').val(res.data[0].answer9);
                        $('#frmFrom' + FormID).find('input[name=Answer10]').val(res.data[0].answer10);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivAcademicDegreePicture").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        if (res.data[0].fileName2 != null && res.data[0].fileName2 != "") {
                            $("#DivPicture2").html("<a href='" + res.data[i].fileName2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        if (res.data[0].fileName3 != null && res.data[0].fileName3 != "") {
                            $("#DivPicture3").html("<a href='" + res.data[i].fileName3Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        if (res.data[0].fileName4 != null && res.data[0].fileName4 != "") {
                            $("#DivPicture4").html("<a href='" + res.data[i].fileName4Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform1").html("ویرایش");
                    }
                    else if (FormID == 3) {
                        //1,3,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);

                        $('#IsGuideLineOrProcess').val(res.data[0].answer3Val);
                        comboBoxWithSearchUpdateText("IsGuideLineOrProcess", res.data[0].answer3);

                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivGuidelinesAndRegulationsFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else {
                            $("#DivGuidelinesAndRegulationsFile").html("");
                        }
                        $("#btnform3").html("ویرایش");

                    } else if (FormID == 4) {

                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivCertificateAndPermitAndStandardFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificateAndPermitAndStandardFile").html("");
                        }
                        $("#btnform4").html("ویرایش");
                    }
                    else if (FormID == 5) {

                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivAwardsFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivAwardsFile").html("");
                        }
                        $("#btnform5").html("ویرایش");
                    }

                    else if (FormID == 8) {
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivSwotFile1").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivSwotFile1").html("");
                        }
                        if (res.data[0].fileName2 != null && res.data[0].fileName1 != "") {
                            $("#DivSwotFile2").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivSwotFile2").html("");
                        }
                        $("#btnform8").html("ویرایش");
                    }
                    else if (FormID == 9) {
                        //1,2,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#DegreeOfEducation2').val(res.data[0].answer2Val);
                        comboBoxWithSearchUpdateText("DegreeOfEducation2", res.data[0].answer2);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivDegreeFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivDegreeFile").html("");
                        }
                        $("#btnform9").html("ویرایش");
                    }
                    else if (FormID == 10) {
                        //1,2,11
                        $('#ReportTitle').val(res.data[0].answer1);

                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivReportFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivReportFile").html("");
                        }
                        $("#btnform10").html("ویرایش");
                    }
                    else if (FormID == 12) {
                        //1,2,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1!="") {
                            $("#DivCertificationCourses2").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificationCourses2").html("");
                        }
                        $("#btnform12").html("ویرایش");
                    }
                    else if (FormID == 13) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#PostInSociety').val(res.data[0].answer3Val);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1!= "") {
                            $("#DivCertificationSociety").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificationSociety").html("");
                        }
                        comboBoxWithSearchUpdateText("PostInSociety", res.data[0].answer3);
                        $("#btnform13").html("ویرایش");
                    }
                    else if (FormID == 15) {
                        //1,2,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1!="") {
                            $("#DivPublicActivityFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivPublicActivityFile").html("");
                        }
                        $("#btnform15").html("ویرایش");
                    }
                    else if (FormID == 16) {
                        //1,2,3
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#DegreeOfEducation').val(res.data[0].answer2Val);
                        comboBoxWithSearchUpdateText("DegreeOfEducation", res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $("#btnform16").html("ویرایش");
                    }

                    else if (FormID == 17) {
                        //6,'1,2
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $("#btnform17").html("ویرایش");

                    } else if (FormID == 22) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivInvestmentFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivInvestmentFile").html("");
                        }
                        $("#btnform22").html("ویرایش");
                    }
                    else if (FormID == 24) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivEmploymentDisabledFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivEmploymentDisabledFile").html("");
                        }
                        $("#btnform24").html("ویرایش");
                    }
                    else if (FormID == 26) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);

                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivCertificationCourses").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificationCourses").html("");
                        }
                        if (res.data[0].fileName2 != null && res.data[0].fileName2 != "") {
                            $("#DivCertificationCoursesAttach").html("<a href='" + res.data[i].fileName2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificationCoursesAttach").html("");
                        }
                        $("#btnform26").html("ویرایش");
                    }


                }

            }
        }, true);
    }


    function delete_DataFormAnswerTables(FormID = null, ColumNum = null, AnswerTableId = null) {


        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/customer/FurtherInfo/Delete_DataFormAnswerTables/" + (isEmpty(AnswerTableId) ? '0' : AnswerTableId), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        intiFormShow(FormID, ColumNum, $("#RequestIdForms").val());
                        $('#frmFrom' + FormID).find('input[name=AnswerTableId]').val('0');
                        alertB("", result.message, "success");
                        if (FormID==1) {
                            clearFormDetail1();
                        } else if (FormID == 26) {
                            clearFormDetail26();
                        }
                        else if (FormID == 3) {
                            clearFormDetail3();
                        }
                        else if (FormID == 4) {
                            clearFormDetail4();
                        }
                        else if (FormID == 5) {
                            clearFormDetail5();
                        }
                        else if (FormID == 16) {
                            clearFormDetail16();
                        }
                        else if (FormID == 17) {
                            clearFormDetail17();
                        }
                        else if (FormID == 8) {
                            clearFormDetail8();
                        }
                        else if (FormID == 9) {
                            clearFormDetail9();
                        }
                        else if (FormID == 10) {
                            clearFormDetail10();
                        }
                        else if (FormID == 12) {
                            clearFormDetail12();
                        }
                        else if (FormID == 13) {
                            clearFormDetail13();
                        }
                        else if (FormID == 15) {
                            clearFormDetail15();
                        }
                        else if (FormID == 22) {
                            clearFormDetail22();
                        }
                        else if (FormID == 24) {
                            clearFormDetail24();
                        }
                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }



    function saveForm(e, FormId = null, ColumnNum = null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/FurtherInfo/Save_DataFormAnswerTabless", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFrom" + FormId), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                $('#frmFrom' + FormId).find('input[name=AnswerTableId]').val('0');
                if (FormId == 1) {
                    clearFormDetail1();
                    initFurtherInfo($("#RequestIdForms").val());
                }
                else {

                    intiFormShow(FormId, ColumnNum, $("#RequestIdForms").val());
                    $(e).html('افزودن');
                }
                if (FormId == 26) {
                    clearFormDetail26();
                } else if (FormId == 3) {
                    clearFormDetail3();
                }
                else if (FormId == 4) {
                    clearFormDetail4();
                }
                else if (FormId == 5) {
                    clearFormDetail5();
                }
                else if (FormId == 16) {
                    clearFormDetail16();
                }
                else if (FormId == 17) {
                    clearFormDetail17();
                }
                else if (FormId == 8) {
                    clearFormDetail8();
                }
                else if (FormId == 9) {
                    clearFormDetail9();
                }
                else if (FormId == 10) {
                    clearFormDetail10();
                }
                else if (FormId == 12) {
                    clearFormDetail12();
                }
                else if (FormId == 13) {
                    clearFormDetail13();
                }
                else if (FormId == 15) {
                    clearFormDetail15();
                }
                else if (FormId == 22) {
                    clearFormDetail22();
                } else if (FormID == 24) {
                    clearFormDetail24();
                }
                document.getElementById("frmFrom" + FormId).reset();
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function savesingleForm(e, FormId = null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/FurtherInfo/Save_DataFromAnswers", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFrom" + FormId), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveFurtherInfo(e) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/FurtherInfo/Save_FurtherInfo", fill_AjaxCallActionPostSaveFormWithUploadFile("FormDe2"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
               // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                intiTab(1);
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveCorporateGovernance(e,id=null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/FurtherInfo/Save_CorporateGovernance", fill_AjaxCallActionPostSaveFormWithUploadFile("FormDe6"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                getCorporateGovernance(id);
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveValueChain(e,FormName=null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/FurtherInfo/Save_ValueChain", fill_AjaxCallActionPostSaveFormWithUploadFile(FormName), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                intiTab(7);
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function savePublicActivities(e) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/FurtherInfo/Save_PublicActivities", fill_AjaxCallActionPostSaveFormWithUploadFile("FormPublicActivities"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveFormDetailTab14(e) {
        try {

            saveSingelAnswerForm(e, 14, String($("#IsPublicActivityFile").prop('checked')), 87);
            saveSingelAnswerForm(e, 14, $('#EmploymentDisabled').val(), 94);
            saveSingelAnswerForm(e, 14, $('#Investment').val(), 91);
            alertB("ثبت", "اطلاعات ثبت شد", "success");
        } catch (e) {

        }

    }


    function saveForm25(e) {
        saveSingelAnswerForm(e, 6, String($("#HaveRepresentative").prop('checked')), 34);
        saveSingelAnswerForm(e, 6, $('#CompanyWebSite').val(), 94);
        saveSingelAnswerForm(e, 6, $('#HighProductKnowledge').val(), 38);
        saveSingelAnswerForm(e, 6, String($("#HaveAuditCommittee").prop('checked')), 39);
        alertB("ثبت", "اطلاعات ثبت شد", "success");

    }

    function initReferral(id = null) {

        AjaxCallAction("GET", "/api/Customer/RequestForRating/InitReferral/" + id, null, true, function (res) {

            if (res.isSuccess) {

                $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(id.toString(), keyMaker()));
                $("#sdklsslks3498sjdkxhjsd_823sdel").val(res.data[0].sendUser);
                var htmlB = "";
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[0].levelStepIndex == 7 && res.data[0].levelStepAccessRole==5) {
                        htmlB += "<button type='button' id='btnreq' style='margin:5px' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);'" + "data-SIndex='" + res.data[i].levelStepSettingIndexId +"' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "' data-SC='" + encrypt(res.data[i].smsContent, keyMaker()) + "' data-ST='" + res.data[i].smsType + "' data-DLSIB='" + encrypt(res.data[i].destLevelStepIndexButton, keyMaker()) + "'>" + res.data[i].destLevelStepIndexButton + "</button>";

                    } 
                }
                $("#bLLSS").html(htmlB);
                $("#sdfcddf").val(1);
                
            } else {
                $(".changeData").remove();
                $("#EndfurtherInfo").html("اطلاعات شما برای پارس کیان جهت بررسی و ارزیابی ارسال شده است و قابل ویرایش نمی باشد.");
                
            }
           

        }, true);

    }

    function saveSingelAnswerForm(e, formId = null, answer = null, dataFormQuestionId = null) {

        $(e).attr("disabled", "");
        var requestId = $("#RequestId").val();
        AjaxCallAction("POST", "/api/customer/FurtherInfo/Save_DataFromAnswers", JSON.stringify({
            Answer: answer,
            FormID: formId,
            RequestId: requestId,
            DataFormQuestionID: dataFormQuestionId,

        }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                //  alertB("ثبت", res.message, "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    //function validate() {

    //    $("form[id='frmFrom1']").validate({
    //        // Specify validation rules
    //        rules: {
    //            "Answer1": {
    //                required: function () {
    //                    return true;
    //                },
    //                minlength: 5,
    //                maxlength: 50
    //            },

    //        },
    //        // Specify validation error messages
    //        messages: {
    //            "Answer1": {
    //                required: function () {
    //                    return "  لطفا نام و نام خانوادگی را را وارد کنید";
    //                },
    //                minlength: " باید حداقل 5 حرف باشد",
    //                maxlength: " باید حداکثر 50 حرف باشد"
    //            },

    //        },
    //        // Make sure the form is submitted to the destination defined
    //        // in the "action" attribute of the form when valid
    //        submitHandler: function (form) {
    //            Web.FurtherInfo.SaveForm("#btnform1", 1, '1,2,7,8');
    //        }
    //    });

    //    }
    $("#frmFrom1 input,textarea").on("focusout", function () {

        $(this).valid();

    });

    $(document).ready(function () {

        $("form[id='frmFrom1']").validate({
            // Specify validation rules
            rules: {
                "Answer1": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },
                "Answer2": {
                    required: function () {
                        return true;
                    },
                    minlength:2,
                    maxlength: 50
                },
                "Answer3": {
                    required: function () {
                        return $("#MemberEductionID").val() != "223";
                    },
                },

            },
            // Specify validation error messages
            messages: {
                "Answer1": {
                    required: function () {
                        return "لطفا نام و نام خانوادگی را وارد کنید";
                    },
                    minlength: " باید حداقل 5 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
                "Answer2": {
                    required: function () {
                        return "لطفا پست سازمانی را وارد کنید";
                    },
                    minlength: " باید حداقل 3 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
                "Answer3": {
                    required: function () {
                        return "لطفا آخرین مدرک تحصیلی را انتخاب کنید";
                    },
                },

            },
            // Make sure the form is submitted to the destination defined
            // in the "action" attribute of the form when valid
            submitHandler: function (form) {
                Web.FurtherInfo.SaveForm("#btnform1", 1, '1,2,7,8');
            }
        });

        $("form[id='frmFrom26']").validate({
            // Specify validation rules
            rules: {
                "Answer1": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },
                "Answer2": {
                    required: function () {
                        return true;
                    },
                    minlength: 2,
                    maxlength: 50
                },
              
            },
            // Specify validation error messages
            messages: {
                "Answer1": {
                    required: function () {
                        return "لطفا نام و نام خانوادگی را وارد کنید";
                    },
                    minlength: " باید حداقل 5 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
                "Answer2": {
                    required: function () {
                        return "لطفا نام دوره را وارد کنید";
                    },
                    minlength: " باید حداقل 5 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
               

            },
            // Make sure the form is submitted to the destination defined
            // in the "action" attribute of the form when valid
            submitHandler: function (form) {
                Web.FurtherInfo.SaveForm(this, 26, '1,2,3,4,11');
            }
        });

        $("form[id='frmFrom3']").validate({
            // Specify validation rules
            rules: {
                "Answer1": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },
              

            },
            // Specify validation error messages
            messages: {
                "Answer1": {
                    required: function () {
                        return "لطفا عنوان دستورالعمل ها و آیین نامه ها یا روش اجرایی را وارد کنید";
                    },
                    minlength: " باید حداقل 5 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
              

            },
            // Make sure the form is submitted to the destination defined
            // in the "action" attribute of the form when valid
            submitHandler: function (form) {
                Web.FurtherInfo.SaveForm(this, 3, '1,3,11');
            }
        });
       
    });

    function initCustomer(dir = 'rtl') {

        ComboBoxWithSearch('.select2', dir);

        AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {


            if (res != null) {
                $("#CutomerName").html("<h4> فرم اطلاعات تکمیلی " + res.companyName+"</h4>");
            }

        }, true);

    }
    function clearFormDetail1() {
        $('#btnform1').html('افزودن');       
        $('#frmFrom1').find('input[name=AnswerTableId]').val(0);
        $('#DivPicture2').html('');
        $('#DivPicture3').html('');
        $('#DivPicture4').html('');
        $('#DivAcademicDegreePicture').html('');
        $('#frmFrom1').get(0).reset();
    }
    function clearFormDetail26() {
        $('#btnform26').html('افزودن');
        $('#frmFrom26').find('input[name=AnswerTableId]').val(0);
        $('#DivCertificationCourses').html('');
        $('#DivCertificationCoursesAttach').html('');
        $('#frmFrom26').get(0).reset();
    }
    function clearFormDetail3() {
        $('#btnform3').html('افزودن');
        $('#DivGuidelinesAndRegulationsFile').html('');
        $('#frmFrom3').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom3').get(0).reset();
    }
    function clearFormDetail4() {
        $('#btnform4').html('افزودن');
        $('#DivCertificateAndPermitAndStandardFile').html('');
        $('#frmFrom4').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom4').get(0).reset();
    }
    function clearFormDetail5() {
         $('#DivAwardsFile').html(''); 
        $('#btnform5').html('افزودن');       
        $('#frmFrom5').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom5').get(0).reset();
    }
    function clearFormDetail16() {      
        $('#btnform16').html('افزودن');
        $('#frmFrom16').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom16').get(0).reset();
    }
    function clearFormDetail17() {
        $('#btnform17').html('افزودن');
        $('#frmFrom17').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom17').get(0).reset();
    }
    function clearFormDetail8() {
        $('#btnform8').html('افزودن');
        $('#DivSwotFile2').html('');
        $('#DivSwotFile1').html('');
        $('#frmFrom8').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom8').get(0).reset();
    }
    function clearFormDetail9() {
        $('#btnform9').html('افزودن');
        $('#DivDegreeFile').html(''); 
        $('#frmFrom9').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom9').get(0).reset();
    }
    function clearFormDetail10() {
        $('#btnform10').html('افزودن');
        $('#DivReportFile').html('');
        $('#frmFrom10').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom10').get(0).reset();
    }
    function clearFormDetail12() {
        $('#btnform12').html('افزودن');
        $('#DivCertificationCourses2').html('');
        $('#frmFrom12').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom12').get(0).reset();
    }
    function clearFormDetail13() {
        $('#btnform13').html('افزودن');
        $('#DivCertificationSociety').html('');
        $('#frmFrom13').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom13').get(0).reset();
    }
    function clearFormDetail15() {
        $('#btnform15').html('افزودن');
        $('#DivPublicActivityFile').html('');
        $('#frmFrom15').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom15').get(0).reset();
    }
    function clearFormDetail22() {
        $('#btnform22').html('افزودن');
        $('#DivInvestmentFile').html('');
        $('#frmFrom22').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom22').get(0).reset();
    }
    function clearFormDetail24() {
        $('#btnform24').html('افزودن');
        $('#DivEmploymentDisabledFile').html('');
        $('#frmFrom24').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom24').get(0).reset();
    }
    
    web.FurtherInfo = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        InitFurtherInfo: initFurtherInfo,
        SystemSeting_Combo: systemSeting_Combo,
        IntiForm: intiForm,
        IntiFormAnswer: intiFormAnswer,
        IntiFormShow: intiFormShow,
        IntiTab: intiTab,
        IntiFormSingelAnswer: intiFormSingelAnswer,
        SaveForm: saveForm,
        SaveSingelAnswerForm: saveSingelAnswerForm,
        SaveFormDetailTab14: saveFormDetailTab14,
        GetFormAnswer: getFormAnswer,
        Delete_DataFormAnswerTables: delete_DataFormAnswerTables,
        SavesingleForm: savesingleForm,
        IntiFormQuestion: intiFormQuestion,
        SaveForm25: saveForm25,
        IntiFormQrid: intiFormQrid,
        SaveFurtherInfo: saveFurtherInfo,
        SaveCorporateGovernance: saveCorporateGovernance,
        GetFurtherInfo: getFurtherInfo,
        SaveValueChain: saveValueChain,
        InitReferral: initReferral,
        GetCorporateGovernance: getCorporateGovernance,
        GetValueChain: getValueChain,
        SavePublicActivities: savePublicActivities,
        GetPublicActivities: getPublicActivities,
        InitCustomer: initCustomer,
        ClearFormDetail1: clearFormDetail1,
        ClearFormDetail26: clearFormDetail26,
        ClearFormDetail3: clearFormDetail3,
        ClearFormDetail4: clearFormDetail4,
        ClearFormDetail5: clearFormDetail5,
        ClearFormDetail16: clearFormDetail16,
        ClearFormDetail17: clearFormDetail17,
        ClearFormDetail8: clearFormDetail8,
        ClearFormDetail9: clearFormDetail9,
        ClearFormDetail10: clearFormDetail10,
        ClearFormDetail12: clearFormDetail12,
        ClearFormDetail13: clearFormDetail13,
        ClearFormDetail15: clearFormDetail15,
        ClearFormDetail22: clearFormDetail22,
        ClearFormDetail24: clearFormDetail24
    };

})(Web, jQuery);
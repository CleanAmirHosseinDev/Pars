(function(n,t){function u(n){n.keyCode==13&&t(`button[title='جستجو']`).click()}function f(n){t(n).attr("disabled","");RemoveAllCharForPrice("AmountOsLastSales");AjaxCallActionPostSaveFormWithUploadFile("/api/customer/Customers/Save_BasicInformationCustomers",fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"),!0,function(i){t(n).removeAttr("disabled");i.isSuccess?goToUrl("/Customer/Customer/EditCustomer"):(t("#AmountOsLastSales").val(moneyCommaSepWithReturn(t("#AmountOsLastSales").val())),alertB("خطا",i.message,"error"))},!0)}function i(n,i){AjaxCallAction("POST","/api/customer/SystemSeting/Get_SystemSetings",JSON.stringify({ParentCodeArr:"63,27,56",PageIndex:0,PageSize:0}),!0,function(r){var u;if(r.isSuccess){var f='<option value="">انتخاب کنید<\/option>',e='<option value="">انتخاب کنید<\/option>',o='<option value="">انتخاب کنید<\/option>';for(u=0;u<r.data.length;u++)r.data[u].parentCode==56?e+=" <option value="+r.data[u].systemSetingId+">"+r.data[u].label+"<\/option>":r.data[u].parentCode==63?o+=" <option value="+r.data[u].systemSetingId+">"+r.data[u].label+"<\/option>":r.data[u].parentCode==27&&(f+=" <option value="+r.data[u].systemSetingId+">"+r.data[u].label+"<\/option>");t("#KindOfCompanyId").html(f);t("#HowGetKnowCompanyId").html(e);t("#HowGetKnowCompanyId").val(n.howGetKnowCompanyId);t("#KindOfCompanyId").val(n.kindOfCompanyId);i&&(t("#TypeServiceRequestedId").html(o),t("#TypeServiceRequestedId").val("66"))}},!0)}function r(n){Web.RequestForRating.RegistingFirstRequest(function(r){r.isSuccess&&(r.data.length>0?(t("#divTypeServiceRequestedId").hide(),i(n,!1)):(t("#divTypeServiceRequestedId").show(),i(n,!0)))})}function e(n="rtl"){ComboBoxWithSearch(".select2",n);AjaxCallAction("GET","/api/customer/Customers/Get_Customers/",null,!0,function(n){n!=null&&(t("#AddressCompany").val(n.addressCompany),t("#CompanyName").val(n.companyName),t("#CeoName").val(n.ceoName),t("#EconomicCode").val(n.economicCode),t("#NationalCode").val(n.nationalCode),t("#CeoNationalCode").val(n.ceoNationalCode),t("#CeoMobile").val(n.ceoMobile),t("#AgentMobile").val(n.agentMobile),t("#AgentName").val(n.agentName),t("#NamesAuthorizedSignatories").val(n.namesAuthorizedSignatories),t("#CountOfPersonal").val(n.countOfPersonal),t("#Email").val(n.email),t("#Tel").val(n.tel),t("#PostalCode").val(n.postalCode),t("#AmountOsLastSales").val(moneyCommaSepWithReturn(isEmpty(n.amountOsLastSales)?"":n.amountOsLastSales.toString())),t("#divDownload").html("<a href='/File/Download?path="+n.lastInsuranceListFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#divDownload_AuditedFinancialStatements").html("<a href='/File/Download?path="+n.auditedFinancialStatementsFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),r(n))},!0)}n.Customer={TextSearchOnKeyDown:u,SaveCustomer:f,InitCustomer:e,SystemSeting_Combo:i,CheckForFirstRequest:r}})(Web,jQuery),function(n,t){function i(){dellstor("token");dellstor("fullName");dellstor("customerID");dellstor("userID");dellstor("loginName");goToUrl("/Account/Login")}function r(){isEmpty(getlstor("token"))?goToUrl("/Account/Login"):t(".fullNameInLayout").html(getlstor("fullName"))}n.Layout={SignOutForExitToLogin:i,InitLayout:r}}(Web,jQuery),function(n,t){function e(n){n.keyCode==13&&t(`button[title='جستجو']`).click()}function o(){AjaxCallAction("POST","/api/customer/RequestForRating/Get_RequestForRatings",JSON.stringify({Search:t("#txtSearch").val(),PageIndex:1,PageSize:t("#cboSelectCount").val()}),!0,function(n){var r,i;if(n.isSuccess){for(r="",i=0;i<n.data.length;i++)r+="<tr><td>"+(i+1)+"<\/td><td>"+n.data[i].kindOfRequestName+"<\/td><td>"+n.data[i].dateOfRequestStr+"<\/td><td>"+n.data[i].levelStepStatus+"<\/td><td><a style='margin-right:5px' href='/Customer/RequestForRating/RequestReferences?id="+n.data[i].requestId+"' class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title=' مشاهده گردش کار' /><\/a>",getlstor("loginName")===n.data[i].destLevelStepAccessRole&&(r+="<a style='margin-right:5px' title='ارجاع' class='btn btn-info fontForAllPage' href='/Customer/RequestForRating/Referral/"+n.data[i].requestId+"'> <i class='fa fa-mail-forward' style='color:black'><\/i><\/a>"),r+="<\/td><\/tr>";t("#tBodyList").html(r)}},!0)}function s(n=null){var t=!1;return AjaxCallAction("POST","/api/customer/RequestForRating/Get_RequestForRatings",JSON.stringify({Search:null,PageIndex:1,PageSize:1,RequestId:n}),!0,function(n){if(n.isSuccess)for(var i=0;i<n.data.length;i++)n.data[i].isFinished&&(t=!0)},!1),t}function h(n=null){AjaxCallAction("POST","/api/customer/RequestForRating/Get_RequestForRatings",JSON.stringify({Search:null,PageIndex:1,PageSize:1}),!0,function(t){n==null?t.isSuccess&&t.data.length==0&&goToUrl("/Customer/Customer/EditCustomer"):n(t)},!1)}function c(n=null){try{AjaxCallAction("GET","/api/customer/RequestForRating/InitReferral/"+n,null,!0,function(i){getU("/css/GlobalAreas/Views/Customer/RequestForRating/P_Referral.html",function(r){var f,u;if(InitModal_Withot_Par("مشاهده جزییات",r,"",!0,"width:100%;"),t("#sdklsslks3498sjdkxhjsd_823sb").val(encrypt(n.toString(),keyMaker())),i.isSuccess){for(f="<div class='form-group'><label for='ReferralExplanation'>توضیح ارجاع<\/label><textarea class='form-control' id='ReferralExplanation' rows='5'><\/textarea><\/div>",u=0;u<i.data.length;u++)f+="<button type='button' class='btn btn-warning ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);' data-DLSI='"+encrypt(i.data[u].destLevelStepIndex,keyMaker())+"' data-LSAR='"+encrypt(i.data[u].levelStepAccessRole,keyMaker())+"' data-LSS='"+encrypt(i.data[u].levelStepStatus,keyMaker())+"'>"+i.data[u].destLevelStepIndexButton+"<\/button>";t("#bLLSS").html(f)}else t("#bLLSS").html("")})},!0)}catch(i){}}function l(n){t(n).attr("disabled","");AjaxCallAction("POST","/api/customer/RequestForRating/Save_Request",JSON.stringify({Request:{KindOfRequest:isEmpty(t("#TypeServiceRequestedId").val())?null:t("#TypeServiceRequestedId").val()}}),!0,function(i){t(n).removeAttr("disabled");i.isSuccess?goToUrl("/Customer/RequestForRating/Index"):alertB("هشدار",i.message,"warning")},!0)}function r(){AjaxCallAction("POST","/api/customer/SystemSeting/Get_SystemSetings",JSON.stringify({ParentCodeArr:"63",PageIndex:0,PageSize:0}),!0,function(n){var r,i;if(n.isSuccess){for(r='<option value="">انتخاب کنید<\/option>',i=0;i<n.data.length;i++)r+=" <option value="+n.data[i].systemSetingId+">"+n.data[i].label+"<\/option>";t("#TypeServiceRequestedId").html(r)}},!0)}function a(){ComboBoxWithSearch(".select2","dir");r()}function v(n=null){AjaxCallAction("POST","/api/customer/RequestForRating/Get_RequestForRatings",JSON.stringify({Search:null,PageIndex:1,PageSize:1,RequestId:n}),!0,function(t){if(t.isSuccess)for(var r=0;r<t.data.length;r++)t.data[r].isFinished?i(n,!0):i(n,!1)},!0)}function i(n=null,i){AjaxCallAction("POST","/api/customer/RequestForRating/Get_RequestReferencessService",JSON.stringify({RequestId:n}),!0,function(n){var r,f,u,e;if(n!=null){for(r="",f=!1,u=0;u<n.data.length;u++)(n.data[u].levelStepAccessRole=="10"||n.data[u].sendUser==null)&&(e=u==0?"bg-secondary":"bg-info",r+="<article class='timeline-entry "+(f?" left-aligned":"")+"'>",r+="<div class='timeline-entry-inner'>",r+="<time class='timeline-time' datetime=''>",r+="<span class='date'>"+n.data[u].sendTimeStr+"<\/span>",r+="<span class='LTRDirection'>"+n.data[u].sendTimeTimeStr+"<\/span>",r+="<\/time>",r+="<div class='timeline-icon "+e+"'>",r+="<i class='entypo-feather'><\/i>",r+="<\/div>",r+="<div class='timeline-label'>",u==0?(r+="<h2>",r+="<span>ایجاد درخواست توسط : <\/span>",r+="<span class='sender'>"+n.data[u].agentName+" ("+n.data[u].roleDesc+") <\/span >",r+="<\/h2>",r+="<ul>",r+="<li>",r+="<span class='smallFontSize'> ["+n.data[u].levelStepStatus+"]<\/span>",r+="<\/li>",r+="<\/ul>"):(n.data[u].sendUser==null||(r+="<span>"+n.data[u].userRoleDes+": <\/span>",r+="<span class='sender'>"+n.data[u].realName+"<\/span>"),r+="<br/>",r+="<ul>",r+="<li>",r+="<span class='smallFontSize'>",r+="["+n.data[u].levelStepStatus+"]",r+="<\/span>",r+="<\/li>",r+="<\/ul>"),r+="<span><\/span>",u==0?(r+="<div class='customDiv'>",r+="<span class='Transcript'>"+n.data[u].kindOfRequestName+"<\/span>",r+="<\/div>"):n.data[u].comment!=null&&(r+="<div class='customDiv'>توضیحات<hr/>",r+="<span class='Transcript'>"+n.data[u].comment+"<\/span>",r+="<\/div>"),r+="<\/div>",r+="<\/div>",r+="<\/article>",f=!f);i?(r+="<article class='timeline-entry "+(f?" left-aligned":"")+"'>",r+="<div class='timeline-entry-inner'>",r+="<time class='timeline-time' datetime='2014-01-10T03:45'><span>اختتام درخواست<\/span><\/time>",r+="<div class='timeline-icon bg-secondary'><i class='entypo-feather'><\/i><\/div>",r+="<div class='timeline-label'>",r+="<h2>",r+="<span>اختتام درخواست <\/span>",r+="<\/h2>",r+="<\/div>",r+="<\/article>"):(r+="<article class='timeline-entry begin'>",r+="<div class='timeline-entry-inner'>",r+="<div class='timeline-icon' style='-webkit-transform: rotate(-90deg); -moz-transform: rotate(-90deg);'>",r+="<i class='entypo-flight'><\/i>",r+="<\/div>",r+="<\/div>",r+="<\/article>");t("#TimeLine").html(r)}},!0)}function y(n=null){AjaxCallAction("GET","/api/Customer/RequestForRating/InitReferral/"+n,null,!0,function(i){i.isSuccess?getU("/css/GlobalAreas/Views/Customer/RequestForRating/P_Referral.html",function(r){var f,u;for(t("#divMAS").html(r),t("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(n.toString(),keyMaker())),t("#phch").show(),f="",u=0;u<i.data.length;u++)f+="<button type='button' style='margin:5px' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);' data-DLSI='"+encrypt(i.data[u].destLevelStepIndex,keyMaker())+"' data-LSAR='"+encrypt(i.data[u].levelStepAccessRole,keyMaker())+"' data-LSS='"+encrypt(i.data[u].levelStepStatus,keyMaker())+"' data-SC='"+encrypt(i.data[u].smsContent,keyMaker())+"' data-ST='"+encrypt(i.data[u].smsType,keyMaker())+"' data-DLSIB='"+encrypt(i.data[u].destLevelStepIndexButton,keyMaker())+"'>"+i.data[u].destLevelStepIndexButton+"<\/button>";t("#bLLSS").html(f);Ckeditor("ReferralExplanation")}):(t("#divMAS").html("<div class='alert alert-error text-center' style='font-size: 20px;'>شما اجازه انجام این عملیات را ندارید<\/div>"),t("#phch").hide(),t("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt("0",keyMaker())),t("#bLLSS").html(""),Ckeditor("ReferralExplanation"))},!0)}function u(n=null){isEmpty(n)||n==0||AjaxCallAction("POST","/api/customer/RequestForRating/Get_RequestForRatings",JSON.stringify({RequestId:n,Search:null,PageIndex:1,PageSize:1}),!0,function(n){n.isSuccess&&getU("/css/GlobalAreas/Views/customer/RequestForRating/P_Contract.html",function(i){t("#contractInfo").html(i);for(var r=0;r<n.data.length;r++)f(n.data[r].kindOfRequest)})},!0)}function f(n=null){isEmpty(n)||n==0||AjaxCallAction("POST","/api/customer/Contract/Get_Contracts/",JSON.stringify({KinfOfRequest:n,Search:null,PageIndex:1,PageSize:1}),!0,function(n){if(n.isSuccess)for(var i=0;i<n.data.length;i++)t("#ContractText").val(n.data[0].contractText),Ckeditor("ContractText")},!0)}function p(){u(decrypt(t("#sdklsslks3498sjdkxhjsd_823sa").val(),keyMaker()))}function w(n){t(".ButtonOpperationLSSlss").attr("disabled","");var i={};i.DestLevelStepIndex=decrypt(t(n).attr("data-DLSI"),keyMaker());i.Comment=getDataCkeditor("ReferralExplanation");i.LevelStepAccessRole=decrypt(t(n).attr("data-LSAR"),keyMaker());i.LevelStepStatus=decrypt(t(n).attr("data-LSS"),keyMaker());i.Request={};i.Request.Requestid=decrypt(t("#sdklsslks3498sjdkxhjsd_823sa").val(),keyMaker());i.Request.KindOfRequest="0";i.SmsContent=decrypt(t(n).attr("data-SC"),keyMaker());i.SmsType=isEmpty(decrypt(t(n).attr("data-ST"),keyMaker()))?null:decrypt(t(n).attr("data-ST"),keyMaker());i.DestLevelStepIndexButton=decrypt(t(n).attr("data-DLSIB"),keyMaker());AjaxCallAction("POST","/api/customer/RequestForRating/Save_Request",JSON.stringify(i),!0,function(n){t(".ButtonOpperationLSSlss").removeAttr("disabled");n.isSuccess?goToUrl("/Customer/RequestForRating/Index"):alertB("هشدار",n.message,"warning")},!0)}n.RequestForRating={TextSearchOnKeyDown:e,SaveRequestForRating:l,InitRequestForRating:a,FilterGrid:o,Get_Detail:c,SystemSeting_ComboRequestForRating:r,SaveReferralRequestForRating:w,RegistingFirstRequest:h,InitRequestReferences:v,InitReferral:y,CheckIsfinish:s,CreateTimeLine:i,InitContract:f,GetContractInfo:u,ShowContract:p}}(Web,jQuery),function(n,t){function i(n=null,i=null,r=""){AjaxCallAction("POST","/api/customer/SystemSeting/Get_SystemSetings",JSON.stringify({ParentCodeArr:n,LabeCode:i,PageIndex:0,PageSize:0}),!0,function(n){var u,i;if(n.isSuccess){for(u='<option value="">انتخاب کنید<\/option>',i=0;i<n.data.length;i++)u+=" <option value="+n.data[i].systemSetingId+">"+n.data[i].value+"<\/option>";t("#"+r).html(u)}},!0)}n.SystemSeting={SystemSeting_Combo:i}}(Web,jQuery),function(n,t){function u(n){n.keyCode==13&&t(`button[title='جستجو']`).click()}function f(n="rtl"){var i,r,f,u;t(".next").click(function(){i=t(this).parent();r=t(this).parent().next();t("#progressbar li").eq(t("fieldset").index(r)).addClass("active");r.show();i.animate({opacity:0},{step:function(n){u=1-n;i.css({display:"none",position:"relative"});r.css({opacity:u})},duration:600})});t(".previous").click(function(){i=t(this).parent();f=t(this).parent().prev();t("#progressbar li").eq(t("fieldset").index(i)).removeClass("active");f.show();i.animate({opacity:0},{step:function(n){u=1-n;i.css({display:"none",position:"relative"});f.css({opacity:u})},duration:600})});t(".radio-group .radio").click(function(){t(this).parent().find(".radio").removeClass("selected");t(this).addClass("selected")});t(".submit").click(function(){return!1});ComboBoxWithSearch(".select2",n);AjaxCallAction("POST","/api/customer/SystemSeting/Get_SystemSetings",JSON.stringify({ParentCodeArr:"5,9,20,30,125",PageIndex:0,PageSize:0}),!0,function(n){var i;if(n.isSuccess){var r='<option value="">انتخاب کنید<\/option>',u='<option value="">انتخاب کنید<\/option>',f='<option value="">انتخاب کنید<\/option>',e="",o="";for(i=0;i<n.data.length;i++)n.data[i].parentCode==5?r+=" <option value="+n.data[i].systemSetingId+">"+n.data[i].label+"<\/option>":n.data[i].parentCode==9?u+=" <option value="+n.data[i].systemSetingId+">"+n.data[i].label+"<\/option>":n.data[i].parentCode==20?f+=" <option value="+n.data[i].systemSetingId+">"+n.data[i].label+"<\/option>":n.data[i].parentCode==30?e+=" <tr><td> <div class='form-group'><label class='control-label col-md-4' for=''>"+n.data[i].label+"<span class='RequiredLabel'>*<\/span><\/label><div class='col-md-8'><input type='file'  class='form-control'/><\/div><\/div><\/td> <td><a href='#'>مشاهده <\/a><\/td><\/tr>":n.data[i].parentCode==125&&(o+=" <tr><td> <div class='form-group'><label class='control-label col-md-4' for=''>"+n.data[i].label+"<span class='RequiredLabel'>*<\/span><\/label><div class='col-md-8'><input type='file'  class='form-control'/><\/div><\/div><\/td> <td><a href='#'>مشاهده <\/a><\/td><\/tr>");t("#MemberPostID").html(r);t("#MemberEductionID").html(u);t("#UniversityID").html(f);t("#CompanyDocument").html(e);t("#OtherDocument").html(o)}},!0)}function e(){i(1)}function o(n=null,t=null){i(n);r(n,t)}function i(n=null){AjaxCallAction("POST","/api/customer/FurtherInfo/Get_DataFormQuestionss",JSON.stringify({DataFormId:n,PageIndex:0,PageSize:0}),!0,function(i){var u,r;if(i.isSuccess){for(u="",r=0;r<i.data.length;r++)r==0?u+="<div class='col-lg-6'>":r==Math.round(i.data.length/2)&&i.data.length>1&&(u+="<\/div><div class='col-lg-6'>"),u+="<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><label class='control-label'  for=''>"+i.data[r].questionText+"<span class='RequiredLabel'>*<\/span><\/label>",u+=i.data[r].questionType=="select"?"<select name='"+i.data[r].questionName+"' id='"+i.data[r].questionName+"' class='form-control select2' ><\/select>":i.data[r].questionType=="textarea"?"<textarea name='"+i.data[r].questionName+"' id='"+i.data[r].questionName+"' class='form-control' ><\/textarea>":i.data[r].questionType=="checkbox"?"<input type='"+i.data[r].questionType+"' name='"+i.data[r].questionName+"' id='"+i.data[r].questionName+"' style='text-align:right; width: 30px' />":"<input type='"+i.data[r].questionType+"' name='"+i.data[r].questionName+"' id='"+i.data[r].questionName+"' placeholder='"+i.data[r].questionText+"' class='form-control' />",u+="<\/div>",u+="<\/div>",r==i.data.length&&i.data.length>1&&(u+="<\/div>");t("#FormDetail"+n).html(u)}},!0)}function r(n=null,i=null){AjaxCallAction("POST","/api/customer/FurtherInfo/Get_DataFormAnswerTabless",JSON.stringify({FormId:n,PageIndex:0,PageSize:0}),!0,function(r){var f,u,e;if(r.isSuccess){f=i.split(",");let e="";for(let n=0;n<r.data.length;n++){for(e+="<tr><td>"+(n+1)+"<\/td><td>",u=0;u<f.length;u++){e=f[u];switch(f[u]){case"1":e+=r.data[n].answer1+"<\/td><td>";break;case"2":e+=r.data[n].answer2+"<\/td><td>";break;case"3":e+=r.data[n].answer3+"<\/td><td>";break;case"4":e+=r.data[n].answer4+"<\/td><td>";break;case"5":e+=r.data[n].answer5+"<\/td><td>";break;case"6":e+=r.data[n].answer6+"<\/td><td>";break;case"7":e+=r.data[n].answer7+"<\/td><td>";break;case"8":e+=r.data[n].answer8+"<\/td><td>";break;case"9":e+=r.data[n].answer6+"<\/td><td>";break;case"10":e+=r.data[n].answer6+"<\/td><td>"}}e+="<a title='ویرایش' href='/Customer/FurtherInfo/EditAnswerTableId?id="+r.data[n].answerTableId+"' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'><\/i><\/a><\/td><\/tr>"}t("#FormDetailAnswer"+n).html(e)}},!0)}n.FurtherInfo={TextSearchOnKeyDown:u,InitFurtherInfo:e,SystemSeting_Combo:f,IntiForm:i,IntiFormAnswer:r,IntiFormShow:o}}(Web,jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function saveCustomer(e) {

        $(e).attr("disabled", "");
        RemoveAllCharForPrice("AmountOsLastSales");
        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/Customers/Save_BasicInformationCustomers", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                /*alertB("ثبت", res.message, "success");*/
                /*$("SeeAllRequest").show();*/
                goToUrl("/Customer/Customer/EditCustomer");

            } else {

                $("#AmountOsLastSales").val(moneyCommaSepWithReturn($("#AmountOsLastSales").val()));

                alertB("خطا", res.message, "error");
            }

        }, true);

    }


    function systemSeting_Combo(resSingle,showdrp) {

        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63,27,56", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';
                var strHowGetKnowCompany = '<option value="">انتخاب کنید</option>';
                var strTypeServiceRequestedId = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].parentCode == 56) {
                        strHowGetKnowCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 63) {
                        strTypeServiceRequestedId += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 27) {
                        strKindOfCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                }

                $("#KindOfCompanyId").html(strKindOfCompany);
                $("#HowGetKnowCompanyId").html(strHowGetKnowCompany);

                $("#HowGetKnowCompanyId").val(resSingle.howGetKnowCompanyId);
                $("#KindOfCompanyId").val(resSingle.kindOfCompanyId);

                if (showdrp) {
                    $("#TypeServiceRequestedId").html(strTypeServiceRequestedId);
                    $("#TypeServiceRequestedId").val('66');
                } 
            }
        }, true);
    }

    function checkForFirstRequest(resSingle) {
        Web.RequestForRating.RegistingFirstRequest(function (res) {

            if (res.isSuccess) {
                if (res.data.length > 0) {
                    $("#divTypeServiceRequestedId").hide();
                    systemSeting_Combo(resSingle, false);
                }

                else {
                    $("#divTypeServiceRequestedId").show();  
                    systemSeting_Combo(resSingle,true);
                }
            }

        });
    }

    function initCustomer(dir = 'rtl') {

        ComboBoxWithSearch('.select2', dir);
        
        AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {


            if (res != null) {
                $("#AddressCompany").val(res.addressCompany);
                $("#CompanyName").val(res.companyName);
                $("#CeoName").val(res.ceoName);
                $("#EconomicCode").val(res.economicCode);
                $("#NationalCode").val(res.nationalCode);
                $("#CeoNationalCode").val(res.ceoNationalCode);
                $("#CeoMobile").val(res.ceoMobile);
                $("#AgentMobile").val(res.agentMobile);
                $("#AgentName").val(res.agentName);
                $("#NamesAuthorizedSignatories").val(res.namesAuthorizedSignatories);
                $("#CountOfPersonal").val(res.countOfPersonal);
                $("#Email").val(res.email);
                $("#Tel").val(res.tel);
                $("#PostalCode").val(res.postalCode);
                
                $("#AmountOsLastSales").val(moneyCommaSepWithReturn(!isEmpty(res.amountOsLastSales) ? res.amountOsLastSales.toString() : ''));

                $("#divDownload").html("<a href='/File/Download?path=" + res.lastInsuranceListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                $("#divDownload_AuditedFinancialStatements").html("<a href='/File/Download?path=" + res.auditedFinancialStatementsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                checkForFirstRequest(res);
               // systemSeting_Combo(res);
                

            }


        }, true);

    }

    web.Customer = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        SaveCustomer: saveCustomer,
        InitCustomer: initCustomer,
        SystemSeting_Combo: systemSeting_Combo,
        CheckForFirstRequest: checkForFirstRequest,

    };

})(Web, jQuery);






(function (web, $) {

    //Document Ready              

    function signOutForExitToLogin() {

        dellstor("token");        
        dellstor("fullName");
        dellstor("customerID");
        dellstor("userID");
        dellstor("loginName");

        goToUrl("/Account/Login");

    }

    function initLayout() {

        if (isEmpty(getlstor("token"))) goToUrl("/Account/Login");
        else {

            $(".fullNameInLayout").html(getlstor("fullName"));            

        }

    }

    web.Layout = {

        SignOutForExitToLogin: signOutForExitToLogin,
        InitLayout: initLayout

    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {

                var strM = '';
              
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>"
                        + res.data[i].kindOfRequestName + "</td><td>"
                        + res.data[i].dateOfRequestStr + "</td><td>"
                        + res.data[i].levelStepStatus + "</td><td>"
                        + "<a style='margin-right:5px' href='/Customer/RequestForRating/RequestReferences?id=" + res.data[i].requestId + "'"      + " class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title=' مشاهده گردش کار' /></a>";
                        if (getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                        strM += "<a style='margin-right:5px' title='ارجاع' class='btn btn-info fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward' style='color:black'></i></a>";
                         }

                      
                    //if (res.data[i].destLevelStepIndex == 4) {
                    //        strM += "<a style='margin-right:5px' title='مشاهده و ارجاع' href='/Customer/RequestForRating/ContractPrinting?id=" + res.data[i].requestId + "' class='btn btn-print fontForAllPage'> <i class='fa fa-print'></i></a>"

                    //    } else if (res.data[i].destLevelStepIndex == 7) {
                    //        strM += "<a style='margin-right:5px' title='ثبت اطلاعات تکمیلی' href='#' class='btn btn-info fontForAllPage'> <i class='fa fa-file-text-o'></i> ثبت اطلاعات تکمیلی</a>"

                    //    }
                    //    else if (res.data[i].destLevelStepIndex == 11) {
                    //        strM += "<a style='margin-right:5px' title='تسویه حساب' href='#' class='btn btn-info fontForAllPage'> <i class='fa fa-file-text-o'></i> تسویه حساب</a>"

                    //    }
                    strM +="</td></tr>";
                }

                $("#tBodyList").html(strM);
            }

        }, true);

    }

    function checkIsfinish(id = null) {
        var isFinish = false;
        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1, RequestId: id }), true, function (res) {
           
            if (res.isSuccess) {
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].isFinished) {
                        isFinish = true;
                    }
                }
            }         
           
        }, false);
        return isFinish;
      
    }

    function registingFirstRequest(successCallback = null) {
        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1 }), true, function (res) {

            if (successCallback == null) {

                if (res.isSuccess) {

                    if (res.data.length == 0) {
                        goToUrl("/Customer/Customer/EditCustomer");
                       
                    }
                }

            }
            else {

                successCallback(res);

            }
        }, false);

    }

    function get_Detail(id = null) {
        try {

            AjaxCallAction("GET", "/api/customer/RequestForRating/InitReferral/" + id, null, true, function (res) {

                getU("/css/GlobalAreas/Views/Customer/RequestForRating/P_Referral.html", function (resG) {

                    InitModal_Withot_Par("مشاهده جزییات", resG, "", true, "width:100%;");

                    $("#sdklsslks3498sjdkxhjsd_823sb").val(encrypt(id.toString(), keyMaker()));


                    if (res.isSuccess) {

                        var htmlB = "<div class='form-group'><label for='ReferralExplanation'>توضیح ارجاع</label><textarea class='form-control' id='ReferralExplanation' rows='5'></textarea></div>";
                        for (var i = 0; i < res.data.length; i++) {

                            htmlB += "<button type='button' class='btn btn-warning ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "'>" + res.data[i].destLevelStepIndexButton + "</button>";

                        }

                        $("#bLLSS").html(htmlB);

                    }
                    else {

                        $("#bLLSS").html("");

                    }

                });

            }, true);

        } catch (e) {

        }


    }

    function saveRequestForRating(e) {

        $(e).attr("disabled", "");

        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_Request", JSON.stringify({ Request: { KindOfRequest: isEmpty($("#TypeServiceRequestedId").val()) ? null : $("#TypeServiceRequestedId").val() } }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                goToUrl("/Customer/RequestForRating/Index");

            }
            else {

                alertB("هشدار", res.message, "warning");

            }

        }, true);

    }

    function systemSeting_ComboRequestForRating() {

        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strTypeServiceRequestedId = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strTypeServiceRequestedId += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                }
                $("#TypeServiceRequestedId").html(strTypeServiceRequestedId);
                // $("#TypeServiceRequestedId").val(resSingle.typeServiceRequestedId);
            }
        }, true);
    }

    function initRequestForRating() {


        ComboBoxWithSearch('.select2', 'dir');
        systemSeting_ComboRequestForRating();

    }

    function initRequestReferences(id = null) {

        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1, RequestId: id }), true, function (res) {

            if (res.isSuccess) {
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].isFinished) {
                        createTimeLine(id, true);
                    } else {
                        createTimeLine(id, false);
                    }
                }
            }

        }, true);
       
          
    }

    function createTimeLine(id = null, isFinish) {
       
        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestReferencessService", JSON.stringify({ RequestId: id }), true, function (res) {

            if (res != null) {
                var strTimeLine = '';
                var left = false;

                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].levelStepAccessRole == "10" || res.data[i].sendUser == null) {
                        var bgColor = i == 0 ? "bg-secondary" : "bg-info";

                        strTimeLine += "<article class='timeline-entry " + (left ? " left-aligned" : "") + "'>";
                        strTimeLine += "<div class='timeline-entry-inner'>";

                        strTimeLine += "<time class='timeline-time' datetime=''>";
                        strTimeLine += "<span class='date'>" + res.data[i].sendTimeStr+"</span>";
                        strTimeLine += "<span class='LTRDirection'>" + res.data[i].sendTimeTimeStr+"</span>";
                        strTimeLine += "</time>";

                        strTimeLine += "<div class='timeline-icon " + bgColor + "'>";
                        strTimeLine += "<i class='entypo-feather'></i>";
                        strTimeLine += "</div>";

                        strTimeLine += "<div class='timeline-label'>";
                        if (i == 0) {
                            strTimeLine += "<h2>";
                            strTimeLine += "<span>ایجاد درخواست توسط : </span>";
                            strTimeLine += "<span class='sender'>" + res.data[i].agentName + " (" + res.data[i].roleDesc + ") " + "</span >";
                            strTimeLine += "</h2>";

                            //  strTimeLine += "<p><strong>گیرنده ها :</strong></p>";
                            strTimeLine += "<ul>";
                            strTimeLine += "<li>";
                            // strTimeLine += "<span class='reciver' > علی احمدی </span >";
                            // strTimeLine += "<span class='PostText'>";                        
                            // strTimeLine += "<text > [رئیس شورا] </text>";                           
                            // strTimeLine += "</span>";
                            strTimeLine += "<span class='smallFontSize'> [" + res.data[i].levelStepStatus + "]</span>";
                            // strTimeLine += "<span class='redColor'>[ خوانده نشده ]</span>";
                            strTimeLine += "</li>";
                            strTimeLine += "</ul>";
                        }
                        else {
                            if (res.data[i].sendUser == null) {
                              //  strTimeLine += "<span>" + res.data[i].roleDesc + ": </span>";
                              //  strTimeLine += "<span class='sender'>" + res.data[i].agentName + "</span>";
                            } else {
                                strTimeLine += "<span>" + res.data[i].userRoleDes + ": </span>";
                                strTimeLine += "<span class='sender'>" + res.data[i].realName + "</span>";
                            }
                            strTimeLine += "<br/>";
                            //  strTimeLine += "<span> گیرنده ها : </span>";
                            strTimeLine += "<ul>";
                            strTimeLine += "<li>";
                            // strTimeLine += "<span class='reciver'>مینا</span>";
                            // strTimeLine += "<span class='PostText'>";
                            // strTimeLine += "<text> [رئیس شورا] </text>";
                            // strTimeLine += " </span>";
                            strTimeLine += "<span class='smallFontSize'>";
                            strTimeLine += "[" + res.data[i].levelStepStatus + "]";
                            // strTimeLine += "[ جهت اقدام] <span >[ خوانده شده ] </span><span class='greenColor'>1401/09/21  3:34</span>";
                            strTimeLine += "</span>";
                            strTimeLine += "</li>";
                            strTimeLine += "</ul>";

                        }
                        strTimeLine += "<span></span>";
                        if (i == 0) {
                            strTimeLine += "<div class='customDiv'>";
                            strTimeLine += "<span class='Transcript'>" + res.data[i].kindOfRequestName + "</span>";
                            strTimeLine += "</div>";
                        } else {
                            if (res.data[i].comment != null) {

                                strTimeLine += "<div class='customDiv'>توضیحات<hr/>";
                                strTimeLine += "<span class='Transcript'>" + res.data[i].comment + "</span>";
                                strTimeLine += "</div>";
                            }
                        }
                        strTimeLine += "</div>";
                        //res.data[i].kindOfRequestName

                        strTimeLine += "</div>";
                        strTimeLine += "</article>";
                        left = !left;
                    }

                }
                if (isFinish) {
                    strTimeLine += "<article class='timeline-entry " + (left ? " left-aligned" : "") + "'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";
                    strTimeLine += "<time class='timeline-time' datetime='2014-01-10T03:45'><span>اختتام درخواست</span></time>";
                    strTimeLine += "<div class='timeline-icon bg-secondary'><i class='entypo-feather'></i></div>";
                    strTimeLine += "<div class='timeline-label'>";
                    strTimeLine += "<h2>";
                    strTimeLine += "<span>اختتام درخواست </span>";
                    // strTimeLine += "<span class='sender''>مهندس</span>";
                    strTimeLine += "</h2>";
                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                } else {
                    strTimeLine += "<article class='timeline-entry begin'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";
                    strTimeLine += "<div class='timeline-icon' style='-webkit-transform: rotate(-90deg); -moz-transform: rotate(-90deg);'>";
                    strTimeLine += "<i class='entypo-flight'></i>";
                    strTimeLine += "</div>";
                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                }
               
                $("#TimeLine").html(strTimeLine);
                
            }

        }, true);

    }

    function initReferral(id = null) {

        AjaxCallAction("GET", "/api/Customer/RequestForRating/InitReferral/" + id, null, true, function (res) {

            if (res.isSuccess) {

                getU("/css/GlobalAreas/Views/Customer/RequestForRating/P_Referral.html", function (resG) {

                    $("#divMAS").html(resG);                   
                    $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(id.toString(), keyMaker()));
                    $("#phch").show();

                    var htmlB = "";
                    for (var i = 0; i < res.data.length; i++) {

                        htmlB += "<button type='button' style='margin:5px' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "' data-SC='" + encrypt(res.data[i].smsContent, keyMaker()) + "' data-ST='" + encrypt(res.data[i].smsType, keyMaker()) + "' data-DLSIB='" + encrypt(res.data[i].destLevelStepIndexButton, keyMaker()) +"'>" + res.data[i].destLevelStepIndexButton + "</button>";

                    }

                    $("#bLLSS").html(htmlB);
                    Ckeditor("ReferralExplanation");
                });
            }
            else {

                $("#divMAS").html("<div class='alert alert-error text-center' style='font-size: 20px;'>شما اجازه انجام این عملیات را ندارید</div>");
                $("#phch").hide();
                $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt('0', keyMaker()));
                $("#bLLSS").html("");
                Ckeditor("ReferralExplanation");
            }

        }, true);

    }

    function getContractInfo(id = null) {

        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {

                    getU("/css/GlobalAreas/Views/customer/RequestForRating/P_Contract.html", function (resG) {

                        $("#contractInfo").html(resG);
                        for (var i = 0; i < res.data.length; i++) {

                            initContract(res.data[i].kindOfRequest);
                        }

                    });

                }

            }, true);
        }
    }

    function initContract(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("POST", "/api/customer/Contract/Get_Contracts/", JSON.stringify({ KinfOfRequest: id, Search: null, PageIndex: 1, PageSize: 1 }), true, function (res) {

                if (res.isSuccess) {
                    for (var i = 0; i < res.data.length; i++) {
                        $("#ContractText").val(res.data[0].contractText);
                        Ckeditor("ContractText");
                    }

                }

            }, true);

        }


    }

    function showContract() {

        getContractInfo(decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker()));
    }

    function saveReferralRequestForRating(e) {

        $(".ButtonOpperationLSSlss").attr("disabled", "");

        var objJ = {};
        objJ.DestLevelStepIndex = decrypt($(e).attr("data-DLSI"), keyMaker());
        objJ.Comment = getDataCkeditor("ReferralExplanation");
        objJ.LevelStepAccessRole = decrypt($(e).attr("data-LSAR"), keyMaker());
        objJ.LevelStepStatus = decrypt($(e).attr("data-LSS"), keyMaker());
        objJ.Request = {};
        objJ.Request.Requestid = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        objJ.Request.KindOfRequest = '0';
        objJ.SmsContent = decrypt($(e).attr("data-SC"), keyMaker());
        objJ.SmsType = !isEmpty(decrypt($(e).attr("data-ST"), keyMaker())) ? decrypt($(e).attr("data-ST"), keyMaker()) : null;
        objJ.DestLevelStepIndexButton = decrypt($(e).attr("data-DLSIB"), keyMaker());

        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_Request", JSON.stringify(objJ), true, function (res) {

            $(".ButtonOpperationLSSlss").removeAttr("disabled");

            if (res.isSuccess) {

                goToUrl("/Customer/RequestForRating/Index");

            }
            else {

                alertB("هشدار", res.message, "warning");

            }

        }, true);

    }

    web.RequestForRating = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        SaveRequestForRating: saveRequestForRating,
        InitRequestForRating: initRequestForRating,
        FilterGrid: filterGrid,
        Get_Detail: get_Detail,
        SystemSeting_ComboRequestForRating: systemSeting_ComboRequestForRating,
        SaveReferralRequestForRating: saveReferralRequestForRating,
        RegistingFirstRequest: registingFirstRequest,
        InitRequestReferences: initRequestReferences,
        InitReferral: initReferral,
        CheckIsfinish: checkIsfinish,
        CreateTimeLine: createTimeLine,
        InitContract: initContract,
        GetContractInfo: getContractInfo,
        ShowContract: showContract
    };

})(Web, jQuery);







(function (web, $) {


    function systemSeting_Combo(parentCodeArr = null, labelCode = null, ComboName = "") {

        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: parentCodeArr, LabeCode: labelCode , PageIndex: 0, PageSize:0 }), true, function (res) {

            if (res.isSuccess) {
                var strM = '<option value="">انتخاب کنید</option>';
                for (var i = 0; i < res.data.length; i++) {

                    strM += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].value + "</option>";
                }
                $("#" + ComboName).html(strM);
        }
        }, true);
}


   
    web.SystemSeting = {       
        SystemSeting_Combo: systemSeting_Combo
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    var current_fs, next_fs, previous_fs; //fieldsets
    var opacity;

    $(".next").click(function () {

        var countform = Number($("#FormLoadCode").val()) + 1;
        $("#FormLoadCode").val(countform);
        intiTab(countform);
       
        current_fs = $(this).parent();
        next_fs = $(this).parent().next();

        //Add Class Active
        $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

        //show the next fieldset
        next_fs.show();
        //hide the current fieldset with style
        current_fs.animate({ opacity: 0 }, {
            step: function (now) {
                // for making fielset appear animation
                opacity = 1 - now;

                current_fs.css({
                    'display': 'none',
                    'position': 'relative'
                });
                next_fs.css({ 'opacity': opacity });
            },
            duration: 600
        });
    });

    $(".previous").click(function () {

        var countform = Number($("#FormLoadCode").val()) -1;
        $("#FormLoadCode").val(countform);
       
        current_fs = $(this).parent();
        previous_fs = $(this).parent().prev();

        //Remove class active
        $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

        //show the previous fieldset
        previous_fs.show();

        //hide the current fieldset with style
        current_fs.animate({ opacity: 0 }, {
            step: function (now) {
                // for making fielset appear animation
                opacity = 1 - now;

                current_fs.css({
                    'display': 'none',
                    'position': 'relative'
                });
                previous_fs.css({ 'opacity': opacity });
            },
            duration: 600
        });
    });

    $('.radio-group .radio').click(function () {
        $(this).parent().find('.radio').removeClass('selected');
        $(this).addClass('selected');
    });

    $(".submit").click(function () {
        return false;
    });

    function intiTab(TabId = null) {

        switch (TabId) {
            case 1:
                intiFormShow(1, "1,2,7,8");
                break;
            case 2:
                intiFormShow(3, "1,2,3");
                break;
            case 3:
                intiForm(6);
                intiFormShow(16, "1,2,3");
                intiFormShow(17, "1,2");
                break;
            case 4:
                intiForm(11);
                break;
            case 5:
                intiFormShow(13, "1,2,3");
                break;
            case 7:
                intiForm(7);
                intiForm(18);
                intiForm(19);
                intiForm(20);
            case 9:
                intiFormShow(9, '1,2');
                intiFormShow(10, '1,2');
                break; 
            case 14:
                //intiFormShow(15, '1,2,3');
                //intiFormShow(22, '1,2');
                
                //intiForm(14);

               
                intiFormShow(24, '1,2');

                intiForm(21);
                intiFormSingelAnswer(21);

                intiForm(23);                
                intiFormSingelAnswer(23);

                break;

        }

    }

    function systemSeting_Combo(dir = 'rtl') {

        ComboBoxWithSearch('.select2', dir);

        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "5,9,20,30,125",  PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strMemberPostID = '<option value="">انتخاب کنید</option>';
                var strMemberEductionID = '<option value="">انتخاب کنید</option>';
                var strUniversityID = '<option value="">انتخاب کنید</option>';
                var strCompanyDocument = '';
                var strOtherDocument = '';
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].parentCode == 5) {
                        strMemberPostID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 9) {
                        strMemberEductionID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 20) {
                        strUniversityID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                     else if (res.data[i].parentCode == 30) {
                        strCompanyDocument += " <tr><td>" + " <div class='form-group'><label class='control-label col-md-4' for=''>" + res.data[i].label + "<span class='RequiredLabel'>*</span></label><div class='col-md-8'><input type='file'  class='form-control'/></div></div></td> <td><a href='#'>مشاهده </a></td></tr>";
                    }
                    else if (res.data[i].parentCode == 125) {
                       
                        strOtherDocument += " <tr><td>" + " <div class='form-group'><label class='control-label col-md-4' for=''>" + res.data[i].label + "<span class='RequiredLabel'>*</span></label><div class='col-md-8'><input type='file'  class='form-control'/></div></div></td> <td><a href='#'>مشاهده </a></td></tr>";
                    }

                }
                

                $("#MemberPostID").html(strMemberPostID);
                $("#MemberEductionID").html(strMemberEductionID);
                $("#UniversityID").html(strUniversityID);
                $("#CompanyDocument").html(strCompanyDocument);
                $("#OtherDocument").html(strOtherDocument);

              //  $("#HowGetKnowCompany").val(resSingle.howGetKnowCompanyId);
              //  $("#KindOfCompany").val(resSingle.kindOfCompanyId);
              //  $("#TypeServiceRequestedId").val(resSingle.typeServiceRequestedId);

                

            }
        }, true);
    }

   

    function initFurtherInfo(dir = 'rtl') {
        intiTab(1);
        ComboBoxWithSearch('.select2', 'dir');
        systemSeting_Combo(dir);
    }

    function intiFormShow(Id=null,Columns=null) {

        intiForm(Id);
        intiFormAnswer(Id, Columns);
       
    }


    function intiForm(FormID=null) {  

        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var strFormId = '';
                
                for (var i = 0; i < res.data.length; i++)
                {
                   
                    if (i == 0) {
                        strFormId += "<div class='col-lg-6'>";
                    } else if (i == Math.round((res.data.length) / 2) && res.data.length>1)
                    {
                        strFormId += "</div><div class='col-lg-6'>";
                    }
                    
                    strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
                    if (res.data[i].questionType=='select') {
                        strFormId += "<select name='" + res.data[i].questionName + "' id='" + res.data[i].questionName +"' class='form-control select2' ></select>";
                    } else if (res.data[i].questionType == 'textarea') {
                        strFormId += "<textarea name='" + res.data[i].questionName + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
                    }
                    else if (res.data[i].questionType == 'checkbox') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='" + res.data[i].questionName + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";

                    } else {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='" + res.data[i].questionName + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
                    }
                    strFormId += "</div>";
                    strFormId += "</div>";
                    if (i == res.data.length  && res.data.length > 1) {
                        strFormId += "</div>";
                    } 
                }
                $("#FormDetail" + FormID).html(strFormId);
            }
        }, true);
    }

    function intiFormSingelAnswer(FormID = null) {
        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFromAnswerss", JSON.stringify({ FormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                if (FormID==14) {
                    for (var i = 0; i < res.data.length; i++) {
                        $("#IsPublicActivityFile").popover(res.data[0].answer);
                    }
                }
                else if (FormID == 21) {
                    for (var i = 0; i < res.data.length; i++) {
                        $("#Investment").val(res.data[0].answer);
                    }

                }
                else if (FormID == 23) {
                    for (var i = 0; i < res.data.length; i++) {
                        $("#EmploymentDisabled").val(res.data[0].answer);
                    }
                }
            }
           
        }, true);
    }

    function intiFormAnswer(FormID = null,ColumNum=null) {
        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormAnswerTabless", JSON.stringify({ FormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var separatedArray = ColumNum.split(',');
                let strFormAnswer = '';
                for (let i = 0; i < res.data.length; i++) {

                    strFormAnswer += "<tr><td>" +( i+1) + "</td><td>";

                    for (var j = 0; j < separatedArray.length; j++) {

                            switch (separatedArray[j]) {
                                case"1":
                                    strFormAnswer += res.data[i].answer1 + "</td><td>";
                                    break;
                                case "2":
                                    strFormAnswer += res.data[i].answer2 + "</td><td>";
                                    break;
                                case "3":
                                    strFormAnswer += res.data[i].answer3 + "</td><td>";
                                    break;
                                case "4":
                                    strFormAnswer += res.data[i].answer4 + "</td><td>";
                                    break;
                                case "5":
                                    strFormAnswer += res.data[i].answer5 + "</td><td>";
                                    break;
                                case "6":
                                    strFormAnswer += res.data[i].answer6 + "</td><td>";
                                    break;
                                case "7":
                                    strFormAnswer += res.data[i].answer7 + "</td><td>";
                                    break;
                                case "8":
                                    strFormAnswer += res.data[i].answer8 + "</td><td>";
                                    break;
                                case "9":
                                    strFormAnswer += res.data[i].answer6 + "</td><td>";
                                    break;
                                case "10":
                                    strFormAnswer += res.data[i].answer6 + "</td><td>";
                                    break;
                            }
                                         

                    }
                       
                    strFormAnswer += "<a title='ویرایش' href='/Customer/FurtherInfo/EditAnswerTableId?id=" + res.data[i].answerTableId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a></td></tr>";
                }
                $("#FormDetailAnswer" + FormID).html(strFormAnswer);
            }
        }, true);
    }

    

    web.FurtherInfo = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        InitFurtherInfo: initFurtherInfo,
        SystemSeting_Combo: systemSeting_Combo,
        IntiForm: intiForm,
        IntiFormAnswer: intiFormAnswer,
        IntiFormShow: intiFormShow,
        IntiTab: intiTab,
        IntiFormSingelAnswer: intiFormSingelAnswer,        
    };

})(Web, jQuery);
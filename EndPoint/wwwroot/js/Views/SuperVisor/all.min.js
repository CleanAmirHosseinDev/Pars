(function(n,t){function i(){dellstor("token");dellstor("fullName");dellstor("userID");dellstor("loginName");dellstor("menu");dellstor("roleDesc");goToUrl("/Account/LoginUser")}function r(){isEmpty(getlstor("token"))?goToUrl("/Account/LoginUser"):(t(".fullNameInLayout").html(getlstor("fullName")),t(".roleDescNameElementLayout").html(getlstor("roleDesc")))}n.Layout={SignOutForExitToLogin:i,InitLayout:r}})(Web,jQuery),function(n,t){function y(n){n.keyCode==13&&t(`button[title='جستجو']`).click()}function p(){AjaxCallAction("POST","/api/superVisor/RequestForRating/Get_LevelStepSetings",JSON.stringify({PageIndex:0,PageSize:0}),!0,function(n){var r,i;if(n.isSuccess){for(r='<option value="">انتخاب کنید<\/option>',i=0;i<n.data.length;i++)r+=" <option value="+n.data[i].levelStepIndex+">"+n.data[i].levelStepStatus+"<\/option>";t("#cboSelectLS").html(r)}},!0)}function w(){ComboBoxWithSearch(".select2","rtl");AjaxCallAction("POST","/api/superVisor/RequestForRating/Get_RequestForRatings",JSON.stringify({Search:t("#txtSearch").val(),PageIndex:1,PageSize:t("#cboSelectCount").val(),DestLevelStepIndex:isEmpty(t("#cboSelectLS").val())?null:t("#cboSelectLS").val()}),!0,function(n){var u,r,i;if(n.isSuccess){for(u=getlstor("loginName"),r="",i=0;i<n.data.length;i++)r+="<tr><td>"+(i+1)+"<\/td><td>"+n.data[i].requestNo+"<\/td><td>"+(isEmpty(n.data[i].companyName)?"":n.data[i].companyName)+"<\/td><td>"+n.data[i].agentMobile+"<\/td><td>"+n.data[i].dateOfRequestStr+"<\/td><td>"+n.data[i].levelStepStatus+"<\/td><td><a style='margin-right:5px; color:black' href='/superVisor/RequestForRating/RequestReferences?id="+n.data[i].requestId+"' class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title='مشاهده گردش کار'>  <\/a>"+(getlstor("loginName")===n.data[i].destLevelStepAccessRole?"<a style='margin-right:5px;color:black' title='مشاهده و اقدام' class='btn btn-edit fontForAllPage' href='/SuperVisor/RequestForRating/Referral/"+n.data[i].requestId+"'> <i class='fa fa-mail-forward' style='color:black'><\/i>  <\/a>":"<a style='color:black;margin-right:5px;' title='نمایش پروفایل' href='/SuperVisor/Customers/ShowCustomers?id="+n.data[i].customerId+"' class='btn btn-default fontForAllPage'><i class='fa fa-eye'><\/i> <\/a>"),(u==n.data[i].destLevelStepAccessRole&&n.data[i].destLevelStepAccessRole=="5"||u=="5"&&n.data[i].destLevelStepAccessRole=="10"&&n.data[i].destLevelStepIndex=="7")&&(r+="<a style='margin-right:5px;color:black' title='مشاهده اطلاعات تکمیلی' class='btn btn-default fontForAllPage' href='/SuperVisor/FutherInfo/Index/"+n.data[i].requestId+"'><i class='fa fa-info'><\/i> <\/a>"),r+="<\/td><\/tr>";t("#tBodyList").html(r)}},!0)}function b(n=null){AjaxCallAction("GET","/api/superVisor/RequestForRating/InitReferral/"+n,null,!0,function(i){i.isSuccess?getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Referral.html",function(r){var f,u;for(t("#divMAS").html(r),t("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(n.toString(),keyMaker())),t("#phch").show(),getlstor("loginName")==="9"&&t("#svisorShowContract").remove(),(i.data[0].destLevelStepIndex<=2||getlstor("loginName")==="5")&&t("#svisorShowDocument").remove(),(!(getlstor("loginName")==="5"||getlstor("loginName")==="8"||getlstor("loginName")==="1"&&i.data[0].levelStepIndex>=8)||i.data[0].destLevelStepIndex<5)&&t("#svisorShowEvaluationFile").remove(),f="",u=0;u<i.data.length;u++)t("#sdklsslks3498sjdkxhjsd_823sb").val(i.data[0].levelStepIndex),f+="<button type='button'  style='margin:5px' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveRequestForRating(this);' data-DLSI='"+encrypt(i.data[u].destLevelStepIndex,keyMaker())+"' data-LSAR='"+encrypt(i.data[u].levelStepAccessRole,keyMaker())+"' data-LSS='"+encrypt(i.data[u].levelStepStatus,keyMaker())+"' data-SC='"+encrypt(i.data[u].smsContent,keyMaker())+"' data-ST='"+i.data[u].smsType+"' data-DLSIB='"+encrypt(i.data[u].destLevelStepIndexButton,keyMaker())+"'>"+i.data[u].destLevelStepIndexButton+"<\/button>";t("#bLLSS").html(f);Ckeditor("ReferralExplanation");e()}):(t("#divMAS").html("<div class='alert alert-error text-center' style='font-size: 20px;'>"+(isEmpty(i.message)?"شما اجازه انجام این عملیات را ندارید":i.message)+"<\/div>"),t("#phch").hide(),t("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt("0",keyMaker())),t("#bLLSS").html(""),Ckeditor("ReferralExplanation"))},!0)}function k(n){f(n,!1)}function d(n=null){isEmpty(n)||n==0||AjaxCallAction("GET","/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/"+(isEmpty(n)?"0":n),null,!0,function(n){n.isSuccess&&(t("#ContractShow").html(n.data.contentContract),t("#SaveDate").html(n.data.saveDateStr),t("#ContractCode").html(n.data.contractCode),t('input[type="text"], textarea').each(function(){var n=t(this).val(),i="<storang>"+n+"<\/storang>";t(this).replaceWith(i)}),window.print())},!0)}function e(){o()}function g(){s()}function i(n=null){isEmpty(n)||n==0||AjaxCallAction("GET","/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/"+(isEmpty(n)?"0":n),null,!0,function(i){i.isSuccess?(t("#FinancialID").val(i.data.financialId),t("#RequestID").val(i.data.requestID),t("#PriceContract").val(moneyCommaSepWithReturn(i.data.priceContract==null?"":i.data.priceContract.toString())),t("#FinalPriceContract").val(moneyCommaSepWithReturn(i.data.finalPriceContract==null?"":i.data.finalPriceContract.toString())),t("#FinancialDocument").val(i.data.financialDocument),t("#ContractDocument").val(i.data.contractDocument),t("#DisCountMoney").val(moneyCommaSepWithReturn(i.data.disCountMoney==null?"":i.data.disCountMoney.toString())),t("#DicCountPerecent").val(moneyCommaSepWithReturn(i.data.dicCountPerecent==null?"":i.data.dicCountPerecent.toString())),getlstor("loginName")==="1"||getlstor("loginName")==="4"?(i.data.contractDocumentCustomer!=null&&i.data.contractDocumentCustomer!=""&&t("#divDownloadContractDocumentCustomer").html("<a  href='/File/Download?path="+i.data.contractDocumentCustomerFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#ContentCKeditor").html("<textarea name='ContentContract' id='ContentContract'>"+i.data.contentContract+"<\/textarea>"),Ckeditor("ContentContract")):(t("#ContractShow").addClass("ContractShowStyle"),t("#ContractShow").html(i.data.contentContract),t('input[type="text"], textarea').each(function(){var n=t(this).val(),i="<storang>"+n+"<\/storang>";t(this).replaceWith(i)}))):c(n)},!0)}function o(){var n=decrypt(t("#sdklsslks3498sjdkxhjsd_823sa").val(),keyMaker());isEmpty(n)||n==0||AjaxCallAction("POST","/api/superVisor/RequestForRating/Get_RequestForRatings",JSON.stringify({RequestId:n,Search:null,PageIndex:1,PageSize:1}),!0,function(n){n.isSuccess&&getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Customer.html",function(i){t("#customerInfo").html(i);for(var r=0;r<n.data.length;r++)h(n.data[r].customerId)})},!0)}function s(){var n=decrypt(t("#sdklsslks3498sjdkxhjsd_823sa").val(),keyMaker());isEmpty(n)||n==0||(getlstor("loginName")==="1"||getlstor("loginName")==="4"?getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Contract-moa.html",function(r){t("#contractInfo").html(r);(getlstor("loginName")==="4"||t("#sdklsslks3498sjdkxhjsd_823sb").val()>2)&&(t("#FinalPriceContract").prop("readonly",!0),t("#DisCountMoney").prop("readonly",!0),t("#DicCountPerecent").prop("readonly",!0));getlstor("loginName")==="1"&&t("#ContractUp").hide();i(n)}):getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Contract.html",function(r){t("#contractInfo").html(r);i(n)}))}function h(n=null){isEmpty(n)||n==0||AjaxCallAction("GET","/api/superVisor/Customers/Get_Customers/"+(isEmpty(n)?"0":n),null,!0,function(n){n!=null&&(n.customerPersonalityType=="223"?(t(".FormIsNotShow").hide(),t(".form-group.FormIsShow").show(),t(".NotShowRequiredLabel").hide(),t("#LabelEconomicCode").html("شماره کارت بازرگانی"),t("#LabelTypeGroupCompanies").html("نوع فعالیت")):(t(".FormIsNotShow").show(),t("#LabelEconomicCode").html("شماره ثبت"),t(".NotShowRequiredLabel").show(),t("#LabelTypeGroupCompanies").html("نوع گروه شرکتها")),t("#AddressCompany").val(n.addressCompany),t("#CompanyName").val(n.companyName),t("#CeoName").val(n.ceoName),t("#EconomicCode").val(n.economicCode),t("#NationalCode").val(n.nationalCode),t("#CeoNationalCode").val(n.ceoNationalCode),t("#CeoMobile").val(n.ceoMobile),t("#AgentMobile").val(n.agentMobile),t("#AgentName").val(n.agentName),t("#NamesAuthorizedSignatories").val(n.namesAuthorizedSignatories),t("#CountOfPersonal").val(n.countOfPersonal),t("#Email").val(n.email),t("#Tel").val(n.tel),t("#PostalCode").val(n.postalCode),t("#AmountOsLastSales").val(moneyCommaSepWithReturn(isEmpty(n.amountOsLastSales)?"":n.amountOsLastSales.toString())),t("#divDownload").html("<a class='btn btn-success' href='/File/Download?path="+n.lastInsuranceListFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#divDownload_AuditedFinancialStatements").html("<a class='btn btn-success' href='/File/Download?path="+n.auditedFinancialStatementsFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#TypeGroupCompanies").val(n.typeGroupCompaniesName),nt(n))},!0)}function nt(n){AjaxCallAction("POST","/api/superVisor/SystemSeting/Get_SystemSetings",JSON.stringify({ParentCodeArr:"63,27,56",PageIndex:0,PageSize:0}),!0,function(i){var r;if(i.isSuccess){var u='<option value="">انتخاب کنید<\/option>',f='<option value="">انتخاب کنید<\/option>',e='<option value="">انتخاب کنید<\/option>';for(r=0;r<i.data.length;r++)i.data[r].parentCode==56?f+=" <option value="+i.data[r].systemSetingId+">"+i.data[r].label+"<\/option>":i.data[r].parentCode==63?e+=" <option value="+i.data[r].systemSetingId+">"+i.data[r].label+"<\/option>":i.data[r].parentCode==27&&(u+=" <option value="+i.data[r].systemSetingId+">"+i.data[r].label+"<\/option>");t("#KindOfCompany").html(u);t("#HowGetKnowCompany").html(f);t("#TypeServiceRequestedId").html(e);t("#HowGetKnowCompany").val(n.howGetKnowCompanyId);t("#KindOfCompany").val(n.kindOfCompanyId);t("#TypeServiceRequestedId").val(n.typeServiceRequestedId)}},!0)}function c(n=null){isEmpty(n)||n==0||AjaxCallAction("GET","/api/superVisor/RequestForRating/Get_ServiceFeeAndCustomerByRequest/"+(isEmpty(n)?"0":n),null,!0,function(i){if(i!=null)if(i.contract==null)alertB("خطا","متن قرارداد وجود ندارد","error");else if(getlstor("loginName")==="1"||getlstor("loginName")==="4"){t("#RequestID").val(n);t("#ContentCKeditor").html("<textarea name='ContentContract' id='ContentContract'>"+i.contract.contractText+"<\/textarea>");var r=i.contract.contractText;t("#PriceContract").val(t(r).find('input[name="ServiceFeePrice"]').val());t("#FinalPriceContract").val(t(r).find('input[name="ServiceFeePrice"]').val());Ckeditor("ContentContract");i.serviceFee==null&&alertB("خطا","نرخی برای شرایط مشتری پیدا نشد","error")}},!0)}function tt(n=null){isEmpty(n)||n==0||AjaxCallAction("GET","/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/"+(isEmpty(n)?"0":n),null,!0,function(n){n.isSuccess&&(t("#ContractShow").addClass("ContractShowStyle"),t("#ContractShow").html(n.data[0].contentContract),t('input[type="text"], textarea').each(function(){var n=t(this).attr("name"),i=t(this).val(),r='<label for="'+n+'" id="">'+i+"<\/label>";t(this).replaceWith(r)}))},!0)}function it(n){t(".ButtonOpperationLSSlss").attr("disabled","");var i={};i.DestLevelStepIndex=decrypt(t(n).attr("data-DLSI"),keyMaker());i.Comment=getDataCkeditor("ReferralExplanation");i.LevelStepAccessRole=decrypt(t(n).attr("data-LSAR"),keyMaker());i.LevelStepStatus=decrypt(t(n).attr("data-LSS"),keyMaker());i.Request={};i.Request.Requestid=decrypt(t("#sdklsslks3498sjdkxhjsd_823sa").val(),keyMaker());i.Request.KindOfRequest=0;i.SmsContent=decrypt(t(n).attr("data-SC"),keyMaker());i.SmsType=isEmpty(t(n).attr("data-ST"))?null:t(n).attr("data-ST")==="true";i.DestLevelStepIndexButton=decrypt(t(n).attr("data-DLSIB"),keyMaker());AjaxCallAction("POST","/api/superVisor/RequestForRating/Save_Request",JSON.stringify(i),!0,function(n){t(".ButtonOpperationLSSlss").removeAttr("disabled");n.isSuccess?goToUrl("/SuperVisor/RequestForRating/Index"):alertB("هشدار",n.message,"warning")},!0)}function rt(){var n=decrypt(t("#sdklsslks3498sjdkxhjsd_823sa").val(),keyMaker());isEmpty(n)||n==0||AjaxCallAction("POST","/api/superVisor/RequestForRating/Get_RequestForRatings",JSON.stringify({RequestId:n,Search:null,PageIndex:1,PageSize:1}),!0,function(t){if(t.isSuccess)for(var i=0;i<t.data.length;i++)t.data[i].destLevelStepIndex>=3&&a(n,t)},!0)}function ut(){var n=decrypt(t("#sdklsslks3498sjdkxhjsd_823sa").val(),keyMaker());isEmpty(n)||n==0||AjaxCallAction("POST","/api/superVisor/RequestForRating/Get_RequestForRatings",JSON.stringify({RequestId:n,Search:null,PageIndex:1,PageSize:1}),!0,function(t){if(t.isSuccess)for(var i=0;i<t.data.length;i++)t.data[i].destLevelStepIndex>=3&&l(n)},!0)}function l(n=null){isEmpty(n)||n==0||getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Document.html",function(i){t("#showDocument").html(i);r(n)})}function a(n=null,i=null){isEmpty(n)||n==0||getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_EvaluationFile.html",function(u){t("#showEvaluationFile").html(u);(i.data[0].levelStepAccessRole=="9"||getlstor("loginName")==="1"||getlstor("loginName")==="8")&&t("#frmFormMain2").remove();getlstor("loginName")!=="8"&&t("#frmFormMain3").remove();r(n)})}function r(n=null){isEmpty(n)||n==0||AjaxCallAction("GET","/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/"+(isEmpty(n)?"0":n),null,!0,function(n){n.isSuccess&&(t("#FinancialID").val(n.data.financialId),t("#RequestID").val(n.data.requestID),t("#ContentContract").val(n.data.contentContract),t("#PriceContract").val(n.data.priceContract),t("#Tax").val(n.data.tax),getlstor("loginName")==="8"&&t("#EvaluationFile").val(n.data.evaluationFile),t("#DisCountMoney").val(n.data.disCountMoney),t("#DicCountPerecent").val(n.data.dicCountPerecent),t("#FinalPriceContract").val(n.data.finalPriceContract),t("#ContractMainCode").val(n.data.contractMainCode),t("#FinancialDocument").val(n.data.financialDocument),t("#ContractDocument").val(n.data.contractDocument),t("#ContractCode").val(n.data.contractCode),getlstor("loginName")!=="4"&&getlstor("loginName")!=="1"&&t("#ContractDocumentCustomer").val(n.data.contractDocumentCustomer),n.data.financialDocument!=null&&n.data.financialDocument!=""?t("#divDownloadFinancialDocument").html("<a class='btn btn-success' href='/File/Download?path="+n.data.financialDocumentFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"):t("#divDownloadFinancialDocument").html("<p style='color:silver'>فایلی وجود ندارد<\/p>"),n.data.contractDocument!=null&&n.data.contractDocument!=""?t("#divDownload_ContractDocument").html("<a class='btn btn-success' href='/File/Download?path="+n.data.contractDocumentFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"):t("#divDownload_ContractDocument").html("<p style='color:silver'>فایلی وجود ندارد<\/p>"),n.data.evaluationFile!=null&&n.data.evaluationFile!=""?t("#divDownload_EvaluationFile").html("<a class='btn btn-success' href='/File/Download?path="+n.data.evaluationFileFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"):t("#divDownload_EvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد<\/p>"),n.data.committeeEvaluationFile!=null&&n.data.committeeEvaluationFile!=""?t("#divDownload_CommitteeEvaluationFile").html("<a class='btn btn-success' href='/File/Download?path="+n.data.committeeEvaluationFileFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"):t("#divDownload_CommitteeEvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد<\/p>"),n.data.lastFinancialDocument!=null&&n.data.lastFinancialDocument!=""?t("#divDownload_LastFinancialDocument").html("<a class='btn btn-success' href='/File/Download?path="+n.data.lastFinancialDocumentFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"):t("#divDownload_LastFinancialDocument").html("<p style='color:silver'>فایلی وجود ندارد<\/p>"))},!0)}function ft(n=null){isEmpty(n)||n==0||AjaxCallAction("GET","/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/"+(isEmpty(n)?"0":n),null,!0,function(n){n.isSuccess&&(t("#FinancialID").val(n.data.financialId),t("#RequestID").val(n.data.requestID),t("#ContentContract").val(n.data.contentContract),t("#PriceContract").val(n.data.priceContract),t("#Tax").val(n.data.tax),t("#DisCountMoney").val(n.data.disCountMoney),t("#DicCountPerecent").val(n.data.dicCountPerecent),t("#FinalPriceContract").val(n.data.finalPriceContract),t("#ContractDocumentCustomer").val(n.data.contractDocumentCustomer),t("#ContractMainCode").val(n.data.contractMainCode),t("#FinancialDocument").val(n.data.financialDocument),t("#ContractDocument").val(n.data.contractDocument),t("#ContractCode").val(n.data.contractCode),n.data.financialDocument!=null&&n.data.financialDocument!=""?t("#divDownloadFinancialDocument").html("<a class='btn btn-success' href='/File/Download?path="+n.data.financialDocumentFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"):t("#divDownloadFinancialDocument").html("<p style='color:silver'>فایلی وجود ندارد<\/p>"),n.data.contractDocument!=null&&n.data.contractDocument!=""?t("#divDownload_ContractDocument").html("<a class='btn btn-success' href='/File/Download?path="+n.data.contractDocumentFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"):t("#divDownload_ContractDocument").html("<p style='color:silver'>فایلی وجود ندارد<\/p>"),n.data.evaluationFile!=null&&n.data.evaluationFile!=""?t("#divDownload_EvaluationFile").html("<a class='btn btn-success' href='/File/Download?path="+n.data.evaluationFileFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"):t("#divDownload_EvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد<\/p>"),n.data.committeeEvaluationFile!=null&&n.data.committeeEvaluationFile!=""?t("#divDownload_CommitteeEvaluationFile").html("<a class='btn btn-success' href='/File/Download?path="+n.data.committeeEvaluationFileFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"):t("#divDownload_CommitteeEvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد<\/p>"))},!0)}function v(n,r=null){t(n).attr("disabled","");RemoveAllCharForPrice("DisCountMoney");t("#ContentContract").val(getDataCkeditor("ContentContract"));AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments",fill_AjaxCallActionPostSaveFormWithUploadFile("frmContract"),!0,function(u){if(t(n).removeAttr("disabled"),u.isSuccess)if(r)t("#DisCountMoney").val(moneyCommaSepWithReturn(t("#DisCountMoney").val())),t("#FinalPriceContract").val(moneyCommaSepWithReturn(t("#FinalPriceContract").val())),t("#PriceContract").val(moneyCommaSepWithReturn(t("#PriceContract").val())),alertB("ثبت"," با موفقیت ثبت شد.","success"),i(decrypt(t("#sdklsslks3498sjdkxhjsd_823sa").val(),keyMaker()));else{var f=decrypt(t("#sdklsslks3498sjdkxhjsd_823sa").val(),keyMaker());goToUrl("/superVisor/RequestForRating/ContractPrint/"+f)}else t("#DisCountMoney").val(moneyCommaSepWithReturn(t("#DisCountMoney").val())),alertB("خطا",u.message,"error")},!0)}function et(n){document.getElementById("EvaluationFile").files.length==0?alertB("هشدار","فایل اکسل را انتخاب نکرده اید!.","warning"):(t(n).attr("disabled",""),AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments",fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain2"),!0,function(i){t(n).removeAttr("disabled");i.isSuccess?alertB("ثبت"," با موفقیت ثبت شد.","success"):alertB("خطا",i.message,"error")},!0))}function ot(n){document.getElementById("CommitteeEvaluationFile").files.length==0?alertB("هشدار","فایل اکسل را انتخاب نکرده اید!.","warning"):(t(n).attr("disabled",""),AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments",fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain3"),!0,function(i){t(n).removeAttr("disabled");i.isSuccess?alertB("ثبت"," با موفقیت ثبت شد.","success"):alertB("خطا",i.message,"error")},!0))}function u(n=null,i){AjaxCallAction("POST","/api/superVisor/RequestForRating/Get_RequestReferencessService",JSON.stringify({RequestId:n}),!0,function(n){var r,f,u,e;if(n!=null){for(r="",f=!1,u=0;u<n.data.length;u++)e=u==0?"bg-secondary":"bg-info",r+="<article class='timeline-entry "+(f?" left-aligned":"")+"'>",r+="<div class='timeline-entry-inner'>",r+="<time class='timeline-time' datetime=''>",r+="<span class='date'>"+n.data[u].sendTimeStr+"<\/span>",r+="<span class='LTRDirection'>"+n.data[u].sendTimeTimeStr+"<\/span>",r+="<\/time>",r+="<div class='timeline-icon "+e+"'>",r+="<i class='entypo-feather'><\/i>",r+="<\/div>",r+="<div class='timeline-label'>",u==0?(r+="<h2>",r+="<span>ایجاد درخواست توسط : <\/span>",r+="<span class='sender'>"+(n.data[u].agentName==null?n.data[u].companyName:n.data[u].agentName)+" ("+n.data[u].roleDesc+") <\/span >",r+="<\/h2>",r+="<ul>",r+="<li>",r+="<span class='smallFontSize'> ["+n.data[u].levelStepStatus+"]<\/span>",r+="<\/li>",r+="<\/ul>"):(n.data[u].sendUser==null||(r+="<span>"+n.data[u].userRoleDes+": <\/span>",r+="<span class='sender'>"+n.data[u].realName+"<\/span>"),r+="<br/>",r+="<ul>",r+="<li>",r+="<span class='smallFontSize'>",r+=u>1?"["+n.data[u].destLevelStepIndexButton+"]":"["+n.data[u].levelStepStatus+"]",r+="<\/span>",r+="<\/li>",r+="<\/ul>"),r+="<span><\/span>",u==0?(r+="<div class='customDiv'>",r+="<span class='Transcript'>"+n.data[u].kindOfRequestName+"<\/span>",r+="<\/div>"):n.data[u].comment!=null&&(r+="<div class='customDiv'>توضیحات<hr/>",r+="<span class='Transcript'>"+n.data[u].comment+"<\/span>",r+="<\/div>"),r+="<\/div>",r+="<\/div>",r+="<\/article>",f=!f;i?(r+="<article class='timeline-entry "+(f?" left-aligned":"")+"'>",r+="<div class='timeline-entry-inner'>",r+="<time class='timeline-time' datetime='2014-01-10T03:45'><span>اختتام درخواست<\/span><\/time>",r+="<div class='timeline-icon bg-secondary'><i class='entypo-feather'><\/i><\/div>",r+="<div class='timeline-label'>",r+="<h2>",r+="<span>اختتام درخواست <\/span>",r+="<\/h2>",r+="<\/div>",r+="<\/article>"):(r+="<article class='timeline-entry begin'>",r+="<div class='timeline-entry-inner'>",r+="<div class='timeline-icon' style='-webkit-transform: rotate(-90deg); -moz-transform: rotate(-90deg);'>",r+="<i class='entypo-flight'><\/i>",r+="<\/div>",r+="<\/div>",r+="<\/article>");t("#TimeLine").html(r)}},!0)}function st(n=null){AjaxCallAction("POST","/api/superVisor/RequestForRating/Get_RequestForRatings",JSON.stringify({Search:null,PageIndex:1,PageSize:1,RequestId:n}),!0,function(t){if(t.isSuccess)for(var i=0;i<t.data.length;i++)t.data[i].isFinished?u(n,!0):u(n,!1)},!0)}function ht(n){document.getElementById("ContractDocumentCustomer").files.length==0?alertB("هشدار","فایلی قرارداد را انتخاب نکرده اید!.","warning"):f(n,!0)}function ct(){if(event.key==="Enter"){var n=t("#DicCountPerecent").val(),r=jQuery.parseHTML(getDataCkeditor("ContentContract")),i=removeComaForString(t("#PriceContract").val());n!=null&&n!=""?t("#lblDicCountPerecent").html(moneyCommaSepWithReturn((i*n/100).toString())):t("#lblDicCountPerecent").html(0)}}function f(n,i=true){var f=removeComaForString(t("#DisCountMoney").val()),e=t("#DicCountPerecent").val(),s=jQuery.parseHTML(getDataCkeditor("ContentContract")),r=null,u=removeComaForString(t("#PriceContract").val()),o;r=f!=null&&f!=""?u-f:e!=null&&e!=""?u-u*e/100:u;t("#FinalPriceContract").val(r);r=moneyCommaSepWithReturn(r.toString());t("#RequestID").val(decrypt(t("#sdklsslks3498sjdkxhjsd_823sa").val(),keyMaker()));t("#ContractShow").hide();t("#ContractShow").html(s);t('input[type="text"], textarea').each(function(){if(t(this).attr("name")=="ServiceFeePrice"){var n='<input type="text" name="ServiceFeePrice"value="'+r+'"/>';t(this).replaceWith(n)}});o=t("#ContractShow").html();setDataCkeditor("ContentContract",o);v(n,i);t("#FinalPriceContract").val(moneyCommaSepWithReturn(r))}n.RequestForRating={FilterGrid:w,TextSearchOnKeyDown:y,InitReferral:b,SaveRequestForRating:it,InitRequestReferences:st,ShowCustomerInfo:e,GetCustomerInfo:o,GetContractInfo:s,InitCustomer:h,ShowContract:g,InitContract:i,CreateTimeLine:u,SaveContractAndFinancialDocuments:v,GetContractCustomer:tt,ShowDocument:ut,GetDocument:r,GetShowDoument:l,ShowEvaluationFile:rt,GetShowEvaluationFile:a,Disconut:f,InitContractNew:c,PrintContract:k,PrintContracting:d,UploadContractCustomer:ht,SaveContractAndFinancialDocumentsArzyab:et,SaveContractAndFinancialDocumentsCommittee:ot,GetDocumentArzyab:ft,FillComboLevelStepSettingList:p,CalDisPerecent:ct}}(Web,jQuery),function(n,t){function i(){AjaxCallAction("POST","/api/superVisor/Customers/Get_Customerss",JSON.stringify({Search:t("#txtSearch").val(),PageIndex:1,PageSize:t("#cboSelectCount").val()}),!0,function(n){var r,i;if(n.isSuccess){for(r="",i=0;i<n.data.length;i++)r+="<tr><td>"+(i+1)+"<\/td><td>"+(isEmpty(n.data[i].companyName)?"":n.data[i].companyName)+"<\/td><td>"+(isEmpty(n.data[i].agentName)?"":n.data[i].agentName)+"<\/td><td>"+(isEmpty(n.data[i].agentMobile)?"":n.data[i].agentMobile)+"<\/td><td>"+n.data[i].saveDateStr+"<\/td><td>"+(n.data[i].isProfileComplete?"ثبت درخواست":"عدم ثبت درخواست")+"<\/td><td><a title='نمایش' href='/SuperVisor/Customers/ShowCustomers?id="+n.data[i].customerId+"' class='btn btn-edit fontForAllPage'><i class='fa fa-eye'><\/i><\/a><\/td><\/tr>";t("#tBodyList").html(r)}},!0)}function r(n){AjaxCallAction("GET","/api/superVisor/Customers/Get_Customers/"+(isEmpty(n)?"0":n),null,!0,function(n){n!=null&&(n.customerPersonalityType=="223"?(t(".form-group").hide(),t(".form-group.FormIsShow").show(),t(".NotShowRequiredLabel").hide(),t("#LabelTypeGroupCompanies").html("نوع فعالیت"),t("#LabelEconomicCode").html("شماره کارت بازرگانی"),t("#LabelCompanyName").html("نام و نام خانوادگی")):(t(".form-group").show(),t(".NotShowRequiredLabel").show(),t("#LabelTypeGroupCompanies").html("نوع گروه شرکتها"),t("#LabelEconomicCode").html("شماره ثبت"),t("#LabelCompanyName").html("نام شرکت")),t("#AddressCompany").html(n.addressCompany),t("#CompanyName").html(n.companyName),t("#CeoName").html(n.ceoName),t("#EconomicCode").html(n.economicCode),t("#NationalCode").html(n.nationalCode),t("#CeoNationalCode").html(n.ceoNationalCode),t("#CeoMobile").html(n.ceoMobile),t("#AgentMobile").html(n.agentMobile),t("#AgentName").html(n.agentName),t("#NamesAuthorizedSignatories").html(n.namesAuthorizedSignatories),t("#CountOfPersonal").html(n.countOfPersonal),t("#Email").html(n.email),t("#Tel").html(n.tel),t("#PostalCode").html(n.postalCode),t("#AmountOsLastSales").html(moneyCommaSepWithReturn(isEmpty(n.amountOsLastSales)?"":n.amountOsLastSales.toString())),t("#HowGetKnowCompanyId").html(n.howGetKnowCompany!=null?n.howGetKnowCompany.label:""),t("#KindOfCompanyId").html(n.kindOfCompany!=null?n.kindOfCompany.label:""),t("#divDownload").html("<a class='btn btn-success' href='/File/Download?path="+n.lastInsuranceListFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#divDownload_AuditedFinancialStatements").html("<a class='btn btn-success' href='/File/Download?path="+n.auditedFinancialStatementsFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#TypeGroupCompanies").text(n.typeGroupCompaniesName))},!0)}n.Customer={FilterGrid:i,InitCustomer:r}}(Web,jQuery),function(n,t){function i(){AjaxCallAction("POST","/api/superVisor/Users/UpdatePass_Users",JSON.stringify({OldPassword:t("#OldPassword").val(),NewPassword:t("#NewPassword").val(),ConfirmPassword:t("#ConfirmPassword").val()}),!0,function(n){debuggerWeb();n.isSuccess?alertB("",n.message,"success"):alertB("خطا",n.message,"error")},!0)}n.Users={UpdatePass:i}}(Web,jQuery),function(n,t){function k(n){n.keyCode==13&&t(`button[title='جستجو']`).click()}function h(n=null){var r=t("#RequestIdForms").val();switch(n){case 1:i(1,"1,2,7,8",r);p(r);break;case 2:i(3,"1,3,11",r);break;case 3:v(r);i(16,"1,2,3",r);i(17,"1,2",r);break;case 4:c(11);l(11,r);break;case 5:i(13,"1,2,3",r);break;case 7:y(r);case 9:i(9,"1,2,11",r);i(10,"1,11",r);break;case 14:w(r);i(15,"1,2,11",r);i(22,"1,11",r);i(24,"1,11",r)}}function o(n=null){if(n==1||n==3||n==16||n==9||n==13){var i="";switch(n){case 1:i="9,20,30,125";break;case 3:i="250";break;case 16:i="9";break;case 9:i="9"}AjaxCallAction("POST","/api/superVisor/SystemSeting/Get_SystemSetings",JSON.stringify({ParentCodeArr:i,PageIndex:0,PageSize:0}),!0,function(i){var f,u,r;if(i.isSuccess)if(n==1){var e='<option value="">انتخاب کنید<\/option>',o='<option value="">انتخاب کنید<\/option>';for(r=0;r<i.data.length;r++)i.data[r].parentCode==9?e+=" <option value="+i.data[r].systemSetingId+">"+i.data[r].label+"<\/option>":i.data[r].parentCode==20&&(o+=" <option value="+i.data[r].systemSetingId+">"+i.data[r].label+"<\/option>");t("#MemberEductionID").html(e);t("#UniversityID").html(o);t("#CompanyDocument").html('option value="">انتخاب کنید<\/option>')}else if(n==3){for(f='<option value="">انتخاب کنید<\/option>',r=0;r<i.data.length;r++)f+=" <option value="+i.data[r].systemSetingId+">"+i.data[r].label+"<\/option>";t("#IsGuideLineOrProcess").html(f)}else if(n==16||n==9){for(u=strDegreeOfEducation2='<option value="">انتخاب کنید<\/option>',r=0;r<i.data.length;r++)u+=" <option value="+i.data[r].systemSetingId+">"+i.data[r].label+"<\/option>";t("#DegreeOfEducation").html(u);t("#DegreeOfEducation2").html(u)}},!0);ComboBoxWithSearch(".select2","rtl")}}function a(n=null){PersianDatePicker(".DatePicker");t("#RequestIdForms").val(n);h(1)}function i(n=null,t=null,i=null){c(n,i);b(n,t,i)}function c(n=null){o(n)}function d(n=null,i=null,r=null){AjaxCallAction("POST","/api/superVisor/FurtherInfo/Get_DataFormQuestionss",JSON.stringify({DataFormId:n,PageIndex:0,PageSize:0}),!0,function(u){var e,s,f;if(u.isSuccess){for(e="",s=1,f=0;f<u.data.length;f++)f==0?e+="<div class='col-lg-6'>":f==Math.round(u.data.length/2)&&u.data.length>1&&(e+="<\/div><div class='col-lg-6'>"),e+="<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><form id='frmFrom"+i+f+"'> <input type='hidden' id='FormID' name='FormID' value='"+n+"' />",e+="<input type='hidden' id='DataFormQuestionID' name='DataFormQuestionID' value='"+u.data[f].dataFormQuestionId+"' />",e+="<Input type='hidden' id='RequestId' name='RequestId' value='"+r+"'/>",e+="<label class='control-label'  for=''>"+u.data[f].questionText+"<span class='RequiredLabel'>*<\/span><\/label>",e+=u.data[f].questionType=="select"?"<select name='Answer"+u.data[f].questionOrder+"' id='"+u.data[f].questionName+"' class='form-control select2' ><\/select>":u.data[f].questionType=="textarea"?"<textarea name='Answer"+u.data[f].questionOrder+"' id='"+u.data[f].questionName+"' class='form-control' ><\/textarea>":u.data[f].questionType=="checkbox"?"<input type='"+u.data[f].questionType+"' name='Answer"+u.data[f].questionOrder+"' id='"+u.data[f].questionName+"' style='text-align:right; width: 30px' />":u.data[f].questionType=="file"?"<input type='"+u.data[f].questionType+"' name='Result_Final_FileName"+s+"' id='"+u.data[f].questionName+"' /><div id='Div"+u.data[f].questionName+"'><\/div>":"<input type='"+u.data[f].questionType+"' name='Answer"+u.data[f].questionOrder+"' id='"+u.data[f].questionName+"' placeholder='"+u.data[f].questionText+"' class='form-control' />",e+="<button title='ثبت' class='btn btn-default fontForAllPage' type='button' onclick='Web.FurtherInfo.SavesingleForm(this,\""+i+f+"\")'> ثبت <\/button ><\/form>",e+="<\/div>",e+="<\/div>",f==u.data.length&&u.data.length>1&&(e+="<\/div>");t("#FormDetail"+n).html(e);o(n)}},!0)}function v(n=null){isEmpty(n)||n==0||AjaxCallAction("GET","/api/superVisor/FurtherInfo/Get_CorporateGovernances/"+(isEmpty(n)?"0":n),null,!0,function(n){n.isSuccess&&(t("#CorporateGovernanceId").val(n.data.corporateGovernanceId),t("#RequestId").val(n.data.requestId),t("#CompanyWebSite").val(n.data.companyWebSite),t("#HighProductKnowledge").val(n.data.highProductKnowledge),t("#HaveRepresentativeStr").prop("checked",n.data.haveRepresentative),t("#HaveAuditCommitteeStr").prop("checked",n.data.haveAuditCommittee),n.data.organazationChart!=null&&n.data.organazationChart!=""&&t("#DivOrganazationChart").html("<a class='btn btn-info' href='/File/Download?path="+n.data.organazationChartFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.organizationalDuties!=null&&n.data.organizationalDuties!=""&&t("#DivOrganizationalDuties").html("<a class='btn btn-info' href='/File/Download?path="+n.data.organizationalDutiesFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.riskManagementGuidelines!=null&&n.data.riskManagementGuidelines!=""&&t("#DivRiskManagementGuidelines").html("<a class='btn btn-info' href='/File/Download?path="+n.data.riskManagementGuidelinesFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.transactionRegulations!=null&&n.data.transactionRegulations!=""&&t("#DivTransactionRegulations").html("<a class='btn btn-info' href='/File/Download?path="+n.data.transactionRegulationsFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.deductionTaxAccount!=null&&n.data.deductionTaxAccount!=""&&t("#DivDeductionTaxAccount").html("<a class='btn btn-info' href='/File/Download?path="+n.data.deductionTaxAccountFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.crmSoftwareContract!=null&&n.data.crmSoftwareContract!=""&&t("#DivCrmSoftwareContract").html("<a class='btn btn-info' href='/File/Download?path="+n.data.crmSoftwareContractFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.crmSoftwareContract!=null&&n.data.crmSoftwareContract!=""&&t("#DivCrmSoftwareContract").html("<a class='btn btn-info' href='/File/Download?path="+n.data.crmSoftwareContractFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.representativeFile!=null&&n.data.representativeFile!=""&&t("#DivRepresentativeFile").html("<a class='btn btn-info' href='/File/Download?path="+n.data.RepresentativeFileFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.letterOfCommendation!=null&&n.data.letterOfCommendation!=""&&t("#DivLetterOfCommendation").html("<a class='btn btn-info' href='/File/Download?path="+n.data.LetterOfCommendationFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.proceedings!=null&&n.data.proceedings!=""&&t("#DivProceedings").html("<a class='btn btn-info' href='/File/Download?path="+n.data.proceedingsFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.inovationFile!=null&&n.data.inovationFile!=""&&t("#DivInovationFile").html("<a class='btn btn-info' href='/File/Download?path="+n.data.inovationFileFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"))},!0)}function y(n=null){isEmpty(n)||n==0||AjaxCallAction("GET","/api/superVisor/FurtherInfo/Get_ValueChain/"+(isEmpty(n)?"0":n),null,!0,function(n){n.isSuccess&&(t("#ValueChainId").val(n.data.valueChainId),t("#RequestId").val(n.data.requestId),n.data.vc1!=null&&n.data.vc1!=""&&t("#DivVc1").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc2!=null&&n.data.vc2!=""&&t("#DivVc2").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc2Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc3!=null&&n.data.vc3!=""&&t("#DivVc3").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc3Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc4!=null&&n.data.vc4!=""&&t("#DivVc4").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc4Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc4!=null&&n.data.vc4!=""&&t("#DivVc4").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc4Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc5!=null&&n.data.vc5!=""&&t("#DivVc5").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc5Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc6!=null&&n.data.vc6!=""&&t("#DivVc6").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc6Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc7!=null&&n.data.vc7!=""&&t("#DivVc7").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc7Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc8!=null&&n.data.vc8!=""&&t("#DivVc8").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc8Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc9!=null&&n.data.vc9!=""&&t("#DivVc9").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc9Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc10!=null&&n.data.vc10!=""&&t("#DivVc10").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc10Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc11!=null&&n.data.vc11!=""&&t("#DivVc11").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc11Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc12!=null&&n.data.vc12!=""&&t("#DivVc12").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc12Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc13!=null&&n.data.vc13!=""&&t("#DivVc13").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc13Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc14!=null&&n.data.vc14!=""&&t("#DivVc14").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc14Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc15!=null&&n.data.vc15!=""&&t("#DivVc15").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc15Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc16!=null&&n.data.vc16!=""&&t("#DivVc16").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc16Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc17!=null&&n.data.vc17!=""&&t("#DivVc17").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc17Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc18!=null&&n.data.vc18!=""&&t("#DivVc18").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc18Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc19!=null&&n.data.vc19!=""&&t("#DivVc19").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc19Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc20!=null&&n.data.vc20!=""&&t("#DivVc20").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc20Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc21!=null&&n.data.vc21!=""&&t("#DivVc21").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc21Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc22!=null&&n.data.vc22!=""&&t("#DivVc22").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc22Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc23!=null&&n.data.vc23!=""&&t("#DivVc23").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc23Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc24!=null&&n.data.vc24!=""&&t("#DivVc24").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc24Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.vc25!=null&&n.data.vc25!=""&&t("#DivVc25").html("<a class='btn btn-info' href='/File/Download?path="+n.data.vc25Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"))},!0)}function p(n=null){isEmpty(n)||n==0||AjaxCallAction("GET","/api/superVisor/FurtherInfo/Get_FurtherInfo/"+(isEmpty(n)?"0":n),null,!0,function(n){n.isSuccess&&(n.data.lastAuditingTaxList!=null&&n.data.lastAuditingTaxList!=""&&t("#divDownloadLastAuditingTaxList").html("<a class='btn btn-info' href='/File/Download?path="+n.data.lastAuditingTaxListFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.lastChangeOfficialNewspaper!=null&&n.data.lastChangeOfficialNewspaper!=""&&t("#divDownloadLastChangeOfficialNewspaper").html("<a class='btn btn-info' href='/File/Download?path="+n.data.LastChangeOfficialNewspaperFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.statuteDoc!=null&&n.data.statuteDoc!=""&&t("#divDownloadStatuteDoc").html("<a class='btn btn-info' href='/File/Download?path="+n.data.statuteDocFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),n.data.officialNewspaper!=null&&n.data.officialNewspaper!=""&&t("#divDownloadOfficialNewspaper").html("<a class='btn btn-info' href='/File/Download?path="+n.data.officialNewspaperFull+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"))},!0)}function w(n=null){isEmpty(n)||n==0||AjaxCallAction("GET","/api/superVisor/FurtherInfo/Get_PublicActivities/"+(isEmpty(n)?"0":n),null,!0,function(n){n.isSuccess&&(t("#IsPublicActivityFileStr").prop("checked",n.data.isPublicActivityFile),t("#Investment").val(n.data.investment),t("#EmploymentDisabled").val(n.data.employmentDisabled),t("#PublicActivitiesID").val(n.data.publicActivitiesID))},!0)}function g(n=null,i=null,r=null){AjaxCallAction("POST","/api/superVisor/FurtherInfo/Get_DataFormQuestionss",JSON.stringify({DataFormId:n,PageIndex:0,PageSize:0}),!0,function(u){var e,s,f;if(u.isSuccess){for(e="",s=1,f=0;f<u.data.length;f++)f==0?e+="<div class='col-lg-6'>":f==Math.round(u.data.length/2)&&u.data.length>1&&(e+="<\/div><div class='col-lg-6'>"),e+="<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><form id='frmFrom"+i+f+"'> <input type='hidden' id='FormID' name='FormID' value='"+n+"' />",e+="<input type='hidden' id='DataFormQuestionID' name='DataFormQuestionID' value='"+u.data[f].dataFormQuestionId+"' />",e+="<Input type='hidden' id='RequestId' name='RequestId' value='"+r+"'/>",e+="<label class='control-label'  for=''>"+u.data[f].questionText+"<span class='RequiredLabel'>*<\/span><\/label>",e+=u.data[f].questionType=="select"?"<select name='Answer"+u.data[f].questionOrder+"' id='"+u.data[f].questionName+"' class='form-control select2' ><\/select>":u.data[f].questionType=="textarea"?"<textarea name='Answer"+u.data[f].questionOrder+"' id='"+u.data[f].questionName+"' class='form-control' ><\/textarea>":u.data[f].questionType=="checkbox"?"<input type='"+u.data[f].questionType+"' name='Answer"+u.data[f].questionOrder+"' id='"+u.data[f].questionName+"' style='text-align:right; width: 30px' />":u.data[f].questionType=="file"?"<input type='"+u.data[f].questionType+"' name='Result_Final_FileName"+s+"' id='"+u.data[f].questionName+"' /><div id='Div"+u.data[f].questionName+"'><\/div>":"<input type='"+u.data[f].questionType+"' name='Answer"+u.data[f].questionOrder+"' id='"+u.data[f].questionName+"' placeholder='"+u.data[f].questionText+"' class='form-control' />",e+="<button title='ثبت' class='btn btn-default fontForAllPage' type='button' onclick='Web.FurtherInfo.SavesingleForm(this,\""+i+f+"\")'> ثبت <\/button ><\/form>",e+="<\/div>",e+="<\/div>",f==u.data.length&&u.data.length>1&&(e+="<\/div>");t("#FormDetail"+n).html(e);o(n)}},!0)}function l(n=null,i=null){AjaxCallAction("POST","/api/superVisor/FurtherInfo/Get_DataFromAnswerss",JSON.stringify({FormId:n,RequestId:i,PageIndex:0,PageSize:0}),!0,function(i){var r;if(i.isSuccess){if(n==14)for(r=0;r<i.data.length;r++)switch(i.data[r].dataFormQuestionId){case 87:t("#IsPublicActivityFile").prop("checked",i.data[r].answer=="false"?!1:!0);break;case 91:t("#Investment").val(i.data[r].answer);break;case 94:t("#EmploymentDisabled").val(i.data[r].answer)}if(n==11)for(r=0;r<i.data.length;r++)switch(i.data[r].dataFormQuestionId){case 79:t("#DivHumanResourcesFile").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>")}if(n==7)for(r=0;r<i.data.length;r++)switch(i.data[r].dataFormQuestionId){case 47:t("#DivVc1").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 48:t("#DivVc2").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 49:t("#DivVc3").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 50:t("#DivVc4").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>")}if(n==18)for(r=0;r<i.data.length;r++)switch(i.data[r].dataFormQuestionId){case 51:t("#DivVc5").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 52:t("#DivVc6").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 53:t("#DivVc7").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 54:t("#DivVc8").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 55:t("#DivVc9").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 56:t("#DivVc10").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 57:t("#DivVc11").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 58:t("#DivVc12").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>")}if(n==19)for(r=0;r<i.data.length;r++)switch(i.data[r].dataFormQuestionId){case 59:t("#DivVc13").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 60:t("#DivVc14").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 61:t("#DivVc15").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 62:t("#DivVc16").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 63:t("#DivVc17").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 64:t("#DivVc18").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 65:t("#DivVc19").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 66:t("#DivVc20").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 67:t("#DivVc21").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>")}if(n==20)for(r=0;r<i.data.length;r++)switch(i.data[r].dataFormQuestionId){case 68:t("#DivVc22").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 69:t("#DivVc23").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 70:t("#DivVc24").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 71:t("#DivVc25").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>")}if(n==25)for(r=0;r<i.data.length;r++)switch(i.data[r].dataFormQuestionId){case 28:i.data[r].fileName1!=null&&i.data[r].fileName1!=""&&t("#DivOrganazationChart").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 29:i.data[r].fileName1!=null&&i.data[r].fileName1!=""&&t("#DivOrganizationalDuties").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 30:i.data[r].fileName1!=null&&i.data[r].fileName1!=""&&t("#DivRiskManagementGuidelines").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 31:t("#DivTransactionRegulations").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 31:t("#DivTransactionRegulations").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 32:t("#DivDeductionTaxAccount").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 33:t("#DivCrmSoftwareContract").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 35:t("#DivRepresentativeFile").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 36:t("#DivletterOfCommendation").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 37:t("#DivInovationFile").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 40:t("#DivProceedings").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>")}if(n==2)for(r=0;r<i.data.length;r++)switch(i.data[r].dataFormQuestionId){case 97:i.data[r].fileName1!=null&&i.data[r].fileName1!=""&&t("#DivLastAuditingTaxList").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 98:i.data[r].fileName1!=null&&i.data[r].fileName1!=""&&t("#DivLastChangeOfficialNewspaper").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 99:i.data[r].fileName1!=null&&i.data[r].fileName1!=""&&t("#DivstatuteDoc").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>");break;case 100:i.data[r].fileName1!=null&&i.data[r].fileName1!=""&&t("#DivOfficialNewspaper").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>")}}},!0)}function b(n=null,i=null,r=null){AjaxCallAction("POST","/api/superVisor/FurtherInfo/Get_DataFormAnswerTabless",JSON.stringify({FormId:n,RequestId:r,PageIndex:0,PageSize:0}),!0,function(r){var f,u;if(r.isSuccess){f=i.split(",");let e="";for(let o=0;o<r.data.length;o++){for(e+="<tr><td>"+(o+1)+"<\/td><td>",u=0;u<f.length;u++)switch(f[u]){case"1":e+=r.data[o].answer1+"<\/td><td>";break;case"2":e+=r.data[o].answer2+"<\/td><td>";break;case"3":e+=r.data[o].answer3+"<\/td><td>";break;case"4":e+=r.data[o].answer4+"<\/td><td>";break;case"5":e+=r.data[o].answer5+"<\/td><td>";break;case"6":e+=r.data[o].answer6+"<\/td><td>";break;case"7":e+=r.data[o].answer7+"<\/td><td>";break;case"8":e+=r.data[o].answer8+"<\/td><td>";break;case"9":e+=r.data[o].answer6+"<\/td><td>";break;case"10":e+=r.data[o].answer6+"<\/td><td>";break;case"11":e+="<a href='/File/Download?path="+r.data[o].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a><\/td><td>";break;case"12":e+="<a href='/File/Download?path="+r.data[o].fileName2Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a><\/td><td>"}e+="<button title='ویرایش' class='btn btn-warring fontForAllPage' type='button' onclick='Web.FurtherInfo.GetFormAnswer("+n+","+r.data[o].answerTableId+")' ><i class='fa fa-edit'><\/i><\/button>";t("#sdfcddf").val()=="1"&&(e+="<button style='margin-right:5px' type='button' title='حذف' class='btn btn-warrnig fontForAllPage changeData' onclick='Web.FurtherInfo.Delete_DataFormAnswerTables("+n+',"'+i+'",'+r.data[o].answerTableId+");'><i class='fa fa-remove'><\/i><\/button>");e+="<\/td><\/tr>"}t("#FormDetailAnswer"+n).html(e)}},!0)}function nt(n=null,i=null){var r=t("#RequestIdForms").val();AjaxCallAction("POST","/api/superVisor/FurtherInfo/Get_DataFormAnswerTabless",JSON.stringify({FormId:n,AnswerTableId:i,RequestId:r,PageIndex:0,PageSize:0}),!0,function(i){if(i.isSuccess)for(var r=0;r<i.data.length;r++)t("#frmFrom"+n).find("input[name=AnswerTableId]").val(i.data[0].answerTableId),n==1?(t("#frmFrom"+n).find("input[name=Answer1]").val(i.data[0].answer1),t("#MemberPostID").val(i.data[0].answer2Val),comboBoxWithSearchUpdateText("MemberPostID",i.data[0].answer2),t("#MemberEductionID").val(i.data[0].answer3Val),comboBoxWithSearchUpdateText("MemberEductionID",i.data[0].answer3),t("#UniversityID").val(i.data[0].answer4Val),comboBoxWithSearchUpdateText("UniversityID",i.data[0].answer4),t("#IsMemeberOfBoard").prop("checked",i.data[0].answer5),i.data[0].answer6!=null?i.data[0].answer6=="on"?t("#frmFrom"+n).find("input[name=Answer6]").prop("checked",!0):t("#frmFrom"+n).find("input[name=Answer6]").prop("checked",!1):t("#frmFrom"+n).find("input[name=Answer6]").prop("checked",!1),t("#frmFrom"+n).find("input[name=Answer6]").val(i.data[0].answer6),t("#frmFrom"+n).find("input[name=Answer7]").val(i.data[0].answer7),t("#frmFrom"+n).find("input[name=Answer8]").val(i.data[0].answer8),t("#frmFrom"+n).find("input[name=Answer9]").val(i.data[0].answer9),t("#frmFrom"+n).find("input[name=Answer10]").val(i.data[0].answer10),i.data[0].fileName1Full!=null&&t("#DivAcademicDegreePicture").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#btnform1").html("ویرایش")):n==3?(t("#frmFrom"+n).find("input[name=Answer1]").val(i.data[0].answer1),t("#IsGuideLineOrProcess").val(i.data[0].answer3Val),comboBoxWithSearchUpdateText("IsGuideLineOrProcess",i.data[0].answer3),i.data[0].fileName1Full!=null&&t("#DivGuidelinesAndRegulationsFile").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#btnform3").html("ویرایش")):n==4?(t("#frmFrom"+n).find("input[name=Answer1]").val(i.data[0].answer1),t("#frmFrom"+n).find("input[name=Answer3]").val(i.data[0].answer3),t("#frmFrom"+n).find("input[name=Answer4]").val(i.data[0].answer4),i.data[0].fileName1Full!=null&&t("#DivCertificateAndPermitAndStandardFile").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#btnform4").html("ویرایش")):n==5?(t("#frmFrom"+n).find("input[name=Answer1]").val(i.data[0].answer1),t("#frmFrom"+n).find("input[name=Answer3]").val(i.data[0].answer3),t("#frmFrom"+n).find("input[name=Answer4]").val(i.data[0].answer4),i.data[0].fileName1Full!=null&&t("#DivAwardsFile").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#btnform5").html("ویرایش")):n==8?(i.data[0].fileName1Full!=null&&t("#DivSwotFile1").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),i.data[0].fileName2Full!=null&&t("#DivSwotFile2").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#btnform8").html("ویرایش")):n==9?(t("#frmFrom"+n).find("input[name=Answer1]").val(i.data[0].answer1),t("#DegreeOfEducation2").val(i.data[0].answer2Val),comboBoxWithSearchUpdateText("DegreeOfEducation2",i.data[0].answer2),i.data[0].fileName1Full!=null&&t("#DivDegreeFile").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#btnform9").html("ویرایش")):n==10?(t("#ReportTitle").val(i.data[0].answer1),i.data[0].fileName1Full!=null&&t("#DivReportFile").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#btnform10").html("ویرایش")):n==12?(t("#frmFrom"+n).find("input[name=Answer1]").val(i.data[0].answer1),t("#frmFrom"+n).find("input[name=Answer2]").val(i.data[0].answer2),t("#frmFrom"+n).find("input[name=Answer3]").val(i.data[0].answer3),t("#frmFrom"+n).find("input[name=Answer4]").val(i.data[0].answer4),i.data[0].fileName1Full!=null&&t("#DivCertificationCourses").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#btnform12").html("ویرایش")):n==13?(t("#frmFrom"+n).find("input[name=Answer1]").val(i.data[0].answer1),t("#frmFrom"+n).find("input[name=Answer2]").val(i.data[0].answer2),t("#PostInSociety").val(i.data[0].answer3Val),i.data[0].fileName1Full!=null&&t("#DivCertificationSociety").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),comboBoxWithSearchUpdateText("PostInSociety",i.data[0].answer3),t("#btnform13").html("ویرایش")):n==15?(t("#frmFrom"+n).find("input[name=Answer1]").val(i.data[0].answer1),t("#frmFrom"+n).find("input[name=Answer2]").val(i.data[0].answer2),i.data[0].fileName1Full!=null&&t("#DivPublicActivityFile").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#btnform15").html("ویرایش")):n==16?(t("#frmFrom"+n).find("input[name=Answer1]").val(i.data[0].answer1),t("#DegreeOfEducation").val(i.data[0].answer2Val),comboBoxWithSearchUpdateText("DegreeOfEducation",i.data[0].answer2),t("#frmFrom"+n).find("input[name=Answer3]").val(i.data[0].answer3),t("#btnform16").html("ویرایش")):n==17?(t("#frmFrom"+n).find("input[name=Answer1]").val(i.data[0].answer1),t("#frmFrom"+n).find("input[name=Answer2]").val(i.data[0].answer2),t("#btnform17").html("ویرایش")):n==22?(t("#frmFrom"+n).find("input[name=Answer1]").val(i.data[0].answer1),i.data[0].fileName1Full!=null&&t("#DivInvestmentFile").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#btnform22").html("ویرایش")):n==24&&(t("#frmFrom"+n).find("input[name=Answer1]").val(i.data[0].answer1),i.data[0].fileName1Full!=null&&t("#DivEmploymentDisabledFile").html("<a href='/File/Download?path="+i.data[r].fileName1Full+"' target='_blank'><i class='fa fa-download'><\/i>&nbsp;دانلود<\/a>"),t("#btnform24").html("ویرایش"))},!0)}function tt(n=null,r=null,u=null){try{debuggerWeb();confirmB("","آیا تمایل به حذف دارید؟","error",function(){AjaxCallAction("GET","/api/superVisor/FurtherInfo/Delete_DataFormAnswerTables/"+(isEmpty(u)?"0":u),null,!0,function(u){debuggerWeb();u.isSuccess?(i(n,r,t("#RequestIdForms").val()),t("#frmFrom"+n).find("input[name=AnswerTableId]").val("0"),alertB("",u.message,"success"),t("#btnform"+n).html("افزودن")):alertB("خطا",u.message,"error")},!0)},function(){},["خیر","بلی"])}catch(f){}}function it(n,r=null,u=null){t(n).attr("disabled","");AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_DataFormAnswerTabless",fill_AjaxCallActionPostSaveFormWithUploadFile("frmFrom"+r),!0,function(f){t(n).removeAttr("disabled");f.isSuccess?(t("#frmFrom"+r).find("input[name=AnswerTableId]").val("0"),r==1?a(t("#RequestIdForms").val()):(i(r,u,t("#RequestIdForms").val()),t(n).html("افزودن")),document.getElementById("frmFrom"+r).reset()):alertB("خطا",f.message,"error")},!0)}function rt(n,i=null){t(n).attr("disabled","");AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_DataFromAnswers",fill_AjaxCallActionPostSaveFormWithUploadFile("frmFrom"+i),!0,function(r){t(n).removeAttr("disabled");r.isSuccess?(l(i,t("#RequestIdForms").val()),alertB("ثبت","اطلاعات ثبت شد","success")):alertB("خطا",r.message,"error")},!0)}function ut(n){t(n).attr("disabled","");AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_FurtherInfo",fill_AjaxCallActionPostSaveFormWithUploadFile("FormDe2"),!0,function(i){t(n).removeAttr("disabled");i.isSuccess?alertB("ثبت","اطلاعات ثبت شد","success"):alertB("خطا",i.message,"error")},!0)}function ft(n){t(n).attr("disabled","");AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_CorporateGovernance",fill_AjaxCallActionPostSaveFormWithUploadFile("FormDe6"),!0,function(i){t(n).removeAttr("disabled");i.isSuccess?alertB("ثبت","اطلاعات ثبت شد","success"):alertB("خطا",i.message,"error")},!0)}function et(n){t(n).attr("disabled","");AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_ValueChain",fill_AjaxCallActionPostSaveFormWithUploadFile("FormDem7"),!0,function(i){t(n).removeAttr("disabled");i.isSuccess?alertB("ثبت","اطلاعات ثبت شد","success"):alertB("خطا",i.message,"error")},!0)}function ot(n){t(n).attr("disabled","");AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_PublicActivities",fill_AjaxCallActionPostSaveFormWithUploadFile("FormPublicActivities"),!0,function(i){t(n).removeAttr("disabled");i.isSuccess?alertB("ثبت","اطلاعات ثبت شد","success"):alertB("خطا",i.message,"error")},!0)}function st(n){try{r(n,14,String(t("#IsPublicActivityFile").prop("checked")),87);r(n,14,t("#EmploymentDisabled").val(),94);r(n,14,t("#Investment").val(),91);alertB("ثبت","اطلاعات ثبت شد","success")}catch(n){}}function ht(n){r(n,6,String(t("#HaveRepresentative").prop("checked")),34);r(n,6,t("#CompanyWebSite").val(),94);r(n,6,t("#HighProductKnowledge").val(),38);r(n,6,String(t("#HaveAuditCommittee").prop("checked")),39);alertB("ثبت","اطلاعات ثبت شد","success")}function ct(n=null){AjaxCallAction("GET","/api/superVisor/RequestForRating/InitReferral/"+n,null,!0,function(i){var u,r;if(i.isSuccess){for(t("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(n.toString(),keyMaker())),u="",r=0;r<i.data.length;r++)i.data[0].levelStepIndex==7&&i.data[0].levelStepAccessRole==5&&(u+="<button type='button' id='btnreq' style='margin:5px' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);' data-DLSI='"+encrypt(i.data[r].destLevelStepIndex,keyMaker())+"' data-LSAR='"+encrypt(i.data[r].levelStepAccessRole,keyMaker())+"' data-LSS='"+encrypt(i.data[r].levelStepStatus,keyMaker())+"' data-SC='"+encrypt(i.data[r].smsContent,keyMaker())+"' data-ST='"+i.data[r].smsType+"' data-DLSIB='"+encrypt(i.data[r].destLevelStepIndexButton,keyMaker())+"'>"+i.data[r].destLevelStepIndexButton+"<\/button>");t("#bLLSS").html(u);t("#sdfcddf").val(1)}else t("#EndfurtherInfo").html("اطلاعات شما برای پارس کیان جهت بررسی و ارزیابی ارسال شده است و قابل ویرایش نمی باشد.")},!0)}function r(n,i=null,r=null,u=null){t(n).attr("disabled","");var f=t("#RequestId").val();AjaxCallAction("POST","/api/superVisor/FurtherInfo/Save_DataFromAnswers",JSON.stringify({Answer:r,FormID:i,RequestId:f,DataFormQuestionID:u}),!0,function(i){t(n).removeAttr("disabled");i.isSuccess||alertB("خطا",i.message,"error")},!0)}var u,f,s,e;t(".next").click(function(){var n=Number(t("#FormLoadCode").val())+1;t("#FormLoadCode").val(n);h(n);u=t(this).parent();f=t(this).parent().next();t("#progressbar li").eq(t("fieldset").index(f)).addClass("active");f.show();u.animate({opacity:0},{step:function(n){e=1-n;u.css({display:"none",position:"relative"});f.css({opacity:e})},duration:600})});t(".previous").click(function(){var n=Number(t("#FormLoadCode").val())-1;t("#FormLoadCode").val(n);u=t(this).parent();s=t(this).parent().prev();t("#progressbar li").eq(t("fieldset").index(u)).removeClass("active");s.show();u.animate({opacity:0},{step:function(n){e=1-n;u.css({display:"none",position:"relative"});s.css({opacity:e})},duration:600})});t(".radio-group .radio").click(function(){t(this).parent().find(".radio").removeClass("selected");t(this).addClass("selected")});t(".submit").click(function(){return!1});n.FurtherInfo={TextSearchOnKeyDown:k,InitFurtherInfo:a,SystemSeting_Combo:o,IntiForm:c,IntiFormAnswer:b,IntiFormShow:i,IntiTab:h,IntiFormSingelAnswer:l,SaveForm:it,SaveSingelAnswerForm:r,SaveFormDetailTab14:st,GetFormAnswer:nt,Delete_DataFormAnswerTables:tt,SavesingleForm:rt,IntiFormQuestion:g,SaveForm25:ht,IntiFormQrid:d,SaveFurtherInfo:ut,SaveCorporateGovernance:ft,GetFurtherInfo:p,SaveValueChain:et,InitReferral:ct,GetCorporateGovernance:v,GetValueChain:y,SavePublicActivities:ot,GetPublicActivities:w}}(Web,jQuery);






(function (web, $) {

    //Document Ready              

    function signOutForExitToLogin() {

        dellstor("token");        
        dellstor("fullName");
        dellstor("userID");
        dellstor("loginName");
        dellstor("menu");
        dellstor("roleDesc");

        goToUrl("/Account/LoginUser");

    }

    function initLayout() {

        if (isEmpty(getlstor("token"))) goToUrl("/Account/LoginUser");
        else {

            $(".fullNameInLayout").html(getlstor("fullName"));
            $(".roleDescNameElementLayout").html(getlstor("roleDesc"));
        }

    }

    web.Layout = {

        SignOutForExitToLogin: signOutForExitToLogin,
        InitLayout: initLayout

    };

})(Web, jQuery);

(function (web, $) {

    //Document Ready  

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function fillComboLevelStepSettingList() {

        AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_LevelStepSetings", JSON.stringify({ PageIndex: 0, PageSize: 0  }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strKindOfCompany += " <option value=" + res.data[i].levelStepIndex + ">" + res.data[i].levelStepStatus + "</option>";
                }

                $("#cboSelectLS").html(strKindOfCompany);



            }
        }, true);

    }

    function filterGrid() {

        ComboBoxWithSearch('.select2', 'rtl');

        AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), DestLevelStepIndex: isEmpty($("#cboSelectLS").val()) ? null : $("#cboSelectLS").val() }), true, function (res) {

            if (res.isSuccess) {
                var n = getlstor("loginName");
                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>"
                        + res.data[i].requestNo + "</td><td>"
                        + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName:'') + "</td><td>"
                        + res.data[i].agentMobile + "</td><td>"
                        + res.data[i].dateOfRequestStr + "</td>"
                        + "<td>" + res.data[i].levelStepStatus + "</td><td>"
                        + "<a style='margin-right:5px; color:black' href='/superVisor/RequestForRating/RequestReferences?id=" + res.data[i].requestId + "'" + " class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title='مشاهده گردش کار'>  </a>"
                        + (getlstor("loginName") === res.data[i].destLevelStepAccessRole ? "<a style='margin-right:5px;color:black' title='مشاهده و اقدام' class='btn btn-edit fontForAllPage' href='/SuperVisor/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward' style='color:black'></i>  </a>" : "<a style='color:black;margin-right:5px;' title='نمایش پروفایل' href='/SuperVisor/Customers/ShowCustomers?id=" + res.data[i].customerId + "' class='btn btn-default fontForAllPage'><i class='fa fa-eye'></i> </a>");

                    if ((n == res.data[i].destLevelStepAccessRole && res.data[i].destLevelStepAccessRole == "5") || (n == "5" && res.data[i].destLevelStepAccessRole == "10" && res.data[i].destLevelStepIndex=="7")) {
                        strM += "<a style='margin-right:5px;color:black' title='مشاهده اطلاعات تکمیلی' class='btn btn-default fontForAllPage' href='/SuperVisor/FutherInfo/Index/" + res.data[i].requestId + "'><i class='fa fa-info'></i> </a>";
                    }
                    strM += "</td></tr>";
                    //if (res.data[i].levelStepIndex >= 7) {


                    // }
                }

                $("#tBodyList").html(strM);

                

            }

        }, true);

    }

    function initReferral(id = null) {

        AjaxCallAction("GET", "/api/superVisor/RequestForRating/InitReferral/" + id, null, true, function (res) {

            if (res.isSuccess) {

                getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Referral.html", function (resG) {

                    $("#divMAS").html(resG);
                    $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(id.toString(), keyMaker()));
                    $("#phch").show();
                    if (getlstor("loginName") === "9") {
                        $("#svisorShowContract").remove();
                    }
                  
                    if (res.data[0].destLevelStepIndex <= 2 || getlstor("loginName") === "5") {
                       
                        $("#svisorShowDocument").remove();
                    }
                    if (!(getlstor("loginName") === "5" || getlstor("loginName") === "8" || (getlstor("loginName") === "1" && res.data[0].levelStepIndex>=8)) || res.data[0].destLevelStepIndex < 5 ) {
                        $("#svisorShowEvaluationFile").remove();
                    }
                    var htmlB = "";
                    for (var i = 0; i < res.data.length; i++) {
                        $("#sdklsslks3498sjdkxhjsd_823sb").val(res.data[0].levelStepIndex);

                        htmlB += "<button type='button'  style='margin:5px' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveRequestForRating(this);' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "' data-SC='" + encrypt(res.data[i].smsContent, keyMaker()) + "' data-ST='" + res.data[i].smsType + "' data-DLSIB='" + encrypt(res.data[i].destLevelStepIndexButton, keyMaker()) + "'>" + res.data[i].destLevelStepIndexButton + "</button>";

                    }

                    $("#bLLSS").html(htmlB);
                    Ckeditor("ReferralExplanation");
                    showCustomerInfo();
                });


            }
            else {

                $("#divMAS").html("<div class='alert alert-error text-center' style='font-size: 20px;'>" + (isEmpty(res.message) ? "شما اجازه انجام این عملیات را ندارید" : res.message) + "</div>");
                $("#phch").hide();
                $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt('0', keyMaker()));
                $("#bLLSS").html("");
                Ckeditor("ReferralExplanation");
            }

        }, true);
        //  Ckeditor("ReferralExplanation");


    }

    function printContract(e) {

        disconut(e, false);
    }

    function printContracting(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#ContractShow").html(res.data.contentContract);
                    $("#SaveDate").html(res.data.saveDateStr);
                    $("#ContractCode").html(res.data.contractCode);
                    $('input[type="text"], textarea').each(function () {
                        //  $(this).attr('readonly', 'readonly');
                        // var text_classname = $(this).attr('name');
                        var value = $(this).val();
                        var new_html = ('<storang>' + value + '</storang>');
                        $(this).replaceWith(new_html);
                    });
                    window.print();
                }

            }, true);
        }
    }


    function showCustomerInfo() {

        getCustomerInfo();
    }

    function showContract() {

        getContractInfo();
    }


    function initContract(id=null) {
       
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#FinancialID").val(res.data.financialId);
                    $("#RequestID").val(res.data.requestID);
                    $("#PriceContract").val(moneyCommaSepWithReturn(res.data.priceContract==null?"":res.data.priceContract.toString()));
                    $("#FinalPriceContract").val(moneyCommaSepWithReturn(res.data.finalPriceContract==null?"":res.data.finalPriceContract.toString()));
                    $("#FinancialDocument").val(res.data.financialDocument);
                    $("#ContractDocument").val(res.data.contractDocument);

                    $("#DisCountMoney").val(moneyCommaSepWithReturn(res.data.disCountMoney==null?"":res.data.disCountMoney.toString()));
                    $("#DicCountPerecent").val(moneyCommaSepWithReturn(res.data.dicCountPerecent==null?"":res.data.dicCountPerecent.toString()));
                    
                    if (getlstor("loginName") === "1" || getlstor("loginName") === "4") {
                        if (res.data.contractDocumentCustomer != null && res.data.contractDocumentCustomer != "") {
                            $("#divDownloadContractDocumentCustomer").html("<a  href='/File/Download?path=" + res.data.contractDocumentCustomerFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#ContentCKeditor").html("<textarea name='ContentContract' id='ContentContract'>" + res.data.contentContract + "</textarea>");
                        Ckeditor("ContentContract");

                    }
                    else {

                        $("#ContractShow").addClass("ContractShowStyle");
                        $("#ContractShow").html(res.data.contentContract);
                        $('input[type="text"], textarea').each(function () {
                            //  $(this).attr('readonly', 'readonly');
                           // var text_classname = $(this).attr('name');
                            var value = $(this).val();
                            var new_html = ('<storang>' + value + '</storang>')
                            $(this).replaceWith(new_html);
                        });
                    }

                }
                else {
                    initContractNew(id);
                }
            }, true);
        }
    }



    function getCustomerInfo() {

        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());

        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {

                    getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Customer.html", function (resG) {

                        $("#customerInfo").html(resG);
                        for (var i = 0; i < res.data.length; i++) {

                            initCustomer(res.data[i].customerId);
                        }

                    });

                }

            }, true);
        }
    }

    function getContractInfo() {

        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());

        if (!isEmpty(id) && id != 0) {

            if ((getlstor("loginName") === "1") || (getlstor("loginName") === "4")) {
                getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Contract-moa.html", function (resG) {

                    $("#contractInfo").html(resG);
                    if (getlstor("loginName") === "4" || $("#sdklsslks3498sjdkxhjsd_823sb").val()>2) {
                        $('#FinalPriceContract').prop('readonly', true);
                        $('#DisCountMoney').prop('readonly', true);
                        $('#DicCountPerecent').prop('readonly', true);
                       
                    }
                    if (getlstor("loginName") === "1") {
                        $("#ContractUp").hide();
                    }
                        initContract(id);
                });
            } else {
                getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Contract.html", function (resG) {

                    $("#contractInfo").html(resG);
                    initContract(id);

                });
            }

        }
    }

    function initCustomer(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/Customers/Get_Customers/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res != null) {

                    if (res.customerPersonalityType == "223") {

                        $(".FormIsNotShow").hide();
                        $(".form-group.FormIsShow").show();
                        $(".NotShowRequiredLabel").hide();
                        $("#LabelEconomicCode").html("شماره کارت بازرگانی");
                        $("#LabelTypeGroupCompanies").html("نوع فعالیت");
                    }
                    else {

                        $(".FormIsNotShow").show();
                        $("#LabelEconomicCode").html("شماره ثبت");
                        $(".NotShowRequiredLabel").show();
                        $("#LabelTypeGroupCompanies").html("نوع گروه شرکتها");
                    }

                    $("#AddressCompany").val(res.addressCompany);
                    $("#CompanyName").val(res.companyName);
                    $("#CeoName").val(res.ceoName);
                    $("#EconomicCode").val(res.economicCode);
                    $("#NationalCode").val(res.nationalCode);
                    $("#CeoNationalCode").val(res.ceoNationalCode);
                    $("#CeoMobile").val(res.ceoMobile);
                    $("#AgentMobile").val(res.agentMobile);
                    $("#AgentName").val(res.agentName);
                    $("#NamesAuthorizedSignatories").val(res.namesAuthorizedSignatories);
                    $("#CountOfPersonal").val(res.countOfPersonal);
                    $("#Email").val(res.email);
                    $("#Tel").val(res.tel);
                    $("#PostalCode").val(res.postalCode);
                    $("#AmountOsLastSales").val(moneyCommaSepWithReturn(!isEmpty(res.amountOsLastSales) ? res.amountOsLastSales.toString() : ''));
                    $("#divDownload").html("<a class='btn btn-success' href='/File/Download?path=" + res.lastInsuranceListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    $("#divDownload_AuditedFinancialStatements").html("<a class='btn btn-success' href='/File/Download?path=" + res.auditedFinancialStatementsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    $("#TypeGroupCompanies").val(res.typeGroupCompaniesName);
                    systemSeting_Combo(res);


                }


            }, true);
        }
    }

    function systemSeting_Combo(resSingle) {

        AjaxCallAction("POST", "/api/superVisor/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63,27,56", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';
                var strHowGetKnowCompany = '<option value="">انتخاب کنید</option>';
                var strTypeServiceRequestedId = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].parentCode == 56) {
                        strHowGetKnowCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 63) {
                        strTypeServiceRequestedId += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 27) {
                        strKindOfCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                }

                $("#KindOfCompany").html(strKindOfCompany);
                $("#HowGetKnowCompany").html(strHowGetKnowCompany);
                $("#TypeServiceRequestedId").html(strTypeServiceRequestedId);

                $("#HowGetKnowCompany").val(resSingle.howGetKnowCompanyId);
                $("#KindOfCompany").val(resSingle.kindOfCompanyId);
                $("#TypeServiceRequestedId").val(resSingle.typeServiceRequestedId);

            }
        }, true);
    }

    function initContractNew(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ServiceFeeAndCustomerByRequest/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res != null) {
                   
                    if (res.contract == null) {
                        alertB("خطا", "متن قرارداد وجود ندارد", "error");
                    }
                    else {
                        if (getlstor("loginName") === "1" || (getlstor("loginName") === "4")) {
                            $("#RequestID").val(id);
                            $("#ContentCKeditor").html("<textarea name='ContentContract' id='ContentContract'>" + res.contract.contractText + "</textarea>");
                            var m = res.contract.contractText;
                           // $("#PriceContract").val(removeComaForString($(m).find('input[name="ServiceFeePrice"]').val()));
                            $("#PriceContract").val($(m).find('input[name="ServiceFeePrice"]').val());
                            $("#FinalPriceContract").val($(m).find('input[name="ServiceFeePrice"]').val());
                            Ckeditor("ContentContract");
                            if (res.serviceFee == null) {
                                alertB("خطا", "نرخی برای شرایط مشتری پیدا نشد", "error");
                            }
                        }
                    }
                       
                    
                }

            }, true);

        }


    }


    function getContractCustomer(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#ContractShow").addClass("ContractShowStyle");
                    $("#ContractShow").html(res.data[0].contentContract);
                    $('input[type="text"], textarea').each(function () {
                        //  $(this).attr('readonly', 'readonly');
                        var text_classname = $(this).attr('name');
                        var value = $(this).val();
                        var new_html = ('<label for="' + text_classname + '" id="' + '">' + value + '</label>');
                        $(this).replaceWith(new_html);
                    });
                }

            }, true);

        }


    }


    function saveRequestForRating(e) {

        $(".ButtonOpperationLSSlss").attr("disabled", "");

        var objJ = {};
        objJ.DestLevelStepIndex = decrypt($(e).attr("data-DLSI"), keyMaker());
        objJ.Comment = getDataCkeditor("ReferralExplanation");
        objJ.LevelStepAccessRole = decrypt($(e).attr("data-LSAR"), keyMaker());
        objJ.LevelStepStatus = decrypt($(e).attr("data-LSS"), keyMaker());
        objJ.Request = {};
        objJ.Request.Requestid = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        objJ.Request.KindOfRequest = 0;
        objJ.SmsContent = decrypt($(e).attr("data-SC"), keyMaker());
        objJ.SmsType = !isEmpty($(e).attr("data-ST")) ? $(e).attr("data-ST") === 'true' : null;
        objJ.DestLevelStepIndexButton = decrypt($(e).attr("data-DLSIB"), keyMaker());

        AjaxCallAction("POST", "/api/superVisor/RequestForRating/Save_Request", JSON.stringify(objJ), true, function (res) {

            $(".ButtonOpperationLSSlss").removeAttr("disabled");

            if (res.isSuccess) {
                //if (objJ.DestLevelStepIndex == "3") {
                //    var m = getDataCkeditor("ContractText");
                //    var FeePrice = $(m).find('input[name="ServiceFeePrice"]').val();// 
                //    // var Price = RemoveAllCharForPrice(FeePrice);
                //   // saveContractAndFinancialDocuments(objJ.Request.Requestid, getDataCkeditor("ContractText"), FeePrice);
                //}

                goToUrl("/SuperVisor/RequestForRating/Index");

            }
            else {

                alertB("هشدار", res.message, "warning");

            }

        }, true);

    }

    function showEvaluationFile() {
        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        //var stepIndex = decrypt($(e).attr("data-DLSI"), keyMaker());

        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {
                    for (var i = 0; i < res.data.length; i++) {

                        if (res.data[i].destLevelStepIndex >= 3) {
                            getShowEvaluationFile(id, res);
                        }
                    }
                }

            }, true);
        }


    }

    function showDocument() {
        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        //var stepIndex = decrypt($(e).attr("data-DLSI"), keyMaker());

        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {
                    for (var i = 0; i < res.data.length; i++) {

                        if (res.data[i].destLevelStepIndex >= 3) {
                            getShowDoument(id);
                        }
                    }
                }

            }, true);
        }



    }


    function getShowDoument(id = null) {
        if (!isEmpty(id) && id != 0) {
            getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Document.html", function (resG) {

                $("#showDocument").html(resG);
                getDocument(id);

            });
        }
    }

    function getShowEvaluationFile(id = null, res = null) {
        if (!isEmpty(id) && id != 0) {
            getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_EvaluationFile.html", function (resG) {

                $("#showEvaluationFile").html(resG);
                if (res.data[0].levelStepAccessRole == "9" || getlstor("loginName") === "1" || getlstor("loginName") === "8") {
                    $("#frmFormMain2").remove();
                }
                    if (getlstor("loginName") !== "8") {
                        $("#frmFormMain3").remove();
                    }
                  getDocument(id);

            });
        }
    }

    function getDocument(id = null) {
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    $("#FinancialID").val(res.data.financialId);
                    $("#RequestID").val(res.data.requestID);
                    $("#ContentContract").val(res.data.contentContract);
                    $("#PriceContract").val(res.data.priceContract);
                    $("#Tax").val(res.data.tax);
                    if (getlstor("loginName") === "8") {
                        $("#EvaluationFile").val(res.data.evaluationFile);
                    }                   
                    $("#DisCountMoney").val(res.data.disCountMoney);
                    $("#DicCountPerecent").val(res.data.dicCountPerecent);
                    $("#FinalPriceContract").val(res.data.finalPriceContract);
                                       
                    $("#ContractMainCode").val(res.data.contractMainCode);
                    $("#FinancialDocument").val(res.data.financialDocument);
                    $("#ContractDocument").val(res.data.contractDocument);
                    $("#ContractCode").val(res.data.contractCode);
                    if (getlstor("loginName") !== "4" && getlstor("loginName") !== "1" ) {
                     $("#ContractDocumentCustomer").val(res.data.contractDocumentCustomer);
                    }
                   
                    if (res.data.financialDocument != null && res.data.financialDocument!="" ) {
                        $("#divDownloadFinancialDocument").html("<a class='btn btn-success' href='/File/Download?path=" + res.data.financialDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownloadFinancialDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.contractDocument != null && res.data.contractDocument !="") {
                        $("#divDownload_ContractDocument").html("<a class='btn btn-success' href='/File/Download?path=" + res.data.contractDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_ContractDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.evaluationFile != null && res.data.evaluationFile !="" ) {
                        $("#divDownload_EvaluationFile").html("<a class='btn btn-success' href='/File/Download?path=" + res.data.evaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_EvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.committeeEvaluationFile != null && res.data.committeeEvaluationFile != "") {
                        $("#divDownload_CommitteeEvaluationFile").html("<a class='btn btn-success' href='/File/Download?path=" + res.data.committeeEvaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_CommitteeEvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.lastFinancialDocument != null && res.data.lastFinancialDocument != "") {
                        $("#divDownload_LastFinancialDocument").html("<a class='btn btn-success' href='/File/Download?path=" + res.data.lastFinancialDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_LastFinancialDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                }

            }, true);
        }
    }

    function getDocumentArzyab(id = null) {
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    $("#FinancialID").val(res.data.financialId);
                    $("#RequestID").val(res.data.requestID);
                    $("#ContentContract").val(res.data.contentContract);
                    $("#PriceContract").val(res.data.priceContract);
                    $("#Tax").val(res.data.tax);
                    // $("#EvaluationFile").val(res.data.evaluationFile);
                    $("#DisCountMoney").val(res.data.disCountMoney);
                    $("#DicCountPerecent").val(res.data.dicCountPerecent);
                    $("#FinalPriceContract").val(res.data.finalPriceContract);
                    $("#ContractDocumentCustomer").val(res.data.contractDocumentCustomer);
                    $("#ContractMainCode").val(res.data.contractMainCode);
                    $("#FinancialDocument").val(res.data.financialDocument);
                    $("#ContractDocument").val(res.data.contractDocument);
                    $("#ContractCode").val(res.data.contractCode);

                    if (res.data.financialDocument != null && res.data.financialDocument != "") {
                        $("#divDownloadFinancialDocument").html("<a class='btn btn-success' href='/File/Download?path=" + res.data.financialDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownloadFinancialDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.contractDocument != null && res.data.contractDocument != "") {
                        $("#divDownload_ContractDocument").html("<a class='btn btn-success' href='/File/Download?path=" + res.data.contractDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_ContractDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.evaluationFile != null && res.data.evaluationFile != "") {
                        $("#divDownload_EvaluationFile").html("<a class='btn btn-success' href='/File/Download?path=" + res.data.evaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_EvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.committeeEvaluationFile != null && res.data.committeeEvaluationFile != "") {
                        $("#divDownload_CommitteeEvaluationFile").html("<a class='btn btn-success' href='/File/Download?path=" + res.data.committeeEvaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_CommitteeEvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                }

            }, true);
        }
    }

    function saveContractAndFinancialDocuments(e,IsShowMsg=null) {

        $(e).attr("disabled", "");

        RemoveAllCharForPrice("DisCountMoney");
        $("#ContentContract").val(getDataCkeditor("ContentContract"));
        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmContract"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                if (IsShowMsg) {
                   
                    $("#DisCountMoney").val(moneyCommaSepWithReturn($("#DisCountMoney").val()));
                    $("#FinalPriceContract").val(moneyCommaSepWithReturn($("#FinalPriceContract").val()));
                    $("#PriceContract").val(moneyCommaSepWithReturn($("#PriceContract").val()));
                    
                    alertB("ثبت", " با موفقیت ثبت شد.", "success");
                    initContract(decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker()));
                }
                else {

                    var id =decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
                    goToUrl("/superVisor/RequestForRating/ContractPrint/" + id);
                }
            
            } else {

                $("#DisCountMoney").val(moneyCommaSepWithReturn($("#DisCountMoney").val()));

                alertB("خطا", res.message, "error");
            }

        }, true);
    }

    function saveContractAndFinancialDocumentsArzyab(e) {

        if (document.getElementById("EvaluationFile").files.length == 0) {
            alertB("هشدار", "فایل اکسل را انتخاب نکرده اید!.", "warning");
        } else {
          
        
        $(e).attr("disabled", "");

       
            AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain2"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                
                   
                    alertB("ثبت", " با موفقیت ثبت شد.", "success");

            } else {

                alertB("خطا", res.message, "error");
            }

        }, true);
            }
    }
    function saveContractAndFinancialDocumentsCommittee(e) {

        if (document.getElementById("CommitteeEvaluationFile").files.length == 0) {
            alertB("هشدار", "فایل اکسل را انتخاب نکرده اید!.", "warning");
        } else {


            $(e).attr("disabled", "");


            AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain3"), true, function (res) {

                $(e).removeAttr("disabled");

                if (res.isSuccess) {


                    alertB("ثبت", " با موفقیت ثبت شد.", "success");

                } else {

                    alertB("خطا", res.message, "error");
                }

            }, true);
        }
    }


    //function saveContractAndFinancialDocuments(RequestID = null, ContentContract = null, FeePrice = null, DicCountPerecent = null, DisCountMoney=null) {

    //    AjaxCallAction("POST", "/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments", JSON.stringify({ RequestID: RequestID, ContentContract: ContentContract, PriceContractStr: FeePrice }), true, function (res) {

    //        if (res.isSuccess) {

    //            // goToUrl("/SuperVisor/RequestForRating/Index");

    //        }
    //        else {

    //            alertB("هشدار", res.message, "warning");

    //        }

    //    }, true);

    //}

    function createTimeLine(id = null, isFinish) {

        AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestReferencessService", JSON.stringify({ RequestId: id }), true, function (res) {

            if (res != null) {
                var strTimeLine = '';
                var left = false;

                for (var i = 0; i < res.data.length; i++) {

                    var bgColor = i == 0 ? "bg-secondary" : "bg-info";

                    strTimeLine += "<article class='timeline-entry " + (left ? " left-aligned" : "") + "'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";

                    strTimeLine += "<time class='timeline-time' datetime=''>";
                    strTimeLine += "<span class='date'>" + res.data[i].sendTimeStr + "</span>";
                    strTimeLine += "<span class='LTRDirection'>" + res.data[i].sendTimeTimeStr + "</span>";
                    strTimeLine += "</time>";

                    strTimeLine += "<div class='timeline-icon " + bgColor + "'>";
                    strTimeLine += "<i class='entypo-feather'></i>";
                    strTimeLine += "</div>";

                    strTimeLine += "<div class='timeline-label'>";
                    if (i == 0) {
                        strTimeLine += "<h2>";
                        strTimeLine += "<span>ایجاد درخواست توسط : </span>";
                        strTimeLine += "<span class='sender'>" + (res.data[i].agentName == null ? res.data[i].companyName : res.data[i].agentName) + " (" + res.data[i].roleDesc + ") " + "</span >";
                        strTimeLine += "</h2>";

                        //  strTimeLine += "<p><strong>گیرنده ها :</strong></p>";
                        strTimeLine += "<ul>";
                        strTimeLine += "<li>";
                        // strTimeLine += "<span class='reciver' > علی احمدی </span >";
                        // strTimeLine += "<span class='PostText'>";                        
                        // strTimeLine += "<text > [رئیس شورا] </text>";                           
                        // strTimeLine += "</span>";
                        strTimeLine += "<span class='smallFontSize'> [" + res.data[i].levelStepStatus + "]</span>";
                        // strTimeLine += "<span class='redColor'>[ خوانده نشده ]</span>";
                        strTimeLine += "</li>";
                        strTimeLine += "</ul>";
                    }
                    else {
                        if (res.data[i].sendUser == null) {
                            // strTimeLine += "<span>" + res.data[i].roleDesc + ": </span>";
                            // strTimeLine += "<span class='sender'>" + res.data[i].agentName + "</span>";
                        } else {
                            strTimeLine += "<span>" + res.data[i].userRoleDes + ": </span>";
                            strTimeLine += "<span class='sender'>" + res.data[i].realName + "</span>";
                        }
                        strTimeLine += "<br/>";
                        //  strTimeLine += "<span> گیرنده ها : </span>";
                        strTimeLine += "<ul>";
                        strTimeLine += "<li>";
                        // strTimeLine += "<span class='reciver'>مینا</span>";
                        // strTimeLine += "<span class='PostText'>";
                        // strTimeLine += "<text> [رئیس شورا] </text>";
                        // strTimeLine += " </span>";
                        strTimeLine += "<span class='smallFontSize'>";
                        if (i > 1) {
                            strTimeLine += "[" + res.data[i].destLevelStepIndexButton + "]";
                            // strTimeLine += "[ جهت اقدام] <span >[ خوانده شده ] </span><span class='greenColor'>1401/09/21  3:34</span>";
                        } else {
                            strTimeLine += "[" + res.data[i].levelStepStatus + "]";
                            // strTimeLine += "[ جهت اقدام] <span >[ خوانده شده ] </span><span class='greenColor'>1401/09/21  3:34</span>";
                        }

                        strTimeLine += "</span>";
                        strTimeLine += "</li>";
                        strTimeLine += "</ul>";

                    }
                    strTimeLine += "<span></span>";
                    if (i == 0) {
                        strTimeLine += "<div class='customDiv'>";
                        strTimeLine += "<span class='Transcript'>" + res.data[i].kindOfRequestName + "</span>";
                        strTimeLine += "</div>";
                    } else {
                        if (res.data[i].comment != null) {

                            strTimeLine += "<div class='customDiv'>توضیحات<hr/>";
                            strTimeLine += "<span class='Transcript'>" + res.data[i].comment + "</span>";
                            strTimeLine += "</div>";
                        }
                    }
                    strTimeLine += "</div>";
                    //res.data[i].kindOfRequestName

                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                    left = !left;


                }
                if (isFinish) {
                    strTimeLine += "<article class='timeline-entry " + (left ? " left-aligned" : "") + "'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";
                    strTimeLine += "<time class='timeline-time' datetime='2014-01-10T03:45'><span>اختتام درخواست</span></time>";
                    strTimeLine += "<div class='timeline-icon bg-secondary'><i class='entypo-feather'></i></div>";
                    strTimeLine += "<div class='timeline-label'>";
                    strTimeLine += "<h2>";
                    strTimeLine += "<span>اختتام درخواست </span>";
                    // strTimeLine += "<span class='sender''>مهندس</span>";
                    strTimeLine += "</h2>";
                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                } else {
                    strTimeLine += "<article class='timeline-entry begin'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";
                    strTimeLine += "<div class='timeline-icon' style='-webkit-transform: rotate(-90deg); -moz-transform: rotate(-90deg);'>";
                    strTimeLine += "<i class='entypo-flight'></i>";
                    strTimeLine += "</div>";
                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                }

                $("#TimeLine").html(strTimeLine);

            }

        }, true);

    }

    function initRequestReferences(id = null) {

        AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1, RequestId: id }), true, function (res) {

            if (res.isSuccess) {
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].isFinished) {
                        createTimeLine(id, true);
                    } else {
                        createTimeLine(id, false);
                    }
                }
            }

        }, true);

    }

    function uploadContractCustomer(e) {
        if (document.getElementById("ContractDocumentCustomer").files.length == 0) {
            alertB("هشدار", "فایلی قرارداد را انتخاب نکرده اید!.", "warning");
        } else {
            disconut(e,  true);
        }

    }

     function calDisPerecent (e) {
         if (event.key === 'Enter') {
             var disPerecent = $('#DicCountPerecent').val();
             var m = jQuery.parseHTML(getDataCkeditor("ContentContract"));
             var dis = null;
             var FeePrice = removeComaForString($("#PriceContract").val());// $('#DicCountPerecent').val();//removeComaForString($(m).find('input[name="ServiceFeePrice"]').val());
             if (disPerecent != null && disPerecent != "") {
                 let disprice = ((FeePrice * disPerecent) / 100).toString();
                 let len = disprice.length;
                 disprice = disprice.slice(0, len - 5) + "000";
                 $("#lblDicCountPerecent").html(moneyCommaSepWithReturn(disprice));
             } else {

                 $("#lblDicCountPerecent").html(0);
             }
         }
    }

    function disconut(e, ShowMsg = true) {

        
        
        var dicMoney = removeComaForString($('#DisCountMoney').val());
        var disPerecent = $('#DicCountPerecent').val();
        var m = jQuery.parseHTML(getDataCkeditor("ContentContract"));
        var Total = null;
        var FeePrice = removeComaForString($("#PriceContract").val());// $('#DicCountPerecent').val();//removeComaForString($(m).find('input[name="ServiceFeePrice"]').val());
         if (dicMoney != null && dicMoney != "") {

             Total = FeePrice - dicMoney;
        }
        else if (disPerecent != null && disPerecent != "") {
             let disprice = ((FeePrice * disPerecent) / 100).toString();
             let len = disprice.length;
             disprice = disprice.slice(0, len - 5) + "000";
             Total = FeePrice - disprice;
         } else {

             Total = FeePrice;
        }
      
        $("#FinalPriceContract").val(Total);
        Total = moneyCommaSepWithReturn(Total.toString());
       // $("#DisCountMoney").val(moneyCommaSepWithReturn(dicMoney.toString()));
        $("#RequestID").val(decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker()));
        $("#ContractShow").hide();
        $("#ContractShow").html(m);
        $('input[type="text"], textarea').each(function () {
            if ($(this).attr("name") == "ServiceFeePrice") {
                var new_html = ('<input type="text" name="ServiceFeePrice"' + 'value="' + Total + '"/>');
                $(this).replaceWith(new_html);
            }
        });

        var elements = $("#ContractShow").html();
        setDataCkeditor('ContentContract', elements);  
        saveContractAndFinancialDocuments(e, ShowMsg);
        $("#FinalPriceContract").val(moneyCommaSepWithReturn(Total));
    }

    web.RequestForRating = {
        FilterGrid: filterGrid,
        TextSearchOnKeyDown: textSearchOnKeyDown,
        InitReferral: initReferral,
        SaveRequestForRating: saveRequestForRating,
        InitRequestReferences: initRequestReferences,
        ShowCustomerInfo: showCustomerInfo,
        GetCustomerInfo: getCustomerInfo,
        GetContractInfo: getContractInfo,
        InitCustomer: initCustomer,
        ShowContract: showContract,
        InitContract: initContract,
        CreateTimeLine: createTimeLine,
        SaveContractAndFinancialDocuments: saveContractAndFinancialDocuments,
        GetContractCustomer: getContractCustomer,
        ShowDocument: showDocument,
        GetDocument: getDocument,
        GetShowDoument: getShowDoument,
        ShowEvaluationFile: showEvaluationFile,
        GetShowEvaluationFile: getShowEvaluationFile,
        Disconut: disconut,
        InitContractNew: initContractNew,
        PrintContract: printContract,
        PrintContracting: printContracting,
        UploadContractCustomer: uploadContractCustomer,
        SaveContractAndFinancialDocumentsArzyab: saveContractAndFinancialDocumentsArzyab,
        SaveContractAndFinancialDocumentsCommittee: saveContractAndFinancialDocumentsCommittee,
        GetDocumentArzyab: getDocumentArzyab,
        FillComboLevelStepSettingList: fillComboLevelStepSettingList,
        CalDisPerecent: calDisPerecent
    };

})(Web, jQuery);

(function (web, $) {

    //Document Ready              

    function filterGrid() {

        AjaxCallAction("POST", "/api/superVisor/Customers/Get_Customerss", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {

                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>" + (isEmpty(res.data[i].companyName) ? '' : res.data[i].companyName) + "</td><td>" + (isEmpty(res.data[i].agentName) ? '' : res.data[i].agentName) + "</td><td>" + (isEmpty(res.data[i].agentMobile) ? '' : res.data[i].agentMobile) + "</td><td>" + res.data[i].saveDateStr + "</td><td>" + (res.data[i].isProfileComplete ? 'ثبت درخواست' : 'عدم ثبت درخواست') + "</td><td><a title='نمایش' href='/SuperVisor/Customers/ShowCustomers?id=" + res.data[i].customerId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-eye'></i></a></td></tr>";

                }
                $("#tBodyList").html(strM);

            }

        }, true);

    }

    function initCustomer(id,dir = 'rtl') {
        
        AjaxCallAction("GET", "/api/superVisor/Customers/Get_Customers/" + (isEmpty(id) ? '0' : id), null, true, function (res) {


            if (res != null) {


                if (res.customerPersonalityType == "223") {

                    $(".form-group").hide();
                    $(".form-group.FormIsShow").show();
                    $(".NotShowRequiredLabel").hide();
                    $("#LabelTypeGroupCompanies").html("نوع فعالیت");
                    $("#LabelEconomicCode").html("شماره کارت بازرگانی");
                    $("#LabelCompanyName").html("نام و نام خانوادگی");
                }
                else {

                    $(".form-group").show();
                    $(".NotShowRequiredLabel").show();
                    $("#LabelTypeGroupCompanies").html("نوع گروه شرکتها");
                    $("#LabelEconomicCode").html("شماره ثبت");
                    $("#LabelCompanyName").html("نام شرکت");
                }


                $("#AddressCompany").html(res.addressCompany);
                $("#CompanyName").html(res.companyName);
                $("#CeoName").html(res.ceoName);
                $("#EconomicCode").html(res.economicCode);
                $("#NationalCode").html(res.nationalCode);
                $("#CeoNationalCode").html(res.ceoNationalCode);
                $("#CeoMobile").html(res.ceoMobile);
                $("#AgentMobile").html(res.agentMobile);
                $("#AgentName").html(res.agentName);
                $("#NamesAuthorizedSignatories").html(res.namesAuthorizedSignatories);
                $("#CountOfPersonal").html(res.countOfPersonal);
                $("#Email").html(res.email);
                $("#Tel").html(res.tel);
                $("#PostalCode").html(res.postalCode);
               
                $("#AmountOsLastSales").html(moneyCommaSepWithReturn(!isEmpty(res.amountOsLastSales) ? res.amountOsLastSales.toString() : ''));

                $("#HowGetKnowCompanyId").html(res.howGetKnowCompany != null ? res.howGetKnowCompany.label : '');

                $("#KindOfCompanyId").html(res.kindOfCompany != null ? res.kindOfCompany.label : '');

                $("#divDownload").html("<a class='btn btn-success' href='/File/Download?path=" + res.lastInsuranceListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                $("#divDownload_AuditedFinancialStatements").html("<a class='btn btn-success' href='/File/Download?path=" + res.auditedFinancialStatementsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                $("#TypeGroupCompanies").text(res.typeGroupCompaniesName);

            }


        }, true);

    }

    web.Customer = {
        FilterGrid: filterGrid,
        InitCustomer: initCustomer
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready      

    function updatePass() {

        AjaxCallAction("POST", "/api/superVisor/Users/UpdatePass_Users", JSON.stringify({ OldPassword: $("#OldPassword").val(), NewPassword: $("#NewPassword").val(), ConfirmPassword: $("#ConfirmPassword").val() }), true, function (result) {

            debuggerWeb();

            if (result.isSuccess) {

                alertB("", result.message, "success");

            }
            else {

                alertB("خطا", result.message, "error");

            }

        }, true);

    }

    web.Users = {
        UpdatePass: updatePass
    };

})(Web, jQuery);

(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    var current_fs, next_fs, previous_fs; //fieldsets
    var opacity;

    $(".next").click(function () {

        var countform = Number($("#FormLoadCode").val()) + 1;
        $("#FormLoadCode").val(countform);





        intiTab(countform);

        current_fs = $(this).parent();
        next_fs = $(this).parent().next();

        //Add Class Active
        $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

        //show the next fieldset
        next_fs.show();
        //hide the current fieldset with style
        current_fs.animate({ opacity: 0 }, {
            step: function (now) {
                // for making fielset appear animation
                opacity = 1 - now;

                current_fs.css({
                    'display': 'none',
                    'position': 'relative'
                });
                next_fs.css({ 'opacity': opacity });
            },
            duration: 600
        });
    });



    $(".previous").click(function () {

        var countform = Number($("#FormLoadCode").val()) - 1;
        $("#FormLoadCode").val(countform);

        current_fs = $(this).parent();
        previous_fs = $(this).parent().prev();

        //Remove class active
        $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

        //show the previous fieldset
        previous_fs.show();

        //hide the current fieldset with style
        current_fs.animate({ opacity: 0 }, {
            step: function (now) {
                // for making fielset appear animation
                opacity = 1 - now;

                current_fs.css({
                    'display': 'none',
                    'position': 'relative'
                });
                previous_fs.css({ 'opacity': opacity });
            },
            duration: 600
        });
    });

    $('.radio-group .radio').click(function () {
        $(this).parent().find('.radio').removeClass('selected');
        $(this).addClass('selected');
    });

    $(".submit").click(function () {
        return false;
    });



    function intiTab(TabId = null) {
        var ID = $("#RequestIdForms").val();

        switch (TabId) {
            case 1:
                intiFormShow(1, "1,2,7,8", ID);
                getFurtherInfo(ID);

                break;
            case 2:
                intiFormShow(3, "1,3,11", ID);

                break;
            case 3:
                getCorporateGovernance(ID);
                intiFormShow(16, "1,2,3", ID);
                intiFormShow(17, "1,2", ID);

                break;
            case 4:
                intiForm(11);
                intiFormSingelAnswer(11, ID);

                break;
            case 5:
                intiFormShow(13, "1,2,3", ID);

                break;
            case 7:
                getValueChain(ID);
            //intiFormQuestion(7, "D");
            //intiFormSingelAnswer(7, ID);
            //intiFormQuestion(18, "D");
            //intiFormSingelAnswer(18, ID);
            //intiFormQuestion(19, "D");
            //intiFormSingelAnswer(18, ID);
            //intiFormQuestion(20, "D");
            //intiFormSingelAnswer(20, ID);

            case 9:
                intiFormShow(9, '1,2,11', ID);
                intiFormShow(10, '1,11', ID);

                break;
            case 14:

                //intiForm(14);
                //intiFormSingelAnswer(14, ID);
                getPublicActivities(ID);
                intiFormShow(15, '1,2,11', ID);
                intiFormShow(22, '1,11', ID);
                intiFormShow(24, '1,11', ID);

                break;

        }

    }

    function systemSeting_Combo(FormId = null) {

        if (FormId == 1 || FormId == 3 || FormId == 16 || FormId == 9 || FormId == 13) {
            var PC = '';
            switch (FormId) {
                case 1:
                    PC = '9,20,30,125';
                    break;
                case 3:
                    PC = '250';
                    break;
                case 16:
                    PC = '9';
                    break;
                case 9:
                    PC = '9';
                    break;

            }

            AjaxCallAction("POST", "/api/superVisor/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: PC, PageIndex: 0, PageSize: 0 }), true, function (res) {

                if (res.isSuccess) {
                    if (FormId == 1) {
                        var strMemberPostID = '<option value="">انتخاب کنید</option>';
                        var strMemberEductionID = '<option value="">انتخاب کنید</option>';
                        var strUniversityID = '<option value="">انتخاب کنید</option>';
                        var strCompanyDocument = 'option value="">انتخاب کنید</option>';

                        for (var i = 0; i < res.data.length; i++) {
                            if (res.data[i].parentCode == 9) {
                                strMemberEductionID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                            } else if (res.data[i].parentCode == 20) {
                                strUniversityID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                            }

                        }
                        $("#MemberEductionID").html(strMemberEductionID);
                        $("#UniversityID").html(strUniversityID);
                        $("#CompanyDocument").html(strCompanyDocument);

                    }
                    else if (FormId == 3) {
                        var strIsGuideLineOrProcess = '<option value="">انتخاب کنید</option>';

                        for (var i = 0; i < res.data.length; i++) {
                            strIsGuideLineOrProcess += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                        }

                        $("#IsGuideLineOrProcess").html(strIsGuideLineOrProcess);

                    }
                    else if (FormId == 16 || FormId == 9) {
                        var strDegreeOfEducation = strDegreeOfEducation2 = '<option value="">انتخاب کنید</option>';

                        for (var i = 0; i < res.data.length; i++) {
                            strDegreeOfEducation += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                        }

                        $("#DegreeOfEducation").html(strDegreeOfEducation);
                        $("#DegreeOfEducation2").html(strDegreeOfEducation);
                    }

                }
            }, true);

            ComboBoxWithSearch('.select2', 'rtl');
        }
    }

    //function getsuperVisor() {

    //    AjaxCallAction("GET", "/api/superVisor/superVisors/Get_superVisors/", null, true, function (res) {
    //        if (res != null) {               
    //            $("#CanSeeFurtherInfo").val(res.tel);
    //        }
    //    }, true);
    //}

    function initFurtherInfo(id = null) {
        PersianDatePicker(".DatePicker");


        $("#RequestIdForms").val(id);
        //initReferral(id);
        intiTab(1);

    }

    function intiFormShow(Id = null, Columns = null, RequestId = null) {

        intiForm(Id, RequestId);
        intiFormAnswer(Id, Columns, RequestId);


    }


    function intiForm(FormID = null, RequestId = null) {

        //AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

        //    if (res.isSuccess) {

        //        var strFormId = '';
        //        var Filename = 1;
        //        for (var i = 0; i < res.data.length; i++) {
        //            if (i == 0) {
        //                strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";
        //            }

        //            if (i == 0) {
        //                strFormId += "<div class='col-lg-6'>";
        //            } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
        //                strFormId += "</div><div class='col-lg-6'>";
        //            }

        //            strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
        //            if (res.data[i].questionType == 'select') {
        //                strFormId += "<select name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control select2' ></select>";
        //            } else if (res.data[i].questionType == 'textarea') {
        //                strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
        //            }
        //            else if (res.data[i].questionType == 'checkbox') {
        //                strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
        //            } else if (res.data[i].questionType == 'file') {
        //                strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";
        //                Filename++;
        //            }

        //            else {
        //                strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
        //            }
        //            strFormId += "</div>";
        //            strFormId += "</div>";
        //            if (i == res.data.length && res.data.length > 1) {
        //                strFormId += "</div>";
        //            }
        //        }
        //        $("#FormDetail" + FormID).html(strFormId);
        systemSeting_Combo(FormID);
        //    }
        //}, true);
    }

    function intiFormQrid(FormID = null, Name = null, RequestId = null) {

        AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var strFormId = '';
                var Filename = 1;

                for (var i = 0; i < res.data.length; i++) {

                    if (i == 0) {
                        strFormId += "<div class='col-lg-6'>";
                    } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
                        strFormId += "</div><div class='col-lg-6'>";
                    }

                    strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><form id='frmFrom" + Name + (i) + "'> <input type='hidden' id='FormID' name='FormID' value='" + FormID + "' />";
                    strFormId += "<input type='hidden' id='DataFormQuestionID' name='DataFormQuestionID' value='" + res.data[i].dataFormQuestionId + "' />";

                    strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";


                    strFormId += "<label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
                    if (res.data[i].questionType == 'select') {
                        strFormId += "<select name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control select2' ></select>";
                    } else if (res.data[i].questionType == 'textarea') {
                        strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
                    }
                    else if (res.data[i].questionType == 'checkbox') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
                    } else if (res.data[i].questionType == 'file') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";

                    }

                    else {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
                    }
                    strFormId += "<button title='ثبت' class='btn btn-default fontForAllPage' type='button' onclick='Web.FurtherInfo.SavesingleForm(this," + '"' + Name + (i) + '"' + ")'> ثبت </button ></form>";

                    strFormId += "</div>";
                    strFormId += "</div>";
                    if (i == res.data.length && res.data.length > 1) {
                        strFormId += "</div>";
                    }


                }
                $("#FormDetail" + FormID).html(strFormId);
                systemSeting_Combo(FormID);
            }
        }, true);
    }

    function getCorporateGovernance(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/FurtherInfo/Get_CorporateGovernances/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    $("#CorporateGovernanceId").val(res.data.corporateGovernanceId);
                    $("#RequestId").val(res.data.requestId);
                    $("#CompanyWebSite").val(res.data.companyWebSite);
                    $("#HighProductKnowledge").val(res.data.highProductKnowledge);
                    $("#HaveRepresentativeStr").prop("checked", res.data.haveRepresentative);
                    // $("#HaveRepresentative").val(res.data.haveRepresentative);
                    $("#HaveAuditCommitteeStr").prop("checked", res.data.haveAuditCommittee);

                    if (res.data.organazationChart != null && res.data.organazationChart != "") {
                        $("#DivOrganazationChart").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.organazationChartFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.organizationalDuties != null && res.data.organizationalDuties != "") {
                        $("#DivOrganizationalDuties").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.organizationalDutiesFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.riskManagementGuidelines != null && res.data.riskManagementGuidelines != "") {
                        $("#DivRiskManagementGuidelines").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.riskManagementGuidelinesFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.transactionRegulations != null && res.data.transactionRegulations != "") {
                        $("#DivTransactionRegulations").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.transactionRegulationsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.deductionTaxAccount != null && res.data.deductionTaxAccount != "") {
                        $("#DivDeductionTaxAccount").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.deductionTaxAccountFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.crmSoftwareContract != null && res.data.crmSoftwareContract != "") {
                        $("#DivCrmSoftwareContract").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.crmSoftwareContractFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.crmSoftwareContract != null && res.data.crmSoftwareContract != "") {
                        $("#DivCrmSoftwareContract").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.crmSoftwareContractFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.representativeFile != null && res.data.representativeFile != "") {
                        $("#DivRepresentativeFile").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.RepresentativeFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.letterOfCommendation != null && res.data.letterOfCommendation != "") {
                        $("#DivLetterOfCommendation").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.LetterOfCommendationFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.proceedings != null && res.data.proceedings != "") {
                        $("#DivProceedings").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.proceedingsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.inovationFile != null && res.data.inovationFile != "") {
                        $("#DivInovationFile").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.inovationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                }

            }, true);
        }
    }

    function getValueChain(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/FurtherInfo/Get_ValueChain/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    $("#ValueChainId").val(res.data.valueChainId);
                    $("#RequestId").val(res.data.requestId);


                    if (res.data.vc1 != null && res.data.vc1 != "") {
                        $("#DivVc1").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc2 != null && res.data.vc2 != "") {
                        $("#DivVc2").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc3 != null && res.data.vc3 != "") {
                        $("#DivVc3").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc3Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc4 != null && res.data.vc4 != "") {
                        $("#DivVc4").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc4Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc4 != null && res.data.vc4 != "") {
                        $("#DivVc4").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc4Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc5 != null && res.data.vc5 != "") {
                        $("#DivVc5").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc5Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc6 != null && res.data.vc6 != "") {
                        $("#DivVc6").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc6Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc7 != null && res.data.vc7 != "") {
                        $("#DivVc7").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc7Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc8 != null && res.data.vc8 != "") {
                        $("#DivVc8").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc8Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc9 != null && res.data.vc9 != "") {
                        $("#DivVc9").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc9Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc10 != null && res.data.vc10 != "") {
                        $("#DivVc10").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc10Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc11 != null && res.data.vc11 != "") {
                        $("#DivVc11").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc11Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc12 != null && res.data.vc12 != "") {
                        $("#DivVc12").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc12Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc13 != null && res.data.vc13 != "") {
                        $("#DivVc13").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc13Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc14 != null && res.data.vc14 != "") {
                        $("#DivVc14").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc14Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc15 != null && res.data.vc15 != "") {
                        $("#DivVc15").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc15Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc16 != null && res.data.vc16 != "") {
                        $("#DivVc16").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc16Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc17 != null && res.data.vc17 != "") {
                        $("#DivVc17").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc17Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc18 != null && res.data.vc18 != "") {
                        $("#DivVc18").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc18Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc19 != null && res.data.vc19 != "") {
                        $("#DivVc19").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc19Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc20 != null && res.data.vc20 != "") {
                        $("#DivVc20").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc20Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc21 != null && res.data.vc21 != "") {
                        $("#DivVc21").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc21Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc22 != null && res.data.vc22 != "") {
                        $("#DivVc22").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc22Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc23 != null && res.data.vc23 != "") {
                        $("#DivVc23").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc23Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc24 != null && res.data.vc24 != "") {
                        $("#DivVc24").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc24Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc25 != null && res.data.vc25 != "") {
                        $("#DivVc25").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.vc25Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                }

            }, true);
        }
    }



    function getFurtherInfo(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/FurtherInfo/Get_FurtherInfo/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    if (res.data.lastAuditingTaxList != null && res.data.lastAuditingTaxList != "") {
                        $("#divDownloadLastAuditingTaxList").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.lastAuditingTaxListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.lastChangeOfficialNewspaper != null && res.data.lastChangeOfficialNewspaper != "") {
                        $("#divDownloadLastChangeOfficialNewspaper").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.LastChangeOfficialNewspaperFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.statuteDoc != null && res.data.statuteDoc != "") {
                        $("#divDownloadStatuteDoc").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.statuteDocFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.officialNewspaper != null && res.data.officialNewspaper != "") {
                        $("#divDownloadOfficialNewspaper").html("<a class='btn btn-info' href='/File/Download?path=" + res.data.officialNewspaperFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                }

            }, true);
        }
    }


    function getPublicActivities(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/FurtherInfo/Get_PublicActivities/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#IsPublicActivityFileStr").prop("checked", res.data.isPublicActivityFile);
                    $("#Investment").val(res.data.investment);
                    $("#EmploymentDisabled").val(res.data.employmentDisabled);
                    $("#PublicActivitiesID").val(res.data.publicActivitiesID);

                }

            }, true);
        }
    }

    function intiFormQuestion(FormID = null, Name = null, RequestId = null) {

        AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var strFormId = '';
                var Filename = 1;

                for (var i = 0; i < res.data.length; i++) {

                    if (i == 0) {
                        strFormId += "<div class='col-lg-6'>";
                    } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
                        strFormId += "</div><div class='col-lg-6'>";
                    }

                    strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><form id='frmFrom" + Name + (i) + "'> <input type='hidden' id='FormID' name='FormID' value='" + FormID + "' />";
                    strFormId += "<input type='hidden' id='DataFormQuestionID' name='DataFormQuestionID' value='" + res.data[i].dataFormQuestionId + "' />";

                    strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";


                    strFormId += "<label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
                    if (res.data[i].questionType == 'select') {
                        strFormId += "<select name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control select2' ></select>";
                    } else if (res.data[i].questionType == 'textarea') {
                        strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
                    }
                    else if (res.data[i].questionType == 'checkbox') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
                    } else if (res.data[i].questionType == 'file') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";

                    }

                    else {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
                    }
                    strFormId += "<button title='ثبت' class='btn btn-default fontForAllPage' type='button' onclick='Web.FurtherInfo.SavesingleForm(this," + '"' + Name + (i) + '"' + ")'> ثبت </button ></form>";

                    strFormId += "</div>";
                    strFormId += "</div>";
                    if (i == res.data.length && res.data.length > 1) {
                        strFormId += "</div>";
                    }


                }
                $("#FormDetail" + FormID).html(strFormId);
                systemSeting_Combo(FormID);
            }
        }, true);
    }

    function intiFormSingelAnswer(FormID = null, Id = null) {
        AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Get_DataFromAnswerss", JSON.stringify({ FormId: FormID, RequestId: Id, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                if (FormID == 14) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 87:
                                $("#IsPublicActivityFile").prop("checked", res.data[i].answer == "false" ? false : true);
                                break;
                            case 91:
                                $("#Investment").val(res.data[i].answer);
                                break;
                            case 94:
                                $("#EmploymentDisabled").val(res.data[i].answer);
                                break;
                        }
                    }

                }
                if (FormID == 11) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 79:
                                $("#DivHumanResourcesFile").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                break;

                        }
                    }

                }
                if (FormID == 7) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 47:
                                $("#DivVc1").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 48:
                                $("#DivVc2").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 49:
                                $("#DivVc3").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 50:
                                $("#DivVc4").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;

                        }
                    }

                }
                if (FormID == 18) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 51:
                                $("#DivVc5").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 52:
                                $("#DivVc6").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 53:
                                $("#DivVc7").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 54:
                                $("#DivVc8").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 55:
                                $("#DivVc9").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 56:
                                $("#DivVc10").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 57:
                                $("#DivVc11").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 58:
                                $("#DivVc12").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;

                        }
                    }

                }
                if (FormID == 19) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 59:
                                $("#DivVc13").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 60:
                                $("#DivVc14").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 61:
                                $("#DivVc15").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 62:
                                $("#DivVc16").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 63:
                                $("#DivVc17").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 64:
                                $("#DivVc18").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 65:
                                $("#DivVc19").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 66:
                                $("#DivVc20").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 67:
                                $("#DivVc21").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;

                        }
                    }

                }
                if (FormID == 20) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 68:
                                $("#DivVc22").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 69:
                                $("#DivVc23").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 70:
                                $("#DivVc24").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 71:
                                $("#DivVc25").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                        }
                    }

                }
                if (FormID == 25) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 28:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivOrganazationChart").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                break;
                            case 29:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivOrganizationalDuties").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                //  $("#DivOrganizationalDuties").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 30:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivRiskManagementGuidelines").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                // $("#DivRiskManagementGuidelines").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 31:
                                $("#DivTransactionRegulations").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 31:
                                $("#DivTransactionRegulations").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 32:
                                $("#DivDeductionTaxAccount").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 33:
                                $("#DivCrmSoftwareContract").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 35:
                                $("#DivRepresentativeFile").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 36:
                                $("#DivletterOfCommendation").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 37:
                                $("#DivInovationFile").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 40:
                                $("#DivProceedings").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            //
                        }
                    }

                }
                if (FormID == 2) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 97:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivLastAuditingTaxList").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                // $("#DivLastAuditingTaxList").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 98:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivLastChangeOfficialNewspaper").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                // $("#DivLastChangeOfficialNewspaper").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 99:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivstatuteDoc").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                // $("#DivstatuteDoc").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 100:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivOfficialNewspaper").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                // $("#DivOfficialNewspaper").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;

                        }
                    }

                }
            }

        }, true);
    }

    function intiFormAnswer(FormID = null, ColumNum = null, RequestId = null) {

        AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Get_DataFormAnswerTabless", JSON.stringify({ FormId: FormID, RequestId: RequestId, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var separatedArray = ColumNum.split(',');
                let strFormAnswer = '';
                for (let i = 0; i < res.data.length; i++) {

                    strFormAnswer += "<tr><td>" + (i + 1) + "</td><td>";

                    for (var j = 0; j < separatedArray.length; j++) {

                        switch (separatedArray[j]) {
                            case "1":
                                strFormAnswer += res.data[i].answer1 + "</td><td>";
                                break;
                            case "2":
                                strFormAnswer += res.data[i].answer2 + "</td><td>";
                                break;
                            case "3":
                                strFormAnswer += res.data[i].answer3 + "</td><td>";
                                break;
                            case "4":
                                strFormAnswer += res.data[i].answer4 + "</td><td>";
                                break;
                            case "5":
                                strFormAnswer += res.data[i].answer5 + "</td><td>";
                                break;
                            case "6":
                                strFormAnswer += res.data[i].answer6 + "</td><td>";
                                break;
                            case "7":
                                strFormAnswer += res.data[i].answer7 + "</td><td>";
                                break;
                            case "8":
                                strFormAnswer += res.data[i].answer8 + "</td><td>";
                                break;
                            case "9":
                                strFormAnswer += res.data[i].answer6 + "</td><td>";
                                break;
                            case "10":
                                strFormAnswer += res.data[i].answer6 + "</td><td>";
                                break;
                            case "11":
                                strFormAnswer += "<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>" + "</td><td>";
                                break;
                            case "12":
                                strFormAnswer += "<a href='/File/Download?path=" + res.data[i].fileName2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>" + "</td><td>";
                                break;
                        }
                    }

                    strFormAnswer += "<button title='ویرایش' class='btn btn-warring fontForAllPage' type='button' onclick='Web.FurtherInfo.GetFormAnswer(" + FormID + "," + res.data[i].answerTableId + ")' ><i class='fa fa-edit'></i></button>";
                    if ($("#sdfcddf").val() == "1") {
                        strFormAnswer += "<button style='margin-right:5px' type='button' title='حذف' class='btn btn-warrnig fontForAllPage changeData' onclick='Web.FurtherInfo.Delete_DataFormAnswerTables(" + FormID + ',"' + ColumNum + '",' + res.data[i].answerTableId + ");'><i class='fa fa-remove'></i></button>";
                    }
                    strFormAnswer += "</td></tr>";
                }
                $("#FormDetailAnswer" + FormID).html(strFormAnswer);
            }
        }, true);
    }

    function getFormAnswer(FormID = null, AnswerTableId = null) {
        var RequestId = $("#RequestIdForms").val();

        AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Get_DataFormAnswerTabless", JSON.stringify({ FormId: FormID, AnswerTableId: AnswerTableId, RequestId: RequestId, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                // $("#RequestId").val(res.data[0].requestId);
                for (var i = 0; i < res.data.length; i++) {

                    $('#frmFrom' + FormID).find('input[name=AnswerTableId]').val(res.data[0].answerTableId);
                    if (FormID == 1) {

                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);

                        $('#MemberPostID').val(res.data[0].answer2Val);
                        comboBoxWithSearchUpdateText("MemberPostID", res.data[0].answer2);

                        $('#MemberEductionID').val(res.data[0].answer3Val);
                        comboBoxWithSearchUpdateText("MemberEductionID", res.data[0].answer3);

                        $('#UniversityID').val(res.data[0].answer4Val);
                        comboBoxWithSearchUpdateText("UniversityID", res.data[0].answer4);

                        $("#IsMemeberOfBoard").prop("checked", res.data[0].answer5);
                        if (res.data[0].answer6 != null) {
                            if (res.data[0].answer6 == "on") {
                                $('#frmFrom' + FormID).find('input[name=Answer6]').prop("checked", true);
                            } else {
                                $('#frmFrom' + FormID).find('input[name=Answer6]').prop("checked", false);
                            }
                        } else {
                            $('#frmFrom' + FormID).find('input[name=Answer6]').prop("checked", false);
                        }
                        $('#frmFrom' + FormID).find('input[name=Answer6]').val(res.data[0].answer6);
                        $('#frmFrom' + FormID).find('input[name=Answer7]').val(res.data[0].answer7);
                        $('#frmFrom' + FormID).find('input[name=Answer8]').val(res.data[0].answer8);
                        $('#frmFrom' + FormID).find('input[name=Answer9]').val(res.data[0].answer9);
                        $('#frmFrom' + FormID).find('input[name=Answer10]').val(res.data[0].answer10);
                        if (res.data[0].fileName1Full != null) {
                            $("#DivAcademicDegreePicture").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform1").html("ویرایش");
                    }
                    else if (FormID == 3) {
                        //1,3,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);

                        $('#IsGuideLineOrProcess').val(res.data[0].answer3Val);
                        comboBoxWithSearchUpdateText("IsGuideLineOrProcess", res.data[0].answer3);

                        if (res.data[0].fileName1Full != null) {
                            $("#DivGuidelinesAndRegulationsFile").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform3").html("ویرایش");

                    } else if (FormID == 4) {

                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);
                        if (res.data[0].fileName1Full != null) {
                            $("#DivCertificateAndPermitAndStandardFile").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform4").html("ویرایش");
                    }
                    else if (FormID == 5) {

                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);
                        if (res.data[0].fileName1Full != null) {
                            $("#DivAwardsFile").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform5").html("ویرایش");
                    }

                    else if (FormID == 8) {
                        if (res.data[0].fileName1Full != null) {
                            $("#DivSwotFile1").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        if (res.data[0].fileName2Full != null) {
                            $("#DivSwotFile2").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform8").html("ویرایش");
                    }
                    else if (FormID == 9) {
                        //1,2,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#DegreeOfEducation2').val(res.data[0].answer2Val);
                        comboBoxWithSearchUpdateText("DegreeOfEducation2", res.data[0].answer2);
                        if (res.data[0].fileName1Full != null) {
                            $("#DivDegreeFile").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform9").html("ویرایش");
                    }
                    else if (FormID == 10) {
                        //1,2,11
                        $('#ReportTitle').val(res.data[0].answer1);

                        if (res.data[0].fileName1Full != null) {
                            $("#DivReportFile").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform10").html("ویرایش");
                    }
                    else if (FormID == 12) {
                        //1,2,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);
                        if (res.data[0].fileName1Full != null) {
                            $("#DivCertificationCourses").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform12").html("ویرایش");
                    }
                    else if (FormID == 13) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#PostInSociety').val(res.data[0].answer3Val);
                        if (res.data[0].fileName1Full != null) {
                            $("#DivCertificationSociety").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }

                        comboBoxWithSearchUpdateText("PostInSociety", res.data[0].answer3);
                        $("#btnform13").html("ویرایش");
                    }
                    else if (FormID == 15) {
                        //1,2,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        if (res.data[0].fileName1Full != null) {
                            $("#DivPublicActivityFile").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform15").html("ویرایش");
                    }
                    else if (FormID == 16) {
                        //1,2,3
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#DegreeOfEducation').val(res.data[0].answer2Val);
                        comboBoxWithSearchUpdateText("DegreeOfEducation", res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $("#btnform16").html("ویرایش");
                    }

                    else if (FormID == 17) {
                        //6,'1,2
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $("#btnform17").html("ویرایش");

                    } else if (FormID == 22) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        if (res.data[0].fileName1Full != null) {
                            $("#DivInvestmentFile").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform22").html("ویرایش");
                    }
                    else if (FormID == 24) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        if (res.data[0].fileName1Full != null) {
                            $("#DivEmploymentDisabledFile").html("<a href='/File/Download?path=" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform24").html("ویرایش");
                    }


                }

            }
        }, true);
    }


    function delete_DataFormAnswerTables(FormID = null, ColumNum = null, AnswerTableId = null) {


        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/superVisor/FurtherInfo/Delete_DataFormAnswerTables/" + (isEmpty(AnswerTableId) ? '0' : AnswerTableId), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        intiFormShow(FormID, ColumNum, $("#RequestIdForms").val());
                        $('#frmFrom' + FormID).find('input[name=AnswerTableId]').val('0');
                        alertB("", result.message, "success");
                        $("#btnform" + FormID).html('افزودن');

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }



    function saveForm(e, FormId = null, ColumnNum = null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_DataFormAnswerTabless", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFrom" + FormId), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                $('#frmFrom' + FormId).find('input[name=AnswerTableId]').val('0');
                if (FormId == 1) {
                    initFurtherInfo($("#RequestIdForms").val());
                } else {

                    intiFormShow(FormId, ColumnNum, $("#RequestIdForms").val());
                    $(e).html('افزودن');
                }
                document.getElementById("frmFrom" + FormId).reset();
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function savesingleForm(e, FormId = null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_DataFromAnswers", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFrom" + FormId), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveFurtherInfo(e) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_FurtherInfo", fill_AjaxCallActionPostSaveFormWithUploadFile("FormDe2"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveCorporateGovernance(e) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_CorporateGovernance", fill_AjaxCallActionPostSaveFormWithUploadFile("FormDe6"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveValueChain(e) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_ValueChain", fill_AjaxCallActionPostSaveFormWithUploadFile("FormDem7"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function savePublicActivities(e) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_PublicActivities", fill_AjaxCallActionPostSaveFormWithUploadFile("FormPublicActivities"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveFormDetailTab14(e) {
        try {

            saveSingelAnswerForm(e, 14, String($("#IsPublicActivityFile").prop('checked')), 87);
            saveSingelAnswerForm(e, 14, $('#EmploymentDisabled').val(), 94);
            saveSingelAnswerForm(e, 14, $('#Investment').val(), 91);
            alertB("ثبت", "اطلاعات ثبت شد", "success");
        } catch (e) {

        }

    }


    function saveForm25(e) {
        saveSingelAnswerForm(e, 6, String($("#HaveRepresentative").prop('checked')), 34);
        saveSingelAnswerForm(e, 6, $('#CompanyWebSite').val(), 94);
        saveSingelAnswerForm(e, 6, $('#HighProductKnowledge').val(), 38);
        saveSingelAnswerForm(e, 6, String($("#HaveAuditCommittee").prop('checked')), 39);
        alertB("ثبت", "اطلاعات ثبت شد", "success");

    }

    function initReferral(id = null) {

        AjaxCallAction("GET", "/api/superVisor/RequestForRating/InitReferral/" + id, null, true, function (res) {

            if (res.isSuccess) {

                $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(id.toString(), keyMaker()));
                var htmlB = "";
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[0].levelStepIndex == 7 && res.data[0].levelStepAccessRole == 5) {
                        htmlB += "<button type='button' id='btnreq' style='margin:5px' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "' data-SC='" + encrypt(res.data[i].smsContent, keyMaker()) + "' data-ST='" + res.data[i].smsType + "' data-DLSIB='" + encrypt(res.data[i].destLevelStepIndexButton, keyMaker()) + "'>" + res.data[i].destLevelStepIndexButton + "</button>";

                    }
                }
                $("#bLLSS").html(htmlB);
                $("#sdfcddf").val(1);

            } else {
               
                $("#EndfurtherInfo").html("اطلاعات شما برای پارس کیان جهت بررسی و ارزیابی ارسال شده است و قابل ویرایش نمی باشد.");

            }


        }, true);

    }

    function saveSingelAnswerForm(e, formId = null, answer = null, dataFormQuestionId = null) {

        $(e).attr("disabled", "");
        var requestId = $("#RequestId").val();
        AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Save_DataFromAnswers", JSON.stringify({
            Answer: answer,
            FormID: formId,
            RequestId: requestId,
            DataFormQuestionID: dataFormQuestionId,

        }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                //  alertB("ثبت", res.message, "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    web.FurtherInfo = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        InitFurtherInfo: initFurtherInfo,
        SystemSeting_Combo: systemSeting_Combo,
        IntiForm: intiForm,
        IntiFormAnswer: intiFormAnswer,
        IntiFormShow: intiFormShow,
        IntiTab: intiTab,
        IntiFormSingelAnswer: intiFormSingelAnswer,
        SaveForm: saveForm,
        SaveSingelAnswerForm: saveSingelAnswerForm,
        SaveFormDetailTab14: saveFormDetailTab14,
        GetFormAnswer: getFormAnswer,
        Delete_DataFormAnswerTables: delete_DataFormAnswerTables,
        SavesingleForm: savesingleForm,
        IntiFormQuestion: intiFormQuestion,
        SaveForm25: saveForm25,
        IntiFormQrid: intiFormQrid,
        SaveFurtherInfo: saveFurtherInfo,
        SaveCorporateGovernance: saveCorporateGovernance,
        GetFurtherInfo: getFurtherInfo,
        SaveValueChain: saveValueChain,
        InitReferral: initReferral,
        GetCorporateGovernance: getCorporateGovernance,
        GetValueChain: getValueChain,
        SavePublicActivities: savePublicActivities,
        GetPublicActivities: getPublicActivities
    };

})(Web, jQuery);
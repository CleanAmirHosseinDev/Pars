
(function (web, $) {

    //Document Ready              


    $("#frmFormMain input,textarea").on("focusout", function () {

        $(this).valid();

    });

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function saveCustomer(e) {
        let req_id = 0;
        $("#btnOpperationRun").attr("disabled", "");

        RemoveAllCharForPrice("AmountOsLastSales");
        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/Customers/Save_BasicInformationCustomers", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), false, function (res) {
            $("#btnOpperationRun").removeAttr("disabled");
            if (res.isSuccess) {
                req_id = res.resultId;
                /*alertB("ثبت", res.message, "success");*/
                /*$("SeeAllRequest").show();*/
                setlstor("fullName", $("#CompanyName").val());

                if ($("#TypeServiceRequestedId").val() == null) {
                    $(".fullNameInLayout").html(getlstor("fullName"));
                    $("#AmountOsLastSales").val(moneyCommaSepWithReturn($("#AmountOsLastSales").val()));
                    /*alertB("ثبت", "پروفایل شما ویرایش شد.", "success");*/
                    alertB("ثبت", "پروفایل شما ویرایش شد", "success", "بله متوجه شدم", function () {
                    });
                } else {
                    alertB("ثبت", "پروفایل شما ویرایش شد", "success", "بله متوجه شدم", function () {
                    });
                }
            }
            else {
                $("#AmountOsLastSales").val(moneyCommaSepWithReturn($("#AmountOsLastSales").val()));
                alertB("خطا", res.message, "error");
            }
        }, true);
        if (req_id != 0) {
            $("#RequestId").val(req_id);
            AjaxCallActionPostSaveFormWithUploadFile("/api/customer/RequestForRating/Save_SaveCustomerRequestInformation", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), false, function (res) {
            }, true);
        }
        goToUrl("/Customer/RequestForRating/Index");
    }

    function saveMobileUser(e) {
        let req_id = 0;
        $("#btnSaveMobileUser").attr("disabled", "");
        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/Customers/Save_BasicInformationCustomers", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), false, function (res) {
            $("#btnSaveMobileUser").removeAttr("disabled");
            if (res.isSuccess) {
                req_id = res.resultId;
                $("#RequestId").val(req_id);
                alertB("ثبت", res.message, "success");
            }
            else {
                alertB("خطا", res.message, "error");
            }
        }, true);

        if (req_id != 0) {
            AjaxCallActionPostSaveFormWithUploadFile("/api/customer/RequestForRating/Save_SaveCustomerRequestInformation", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), false, function (res) {
                goToUrl("/Customer/RequestForRating/Index");
            }, false);
        }
    }


    function systemSeting_Combo(resSingle, showdrp) {


        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "126,63,27,56,221", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';
                var strHowGetKnowCompany = '<option value="">انتخاب کنید</option>';
                var strTypeServiceRequestedId = '<option value="">انتخاب کنید</option>';
                var strCustomerPersonalityType = '<input type="hidden" name="CustomerPersonalityType" id="CustomerPersonalityType">';
                var strTypeGroupCompanies = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].parentCode == 56) {
                        strHowGetKnowCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                    else if (res.data[i].parentCode == 63) {
                        strTypeServiceRequestedId += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                    else if (res.data[i].parentCode == 27) {
                        strKindOfCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                    else if (res.data[i].parentCode == 221 && isEmpty(resSingle.customerPersonalityType)) {
                        strCustomerPersonalityType += "<input type='radio' value=" + res.data[i].systemSetingId + " name='CustomerPersonalityTypeStr' id='CustomerPersonalityTypeStr' onchange='Web.Customer.OnChangeCustomerPersonalityType(this);' style='margin-right: 30px;'>" + res.data[i].label;
                    }
                    else if (res.data[i].parentCode == 126) {
                        strTypeGroupCompanies += "<option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                }


                $("#divCustomerPersonalityTypeRadio").html(strCustomerPersonalityType);
                $("#CustomerPersonalityTypeStr[value='" + resSingle.customerPersonalityType + "']").prop("checked", true);

                $("#CustomerPersonalityType").val(resSingle.customerPersonalityType);

                if (!isEmpty(resSingle.customerPersonalityType)) $("#divCustomerPersonalityType").hide();

                temp_OnChangeCustomerPersonalityType(resSingle.customerPersonalityType);


                $("#TypeGroupCompanies").html(strTypeGroupCompanies);
                $("#TypeGroupCompanies").val(resSingle.typeGroupCompanies);

                $("#KindOfCompanyId").html(strKindOfCompany);
                $("#HowGetKnowCompanyId").html(strHowGetKnowCompany);

                $("#HowGetKnowCompanyId").val(resSingle.howGetKnowCompanyId);
                $("#KindOfCompanyId").val(resSingle.kindOfCompanyId);

                if (showdrp) {
                    $("#TypeServiceRequestedId").html(strTypeServiceRequestedId);
                    $("#TypeServiceRequestedId").val('66');
                }

                validate();

                $("#CountOfPersonal").keyup();
                $("#AmountOsLastSales").keyup();
            }
        }, true);
    }

    function validate() {

        $.validator.addMethod(
            "CeoMobileValidation",
            function (value, element) {
                return CheckMobile(value);
            },
            "موبایل مدیر عامل خود را به درستی وارد نمایید"
        );
        $.validator.addMethod(
            "AgentMobileValidation",
            function (value, element) {
                return CheckMobile(value);
            },
            function () {
                return $("#Span_Label_AgentMobile").text() + " " + ($("#CustomerPersonalityType").val() != "223" ? "شرکت/مشاور " : " ") + " خود را به درستی وارد نمایید";
            }
        );
        $.validator.addMethod(
            "TelValidation",
            function (value, element) {
                return CheckTel(value);
            },
            function () {
                return "شماره تلفن ثابت خود را به درستی وارد نمایید";
            }
        );

        $.validator.addMethod(
            "AmountOsLastSalesValidation",
            function (value, element) {
                return value.indexOf("/") !== -1 ? false: true;
            },
            function () {
                return "مبلغ وارد شده نامعتبر می باشد لطفا مبلغ را دستی وارد کنید";
            }
        );

        $("form[id='frmFormMain']").validate({
            // Specify validation rules
            rules: {
                "CompanyName": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },
                "CeoMobile": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 11,
                    maxlength: 11,
                    CeoMobileValidation: $("#CeoMobile").val(),
                },
                "CeoName": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 5,
                    maxlength: 50
                },
                "CeoNationalCode": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 10,
                    maxlength: 10
                },
                "EconomicCode": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 3,
                    maxlength: 50
                },
                "NationalCode": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 10,
                    maxlength: 11
                },
                "NationalCodeRepresentative": {
                    minlength: 10,
                    maxlength: 10
                },
                "AgentName": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },
                "EmailRepresentative": {
                    minlength: 5,
                    maxlength: 50,
                    email: true
                },
                "AgentMobile": {
                    required: function () {
                        return true;
                    },
                    minlength: 11,
                    maxlength: 11,
                    AgentMobileValidation: $("#AgentMobile").val(),
                },
                "AddressCompany": {
                    required: function () {
                        return true;
                    },
                },
                "CountOfPersonal": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    maxlength: 9
                },
                "HowGetKnowCompanyId": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                },
                "KindOfCompanyId": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                },
                "TypeGroupCompanies": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                },
                "Email": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50,
                    email: true
                },
                "Tel": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 11,
                    maxlength: 11,
                    TelValidation: $("#Tel").val(),
                },
                "PostalCode": {
                    required: function () {
                        return true;
                    },
                    minlength: 10,
                    maxlength: 10
                },
                "EconomicCodeReal": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    minlength: 10,
                    maxlength: 12
                },
                "AmountOsLastSales": {
                    required: function () {
                        return $("#CustomerPersonalityType").val() != "223";
                    },
                    maxlength: 18,
                    AmountOsLastSalesValidation: $("#AmountOsLastSales").val(),
                },
            },
            // Specify validation error messages
            messages: {
                "CompanyName": {
                    required: function () {
                        return "لطفا " + $("#LabelCompanyName").text() + " را وارد کنید";
                    },
                    minlength: $("#LabelCompanyName").text() + " باید حداقل 5 حرف باشد",
                    maxlength: $("#LabelCompanyName").text() + " باید حداکثر 50 حرف باشد"
                },
                "CeoMobile": {
                    required: function () {
                        return "لطفا موبایل مدیر عامل را وارد کنید";
                    },
                    minlength: "موبایل مدیر عامل باید حداقل 11 حرف باشد",
                    maxlength: "موبایل مدیر عامل باید حداکثر 11 حرف باشد",
                },
                "CeoName": {
                    required: function () {
                        return "لطفا نام مدیر عامل را وارد کنید";
                    },
                    minlength: "نام مدیر عامل باید حداقل 5 حرف باشد",
                    maxlength: "نام مدیر عامل باید حداکثر 50 حرف باشد"
                },
                "CeoNationalCode": {
                    required: function () {
                        return "لطفا کد ملی مدیر عامل را وارد کنید";
                    },
                    minlength: "کد ملی مدیر عامل باید حداقل 10 حرف باشد",
                    maxlength: "کد ملی مدیر عامل باید حداکثر 10 حرف باشد"
                },
                "EconomicCode": {
                    required: function () {
                        return "لطفا " + $("#LabelEconomicCode").text() + " را وارد کنید";
                    },
                    minlength: $("#LabelEconomicCode").text() + " باید حداقل 3 حرف باشد",
                    maxlength: $("#LabelEconomicCode").text() + " باید حداکثر 50 حرف باشد"
                },
                "NationalCode": {
                    required: function () {
                        return "لطفا شناسه ملی  شرکت را وارد کنید";
                    },
                    minlength: "شناسه ملی  شرکت باید حداقل 10 حرف باشد",
                    maxlength: "شناسه ملی  شرکت باید حداکثر 11 حرف باشد"
                },
                "NationalCodeRepresentative": {
                    minlength: "کد ملی نماینده شرکت/ مشاور باید حداقل 10 حرف باشد",
                    maxlength: "کد ملی نماینده شرکت/ مشاور باید حداکثر 10 حرف باشد"
                },
                "AgentName": {
                    required: function () {
                        return "لطفا نام نماینده شرکت/ مشاور شرکت را وارد کنید";
                    },
                    minlength: "نام نماینده شرکت/ مشاور شرکت باید حداقل 5 حرف باشد",
                    maxlength: "نام نماینده شرکت/ مشاور شرکت باید حداکثر 50 حرف باشد"
                },
                "EmailRepresentative": {
                    minlength: "ایمیل نماینده شرکت/ مشاور باید حداقل 5 حرف باشد",
                    maxlength: "ایمیل نماینده شرکت/ مشاور باید حداکثر 50 حرف باشد",
                    email: "لطفا ایمیل نماینده شرکت/ مشاور معتبر وارد کنید"
                },
                "AgentMobile": {
                    required: function () {
                        return "لطفا " + $("#Span_Label_AgentMobile").text() + ($("#CustomerPersonalityType").val() != "223" ? "شرکت/مشاور " : " ") + " را وارد کنید";
                    },
                    minlength: function () {
                        return $("#Span_Label_AgentMobile").text() + " " + ($("#CustomerPersonalityType").val() != "223" ? "شرکت/مشاور " : "") + " باید حداقل 11 حرف باشد";
                    },
                    maxlength: function () {
                        return $("#Span_Label_AgentMobile").text() + " " + ($("#CustomerPersonalityType").val() != "223" ? "شرکت/مشاور " : "") + " باید حداکثر 11 حرف باشد";
                    }
                },
                "AddressCompany": {
                    required: function () {
                        return "لطفا آدرس را وارد کنید";
                    },
                },
                "CountOfPersonal": {
                    required: function () {
                        return "لطفا تعداد کارکنان " + ($("#CustomerPersonalityType").val() != "223" ? "شرکت " : " ") + " را وارد کنید";
                    },
                    maxlength: function () {
                        return "تعداد کارکنان " + ($("#CustomerPersonalityType").val() != "223" ? "شرکت " : "") + " باید حداکثر 9 حرف باشد";
                    }
                },
                "HowGetKnowCompanyId": {
                    required: function () {
                        return "لطفا نحوه آشنایی با شرکت را انتخاب کنید";
                    },
                },
                "KindOfCompanyId": {
                    required: function () {
                        return "لطفا نوع  فعالیت شرکت را انتخاب کنید";
                    },
                },
                "TypeGroupCompanies": {
                    required: function () {
                        return "لطفا " + $("#LabelTypeGroupCompanies").text() + " را انتخاب کنید";
                    },
                },
                "Email": {
                    required: function () {
                        return "لطفا ایمیل شرکت را وارد کنید";
                    },
                    minlength: "ایمیل شرکت باید حداقل 5 حرف باشد",
                    maxlength: "ایمیل شرکت باید حداکثر 50 حرف باشد",
                    email: "لطفا ایمیل شرکت معتبر وارد کنید"
                },
                "Tel": {
                    required: function () {
                        return "لطفا شماره تلفن ثابت را وارد کنید";
                    },
                    minlength: "شماره تلفن ثابت باید حداقل 11 حرف باشد",
                    maxlength: "شماره تلفن ثابت باید حداکثر 11 حرف باشد"
                },
                "PostalCode": {
                    required: function () {
                        return "لطفا کد پستی را وارد کنید";
                    },
                    minlength: "کد پستی باید حداقل 10 حرف باشد",
                    maxlength: "کد پستی باید حداکثر 10 حرف باشد"
                },
                "EconomicCodeReal": {
                    required: function () {
                        return "لطفا کد اقتصادی را وارد کنید";
                    },
                    minlength: "کد اقتصادی باید حداقل 10 حرف باشد",
                    maxlength: "کد اقتصادی باید حداکثر 12 حرف باشد"
                },
                "AmountOsLastSales": {
                    required: function () {
                        return "لطفا درآمد عملیاتی بر اساس صورت های مالی حسابرسی شده را وارد کنید";
                    },
                    maxlength: "درآمد عملیاتی بر اساس صورت های مالی حسابرسی شده باید حداکثر 18 رقم باشد"                    
                },
            },
            // Make sure the form is submitted to the destination defined
            // in the "action" attribute of the form when valid
            submitHandler: function (form) {

                if ($("#divTypeServiceRequestedId:hidden").length === 0) {

                    confirmB("", "مشتری محترم در نظر داشته باشید چون معیار و مبنای شروع ارزیابی بر اساس اطلاعات پایه شما می باشد لذا در صورت اطمینان از صحت ورود اطلاعات تایید کنید پس از تایید امکان ویرایش وجود ندارد", "warning", function () {

                        Web.Customer.SaveCustomer(this);

                    }, function () {

                    }, ["انصراف از ثبت", "بله مطمئنم"]);

                }
                else {

                    Web.Customer.SaveCustomer(this);

                }




            }
        });

    }

    function checkForFirstRequest(resSingle) {
        Web.RequestForRating.RegistingFirstRequest(function (res) {

            if (res.isSuccess) {
                if (res.data.length > 0) {
                    $("#divTypeServiceRequestedId").hide();
                    systemSeting_Combo(resSingle, false);
                    $('#hide_information').hide();
                }

                else {
                    $("#divTypeServiceRequestedId").show();
                    systemSeting_Combo(resSingle, true);
                }
            }

        });
    }

    function initCustomer(dir = 'rtl') {
        ComboBoxWithSearch('.select2', dir);

        AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {
            if (res != null) {
                $("#AddressCompany").val(res.addressCompany);
                $("#CompanyName").val(res.companyName);
                $("#CeoName").val(res.ceoName);
                $("#EconomicCode").val(res.economicCode);
                $("#EconomicCodeReal").val(res.economicCodeReal);
                $("#NationalCode").val(res.nationalCode);
                $("#CeoNationalCode").val(res.ceoNationalCode);
                $("#CeoMobile").val(res.ceoMobile);
                $("#AgentMobile").val(res.agentMobile);
                $("#AgentName").val(res.agentName);
                $("#NamesAuthorizedSignatories").val(res.namesAuthorizedSignatories);
                Tagsinput("NamesAuthorizedSignatories");

                $("#CountOfPersonal").val(res.countOfPersonal);

                $("#Email").val(res.email);
                $("#Tel").val(res.tel);
                $("#PostalCode").val(res.postalCode);
                $("#AmountOsLastSales").val(moneyCommaSepWithReturn(!isEmpty(res.amountOsLastSales) ? res.amountOsLastSales.toString() : ''));

                $("#EmailRepresentative").val(res.emailRepresentative);
                $("#NationalCodeRepresentative").val(res.nationalCodeRepresentative);

                $("input[name='AuditedFinancialStatements']").val(res.auditedFinancialStatements);
                $("input[name='LastInsuranceList']").val(res.lastInsuranceList);

                $("input[name='ScanCustomerNationalCard']").val(res.scanCustomerNationalCard);
                $("input[name='ScanManagerNationalCard']").val(res.scanManagerNationalCard);
                if (res.scanCustomerNationalCard != null && res.scanCustomerNationalCard != "") {
                    $("#divDownload_ScanCustomerNationalCard").html("<a class='btn btn-success' href='" + res.scanCustomerNationalCardFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                }
                if (res.scanManagerNationalCard != null && res.scanManagerNationalCard != "") {
                    $("#divDownload_ScanManagerNationalCard").html("<a class='btn btn-success' href='" + res.scanManagerNationalCardFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                }

                if (res.lastInsuranceList != null && res.lastInsuranceList != "") {
                    $("#divDownload").html("<a class='btn btn-success' href='" + res.lastInsuranceListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                }
                if (res.auditedFinancialStatements != null && res.auditedFinancialStatements != "") {
                    $("#divDownload_AuditedFinancialStatements").html("<a class='btn btn-success' href='" + res.auditedFinancialStatementsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                }
                checkForFirstRequest(res);
                // systemSeting_Combo(res);
            }
            else {
                Tagsinput("NamesAuthorizedSignatories");
            }

        }, true);
    }

    function onChangeCustomerPersonalityType(e) {

        temp_OnChangeCustomerPersonalityType($(e).val());

    }

    function temp_OnChangeCustomerPersonalityType(val) {

        $("label[class='error']").text('');

        if (val == "223") {

            $(".form-group").hide();
            $(".form-group.FormIsShow").show();
            $(".NotShowRequiredLabel").hide();
            $("#LabelTypeGroupCompanies").html("نوع فعالیت");
            $("#LabelEconomicCode").html("شماره کارت بازرگانی");
            $("#LabelCompanyName").html("نام و نام خانوادگی");
            $("#Span_Label_AgentMobile").html("شماره موبایل / شماره موبایل نماینده ");
            $("#LabelAgentName").html("نام نماینده ");

            $("#spanScanCustomerNationalCardReq").show();
            $("#spanScanManagerNationalCardReq").hide();
        }
        else {

            $(".form-group").show();
            $(".NotShowRequiredLabel").show();
            $("#LabelTypeGroupCompanies").html("نوع فعالیت شرکتها");
            $("#LabelEconomicCode").html("شماره ثبت");
            $("#LabelCompanyName").html("نام شرکت");
            $("#Span_Label_AgentMobile").html("شماره نماینده");

            $("#spanScanCustomerNationalCardReq").hide();
            $("#spanScanManagerNationalCardReq").hide();
        }

        $("#CustomerPersonalityType").val(val);

    }

    function onKeyPressInCountOfPersonal(event) {

        if ($(event).val() == "0") {
            $("#spanListLastBimeReq").hide();
        }
        else {
            $("#spanListLastBimeReq").show();
        }

    }

    function onkeuUpInAmountOsLastSales(e) {

        if ($(e).val() == "0") {

            $("#Span_Label_Result_Final_AuditedFinancialStatements").hide();

        }
        else {
            $("#Span_Label_Result_Final_AuditedFinancialStatements").show();
        }

        TextBoxOnlyPrice(e);

    }

    web.Customer = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        SaveCustomer: saveCustomer,
        InitCustomer: initCustomer,
        SystemSeting_Combo: systemSeting_Combo,
        CheckForFirstRequest: checkForFirstRequest,
        OnChangeCustomerPersonalityType: onChangeCustomerPersonalityType,
        OnKeyPressInCountOfPersonal: onKeyPressInCountOfPersonal,
        OnkeuUpInAmountOsLastSales: onkeuUpInAmountOsLastSales,
        SaveMobileUser: saveMobileUser
    };

})(Web, jQuery);






(function (web, $) {

    //Document Ready              

    function signOutForExitToLogin() {

        AjaxCallActionWithotHeading("POST", "/api/Securitys/SignOutForExitToLogin", JSON.stringify({ Userid: getlstor("customerID"), AreaName: "مشتری" }), true, function (res) {
            debugger;
            if (res.isSuccess) {

                localStorage.removeItem("token");

                dellstor("fullName");
                dellstor("customerID");
                dellstor("userID");
                dellstor("loginName");


                goToUrl("/Account/Login");

            }

        }, false);

    }

    function initLayout() {

        if (isEmpty(localStorage.getItem("token"))) goToUrl("/Account/Login");
        else {

            $(".fullNameInLayout").html(getlstor("fullName"));

        }

    }

    web.Layout = {

        SignOutForExitToLogin: signOutForExitToLogin,
        InitLayout: initLayout

    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {

                var strM = '';

                for (var i = 0; i < res.data.length; i++) {
                    var st = "", st2 = "";
                    if (res.data[i].kindOfRequest == 254) {
                        if (res.data[i].destLevelStepAccessRole == "10" && res.data[i].destLevelStepIndex == "7") {

                            st2 = "<span style='font-size:1.5em'> &#128194;</span> ";
                        }
                        strM += "<tr><td>" + (i + 1) + "</td><td>"
                            + res.data[i].kindOfRequestName + "</td><td>"
                            + res.data[i].dateOfRequestStr + "</td>";
                        if (res.data[i].sendUser != null) {
                            strM += "<td style='font-size:x-small'>" + (res.data[i].comment == null ? "" : res.data[i].comment) + "</td>";
                        } else {
                            strM += "<td></td>";
                        }

                        if (res.data[i].levelStepSettingIndexID == "29") {
                            strM += "<td>" + "<span style='color:red'>&#10060;" + "عدم تایید قرارداد" + "</span>" + "</td><td>";
                        } else if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                            strM += "<td>" + "<span style='color:red'> &#10060; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
                        }
                        else {
                            strM += "<td>" + st2
                                + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                                + res.data[i].levelStepStatus + "</td><td>";
                        }
                        strM += "<a style='margin-right:5px;color:black' href='/Customer/RequestForRating/RequestReferences?id=" + res.data[i].requestId + "'" + " class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title='مشاهده گردش کار'> </a>";
                        if (getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                            if (res.data[i].levelStepSettingIndexID == 34) {
                                strM += "<a style='margin-right:5px;' title='تایید قرارداد و بارگذاری قرارداد ' class='btn btn-success fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward'></i> تایید قرارداد و بارگذاری قرارداد </a>";

                            }

                            if (res.data[i].destLevelStepIndex == 11 && getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                                strM += "<a style='margin-right:5px;color:black' title='بارگذاری سند تسویه نهایی ' class='btn btn-info fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward' style='color:black'></i> بارگذاری سند تسویه نهایی </a>";

                            }
                        }
                        if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                            strM += "<a style='margin-right:5px;color:black' title='اصلاح/ تکمیل اطلاعات'  class='btn btn-edit fontForAllPage' href='/Customer/Customer/EditCustomer/" + res.data[i].requestId + "'><i class='fa fa-edit'></i> اصلاح/ تکمیل اطلاعات اولیه</a>";
                            strM += "<button style='margin-right:5px;color:black' class='btn btn-info fontForAllPage' type='button'  onclick='Web.RequestForRating.SaveReferralRequestForRatingAgain(this," + res.data[i].requestId + "," + res.data[i].kindOfRequest + ");'>ارسال مجدد </button >";

                        }
                        if ( (res.data[i].levelStepSettingIndexID == 41)) {
                            //   strM += "<button type='button' style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-success fontForAllPage'  onclick='Web.RequestForRating.ShowFurtherInfo(this," + res.data[i].requestId + ");'><i class='fa fa-edit'></i> اطلاعات تکمیلی</button>";
                            strM += "<a style='margin-right:5px;color:black' title='پرسشنامه' class='btn btn-success fontForAllPage' href='/Customer/Corporate/index/" + res.data[i].requestId + "'><i class='fa fa-edit'></i>پرسشنامه</a>";

                        }
                        if ((res.data[i].levelStepSettingIndexID >= 43)) {
                            //   strM += "<button type='button' style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-success fontForAllPage'  onclick='Web.RequestForRating.ShowFurtherInfo(this," + res.data[i].requestId + ");'><i class='fa fa-edit'></i> اطلاعات تکمیلی</button>";
                            strM += "<a style='margin-right:5px;color:black' title='پرسشنامه' class='btn btn-default fontForAllPage' href='/Customer/Corporate/index/" + res.data[i].requestId + "'><i class='fa fa-eye'></i>پرسشنامه</a>";

                        }

                        else if ((res.data[i].levelStepSettingIndexID == 42)) {
                            strM += "<a style='margin-right:5px;color:black' title='بررسی پرسشنامه' class='btn btn-warning fontForAllPage' href='/Customer/Corporate/ReturnBackQuestion/" + res.data[i].requestId + "'><i class='fa fa-eye'></i> پرسشنامه </a>";

                        }

                        else if (res.data[i].destLevelStepIndex == 110) {
                            strM += "<a style='margin-right:5px;color:black' title='نمایش امتیازها' class='btn btn-success fontForAllPage' href='/Customer/Corporate/ShowScore/" + res.data[i].requestId + "'><i class='fa fa-star'></i> </a>";
                        }
                        if (res.data[i].contractDocument != null && res.data[i].contractDocument != "") {
                            strM += "<a style='margin-right:5px;color:black' title='اسناد مشتری' class='btn btn-default fontForAllPage' href='/Customer/RequestForRating/RequestDocument/" + res.data[i].requestId + "'><i class='fa fa-file-pdf-o'></i> </a>";
                        }
                       
                        if (res.data[i].customerRequestInformationId != null && res.data[i].contractDocument == "" ) {
                            strM += "<a style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-default fontForAllPage' href='/Customer/RequestForRating/EditCustomerRequestInformation/" + res.data[i].customerRequestInformationId + "'><i class='fa fa-file-pdf-o'></i> </a>";
                        }
                        strM += "</td></tr>";
                    }
                    else if (res.data[i].kindOfRequest == 66) {
                        if (res.data[i].destLevelStepAccessRole == "10" && res.data[i].destLevelStepIndex == "7") {

                            st2 = "<span style='font-size:1.5em'> &#128194;</span> ";
                        }
                        strM += "<tr><td>" + (i + 1) + "</td><td>"
                            + res.data[i].kindOfRequestName + "</td><td>"
                            + res.data[i].dateOfRequestStr + "</td>";
                        if (res.data[i].sendUser != null) {
                            strM += "<td style='font-size:x-small'>" + (res.data[i].comment == null ? "" : res.data[i].comment) + "</td>";
                        } else {
                            strM += "<td></td>";
                        }

                        if (res.data[i].levelStepSettingIndexID == "29") {
                            strM += "<td>" + "<span style='color:red'>&#10060;" + "عدم تایید قرارداد" + "</span>" + "</td><td>";
                        } else if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                            strM += "<td>" + "<span style='color:red'> &#10060; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
                        }
                        else {
                            strM += "<td>" + st2
                                + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                                + res.data[i].levelStepStatus + "</td><td>";
                        }
                        strM += "<a style='margin-right:5px;color:black' href='/Customer/RequestForRating/RequestReferences?id=" + res.data[i].requestId + "'" + " class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title='مشاهده گردش کار'> </a>";
                        if (getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                            if (res.data[i].destLevelStepIndex == 4) {
                                strM += "<a style='margin-right:5px;' title='تایید قرارداد و بارگذاری قرارداد ' class='btn btn-success fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward'></i> تایید قرارداد و بارگذاری قرارداد </a>";

                            }

                            if (res.data[i].destLevelStepIndex == 11 && getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                                strM += "<a style='margin-right:5px;color:black' title='بارگذاری سند تسویه نهایی ' class='btn btn-info fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward' style='color:black'></i> بارگذاری سند تسویه نهایی </a>";

                            }
                        }
                        if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                            strM += "<a style='margin-right:5px;color:black' title='اصلاح/ تکمیل اطلاعات'  class='btn btn-edit fontForAllPage' href='/Customer/Customer/EditCustomer/" + res.data[i].requestId + "'><i class='fa fa-edit'></i> اصلاح/ تکمیل اطلاعات اولیه</a>";
                            strM += "<button style='margin-right:5px;color:black' class='btn btn-info fontForAllPage' type='button'  onclick='Web.RequestForRating.SaveReferralRequestForRatingAgain(this," + res.data[i].requestId + "," + res.data[i].kindOfRequest + ");'>ارسال مجدد </button >";

                        }
                        if (res.data[i].destLevelStepIndex == 7) {
                            //   strM += "<button type='button' style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-success fontForAllPage'  onclick='Web.RequestForRating.ShowFurtherInfo(this," + res.data[i].requestId + ");'><i class='fa fa-edit'></i> اطلاعات تکمیلی</button>";
                            strM += "<a style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-success fontForAllPage' href='/Customer/FurtherInfo/index/" + res.data[i].requestId + "'><i class='fa fa-edit'></i> اطلاعات تکمیلی</a>";

                        } else if (res.data[i].destLevelStepIndex >= 7 || res.data[i].destLevelStepIndexButton === "ارجاع به کارشناس ارزیاب جهت مشاهده اطلاعات تکمیلی") {
                            strM += "<a style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-default fontForAllPage' href='/Customer/FurtherInfo/index/" + res.data[i].requestId + "'><i class='fa fa-eye'></i> اطلاعات تکمیلی</a>";

                        }
                        if (res.data[i].contractDocument != null && res.data[i].contractDocument != "") {
                            strM += "<a style='margin-right:5px;color:black' title='اسناد مشتری' class='btn btn-default fontForAllPage' href='/Customer/RequestForRating/RequestDocument/" + res.data[i].requestId + "'><i class='fa fa-edit'></i> </a>";
                        }
                        if (res.data[i].customerRequestInformationId != null && res.data[i].contractDocument == "") {
                            strM += "<a style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-default fontForAllPage' href='/Customer/RequestForRating/EditCustomerRequestInformation/" + res.data[i].customerRequestInformationId + "'><i class='fa fa-edit'></i> </a>";
                        }

                        strM += "</td></tr>";
                    }

                    
                    //if (res.data[i].destLevelStepAccessRole == "10" && res.data[i].destLevelStepIndex == "7") {

                    //    st2 = "<span style='font-size:1.5em'> &#128194;</span> ";
                    //}
                    //strM += "<tr><td>" + (i + 1) + "</td><td>"
                    //    + res.data[i].kindOfRequestName + "</td><td>"
                    //    + res.data[i].dateOfRequestStr + "</td>";
                    //if (res.data[i].sendUser!=null  ) {
                    //    strM += "<td style='font-size:x-small'>" + (res.data[i].comment == null ? "" : res.data[i].comment) + "</td>";
                    //} else {
                    //    strM += "<td></td>";
                    //}
                    
                    //if (res.data[i].levelStepSettingIndexID == "29") {
                    //    strM += "<td>" + "<span style='color:red'>&#10060;" + "عدم تایید قرارداد" + "</span>" + "</td><td>";
                    //} else if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                    //    strM += "<td>" + "<span style='color:red'> &#10060; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
                    //}
                    //else {
                    //    strM += "<td>" + st2
                    //        + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                    //        + res.data[i].levelStepStatus + "</td><td>";
                    //}
                    //strM += "<a style='margin-right:5px;color:black' href='/Customer/RequestForRating/RequestReferences?id=" + res.data[i].requestId + "'" + " class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title='مشاهده گردش کار'> </a>";
                    //if (getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                    //    if (res.data[i].destLevelStepIndex == 4) {
                    //        strM += "<a style='margin-right:5px;' title='تایید قرارداد و بارگذاری قرارداد ' class='btn btn-success fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward'></i> تایید قرارداد و بارگذاری قرارداد </a>";

                    //    }

                    //    if (res.data[i].destLevelStepIndex == 11 && getlstor("loginName") === res.data[i].destLevelStepAccessRole) {
                    //        strM += "<a style='margin-right:5px;color:black' title='بارگذاری سند تسویه نهایی ' class='btn btn-info fontForAllPage' href='/Customer/RequestForRating/Referral/" + res.data[i].requestId + "'> <i class='fa fa-mail-forward' style='color:black'></i> بارگذاری سند تسویه نهایی </a>";

                    //    }
                    //}
                    //if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                    //    strM += "<a style='margin-right:5px;color:black' title='اصلاح/ تکمیل اطلاعات'  class='btn btn-edit fontForAllPage' href='/Customer/Customer/EditCustomer/" + res.data[i].requestId + "'><i class='fa fa-edit'></i> اصلاح/ تکمیل اطلاعات اولیه</a>";
                    //    strM += "<button style='margin-right:5px;color:black' class='btn btn-info fontForAllPage' type='button'  onclick='Web.RequestForRating.SaveReferralRequestForRatingAgain(this," + res.data[i].requestId + ");'>ارسال مجدد </button >";

                    //}
                    //if (res.data[i].destLevelStepIndex == 7) {
                    // //   strM += "<button type='button' style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-success fontForAllPage'  onclick='Web.RequestForRating.ShowFurtherInfo(this," + res.data[i].requestId + ");'><i class='fa fa-edit'></i> اطلاعات تکمیلی</button>";
                    //    strM += "<a style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-success fontForAllPage' href='/Customer/FurtherInfo/index/" + res.data[i].requestId + "'><i class='fa fa-edit'></i> اطلاعات تکمیلی</a>";

                    //} else if (res.data[i].destLevelStepIndex >= 7 || res.data[i].destLevelStepIndexButton === "ارجاع به کارشناس ارزیاب جهت مشاهده اطلاعات تکمیلی") {
                    //    strM += "<a style='margin-right:5px;color:black' title='اطلاعات تکمیلی' class='btn btn-default fontForAllPage' href='/Customer/FurtherInfo/index/" + res.data[i].requestId + "'><i class='fa fa-eye'></i> اطلاعات تکمیلی</a>";

                    //}
                    //if (res.data[i].contractDocument != null && res.data[i].contractDocument!="") {
                    //    strM += "<a style='margin-right:5px;color:black' title='اسناد مشتری' class='btn btn-default fontForAllPage' href='/Customer/RequestForRating/RequestDocument/" + res.data[i].requestId + "'><i class='fa fa-file-pdf-o'></i> </a>";
                    //}
                  
                    //strM += "</td></tr>";
                }

                $("#tBodyList").html(strM);
            }

        }, true);

    }

    function checkIsfinish(id = null) {
        var isFinish = false;
        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1, RequestId: id }), true, function (res) {

            if (res.isSuccess) {
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].isFinished) {
                        isFinish = true;
                    }
                }
            }

        }, false);
        return isFinish;

    }

    function registingFirstRequest(successCallback = null) {
        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1 }), true, function (res) {

            if (successCallback == null) {

                if (res.isSuccess) {

                    if (res.data.length == 0) {
                        goToUrl("/Customer/Customer/EditCustomer");

                    }
                }

            }
            else {

                successCallback(res);

            }
        }, false);

    }

    function dashboardInformation() {
        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1 }), true, function (res) {

            if (res.isSuccess) {

                if (res.data.length == 0) {
                    goToUrl("/Customer/Customer/EditCustomer");

                } else
                {
                    var IsFinishCount = 0;
                    for (var i = 0; i < res.data.length; i++) {
                        if (res.data[i].isFinished == true) {
                            IsFinishCount++;
                        }
                    }
                    $("#RequestCount").text("(" + res.data.length + ")");
                    $("#RequestIsFinishedCount").text("("+IsFinishCount+")");
                }
            }
        }, true);

    }

    function get_Detail(id = null) {
        try {

            AjaxCallAction("GET", "/api/customer/RequestForRating/InitReferral/" + id, null, true, function (res) {

                getU("/css/GlobalAreas/Views/Customer/RequestForRating/P_Referral.html", function (resG) {

                    InitModal_Withot_Par("مشاهده جزییات", resG, "", true, "width:100%;");

                    $("#sdklsslks3498sjdkxhjsd_823sb").val(encrypt(id.toString(), keyMaker()));


                    if (res.isSuccess) {

                        var htmlB = "<div class='form-group'><label for='ReferralExplanation'>توضیح ارجاع</label><textarea class='form-control' id='ReferralExplanation' rows='5'></textarea></div>";
                        for (var i = 0; i < res.data.length; i++) {

                            htmlB += "<button type='button' id='btnReference' class='btn btn-warning ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "'>" + res.data[i].destLevelStepIndexButton + "</button>";

                        }

                        $("#bLLSS").html(htmlB);

                    }
                    else {

                        $("#bLLSS").html("");

                    }

                });

            }, true);

        } catch (e) {

        }


    }


    function editCustomerRequestInformation(e) {
        $(e).attr("disabled", "");
        let req_id = $("#RequestId").val();
        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/RequestForRating/Save_SaveCustomerRequestInformation", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), false, function (res) {
            goToUrl("/Customer/RequestForRating/Index");
        }, false);
        $(e).removeAttr("disabled");
        goToUrl("/Customer/RequestForRating/Index");
    }

    function saveRequestForRating(e) {

        $(e).attr("disabled", "");
        let req_id = 0;
        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_Request", JSON.stringify({ Request: { KindOfRequest: isEmpty($("#TypeServiceRequestedId").val()) ? null : $("#TypeServiceRequestedId").val() } }), false, function (res) {
            $(e).removeAttr("disabled");
            req_id = res.resultId;
            if (!res.isSuccess) {
                alertB("هشدار", res.message, "warning");
            }
        }, true);
        $("#RequestId").val(req_id);
        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/RequestForRating/Save_SaveCustomerRequestInformation", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), false, function (res) {
            goToUrl("/Customer/RequestForRating/Index");
        }, false);
        $(e).removeAttr("disabled");
        goToUrl("/Customer/RequestForRating/Index");
    }

    function saveContractAndFinancialDocument(e) {
        if ($("#EvaluationFile").val() != null && $("#EvaluationFile").val() != "") {

            if (document.getElementById("LastFinancialDocument").files.length == 0) {
                alertB("هشدار", "فایل  سند تسویه را انتخاب نکرده اید!.", "warning");
            }
            else {
                $(e).attr("disabled", "");
                $("#EditStatuse").val("12");
                AjaxCallActionPostSaveFormWithUploadFile("/api/customer/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), true, function (res) {
                   
                    $(e).removeAttr("disabled");

                    if (res.isSuccess) {
                        $("#btnreq").click();
                        // alertB("ثبت", "مدارک با موفقیت ثبت شد.", "success");
                        /*$("SeeAllRequest").show();*/
                        //  goToUrl("/Customer/RequestForRating/Index");

                    } else {

                        $("#AmountOsLastSales").val(moneyCommaSepWithReturn($("#AmountOsLastSales").val()));

                        alertB("خطا", res.message, "error");
                    }

                }, true);

            }
        }
        else if (document.getElementById("ContractDocument").files.length == 0 || document.getElementById("FinancialDocument").files.length == 0) {
            alertB("هشدار", "فایل قرارداد یا سند پرداخت را انتخاب نکرده اید!.", "warning");
        }
        else {
            $(e).attr("disabled", "");
            $("#EditStatuse").val("5");
            AjaxCallActionPostSaveFormWithUploadFile("/api/customer/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), true, function (res) {

                $(e).removeAttr("disabled");

                if (res.isSuccess) {
                    $("#btnreq").click();
                    // alertB("ثبت", "مدارک با موفقیت ثبت شد.", "success");
                    /*$("SeeAllRequest").show();*/
                    //  goToUrl("/Customer/RequestForRating/Index");

                } else {

                    $("#AmountOsLastSales").val(moneyCommaSepWithReturn($("#AmountOsLastSales").val()));

                    alertB("خطا", res.message, "error");
                }

            }, true);

        }

    }

    function systemSeting_ComboRequestForRating() {

        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strTypeServiceRequestedId = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strTypeServiceRequestedId += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                }
                $("#TypeServiceRequestedId").html(strTypeServiceRequestedId);
                // $("#TypeServiceRequestedId").val(resSingle.typeServiceRequestedId);
            }
        }, true);
    }

    function initRequestForRating() {


        ComboBoxWithSearch('.select2', 'dir');
        systemSeting_ComboRequestForRating();

    }

    function initRequestReferences(id = null) {

        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1, RequestId: id }), true, function (res) {

            if (res.isSuccess) {
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].isFinished) {
                        createTimeLine(id, true);
                    } else {
                        createTimeLine(id, false);
                    }
                }
            }

        }, true);


    }

    function createTimeLine(id = null, isFinish) {

        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestReferencessService", JSON.stringify({ RequestId: id }), true, function (res) {

            if (res != null) {
                var strTimeLine = '';
                var left = false;

                for (var i = 0; i < res.data.length; i++) {
                    if ((res.data[i].levelStepAccessRole == "10" || res.data[i].sendUser == null) && i!=1) {
                        var bgColor = i == 0 ? "bg-secondary" : "bg-info";

                        strTimeLine += "<article class='timeline-entry " + (left ? " left-aligned" : "") + "'>";
                        strTimeLine += "<div class='timeline-entry-inner'>";

                        strTimeLine += "<time class='timeline-time' datetime=''>";
                       // strTimeLine += "<span class='date'>" + res.data[i].sendTimeStr + "</span>";
                       // strTimeLine += "<span class='LTRDirection'>" + res.data[i].sendTimeTimeStr + "</span>";
                        strTimeLine += "</time>";

                        strTimeLine += "<div class='timeline-icon " + bgColor + "'>";
                        strTimeLine += "<i class='entypo-feather'></i>";
                        strTimeLine += "</div>";

                        strTimeLine += "<div class='timeline-label'>";
                        if (i == 0) {
                            strTimeLine += "<span class='smallFontSize' style='font-weight:bold'>";
                            strTimeLine += (res.data[i].agentName == null ? res.data[i].companyName : res.data[i].agentName) + " : [" + res.data[i].kindOfRequestName + "]</span >";

                            strTimeLine += "<div style='float:left;color:green'><span class='date smallFontSize'>( تاریخ: " + res.data[i].sendTimeStr + "</span>";
                            strTimeLine += "<span class='LTRDirection smallFontSize'> ساعت: " + res.data[i].sendTimeTimeStr + " )</span></div>";
                           
                        }
                        else {
                            if (res.data[i].sendUser == null) {
                                strTimeLine += "<span class='boxCounter'>" + i.toString() + "</span>"
                                    + (res.data[i].levelStepSettingIndexID == "29" ? " &#x274C; " : "")
                                    + (res.data[i].levelStepSettingIndexID == "7" ? " &#x2705; " : "")
                                    + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                                    + "<span class='sender'>ارجاع از: مشتری" + (res.data[i].agentName == null ? " (" + res.data[i].companyName + ")" : " (" + res.data[i].agentName + ")") + "</span><br/>";
                                strTimeLine += " <span>به: " + res.data[i].roleDesReciver + " </span>";
                                strTimeLine += "<span class='sender'>" + " (" + res.data[i].reciverName + ")" + "</span>";
                            }
                            else if (res.data[i].reciverName == null) {
                                strTimeLine += "<span class='boxCounter'>" + i.toString() + "</span>"
                                    + (res.data[i].levelStepSettingIndexID == "4" ? " &#x1F4DD;" : "")
                                    + (res.data[i].levelStepSettingIndexID == "11" ? " &#x1F4C2;" : "")
                                    + " <span> ارجاع از:  " + res.data[i].userRoleDes + " (" + res.data[i].realName + ")"                                    
                                    + " </span><br/>";
                                strTimeLine += " <span>به: " + "مشتری" + " </span>";
                                strTimeLine += "<span class='sender'>" + (res.data[i].agentName == null ? " (" + res.data[i].companyName + ")" : " (" + res.data[i].agentName + ")") + "</span>";
                            }
                            else {
                                strTimeLine += "<span class='boxCounter'>" + i.toString() + "</span>"

                                    + (res.data[i].roleDesReciver != null ? " <span> ارجاع از:  " + res.data[i].userRoleDes + " (" + res.data[i].realName + ")"
                                        + " </span><br/>" : "");
                                strTimeLine += " <span>به: " + res.data[i].roleDesReciver + " </span>";
                                strTimeLine += "<span class='sender'>" + " (" + res.data[i].reciverName + ")" + "</span>";
                            }
                            strTimeLine += "<br/>";
                            strTimeLine += "<span class='smallFontSize'>";
                            strTimeLine += "[" + res.data[i].destLevelStepIndexButton + "]";
                            // strTimeLine += "[ جهت اقدام] <span >[ خوانده شده ] </span><span class='greenColor'>1401/09/21  3:34</span>";
                            strTimeLine += "</span>";
                            strTimeLine += "<div style='float:left;color:green'><span class='date smallFontSize'>( تاریخ: " + res.data[i].sendTimeStr + "</span>";
                            strTimeLine += "<span class='LTRDirection smallFontSize'> ساعت: " + res.data[i].sendTimeTimeStr + ")</span></div>";


                        }
                        strTimeLine += "<span></span>";
                        if (i != 0)
                        {
                            if (res.data[i].comment != null && res.data[i].comment!="") {

                                strTimeLine += "<div class='customDiv'>توضیحات<br/>";
                                strTimeLine += "<span class='Transcript'>" + res.data[i].comment + "</span>";
                                strTimeLine += "</div>";
                            }
                        }
                        strTimeLine += "</div>";
                        //res.data[i].kindOfRequestName

                        strTimeLine += "</div>";
                        strTimeLine += "</article>";
                        left = !left;
                    }

                }
                if (isFinish) {
                    strTimeLine += "<article class='timeline-entry " + (left ? " left-aligned" : "") + "'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";
                    strTimeLine += "<time class='timeline-time' datetime='2014-01-10T03:45'><span>اختتام درخواست</span></time>";
                    strTimeLine += "<div class='timeline-icon bg-secondary'><i class='entypo-feather'></i></div>";
                    strTimeLine += "<div class='timeline-label'>";
                    strTimeLine += "<h2>";
                    strTimeLine += "<span>اختتام درخواست </span>";
                    // strTimeLine += "<span class='sender''>مهندس</span>";
                    strTimeLine += "</h2>";
                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                } else {
                    strTimeLine += "<article class='timeline-entry begin'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";
                    strTimeLine += "<div class='timeline-icon' style='-webkit-transform: rotate(-90deg); -moz-transform: rotate(-90deg);'>";
                    strTimeLine += "<i class='entypo-flight'></i>";
                    strTimeLine += "</div>";
                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                }

                $("#TimeLine").html(strTimeLine);

            }

        }, true);

    }

    function initReferral(id = null) {

        AjaxCallAction("GET", "/api/Customer/RequestForRating/InitReferral/" + id, null, true, function (res) {

            if (res.isSuccess) {

                getU("/css/GlobalAreas/Views/Customer/RequestForRating/P_Referral.html", function (resG) {

                    $("#divMAS").html(resG);
                    $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(id.toString(), keyMaker()));
                    $("#sdklsslks3498sjdkxhjsd_823sdel").val(res.data[0].sendUser);
                    $("#phch").show();

                    var htmlB = "";
                    for (var i = 0; i < res.data.length; i++) {

                        htmlB += "<button type='button' id='btnreq' style='margin:5px' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);' " + "data-SIndex='" + res.data[i].levelStepSettingIndexId +"' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "' data-SC='" + encrypt(res.data[i].smsContent, keyMaker()) + "' data-ST='" + res.data[i].smsType + "' data-DLSIB='" + encrypt(res.data[i].destLevelStepIndexButton, keyMaker()) + "'>" + res.data[i].destLevelStepIndexButton + "</button>";

                    }

                    $("#bLLSS").html(htmlB);
                    showContract();
                    // Ckeditor("ReferralExplanation");
                });
            }
            else {

                $("#divMAS").html("<div class='alert alert-error text-center' style='font-size: 20px;'>شما اجازه انجام این عملیات را ندارید</div>");
                $("#phch").hide();
                $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt('0', keyMaker()));
                $("#bLLSS").html("");
                Ckeditor("ReferralExplanation");
            }

        }, true);

    }

    function getContractInfo(id = null) {

        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {

                    getU("/css/GlobalAreas/Views/customer/RequestForRating/P_Contract.html", function (resG) {

                        $("#contractInfo").html(resG);
                        $("#RequestId").val(id);
                        for (var i = 0; i < res.data.length; i++) {

                            initContract(res.data[i].requestId);
                        }

                    });

                }

            }, true);
        }
    }

    function getDocument(id = null) {
        if (id==null) {
            var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        }
        
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    if (res.data.contractCode == null) {
                        $("#LoadContractCustomer").remove();

                    } else {
                        $("#frmOkContract").remove();
                        $("#ContractCusmerMsg").remove();
                        $("#FinancialID").val(res.data.financialId);
                        $("#RequestID").val(res.data.requestID);

                             if ((res.data.committeeEvaluationFile != null && res.data.committeeEvaluationFile != "") || (res.data.evaluationFile != null && res.data.evaluationFile != "")) {
                                 $("#FirstDoc").remove();
                                 $("#upcontract").remove();
                                 $("#EvaluationFile").val(res.data.evaluationFile);
                        }
                        else {
                            $("#UpLastFinancialDocument").remove();
                        }

                        if (res.data.financialDocument != null && res.data.financialDocument != "") {
                            $("#divDownloadFinancialDocument").html("<a class='btn btn-success' href='" + res.data.financialDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else {
                            $("#divDownloadFinancialDocument").html("<p style='color:silver'></p>");
                        }
                        if (res.data.financialDocument2 != null && res.data.financialDocument2 != "") {
                            $("#divDownloadFinancialDocument2").html("<a class='btn btn-success' href='" + res.data.financialDocument2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else {
                            $("#divDownloadFinancialDocument2").html("<p style='color:silver'></p>");
                        }
                        if (res.data.contractDocument != null && res.data.contractDocument != "") {
                            $("#divDownload_ContractDocument").html("<a class='btn btn-success' href='" + res.data.contractDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else {
                            $("#divDownload_ContractDocument").html("<p style='color:silver'></p>");
                        }
                        if (res.data.lastFinancialDocument != null && res.data.lastFinancialDocument != "") {
                            $("#divDownload_LastFinancialDocument").html("<a class='btn btn-success' href='" + res.data.contractDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else {
                            $("#divDownload_LastFinancialDocument").html("<p style='color:silver'></p>");
                        }
                    }

                }

            }, true);
        }
    }

    function showDocument() {

        getU("/css/GlobalAreas/Views/customer/RequestForRating/P_Document.html", function (resG) {

            $("#showDocumentRep").html(resG);
            getDocument();

        });
    }

    function initContract(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    if (res.data.contractCode != null) {
                        if ((res.data.committeeEvaluationFile != null && res.data.committeeEvaluationFile != "") || (res.data.evaluationFile != null && res.data.evaluationFile != "")) {
                            var strhtml = "<div class='bc'><p> قرارداد نمایش متن</p><div id='divDownloadContractDocumentCustomer' ></div ><br/><br/>";

                            $("#divDownloadContract").html(strhtml);
                            $("#divDownloadContract").show();
                            var PreFact = (res.data.canSeePreFactor == true? "<a style='margin-right:5px' href='/customer/RequestForRating/PrintFactor/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintPerFactor(this)' > <i class='fa fa-print'></i> پیش  فاکتور  </a >":"");
                            $("#divDownloadContractDocumentCustomer").html("<a style='margin-left:5px' href='/customer/RequestForRating/ContractPrint/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintContract(this)' > <i class='fa fa-print'></i>   نمایش قرارداد  </a>" + PreFact);

                        } else {

                            var strhtml = "<div class='bc'><p>لطفا تمام صفحات مهر و امضا در سربرگ شرکت پارس کیان انجام شود و اصل قرارداد با مهر و امضای همه صفحات به شرکت پارس کیان ارسال گردد</p><div id='divDownloadContractDocumentCustomer' ></div ><br/><br/>";

                            strhtml += "<br/><p>" + " نکته: هنگام چاپ حتما اندازه کاغذ را روی A4 تنظیم کنید و گزینه Background graphics  را انتخاب کنید." + "</p></div>";
                            $("#divDownloadContract").html(strhtml);
                            $("#divDownloadContract").show();
                            $("#divDownloadContractDocumentCustomer").html("<a style='margin-left:5px' href='/customer/RequestForRating/ContractPrint/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintContract(this)' > <i class='fa fa-print'></i>   نمایش قرارداد  </a ><a href='/customer/RequestForRating/PrintFactor/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintPerFactor(this)' > <i class='fa fa-print'></i> پیش  فاکتور  </a ><br/><br/><br/><span>علت عدم تایید</span><input type='text' id='Comment2' name='Comment2' class='form-control' /><button style='margin-right:5px' class='btn btn-edit fontForAllPage' onclick='Web.RequestForRating.SaveReferralRequestForRatingCancel(this," + id + ")'>عدم تایید </button>");

                        }

                    } else {

                        $("#FinancialID").val(res.data.financialId);                       

                        var PreFact = (res.data.canSeePreFactor == true ? "<a style='margin-right:5px' href='/customer/RequestForRating/PrintFactor/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintPerFactor(this)' > <i class='fa fa-print'></i> پیش  فاکتور  </a >" : "");

                        var strhtml = "<div class='bc'><a href='/customer/RequestForRating/ContractPrint/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintContract(this)' > <i class='fa fa-print'></i> پیش نمایش نمونه قرارداد  </a >" + PreFact+"<br/><br/>";
                        strhtml += "<p>آیا قرارداد را تایید می کنید؟ در صورت عدم تایید قرارداد، در خواست شما به کارشناس ارسال خواهد شد </p><input type = 'hidden' id ='RequestId' name ='RequestId' value='" + id + "' />";
                        strhtml += " <button type='button' style='margin-left:5px' class='btn btn-success fontForAllPage' onclick='Web.RequestForRating.OkContract(this," + id + ")'>تایید  قرارداد</button><br/><br/><span>علت عدم تایید</span><input type='text' id='Comment2' name='Comment2' class='form-control' /><button style='margin-left:5px' class='btn btn-edit fontForAllPage' onclick='Web.RequestForRating.SaveReferralRequestForRatingCancel(this," + id + ")' type='button'>عدم تایید قرارداد </button><br /></div>";
                        $("#divOkContract").html(strhtml);
                    }
                   
                }

            }, true);
        }


    }

    //function okContract(e) {

    //    var id = $("#RequestId").val();
    //    if (!isEmpty(id) && id != 0) {

    //        var objJ = {};
    //        //objJ.Values = [];
    //        //objJ.Values.push({ Text: "test1", ValueObj:"12345"});;
    //        objJ.FinancialId = 46;

    //        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_ContractAndFinancialDocumentsNoForm", JSON.stringify(objJ), true, function (res) {

    //            if (res.isSuccess) {

    //                if (res.data.contractMainCode != null && res.data.contractMainCode != "") {
    //                    $("#divOkContract").remove();
    //                    var strhtml = "<div class='bc'><p> قرارداد زیر را دانلود و سپس آن را امضاء کنید و سپس آن را از تب <span style='color: forestgreen; font - weight: bolder'>بارگذاری اسناد قرارداد و پرداخت</span> به همراه سند تسویه بارگذاری کنید.</p><div id='divDownloadContractDocumentCustomer' ></div ></div>";
    //                    $("#divDownloadContract").html(strhtml);

    //                    $("#divDownloadContract").show();

    //                    $("#divDownloadContractDocumentCustomer").html("<a class='btn btn-info' href='" + res.data.contractDocumentCustomerFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
    //                }
    //            }

    //        }, true);
    //    }
    //}

    function okContract(e, id = null) {


        $(e).removeAttr("disabled");
        $("#EditStatuse").val("4");
        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmOkContract"), true, function (res) {

            if (res.isSuccess) {

                $("#divOkContract").remove();
                var strhtml = "<div class='bc'><p> قرارداد زیر را چاپ و سپس همه صفحات آن <span style='color:red; font-size:1.5em;'>امضاء شود</span> و سپس آن را از تب <span style='color: forestgreen; font - weight: bolder'>بارگذاری اسناد قرارداد و پرداخت</span> به همراه سند تسویه بارگذاری کنید.</p><div id='divDownloadContractDocumentCustomer' ></div ><br/><br/>";
               
                strhtml += "<br/><br/><br/><span>علت عدم تایید</span><input type='text' id='Comment2' name='Comment2' class='form-control' /><button style='margin-right:5px' class='btn btn-edit fontForAllPage' onclick='Web.RequestForRating.SaveReferralRequestForRatingCancel(this," + id + ")'>عدم تایید </button><br/><p>" + " نکته: هنگام چاپ حتما اندازه کاغذ را روی A4 تنظیم کنید و گزینه Background graphics  را انتخاب کنید." + "</p></div>";
                $("#divDownloadContract").html(strhtml);
                $("#divDownloadContract").show();
                $("#divDownloadContractDocumentCustomer").html("<a href='/customer/RequestForRating/ContractPrint/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintContract(this)' > <i class='fa fa-print'></i>   نمایش قرارداد  </a ><a style='margin-right:5px;' href='/customer/RequestForRating/PrintFactor/" + id + "' class='btn btn-default fontForAllPage' onclick = 'Web.RequestForRating.PrintPerFactor(this)' > <i class='fa fa-print'></i> پیش  فاکتور  </a >");

            } else {
                alertB("خطا", res.message, "error");
            }

        }, true);




    }

    function cancelContract(e) {
        var m = $("#Comment2").val()
        $("#Comment").val(m);
        $("#btnreq").click();
    }
    function cancelContracAfterConfirm(e) {
        $("#Comment").val(" درخواست اصلاح قرارداد");
        $("#btnreq").click();
    }

    function printContract(e) {

        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        goToUrl("/customer/RequestForRating/ContractPrint/" + id);
    }
    function printPerFactor(id = null) {
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                 
                    $("#SaveDate").html(res.data.saveDateStr);
                    $("#PriceFee1").html(moneyCommaSepWithReturn(res.data.finalPriceContract.toString()));
                    $("#PriceFee2").html(moneyCommaSepWithReturn(res.data.finalPriceContract.toString()));
                    $("#PriceFee3").html(moneyCommaSepWithReturn(res.data.finalPriceContract.toString()));
                    $("#TaxPrice1").html(moneyCommaSepWithReturn(res.data.tax.toString()));
                    $("#TaxPrice2").html(moneyCommaSepWithReturn(res.data.tax.toString()));
                    $("#TotalPrice").html(moneyCommaSepWithReturn((res.data.finalPriceContract + res.data.tax).toString()));
                    $("#TotalPrice2").html(moneyCommaSepWithReturn((res.data.finalPriceContract + res.data.tax).toString()));
                    $("#TotalPrice3").html(moneyCommaSepWithReturn((res.data.finalPriceContract + res.data.tax).toString()));
  initCustomer();

                }

            }, true);
        }
    }
    function initCustomer() {

        AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {

            if (res != null) {
                $("#CustomerName2").html(res.companyName);
                $("#CustomerName").html(res.companyName);
                $("#EconomicCode").html(res.economicCode);
                $("#NationalCode").html(res.nationalCode);
                $("#PostalCode").html(res.postalCode);
                $("#AddressCompany").html(res.addressCompany);
                $("#Tel").html(res.tel);
            }
        }, true);

    }

    function printContracting(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#ContractShow").html(res.data.contentContract);
                    if (res.data.contractCode != null && res.data.contractCode != "") {
                        $('.PageContractFirst').find('input[name=SaveDate]').val(res.data.saveDateStr);
                        $('.PageContractFirst').find('input[name=ContractCode]').val(res.data.contractCode);


                    } else {
                        $("#ptr").html("<p> این نسخه قرارداد اصلی نمی باشد.</p>");
                    }

                    $("#ContractCode").html(res.data.contractCode);
                    $('input[type="text"], textarea').each(function () {
                        //  $(this).attr('readonly', 'readonly');
                        // var text_classname = $(this).attr('name');
                        var value = $(this).val();
                        var new_html = ('<storang>' + value + '</storang>');
                        $(this).replaceWith(new_html);
                    });
                    if (res.data.contentContract != null && res.data.contentContract != "") {
                        $("#ptr").show();
                    } else {
                        $("#ptr").hide();
                    }

                }

            }, true);
        }
    }
    function printDiv() {
        $("#ptr").hide();
        window.print();
    }

    function showContract() {

        getContractInfo(decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker()));
    }



    function saveReferralRequestForRating(e, Comment = null) {

        $(".ButtonOpperationLSSlss").attr("disabled", "");
        var commenttxt = $("#Comment").val() == null ? Comment : $("#Comment").val();
        var objJ = {};
        objJ.DestLevelStepIndex = decrypt($(e).attr("data-DLSI"), keyMaker());
        objJ.Comment = commenttxt;// Comment; // $("#Comment").val();// getDataCkeditor("ReferralExplanation");
        objJ.LevelStepAccessRole = decrypt($(e).attr("data-LSAR"), keyMaker());
        objJ.LevelStepStatus = decrypt($(e).attr("data-LSS"), keyMaker());
        objJ.Request = {};
        objJ.Request.Requestid = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        objJ.Request.KindOfRequest = '0';
        objJ.SmsContent = decrypt($(e).attr("data-SC"), keyMaker());
        objJ.SmsType = !isEmpty($(e).attr("data-ST")) ? $(e).attr("data-ST") === 'true' : null;
        objJ.DestLevelStepIndexButton = decrypt($(e).attr("data-DLSIB"), keyMaker());
        objJ.ReciveUser = $("#sdklsslks3498sjdkxhjsd_823sdel").val();
        objJ.LevelStepSettingIndexID = $(e).attr("data-SIndex");
        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_Request", JSON.stringify(objJ), true, function (res) {

            $(".ButtonOpperationLSSlss").removeAttr("disabled");

            if (res.isSuccess) {
                goToUrl("/Customer/RequestForRating/Index");

            }
            else {

                alertB("هشدار", res.message, "warning");

            }

        }, true);

    }

    function saveReferralRequestForRatingAgain(e, Requestid = null,RequestType=null) {
        if (RequestType==66) {
            var objJ = {};
            objJ.DestLevelStepIndex = "3";
            objJ.Comment = "اطلاعات اصلاح شد";// getDataCkeditor("ReferralExplanation");
            objJ.LevelStepAccessRole = "4";
            objJ.LevelStepStatus = "در انتظار بررسی مشخصات اولیه مشتری توسط کارشناس امور قراردادها";
            objJ.Request = {};
            objJ.Request.Requestid = Requestid;
            objJ.Request.KindOfRequest = '0';
            objJ.SmsContent = null;
            objJ.SmsType = null;
            objJ.DestLevelStepIndexButton = "در انتظار بررسی مشخصات اولیه مشتری توسط کارشناس امور قراردادها";
            objJ.ReciveUser = "146";// $("#sdklsslks3498sjdkxhjsd_823sdel").val();
            objJ.LevelStepSettingIndexID = "1";

        } else if(RequestType == 254) {
            var objJ = {};
            objJ.DestLevelStepIndex = "101";
            objJ.Comment = "اطلاعات اصلاح شد";// getDataCkeditor("ReferralExplanation");
            objJ.LevelStepAccessRole = "4";
            objJ.LevelStepStatus = "در انتظار بررسی مشخصات اولیه مشتری توسط کارشناس امور قراردادها";
            objJ.Request = {};
            objJ.Request.Requestid = Requestid;
            objJ.Request.KindOfRequest = '254';
            objJ.SmsContent = null;
            objJ.SmsType = null;
            objJ.DestLevelStepIndexButton = "در انتظار بررسی مشخصات اولیه مشتری توسط کارشناس امور قراردادها";
            objJ.ReciveUser = "146";// $("#sdklsslks3498sjdkxhjsd_823sdel").val();
            objJ.LevelStepSettingIndexID = "33";

        }


        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_Request", JSON.stringify(objJ), true, function (res) {

            if (res.isSuccess) {

                alertB("ثبت", "درخواست شما ارسال مجدد ارسال شد", "success");
                goToUrl("/Customer/RequestForRating/Index");
            }
            else {

                alertB("هشدار", res.message, "warning");

            }

        }, true);

    }

    function saveReferralRequestForRatingCancel(e, Requestid = null) {

        var objJ = {};
        objJ.DestLevelStepIndex = "3";
        objJ.Comment = $("#Comment2").val();
        objJ.LevelStepAccessRole = "4";
        objJ.LevelStepStatus = "در انتظار تنظیم و اصلاح قرارداد توسط کارشناس امور قراردادها";
        objJ.Request = {};
        objJ.Request.Requestid = Requestid;
        objJ.Request.KindOfRequest = '0';
        objJ.SmsContent = null;
        objJ.SmsType = null;
        objJ.DestLevelStepIndexButton = "ارجاع به کارشناس امور قراردادها جهت بررسی عدم تاییدمشتری";
        objJ.LevelStepSettingIndexID = "29"
        objJ.ReciveUser = $("#sdklsslks3498sjdkxhjsd_823sdel").val();
        AjaxCallAction("POST", "/api/customer/RequestForRating/Save_Request", JSON.stringify(objJ), true, function (res) {


            if (res.isSuccess) {

                alertB("ثبت", "درخواست شما به مسئول قرارداد ارسال شد منتظر تماس ما باشید", "success", "بله متوجه شدم", function () {

                    goToUrl("/Customer/RequestForRating/Index");

                });

            }
            else {

                alertB("هشدار", res.message, "warning");

            }

        }, true);

    }

    function copyFurtherInfo(id=null,preReq = null) {       
        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("GET", "/api/customer/FurtherInfo/Copy_FurtherInfo/" + id + "-" + preReq, null, true, function (res) {

                if (res.isSuccess) {
                    alertB("ثبت", "کپی انجام شد", "success", "بله متوجه شدم", function () {
                        goToUrl("/Customer/FurtherInfo/index/" + id);
                    });
                }

            }, true);
        }

    }


    

    function showFurtherInfo(e, RequestId) {
       
        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestHistory", JSON.stringify({ RequestId: RequestId, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

            if (res.isSuccess) {
                if (res.data.length > 0) {

                    alertB("ثبت", "به دلیل وجود سابقه اطلاعاتی یک کپی از اطلاعات درست می شود تا شما بتوانید آنها را ویرایش کنید", "success", "بله متوجه شدم", function () {
                        copyFurtherInfo(RequestId,res.data[0].requestId);
                        // tempSaveRFR(e);
                    });
                }
                else {
                    goToUrl("/Customer/FurtherInfo/index/" + RequestId);
                }
            }

        }, true);

    }


    web.RequestForRating = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        SaveRequestForRating: saveRequestForRating,
        InitRequestForRating: initRequestForRating,
        EditCustomerRequestInformation: editCustomerRequestInformation,
        FilterGrid: filterGrid,
        Get_Detail: get_Detail,
        SystemSeting_ComboRequestForRating: systemSeting_ComboRequestForRating,
        SaveReferralRequestForRating: saveReferralRequestForRating,
        RegistingFirstRequest: registingFirstRequest,
        InitRequestReferences: initRequestReferences,
        InitReferral: initReferral,
        CheckIsfinish: checkIsfinish,
        CreateTimeLine: createTimeLine,
        InitContract: initContract,
        GetContractInfo: getContractInfo,
        ShowContract: showContract,
        PrintContract: printContract,
        SaveContractAndFinancialDocument: saveContractAndFinancialDocument,
        ShowDocument: showDocument,
        GetDocument: getDocument,
        PrintContracting: printContracting,
        OkContract: okContract,
        CancelContract: cancelContract,
        PrintDiv: printDiv,
        CancelContracAfterConfirm: cancelContracAfterConfirm,
        SaveReferralRequestForRatingAgain: saveReferralRequestForRatingAgain,
        PrintPerFactor: printPerFactor,
        InitCustomer: initCustomer,
        SaveReferralRequestForRatingCancel: saveReferralRequestForRatingCancel,
        DashboardInformation: dashboardInformation,       
        CopyFurtherInfo: copyFurtherInfo,
        ShowFurtherInfo: showFurtherInfo
        
    };

})(Web, jQuery);
function checkAllDocUpload(el) {
    let errorCounter = 0
    document.querySelectorAll("#document_save_pane label span").forEach(function (it) {
        let inputElement = it.parentNode.parentNode.querySelector("input");
        let downloadBtn = it.parentNode.parentNode.querySelector("a");
        if (inputElement.files.length == 0 && downloadBtn.href == "") {
            it.style.fontSize = "15px";
            it.innerHTML = "این مورد ضرروری است!";
            errorCounter += 1;
        } else {
            it.style.fontSize = "25px";
            it.innerHTML = "*";
        }
    })

    document.querySelectorAll("#document_save_pane label span").forEach(function (it) {
        try {
            if (it.innerHTML == "این مورد ضرروری است!") {
                $([document.documentElement, document.body]).animate({
                    scrollTop: $(it).offset().top - 200
                }, 2000);
                throw Exception;
            }
        } catch (e) {
            if (e !== Exception) throw e;
        }
    })

    if (errorCounter == 0) {
        let count_of_requierd_doc = 0;
        let count_of_requierd_doc_answerd = 0;
        AjaxCallAction("POST", "/api/customer/Corporate/Get_DataFormDocuments", JSON.stringify({
            PageIndex: 0,
            PageSize: 0,
            IsActive: 15,
            IsRequierd: true
        }), false, function (res) {
            if (res.isSuccess) {
                count_of_requierd_doc = res.data.length;
            }
        }, false);

        AjaxCallAction("POST", "/api/customer/Corporate/Get_DataFromAnswerss", JSON.stringify({
            PageIndex: 0,
            PageSize: 0,
            IsActive: 15,
            FormId: 0,
            RequestId: $("#RequestIdForms").val(),
            DataFormQuestionId: 0,
        }), false, function (res) {
            if (res.isSuccess) {
                count_of_requierd_doc_answerd = res.data.length;
            }
        }, false);

        if (count_of_requierd_doc <= count_of_requierd_doc_answerd) {
            current_fs = $(el).parent();
            next_fs = $(el).parent().next();

            //Add Class Active
            $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

            //show the next fieldset
            next_fs.show();
            //hide the current fieldset with style
            current_fs.animate({
                opacity: 0,
            }, {
                step: function (now) {
                    // for making fielset appear animation
                    opacity = 1 - now;

                    current_fs.css({
                        display: "none",
                        position: "relative",
                    });
                    next_fs.css({
                        opacity: opacity,
                    });
                },
                duration: 600,
            });
            return true;
        }
        else {
            alertB("خطا", "فایل هایی که در کنار آنها علامت * می باشد اجباری هستند توجه نمایید بعد از اپلود فایل باید بر روی ذخیره کلیک نمایید تا اپلود شود", "error", "بله متوجه شدم", function () { });
            return false;
        }
        return false;
    }
    else {
        alertB("خطا", "فایل هایی که در کنار آنها علامت * می باشد اجباری هستند توجه نمایید بعد از اپلود فایل باید بر روی ذخیره کلیک نمایید تا اپلود شود", "error", "بله متوجه شدم", function () { });
    }
}

(function (web, $) {
    var userAccessSaveForm = true
    var DataFormList = "";
    var LoadedDataFromDb = "";
    var LoadedDataFromDbDocument = "";
    var progresDynamicBar = [];
    var VersionQuestion = null; // تعیین ورژن سوالات
    //Document Ready

    function makeLiProgresBar(progresDynamicBar) {
        let _strM = "";
        for (let i = 0; i < progresDynamicBar.length; i++) {
            if (i == 0)
                _strM += "<li class='active' id='payment'><strong>" + progresDynamicBar[i].label + "</strong></li>";
            else {
                _strM += "<li class='' id='payment'><strong>" + progresDynamicBar[i].label + "</strong></li>";
            }
        }
        _strM += "<li id='confirm'><strong>بارگذاری مدارک</strong></li>";
        return _strM;
    }

    function makeFieldset(fieldId, isFirst = true) {
        let str_M = "";
        if (isFirst) {
            str_M += "<fieldset><button type='button' name='next' class='next action-button' style='border:none;width:90px'>فرم بعدی <i class='fa fa-arrow-left'></i></button>";
            str_M += "<div class='form-card'><div class='row'><div class='col-md-12'><div class='nav-tabs-custom'><ul class='nav nav-tabs' id='TargetTabs" + fieldId + "'></ul>";
            str_M += "<div class='tab-content' id='TabPaneTargetTabs" + fieldId + "'></div></div></div></div></div>";
            str_M += "<button type='button' name='next' class='next action-button' style='border:none;width:90px'>فرم بعدی <i class='fa fa-arrow-left'></i></button></fieldset>";
        } else {
            str_M += "<fieldset><button type='button' name='previous' class='previous action-button-previous' style='border:none;width:90px'><i class='fa fa-arrow-right'></i> فرم قبلی </button>";
            str_M += "<button type='button' name='next' class='next action-button' style='border:none;width:90px'>فرم بعدی <i class='fa fa-arrow-left'></i></button>";
            str_M += "<div class='form-card'><div class='row'><div class='col-md-12'><div class='nav-tabs-custom'><ul class='nav nav-tabs' id='TargetTabs" + fieldId + "'></ul>";
            str_M += "<div class='tab-content' id='TabPaneTargetTabs" + fieldId + "'></div></div></div></div></div>";
            str_M += "<button type='button' name='previous' class='previous action-button-previous' style='border:none;width:90px'><i class='fa fa-arrow-right'></i> فرم قبلی </button>";
            str_M += "<button type='button' name='next' class='next action-button' style='border:none;width:90px'>فرم بعدی <i class='fa fa-arrow-left'></i></button></fieldset>";
        }
        return str_M;
    }

    function makeTabProgresDynamic() {
        if (progresDynamicBar.length == 0)
            AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings/", JSON.stringify({
                PageIndex: 0,
                PageSize: 0,
                ParentCode: 286,
                SortOrder: "Value_D",
            }), false, function (result) {
                progresDynamicBar = result.data;
            }, false);
        let _strM = "";
        if (progresDynamicBar.length > 1)
            for (let i = 0; i < progresDynamicBar.length; i++) {
                if (i == 0)
                    _strM += makeFieldset(progresDynamicBar[i].systemSetingId, true);
                else {
                    _strM += makeFieldset(progresDynamicBar[i].systemSetingId, false);
                }
            }
        let _strLi = makeLiProgresBar(progresDynamicBar);
        $("#progressbar").html(_strLi);
        $("#progressbar").after(_strM);
        $(".next").click(function () {
            current_fs = $(this).parent();
            next_fs = $(this).parent().next();

            //Add Class Active
            $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

            //show the next fieldset
            next_fs.show();
            //hide the current fieldset with style
            current_fs.animate({
                opacity: 0,
            }, {
                step: function (now) {
                    // for making fielset appear animation
                    opacity = 1 - now;

                    current_fs.css({
                        display: "none",
                        position: "relative",
                    });
                    next_fs.css({
                        opacity: opacity,
                    });
                },
                duration: 600,
            });
        });

        $(".previous").click(function () {
            current_fs = $(this).parent();
            previous_fs = $(this).parent().prev();

            //Remove class active
            $("#progressbar li")
                .eq($("fieldset").index(current_fs))
                .removeClass("active");

            //show the previous fieldset
            previous_fs.show();

            //hide the current fieldset with style
            current_fs.animate({
                opacity: 0,
            }, {
                step: function (now) {
                    // for making fielset appear animation
                    opacity = 1 - now;

                    current_fs.css({
                        display: "none",
                        position: "relative",
                    });
                    previous_fs.css({
                        opacity: opacity,
                    });
                },
                duration: 600,
            });
        });
    }

    function initCorporate(id = null, makeQuestionForm = true) {
        PersianDatePicker(".DatePicker");
        $("#RequestIdForms").val(id);
        initCustomer();

        makeTabProgresDynamic();
        if (makeQuestionForm) {

            AjaxCallAction("POST", "/api/customer/RequestForRating/Get_RequestForRatings",
                JSON.stringify({ PageIndex: 1, PageSize: 1, RequestId: id, KindOfRequest: 254 }), false,
                function (res) {
                    if (res.isSuccess)
                        userAccessSaveForm = (res.data[0].destLevelStepIndex <= 105) && (res.data[0].destLevelStepAccessRole == 10)
                }, false);


            if (userAccessSaveForm) {
                let strmsg = "<div class='swal-overlay swal-overlay--show-modal' tabindex='-1' id='message_startsub'>" +
                    "<div class='swal-modal' role='dialog' aria-modal='true' style='width: 1000px!important;'>" +
                    "<div class='swal-text' style=''>" +
                    "مشتری گرامی<br>با سلام و احترام<br>پیش از تکمیل و ثبت نهایی پرسشنامه ارزیابی حاکمیت شرکتی لطفا موارد ذیل دقت نمایید :<br>1 - جهت ارزیابی " + "پرسش های ثبت شده ، بارگذاری مدارک و مستندات طبق فیلدهای طراحی شده در بخش 'بارگذاری مدارک' الزامی است، لذا خواهشمند است نسبت به ارسال مدارک درخواستی بصورت خوانا و دقیق دقت فرمایید.<br>2 - فرمت فایلهای قابل قبول جهت ارسال در بخش 'بارگذاری مدارک' ، PDF, Excel, image است.<br>3 - لطفا پس از پاسخ دادن به سوالات هر فرم، دکمه 'ذخیره سازی' در آن فرم را کلیک کرده و سپس جهت پاسخ دهی به فرم بعدی بروید.<br>4 - با توجه به اینکه سوالات بصورت بلی / خیر طراحی شده است، در صورت عدم امکان پاسخ دهی دقیق به هر سوال، ضمن ارائه توضیحات کد در بخش 'توضیحات' پاسخ خود را از بین دو گزینه موجود انتخاب نمایید.<br>5 - توجه کنید در صورت مغایرت پاسخ های ارسالی با مدارک بارگذاری شده، ضمن عدم تعلق نمره مربوطه، آن سوال مجددا جهت اصلاح پاسخ یا باگذاری مدارک مربوطه بازگشت داده میشود. لذا خواهشمند است جهت تسریع در امر ارزیابی، با دقت نسبت به پاسخ دهی به سوالات و بارگذاری مدارک اقدام نمایید.<br>6 - در صورت بازگشت مجدد سوالات، جهت اصلاح، به توضیحات کارشناس ارزیابی حاکمیت شرکتی توجه فرمایید و در صورت وجود هر گونه ابهام با شماره پشتیبانی کارشناس حاکمیت شرکتی تماس حاصل فرمایید.<br> " +
                    " 7 - بارگذاری مدارک ستاره دار برای انجام ارزیابی، الزامی است. در صورت در دسترس نبودن مدرک مذکور یا عدم موضوعیت سوال مربوطه برای آن شرکت، لطفا پیام، 'مدرک درخواستی در دسترس نیست' یا 'عدم موضوعیت سوال' را در قالب یک فایل PDF برای مدارکی که ارسال آنها الزامی است، بارگذاری کنید. بدیهی است که در این صورت، امتیازی برای این سوال به شرکتی تعلق نمی گیرد.<br>" +
                    " </div> <div class='swal-footer'>" +
                    " <div class='swal-button-container'>" +
                    " <button onclick=\"$('#message_startsub').remove()\" class='swal-button swal-button--confirm'>بله متوجه شدم</button><div class='swal-button__loader'><div></div><div></div><div></div></div>" +
                    "</div></div></div></div>";
                $("#message_start").html(strmsg);
            }


            makeDynamicForm("A", "TargetTabs287", true, "TabPaneTargetTabs287");

            makeDynamicForm("B", "TargetTabs290", true, "TabPaneTargetTabs290");

            makeDynamicForm("C", "TargetTabs291", true, "TabPaneTargetTabs291");

            makeDynamicForm("D", "TargetTabs288", true, "TabPaneTargetTabs288");

            makeDynamicForm("E", "TargetTabs289", true, "TabPaneTargetTabs289");

            makeDynamicForm("F", "TargetTabs292", true, "TabPaneTargetTabs292");

            makeDynamicForm("G", "TargetTabs293", true, "TabPaneTargetTabs293");

            makeDynamicForm("H", "TargetTabs294", true, "TabPaneTargetTabs294");

            makeDynamicDocumentForm("ducument_save", "document_save_pane");

            initReferral(id, true);
        }
        else {
            var checkReport = "";

            var cat287li = "";
            var cat288li = "";
            var cat289li = "";
            var cat290li = "";
            var cat291li = "";
            var cat292li = "";
            var cat293li = "";
            var cat294li = "";

            var cat287Pan = "";
            var cat288Pan = "";
            var cat289Pan = "";
            var cat290Pan = "";
            var cat291Pan = "";
            var cat292Pan = "";
            var cat293Pan = "";
            var cat294Pan = "";

            var fisrtInGroup287 = true;
            var fisrtInGroup288 = true;
            var fisrtInGroup289 = true;
            var fisrtInGroup290 = true;
            var fisrtInGroup291 = true;
            var fisrtInGroup292 = true;
            var fisrtInGroup293 = true;
            var fisrtInGroup294 = true;

            makeDocLiAndPan("ducument_save", "document_save_pane");

            AjaxCallAction("POST", "/api/customer/Corporate/Get_DataFormReportChecks/", JSON.stringify({
                PageIndex: 0,
                PageSize: 0,
                IsActive: 15,
                RequestId: id,
                SortOrder: "QuestionId_A",
            }), false, function (res) {
                if (res != null) {
                    checkReport = res;
                    let list_li_data = res.data;

                    list_li_data = res.data.filter((arr, index, self) =>
                        index === self.findIndex((t) => (t.formCode === arr.formCode && t.formCode != "")))

                    for (let i = 0; i < list_li_data.length; i++) {
                        let dataForm = "";
                        let question = "";
                        AjaxCallAction("GET", "/api/customer/Corporate/Get_DataForm/" + list_li_data[i].formId, null, false, function (form) {
                            dataForm = form;
                        }, false);
                        AjaxCallAction("GET", "/api/customer/Corporate/Get_DataFormQuestions/" + list_li_data[i].questionId, null, false, function (form) {
                            question = form;
                        }, false);

                        switch (list_li_data[i].categoryId) {
                            case 287:
                                if (list_li_data[i].questionId != 0 && list_li_data[i].formId != 0) {
                                    let tempresult = makeLiAndPan(list_li_data[i].formCode, dataForm.formTitle, list_li_data[i].formId, id, fisrtInGroup287);
                                    cat287li += tempresult[0];
                                    cat287Pan += tempresult[1];
                                    fisrtInGroup287 = false;
                                }
                                break;
                            case 288:
                                if (list_li_data[i].questionId != 0 && list_li_data[i].formId != 0) {
                                    let tempresult = makeLiAndPan(list_li_data[i].formCode, dataForm.formTitle, list_li_data[i].formId, id, fisrtInGroup288);
                                    cat288li += tempresult[0];
                                    cat288Pan += tempresult[1];
                                    fisrtInGroup288 = false;
                                }
                                break;
                            case 289:
                                if (list_li_data[i].questionId != 0 && list_li_data[i].formId != 0) {
                                    let tempresult = makeLiAndPan(list_li_data[i].formCode, dataForm.formTitle, list_li_data[i].formId, id, fisrtInGroup289);
                                    cat289li += tempresult[0];
                                    cat289Pan += tempresult[1];
                                    fisrtInGroup289 = false;
                                }
                                break;
                            case 290:
                                if (list_li_data[i].questionId != 0 && list_li_data[i].formId != 0) {
                                    let tempresult = makeLiAndPan(list_li_data[i].formCode, dataForm.formTitle, list_li_data[i].formId, id, fisrtInGroup290);
                                    cat290li += tempresult[0];
                                    cat290Pan += tempresult[1];
                                    fisrtInGroup290 = false;
                                }
                                break;

                            case 291:
                                if (list_li_data[i].questionId != 0 && list_li_data[i].formId != 0) {
                                    let tempresult = makeLiAndPan(list_li_data[i].formCode, dataForm.formTitle, list_li_data[i].formId, id, fisrtInGroup291);
                                    cat291li += tempresult[0];
                                    cat291Pan += tempresult[1];
                                    fisrtInGroup291 = false;
                                }
                                break;

                            case 292:
                                if (list_li_data[i].questionId != 0 && list_li_data[i].formId != 0) {
                                    let tempresult = makeLiAndPan(list_li_data[i].formCode, dataForm.formTitle, list_li_data[i].formId, id, fisrtInGroup292);
                                    cat292li += tempresult[0];
                                    cat292Pan += tempresult[1];
                                    fisrtInGroup292 = false;
                                }
                                break;

                            case 293:
                                if (list_li_data[i].questionId != 0 && list_li_data[i].formId != 0) {
                                    let tempresult = makeLiAndPan(list_li_data[i].formCode, dataForm.formTitle, list_li_data[i].formId, id, fisrtInGroup293);
                                    cat293li += tempresult[0];
                                    cat293Pan += tempresult[1];
                                    fisrtInGroup293 = false;
                                }
                                break;

                            case 294:
                                if (list_li_data[i].questionId != 0 && list_li_data[i].formId != 0) {
                                    let tempresult = makeLiAndPan(list_li_data[i].formCode, dataForm.formTitle, list_li_data[i].formId, id, fisrtInGroup294);
                                    cat294li += tempresult[0];
                                    cat294Pan += tempresult[1];
                                    fisrtInGroup294 = false;
                                }
                                break;
                        }
                    }
                    $("#TargetTabs287").append(cat287li);
                    $("#TabPaneTargetTabs287").append(cat287Pan != "" ? cat287Pan : '<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');

                    $("#TargetTabs288").append(cat288li);
                    $("#TabPaneTargetTabs288").append(cat288Pan != "" ? cat288Pan : '<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');

                    $("#TargetTabs289").append(cat289li);
                    $("#TabPaneTargetTabs289").append(cat289Pan != "" ? cat289Pan : '<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');

                    $("#TargetTabs290").append(cat290li);
                    $("#TabPaneTargetTabs290").append(cat290Pan != "" ? cat290Pan : '<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');

                    $("#TargetTabs291").append(cat291li);
                    $("#TabPaneTargetTabs291").append(cat291Pan != "" ? cat291Pan : '<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');

                    $("#TargetTabs292").append(cat292li);
                    $("#TabPaneTargetTabs292").append(cat292Pan != "" ? cat292Pan : '<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');

                    $("#TargetTabs293").append(cat293li);
                    $("#TabPaneTargetTabs293").append(cat293Pan != "" ? cat293Pan : '<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');

                    $("#TargetTabs294").append(cat294li);
                    $("#TabPaneTargetTabs294").append(cat294Pan != "" ? cat294Pan : '<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');
                }
            },
                true
            );

            for (let i = 0; i < checkReport.data.length; i++) {
                let question = "";
                let answer = "";
                let _document = "";
                AjaxCallAction("GET", "/api/customer/Corporate/Get_DataFormQuestions/" + checkReport.data[i].questionId, null, false, function (form) {
                    question = form;
                }, false);
                AjaxCallAction("GET", "/api/customer/Corporate/Get_DataFromAnswers/" + checkReport.data[i].answerId, null, false, function (form) {
                    answer = form;
                }, false);
                if (checkReport.data[i].documentId != null)
                    AjaxCallAction("GET", "/api/customer/Corporate/Get_DataFormDocument/" + checkReport.data[i].documentId, null, false, function (form) {
                        _document = form;
                    }, false);

                if (checkReport.data[i].questionId != 0 && checkReport.data[i].formId != 0) {
                    let strFormId = generate_strFormId(question, id, checkReport.data[i].formId, true, checkReport.data[i].superVisorDescription);
                    $("#FormDetail" + checkReport.data[i].formId).append(strFormId);
                    if (answer.answer == "Yes") {
                        $("input:radio[name='Q_" + answer.dataFormQuestionId + "'][value='Yes']").prop("checked", true);
                    } else if (answer.answer == "No") {
                        $("input:radio[name='Q_" + answer.dataFormQuestionId + "'][value='No']").prop("checked", true);
                    } else {
                        $("#Q_" + answer.dataFormQuestionId + " option[value='" + answer.answer + "']").prop("selected", true);
                    }
                    $("input[name*='Description_Q" + answer.dataFormQuestionId + "']").val(answer.description);
                } else {
                    if (_document != "")
                        makeDocumentFile([_document], checkReport.data[i].superVisorDescription);
                }
            }
            initReferral(id, false);
        }
    }

    function makeLiAndPan(formCode, formTitle, formId, reqid, isActive) {
        let li_option = "";
        let tabPane = "";
        if (isActive) {
            li_option = "<li class='active'><a href='#FormDetailTab" + formCode + "' data-toggle='tab' aria-expanded='false' >" + formCode + "</a></li>";
            tabPane = makeTabPane(formCode, formTitle, formId, reqid, isActive);
            isActive = false;
        } else {
            tabPane = makeTabPane(formCode, formTitle, formId, reqid, isActive);
            li_option = "<li class=''><a href='#FormDetailTab" + formCode + "' data-toggle='tab' aria-expanded='false' >" + formCode + "</a></li>";
        }
        return [li_option, tabPane];
    }

    function initCustomer(dir = "rtl") {
        ComboBoxWithSearch(".select2", dir);
        AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {
            if (res != null) {
                $("#CutomerName").html(
                    "<h4> فرم پرسشنامه حاکمیت شرکتی " + res.companyName + "</h4>"
                );
            }
        }, true);
    }

    function intiForm(FormID = null, RequestId = null) {
        let strFormId = "";
        AjaxCallAction("POST", "/api/customer/Corporate/Get_DataFormQuestionss", JSON.stringify({
            DataFormId: FormID,
            PageIndex: 0,
            PageSize: 0,
            DataFormType: 2,
            IsActive: 15,
            Version: VersionQuestion,
        }), false, function (res) {
            if (res.isSuccess) {
                let strFormId = generate_strFormId(res, RequestId, FormID);
                $("#FormDetail" + FormID).html(strFormId);
                AjaxCallAction("POST", "/api/customer/Corporate/Get_DataFromAnswerss", JSON.stringify({
                    PageIndex: 0,
                    PageSize: 0,
                    FormID: FormID,
                    RequestId: RequestId,
                }), true, function (res) {
                    if (res.isSuccess) {
                        LoadedDataFromDb = res.data;
                        for (let i = 0; LoadedDataFromDb.length > i; i++) {
                            if (LoadedDataFromDb[i].answer == "Yes") {
                                $("input:radio[name='Q_" + LoadedDataFromDb[i].dataFormQuestionId + "'][value='Yes']").prop("checked", true);
                            } else if (LoadedDataFromDb[i].answer == "No") {
                                $("input:radio[name='Q_" + LoadedDataFromDb[i].dataFormQuestionId + "'][value='No']").prop("checked", true);
                            } else {
                                $("#Q_" + LoadedDataFromDb[i].dataFormQuestionId + " option[value='" + LoadedDataFromDb[i].answer + "']").prop("selected", true);
                            }
                            $("input[name*='Description_Q" + LoadedDataFromDb[i].dataFormQuestionId + "']").val(LoadedDataFromDb[i].description);
                        }
                    }
                }, true);
            }
        }, true);
    }

    function generate_strFormId(res, RequestId, FormId, isSingle = false, analizeDescription = "") {
        let strFormId = "";
        if (isSingle) {
            strFormId += "<div class='form-group'><div class='col-md-12'><h4 style='line-height: 1.5;'>" + res.questionText;
            if (!isEmpty(res.helpText))
                strFormId += " <span title='" + res.helpText + "'><i class='fa'></i></span>";
            strFormId += "</h4></div><div class='col-md-12'><div class='row'><div class='col-md-4'>"
            if (res.questionType == "select") {
                var options = combo(res.dataFormQuestionId);
                strFormId += "<select required name='Q_" + res.dataFormQuestionId + "' id='Q_" + res.dataFormQuestionId + "' class='form-control' style='padding: 0px 15px;' >" + options + "</select>";
            } else if (res.questionType == "yesNo") {
                strFormId += "<label class='control-label'>بله</label><input type='radio' required name='Q_" + res.dataFormQuestionId + "' value='Yes' />";
                strFormId += "<label class='control-label'>خیر</label><input type='radio' required name='Q_" + res.dataFormQuestionId + "' value='No' />";
            }
            strFormId += "</div><div class='col-md-8'>";
            strFormId += "<input placeholder='توضیحات' class='form-control' name='Description_Q" + res.dataFormQuestionId + "' onfocus='select();' type='text' value='' />";
            strFormId += "</div><div class='col-md-8'>";
            strFormId += "<p style='color: blue;'>توضیح کارشناس : " + analizeDescription + "</p>";
            strFormId += "</div ></div ></div ></div >";
            return strFormId;
        } else {
            strFormId = "<div class='col-md-12'>";
            for (var i = 0; i < res.data.length; i++) {
                strFormId += "<div class='form-group'><div class='col-md-12'><h4 style='line-height: 1.5;'>" + (i + 1) + " - " + res.data[i].questionText;
                if (!isEmpty(res.data[i].helpText))
                    strFormId += " <span title='" + res.data[i].helpText + "'><i class='fa'></i></span>"
                strFormId += "</h4></div><div class='col-md-12'><div class='row'><div class='col-md-4'>";
                if (res.data[i].questionType == "select") {
                    var options = combo(res.data[i].dataFormQuestionId);
                    strFormId += "<select required name='Q_" + res.data[i].dataFormQuestionId + "' id='Q_" + res.data[i].dataFormQuestionId + "' class='form-control' style='padding: 0px 15px;' >" + options + "</select>";
                } else if (res.data[i].questionType == "yesNo") {
                    strFormId += "<label class='control-label'>بله</label><input type='radio' required name='Q_" + res.data[i].dataFormQuestionId + "' value='Yes' />";
                    strFormId += "<label class='control-label'>خیر</label><input type='radio' required name='Q_" + res.data[i].dataFormQuestionId + "' value='No' />";
                }
                strFormId += "</div><div class='col-md-8'>";
                strFormId += "<input placeholder='توضیحات' class='form-control' name='Description_Q" + res.data[i].dataFormQuestionId + "' onfocus='select();' type='text' value='' />";
                strFormId += "</div ></div ></div ></div >"
            }
            strFormId += "</div>";
        }
        return strFormId;
    }

    function combo(QuestionID = null) {
        let strM = "";
        AjaxCallAction("POST", "/api/customer/Corporate/Get_Options", JSON.stringify({
            DataFormQuestionsId: QuestionID,
            PageIndex: 0,
            PageSize: 0,
            IsActive: 15,
        }), false, function (res) {
            if (res.isSuccess) {
                strM = '<option value="0">انتخاب کنید</option>';
                for (var i = 0; i < res.data.length; i++) {
                    strM += "<option value='" + res.data[i].id + "_" + res.data[i].text + "'>" + res.data[i].text + "</option>";
                }
            }
        }, true);
        return strM;
    }

    function makeDynamicForm(SubCategoryName, PutPlace, FirstItemActive = true, PutTabPane) {
        let ID = $("#RequestIdForms").val();
        if (isEmpty(DataFormList))
            AjaxCallAction("POST", "/api/customer/Corporate/Get_DataForms", JSON.stringify({
                PageIndex: 0,
                PageSize: 0,
                DataFormType: 2,
                SortOrder: "FormCode_A",
            }), false, function (res) {
                if (res.isSuccess) {
                    DataFormList = res.data;
                }
            }, true);
        let is_first = FirstItemActive;
        let li_option = "";
        let tabPane = "";

        for (let i = 0; i < DataFormList.length; i++) {
            if (DataFormList[i].formCode.slice(0, 1) === SubCategoryName) {
                if (is_first) {
                    li_option += "<li class='active'><a href='#FormDetailTab" + DataFormList[i].formCode + "' data-toggle='tab' aria-expanded='false' >" + DataFormList[i].formCode + "</a></li>";
                    tabPane += makeTabPane(DataFormList[i].formCode, DataFormList[i].formTitle, DataFormList[i].formId, ID, is_first);
                    is_first = false;
                } else {
                    tabPane += makeTabPane(DataFormList[i].formCode, DataFormList[i].formTitle, DataFormList[i].formId, ID, is_first);
                    li_option += "<li class=''><a href='#FormDetailTab" + DataFormList[i].formCode + "' data-toggle='tab' aria-expanded='false' >" + DataFormList[i].formCode + "</a></li>";
                }
            }
        }
        $("#" + PutPlace).append(li_option);
        $("#" + PutTabPane).append(tabPane);

        for (let i = 0; i < DataFormList.length; i++) {
            if (DataFormList[i].formCode.slice(0, 1) === SubCategoryName) {
                intiForm(DataFormList[i].formId, ID);
            }
        }
    }

    function makeDocLiAndPan(putPlace, putTabPan) {
        let ID = $("#RequestIdForms").val();
        let li_option = "";
        let tabPane = "";
        li_option += "<li class='active'><a href='#FormDocumentTabDocument287' data-toggle='tab' aria-expanded='true' >بارگذاری مدارک</a></li>";
        //li_option += "<li class='active'><a href='#FormDocumentTabDocument287' data-toggle='tab' aria-expanded='true' >سهامداران</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument288' data-toggle='tab' aria-expanded='false' >نقش ذینفعان</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument289' data-toggle='tab' aria-expanded='false' >افشاء و شفافیت</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument290' data-toggle='tab' aria-expanded='false' >هیئت مدیره</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument291' data-toggle='tab' aria-expanded='false' >اطلاعات نهایی و اشخاص وابسته</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument292' data-toggle='tab' aria-expanded='false' >صورت های مالی و حسابرسی</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument293' data-toggle='tab' aria-expanded='false' >کمیته ها</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument294' data-toggle='tab' aria-expanded='false' >سایر</a></li>";

        $("#" + putPlace).append(li_option);

        tabPane += makeDocumentTabPane("Document287", "سهامداران", ID, true);
        tabPane += makeDocumentTabPane("Document288", "نقش ذینفعان", ID, true);
        tabPane += makeDocumentTabPane("Document289", "افشاء و شفافیت", ID, true);
        tabPane += makeDocumentTabPane("Document290", "هیئت مدیره", ID, true);
        tabPane += makeDocumentTabPane("Document291", "اطلاعات نهایی و اشخاص وابسته", ID, true);
        tabPane += makeDocumentTabPane("Document292", "صورت های مالی و حسابرسی", ID, true);
        tabPane += makeDocumentTabPane("Document293", "کمیته ها", ID, true);
        tabPane += makeDocumentTabPane("Document294", "سایر", ID, true);

        $("#" + putTabPan).append(tabPane);
    }

    function makeDynamicDocumentForm(PutPlace, PutTabPane) {
        makeDocLiAndPan(PutPlace, PutTabPane);

        var DataFormDocumentList = [];
        AjaxCallAction("POST", "/api/customer/Corporate/Get_DataFormDocuments", JSON.stringify({
            PageIndex: 0,
            PageSize: 0,
            IsActive: 15,
            SortOrder: "DataFormDocumentId_A",
        }), false, function (res) {
            if (res.isSuccess) {
                DataFormDocumentList = res.data;
            }
        }, true);

        makeDocumentFile(DataFormDocumentList);
    }

    function makeDocumentFile(DataFormDocumentList, description = "") {
        let ID = $("#RequestIdForms").val();
        let _str287 = "";
        let _str288 = "";
        let _str289 = "";
        let _str290 = "";
        let _str291 = "";
        let _str292 = "";
        let _str293 = "";
        let _str294 = "";
        for (let i = 0; i < DataFormDocumentList.length; i++) {
            let title = DataFormDocumentList[i].title;
            let formId = "Doc" + DataFormDocumentList[i].dataFormDocumentId;
            let helpText = DataFormDocumentList[i].helpText;
            let isRequierd = DataFormDocumentList[i].isRequierd
            switch (DataFormDocumentList[i].categoryId) {
                case 287:
                    _str287 += makeFileInput(title, formId, helpText, ID, description, isRequierd);
                    break;
                case 288:
                    _str288 += makeFileInput(title, formId, helpText, ID, description, isRequierd);
                    break;
                case 289:
                    _str289 += makeFileInput(title, formId, helpText, ID, description, isRequierd);
                    break;
                case 290:
                    _str290 += makeFileInput(title, formId, helpText, ID, description, isRequierd);
                    break;
                case 291:
                    _str291 += makeFileInput(title, formId, helpText, ID, description, isRequierd);
                    break;
                case 292:
                    _str292 += makeFileInput(title, formId, helpText, ID, description, isRequierd);
                    break;
                case 293:
                    _str293 += makeFileInput(title, formId, helpText, ID, description, isRequierd);
                    break;
                case 294:
                    _str294 += makeFileInput(title, formId, helpText, ID, description, isRequierd);
                    break;
                default:
                    break;
            }
        }

        if (_str287 == "") {
            $("#FormDocumentDocument287").html('<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');
        } else {
            $("#FormDocumentDocument287").append(_str287);
        }

        if (_str288 == "") {
            $("#FormDocumentDocument288").html('<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');
        } else {
            $("#FormDocumentDocument288").append(_str288);
        }

        if (_str289 == "") {
            $("#FormDocumentDocument289").html('<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');
        } else {
            $("#FormDocumentDocument289").append(_str289);
        }

        if (_str290 == "") {
            $("#FormDocumentDocument290").html('<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');
        } else {
            $("#FormDocumentDocument290").append(_str290);
        }

        if (_str291 == "") {
            $("#FormDocumentDocument291").html('<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');
        } else {
            $("#FormDocumentDocument291").append(_str291);
        }

        if (_str292 == "") {
            $("#FormDocumentDocument292").html('<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');
        } else {
            $("#FormDocumentDocument292").append(_str292);
        }

        if (_str293 == "") {
            $("#FormDocumentDocument293").html('<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');
        } else {
            $("#FormDocumentDocument293").append(_str293);
        }

        if (_str294 == "") {
            $("#FormDocumentDocument294").html('<p class="text-primary text-center">سوالی برای نمایش وجود ندارد</p>');
        } else {
            $("#FormDocumentDocument294").append(_str294);
        }

        if (isEmpty(LoadedDataFromDbDocument))
            AjaxCallAction("POST", "/api/customer/Corporate/Get_DataFromAnswersDocuments", JSON.stringify({
                PageIndex: 0,
                PageSize: 0,
                FormID: null,
                RequestId: ID,
                DataFormQuestionId: null,
            }), false, function (res) {
                if (res.isSuccess) {
                    LoadedDataFromDbDocument = res.data;
                }
            }, true);
        for (let i = 0; i < LoadedDataFromDbDocument.length; i++) {
            try {
                $("#Download_" + LoadedDataFromDbDocument[i].dataFormDocumentId).prop("href", LoadedDataFromDbDocument[i].fileName1Full);
                $("#Download_" + LoadedDataFromDbDocument[i].dataFormDocumentId).css("display", "inline-block");
            } catch (e) { }
        }
    }

    function makeFileInput(inputTitle, inputName, helpText, RequestId, analaizeDescription = "", isRequierd = true) {
        let _str = "<form id='frmDoc" + inputName + "'>";
        _str += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><label class='control-label'>" + inputTitle;
        if (!isEmpty(helpText))
            _str += " <span title='" + helpText + "'><i class='fa'></i></span>";
        if (isRequierd)
            _str += "<span style='font-size: 25px;color: red;padding: 10px;'>*</span>"
        _str += "</label><input type='file' name='Result_Final_FileName1' accept='image/*,.pdf,.xlsx,' id='Inp" + inputName + "'";
        _str += "onchange=\"checkUploadWithFileSiza(this, '" + inputTitle + "' , 5);\">";
        if (userAccessSaveForm) {
            _str += '<input type="submit" value="ذخیره فایل" class="btn btn-success" ';
            _str += "onclick=\"return Web.Corporate.Save_AnswersUpload(this, 'frmDoc" + inputName + "')\">";
        }
        _str += "<a class='btn btn-primary' style='margin-right: 10px;display:none;' target='_blank' id='Download_" + inputName.slice(3, inputName.length) + "'>";
        if (analaizeDescription != "") {
            _str += "<i class='fa fa-download'></i> &nbsp;دانلود</a><br/><p style='color:blue;'> توضیحات کارشناس : " + analaizeDescription + "</p></div></div>";
        } else {
            _str += "<i class='fa fa-download'></i> &nbsp;دانلود</a></div></div>";
        }
        _str += "<input type='hidden' id='FormId' name='FormId' value='0' />";
        _str += "<input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "' />";
        _str += "<input type='hidden' id='DataFormQuestionId' name='DataFormQuestionId' value='0' />";
        _str += "<input type='hidden' id='DataFormDocumentId' name='DataFormDocumentId' value='" + inputName.slice(3, inputName.length) + "' />";
        _str += "<input type='hidden' id='IsActive' name='IsActive' value='15' /></form>";
        return _str;
    }

    function makeTabPane(FormCode, FormTitle, FormId, RequestId, FirstItemActive = true) {
        let is_first = FirstItemActive;
        let strM = "";
        if (is_first) {
            strM = "<div class='tab-pane active' id='FormDetailTab" + FormCode + "'>";
        } else {
            strM = "<div class='tab-pane' id='FormDetailTab" + FormCode + "'>";
        }
        strM += "<div style='display:flex;justify-content: space-between;align-items: center;'>";
        strM += "<h2 class='fs-title'>" + FormTitle + "</h2>";
        if (userAccessSaveForm) {
            strM += "<a class='btn btn-success changeData' style='height: 35px;' onclick='Web.Corporate.SaveSerializedForm(" + FormId + ");'>ذخیره تغییرات " + FormCode + "</a>";
        }
        strM += "</div><div style=' border: 2px solid #00c0ef; padding: 30px; border-radius: 5px; margin-bottom: 20px'><form id='frmFrom";
        strM += FormId + "' class='changeData'>";
        strM += "<input type='hidden' id='FormID' name='FormID' value='" + FormId + "' />";
        strM += "<input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "' />";
        strM += "<div class='row' id='FormDetail" + FormId + "'></div></form></div></div>";
        return strM;
    }

    function makeDocumentTabPane(FormCode, FormTitle, RequestId, FirstItemActive = true) {
        let is_first = FirstItemActive;
        let strM = "";
        if (is_first) {
            strM = "<div class='tab-pane active' id='FormDocumentTab" + FormCode + "'>";
        } else {
            strM = "<div class='tab-pane' id='FormDocumentTab" + FormCode + "'>";
        }
        strM += "<div style='display:flex;justify-content: space-between;align-items: center;'>";
        strM += "<h2 class='fs-title'>" + FormTitle + "</h2></div>";
        strM += "<div style=' border: 2px solid #00c0ef; padding: 30px; border-radius: 5px; margin-bottom: 20px'><form id='frmFrom";
        strM += FormCode + "' class='changeData'>";
        strM += "<input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "' />";
        strM += "<div class='row' id='FormDocument" + FormCode + "'></div></form></div></div>";
        return strM;
    }

    function save_AnswersUpload(el, FormName) {
        let requestId = $("#RequestIdForms").val();
        $(el).attr("disabled", "");
        let fileInp = document.getElementById(
            "Inp" + FormName.slice(6, FormName.length)
        );
        showWait();
        if (fileInp.files.length != 0) {
            AjaxCallActionPostSaveFormWithUploadFile("/api/customer/Corporate/Save_DataFromAnswersUpload", fill_AjaxCallActionPostSaveFormWithUploadFile(FormName), true,
                function (res) {
                    $(el).removeAttr("disabled");
                    if (res.isSuccess) {
                        if (res.dataId != 0)
                            // ذخیره سوال در جدول آنالیز نمره
                            AjaxCallAction("POST", "/api/customer/Corporate/Save_DataFromReport", JSON.stringify({
                                RequestId: requestId,
                                DataFormAnswerId: res.dataId,
                                SystemScore: 0,
                                AnalizeScore: 0,
                                IsActive: 15,
                            }), true,
                                function (reee) { },
                                true
                            );
                        $("#Download_" + FormName.slice(9, FormName.length)).prop("href", res.data.fileName1Full);
                        $("#Download_" + FormName.slice(9, FormName.length)).css("display", "inline-block");
                        hideWait();
                        alertB("ثبت", "اطلاعات ثبت شد", "success");
                    } else {
                        alertB("خطا", "ذخیره موفقیت آمیز نبود مجددا تلاش فرماید", "error");
                    }
                },
                true
            );
        } else {
            hideWait();
            alertB("خطا", "ابتدا فایل را انتخاب نمایید!", "error");
            $(el).removeAttr("disabled");
        }
        hideWait();
        return false;
    }

    function saveSerializedForm(FormId) {
        showWait();
        let SerializerForm = $("#frmFrom" + FormId).serializeArray();
        let formId = SerializerForm[0]["value"];
        let SerializerAnswers = SerializerForm.slice(2, SerializerForm.length);
        let list_of_answer = SerializerAnswers.filter(s => s.name.startsWith("Q_"))
        let list_of_description = SerializerAnswers.filter(s => s.name.startsWith("Description_"))
        let counter = SerializerAnswers.length;

        if (list_of_answer.length == list_of_description.length) {
            for (let i = 0; i < counter && counter % 2 == 0; i += 2) {
                let SingleQuestion = SerializerAnswers.slice(0, 2);
                let question_id = SingleQuestion[0]["name"].split("_")[1];
                let answer = SingleQuestion[0]["value"];
                let description = SingleQuestion[1]["value"];

                SerializerAnswers = SerializerAnswers.slice(2, SerializerAnswers.length);

                if (!isEmpty(answer) && answer != "0") {
                    saveSingelAnswerForm(formId, answer, description, question_id);
                }
            }
        }
        else {
            alertB("خطا", "ابتدا به همه سوالات این صفحه پاسخ داده سپس اقدام به ذخیره سازی فرم نمایید", "error", "بله متوجه شدم", function () { });
        }
        hideWait();
    }

    function saveSingelAnswerForm(formId = "0", answer = "0", description = "", dataFormQuestionId = "0", fileName = "") {
        var requestId = $("#RequestId").val();
        var dataFormQuestionScore = 0;
        
        AjaxCallAction("POST", "/api/customer/Corporate/Save_DataFromAnswers",
            JSON.stringify({
                Answer: answer,
                Description: description,
                FormId: parseInt(formId),
                RequestId: parseInt(requestId),
                DataFormQuestionId: parseInt(dataFormQuestionId),
                FileName1: fileName,
                IsActive: 15,
            }), false, function (res) {
                if (res.isSuccess) {
                    if (dataFormQuestionId != 0 || dataFormQuestionId != "0") {
                        // سوال رو دریافت کردم تا نمره مربوط به اون رو داشته باشم
                        AjaxCallAction("GET", "/api/customer/Corporate/Get_DataFormQuestions/" + dataFormQuestionId, null, false,
                            function (res1) {
                                if (!isEmpty(res1)) {
                                    dataFormQuestionScore = res1.score;
                                    if (res1.questionType == "select") {
                                        AjaxCallAction("GET", "/api/customer/Corporate/Get_Option/" + answer.split("_")[0], null, false,
                                            function (datares) {
                                                if (!isEmpty(datares)) {
                                                    dataFormQuestionScore =
                                                        dataFormQuestionScore * datares.ratio;
                                                }
                                            }, false);
                                    }
                                    // اگر با موفقیت پاسخ ذخیره شد
                                    if (res.dataId != 0)
                                        // ذخیره سوال در جدول آنالیز نمره
                                        AjaxCallAction("POST", "/api/customer/Corporate/Save_DataFromReport",
                                            JSON.stringify({
                                                RequestId: requestId,
                                                DataFormAnswerId: res.dataId,
                                                SystemScore: dataFormQuestionScore,
                                                AnalizeScore: 0,
                                                IsActive: 15,
                                            }), false, function (reee) { }, false);
                                }
                            }, false);
                    }

                    alertB("ثبت", res.message, "success");
                } else {
                    alertB("خطا", res.message, "error");
                }
        }, true);
        
    }


    function initReferral(id = null, is_check = true) {
        AjaxCallAction("GET", "/api/Customer/RequestForRating/InitReferral/" + id, null, true, function (res) {
            if (res.isSuccess) {

                $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(id.toString(), keyMaker()));
                $("#sdklsslks3498sjdkxhjsd_823sdel").val(res.data[0].sendUser);
                var htmlB = "";
                for (var i = 0; i < res.data.length; i++) {
                    if ((res.data[0].levelStepIndex == 105 || res.data[0].levelStepIndex == 106) && res.data[0].levelStepAccessRole == 12) {
                        htmlB += "<button type='button' id='btnreq' style='margin:5px' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.Corporate.CheckAnswerToAllQuestion(this, " + is_check + ");'" + "data-SIndex='" + res.data[i].levelStepSettingIndexId + "' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "' data-SC='" + encrypt(res.data[i].smsContent, keyMaker()) + "' data-ST='" + res.data[i].smsType + "' data-DLSIB='" + encrypt(res.data[i].destLevelStepIndexButton, keyMaker()) + "'>" + res.data[i].destLevelStepIndexButton + "</button>";

                    }
                }
                $("#bLLSS").html(htmlB);
                $("#sdfcddf").val(1);

            } else {
                $("#EndCorporateInfo").html("اطلاعات شما برای پارس کیان جهت بررسی و ارزیابی ارسال شده است و قابل ویرایش نمی باشد.");
            }


        }, true);
    }

    function checkAnswerToAllQuestion(el, is_check = true) {
        if (is_check == true) {
            let countOfQuestion = 0;
            let countOfAnswer = 0;
            showWait();
            AjaxCallAction("POST", "/api/customer/Corporate/Get_DataFromAnswerss", JSON.stringify({
                PageIndex: 0,
                PageSize: 0,
                IsActive: 15,
                RequestId: $("#RequestIdForms").val(),
            }), false, function (res) {
                if (res.isSuccess) {
                    countOfAnswer = res.data.length;
                }
            }, false);

            AjaxCallAction("POST", "/api/customer/Corporate/Get_DataFormQuestionss", JSON.stringify({
                PageIndex: 0,
                PageSize: 0,
                IsActive: 15,
                DataFormType: 2,
                Version: VersionQuestion,
            }), false, function (res) {
                countOfQuestion = res.data.length;
            }, false);

            if (countOfAnswer == countOfQuestion) {
                Web.RequestForRating.SaveReferralRequestForRating(el)
            }
            else {
                hideWait();
                alertB("خطا", "ابتدا باید به همه سوالات پاسخ بدهید سپس اقدام به ذخیره سازی نمایید", "error", "بله متوجه شدم", function () { });
            }
        }
        else {
            Web.RequestForRating.SaveReferralRequestForRating(el)
        }
    }

    function initCorporateScore(id) {
        let sum_score = 0;
        let all_score = 0;

        AjaxCallAction("POST", "/api/customer/Corporate/Get_DataFormQuestionss", JSON.stringify({
            PageIndex: 0,
            PageSize: 0,
            IsActive: 15,
            DataFormType: 2,
            Version: VersionQuestion,
        }), false, function (res) {
            for (let i = 0; i < res.data.length; i++){
                all_score += res.data[i].score;
            }
        }, false);

        AjaxCallAction("POST", "/api/customer/Corporate/Get_DataFormReports", JSON.stringify({
            PageIndex: 0,
            PageSize: 0,
            IsActive: 15,
            RequestId: id
        }), false, function (res) {
            if (res.isSuccess) {
                console.log(res)
                for (let i = 0; i < res.data.length; i++) {
                    sum_score += res.data[i].analizeScore;
                }
            }
        }, true);
        $("#msform").html('<p>نمره نهایی شما برابر است با ' + sum_score + ' از ' + all_score + ' نمره</p>')
        getDocumentScore(id);
    }

    //function getDocument(id = null) {
    //    if (!isEmpty(id) && id != 0) {

    //        AjaxCallAction("GET", "/api/Customer/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

    //            if (res.isSuccess) {
    //                $("#FinancialID").val(res.data.financialId);
    //                $("#RequestID").val(res.data.requestID);
    //                if ((res.data.committeeEvaluationFile != null && res.data.committeeEvaluationFile != "") || res.data.confirmCommitteeEvaluation === "True") {
    //                    $("#frmFormMain2").remove();
    //                    $("#frmFormMain4").remove();
    //                } else {
    //                    $("#ConfirmCommitteeEvaluation").val(res.data.confirmCommitteeEvaluation);
    //                }
    //                if (getlstor("loginName") === "8") {
    //                    $("#EvaluationFile").val(res.data.evaluationFile);
    //                }
    //                if (getlstor("loginName") === "6") {
    //                    $("div.result").remove();
    //                }


    //                if (res.data.financialDocument != null && res.data.financialDocument != "") {
    //                    $("#divDownloadFinancialDocument").html("<a class='btn btn-success' href='" + res.data.financialDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
    //                } else {
    //                    $("#divDownloadFinancialDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
    //                }
    //                if (res.data.financialDocument2 != null && res.data.financialDocument2 != "") {
    //                    $("#divDownloadFinancialDocument2").html("<a class='btn btn-success' href='" + res.data.financialDocument2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
    //                } else {
    //                    $("#divDownloadFinancialDocument2").html("<p style='color:silver'>فایلی وجود ندارد</p>");
    //                }
    //                if (res.data.contractDocument != null && res.data.contractDocument != "") {
    //                    $("#divDownload_ContractDocument").html("<a class='btn btn-success' href='" + res.data.contractDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
    //                } else {
    //                    $("#divDownload_ContractDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
    //                }
    //                if (res.data.evaluationFile != null && res.data.evaluationFile != "") {
    //                    $("#divDownload_EvaluationFile").html("<a class='btn btn-success' href='" + res.data.evaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
    //                } else {
    //                    $("#divDownload_EvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
    //                }
    //                if (res.data.committeeEvaluationFile != null && res.data.committeeEvaluationFile != "") {
    //                    $("#divDownload_CommitteeEvaluationFile").html("<a class='btn btn-success' href='" + res.data.committeeEvaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
    //                } else {
    //                    $("#divDownload_CommitteeEvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
    //                }
    //                if (res.data.lastFinancialDocument != null && res.data.lastFinancialDocument != "") {
    //                    $("#divDownload_LastFinancialDocument").html("<a class='btn btn-success' href='" + res.data.lastFinancialDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
    //                } else {
    //                    $("#divDownload_LastFinancialDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
    //                }
    //                if (res.data.leaderEvaluationFile != null && res.data.leaderEvaluationFile != "") {
    //                    $("#divDownload_LeaderEvaluationFile").html("<a class='btn btn-success' href='" + res.data.leaderEvaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
    //                } else {
    //                    $("#divDownload_LeaderEvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
    //                }
    //            }

    //        }, true);
    //    }
    //}

    function getDocumentScore(id = null) {
        if (!isEmpty(id) && id != 0) {

            if (!isEmpty(id) && id != 0) {

                AjaxCallAction("GET", "/api/customer/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                    if (res.isSuccess) {
                        if (res.data.evaluationFile != null && res.data.evaluationFile != "")
                        {
                        $("#divDownload_EvaluationFile").html("<a class='btn btn-success' href='" + res.data.evaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else
                        {
                        $("#divDownload_EvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                        }
                    }

                }, true);
            }


          
        }
    }


    web.Corporate = {
        IntiForm: intiForm,
        InitCorporate: initCorporate,
        InitCustomer: initCustomer,
        Combo: combo,
        MakeDynamicForm: makeDynamicForm,
        MakeDynamicDocumentForm: makeDynamicDocumentForm,
        SaveSerializedForm: saveSerializedForm,
        Save_AnswersUpload: save_AnswersUpload,
        InitReferral: initReferral,
        InitCorporateScore: initCorporateScore,
        CheckAnswerToAllQuestion: checkAnswerToAllQuestion,
        GetDocumentScore: getDocumentScore
    };
})(Web, jQuery);







(function (web, $) {


    function systemSeting_Combo(parentCodeArr = null, labelCode = null, ComboName = "") {

        AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: parentCodeArr, LabeCode: labelCode , PageIndex: 0, PageSize:0 }), true, function (res) {

            if (res.isSuccess) {
                var strM = '<option value="">انتخاب کنید</option>';
                for (var i = 0; i < res.data.length; i++) {

                    strM += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].value + "</option>";
                }
                $("#" + ComboName).html(strM);
        }
        }, true);
}


   
    web.SystemSeting = {       
        SystemSeting_Combo: systemSeting_Combo
    };

})(Web, jQuery);

(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    var current_fs, next_fs, previous_fs; //fieldsets
    var opacity;

    $(".next").click(function () {

        var countform = Number($("#FormLoadCode").val()) + 1;
        $("#FormLoadCode").val(countform);
        intiTab(countform);

        current_fs = $(this).parent();
        next_fs = $(this).parent().next();

        //Add Class Active
        $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

        //show the next fieldset
        next_fs.show();
        //hide the current fieldset with style
        current_fs.animate({ opacity: 0 }, {
            step: function (now) {
                // for making fielset appear animation
                opacity = 1 - now;

                current_fs.css({
                    'display': 'none',
                    'position': 'relative'
                });
                next_fs.css({ 'opacity': opacity });
            },
            duration: 600
        });
    });

    

    $(".previous").click(function () {

        var countform = Number($("#FormLoadCode").val()) - 1;
        $("#FormLoadCode").val(countform);

        current_fs = $(this).parent();
        previous_fs = $(this).parent().prev();

        //Remove class active
        $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

        //show the previous fieldset
        previous_fs.show();

        //hide the current fieldset with style
        current_fs.animate({ opacity: 0 }, {
            step: function (now) {
                // for making fielset appear animation
                opacity = 1 - now;

                current_fs.css({
                    'display': 'none',
                    'position': 'relative'
                });
                previous_fs.css({ 'opacity': opacity });
            },
            duration: 600
        });
    });

    $('.radio-group .radio').click(function () {
        $(this).parent().find('.radio').removeClass('selected');
        $(this).addClass('selected');
    });

    $(".submit").click(function () {
        return false;
    });



    function intiTab(TabId = null) {
        var ID = $("#RequestIdForms").val();
        
        switch (TabId) {
            case 1:
                intiFormShow(1, "1,2,7,8", ID);
                getFurtherInfo(ID);
                intiFormShow(26, '1,2,3,4,11,12', ID);
                
                break;
            case 2:
                intiFormShow(3, "1,3,11", ID);
                
                break;
            case 3:
                getCorporateGovernance(ID);
                intiFormShow(16, "1,2,3", ID);
                intiFormShow(17, "1,2,3", ID);
               
                break;
            case 4:
                intiForm(11);
                intiFormSingelAnswer(11, ID);
               
                break;
            case 5:
                intiFormShow(13, "1,2,3,11", ID);
              
                break;
            case 7:
                getValueChain(ID);
                //intiFormQuestion(7, "D");
                //intiFormSingelAnswer(7, ID);
                //intiFormQuestion(18, "D");
                //intiFormSingelAnswer(18, ID);
                //intiFormQuestion(19, "D");
                //intiFormSingelAnswer(18, ID);
                //intiFormQuestion(20, "D");
                //intiFormSingelAnswer(20, ID);
                
            case 9:
                intiFormShow(9, '1,2,11', ID);
                intiFormShow(10, '1,11', ID);
                
                break;
            case 14:

                //intiForm(14);
                //intiFormSingelAnswer(14, ID);
                getPublicActivities(ID);
                intiFormShow(15, '1,2,11', ID);
                intiFormShow(22, '1,11', ID);
                intiFormShow(24, '1,11', ID);
               
                break;

        }

    }

    function systemSeting_Combo(FormId = null) {

        if (FormId == 1 || FormId == 3 || FormId == 16 || FormId == 9 || FormId == 13) {
            var PC = '';
            switch (FormId) {
                case 1:
                    PC = '9,20,30,125';
                    break;
                case 3:
                    PC = '250';
                    break;
                case 16:
                    PC = '9';
                    break;
                case 9:
                    PC = '9';
                    break;
               
            }

            AjaxCallAction("POST", "/api/customer/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: PC, PageIndex: 0, PageSize: 0 }), true, function (res) {

                if (res.isSuccess) {
                    if (FormId == 1) {
                        var strMemberPostID = '<option value="">انتخاب کنید</option>';
                        var strMemberEductionID = '<option value="">انتخاب کنید</option>';
                        var strUniversityID = '<option value="">انتخاب کنید</option>';
                        var strCompanyDocument = 'option value="">انتخاب کنید</option>';

                        for (var i = 0; i < res.data.length; i++) {
                            if (res.data[i].parentCode == 9) {
                                strMemberEductionID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                            } else if (res.data[i].parentCode == 20) {
                                strUniversityID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                            }

                        }
                        $("#MemberEductionID").html(strMemberEductionID);
                        $("#UniversityID").html(strUniversityID);
                        $("#CompanyDocument").html(strCompanyDocument);

                    }
                    else if (FormId == 3) {
                        var strIsGuideLineOrProcess = '<option value="">انتخاب کنید</option>';

                        for (var i = 0; i < res.data.length; i++) {
                            strIsGuideLineOrProcess += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                        }

                        $("#IsGuideLineOrProcess").html(strIsGuideLineOrProcess);

                    }
                    else if (FormId == 16 || FormId == 9) {
                        var strDegreeOfEducation = strDegreeOfEducation2 = '<option value="">انتخاب کنید</option>';

                        for (var i = 0; i < res.data.length; i++) {
                            strDegreeOfEducation += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                        }

                        $("#DegreeOfEducation").html(strDegreeOfEducation);
                        $("#DegreeOfEducation2").html(strDegreeOfEducation);
                    }
                   
                }
            }, true);

            ComboBoxWithSearch('.select2', 'rtl');
        }
    }

    //function getCustomer() {

    //    AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {
    //        if (res != null) {               
    //            $("#CanSeeFurtherInfo").val(res.tel);
    //        }
    //    }, true);
    //}

    function initFurtherInfo(id = null) {
        PersianDatePicker(".DatePicker");
        $("#RequestIdForms").val(id);
        initReferral(id);        
        intiTab(1);
        initCustomer();
    }

    function intiFormShow(Id = null, Columns = null, RequestId = null) {

        intiForm(Id, RequestId);
        intiFormAnswer(Id, Columns, RequestId);


    }


    function intiForm(FormID = null, RequestId = null) {

        //AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

        //    if (res.isSuccess) {

        //        var strFormId = '';
        //        var Filename = 1;
        //        for (var i = 0; i < res.data.length; i++) {
        //            if (i == 0) {
        //                strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";
        //            }

        //            if (i == 0) {
        //                strFormId += "<div class='col-lg-6'>";
        //            } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
        //                strFormId += "</div><div class='col-lg-6'>";
        //            }

        //            strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
        //            if (res.data[i].questionType == 'select') {
        //                strFormId += "<select name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control select2' ></select>";
        //            } else if (res.data[i].questionType == 'textarea') {
        //                strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
        //            }
        //            else if (res.data[i].questionType == 'checkbox') {
        //                strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
        //            } else if (res.data[i].questionType == 'file') {
        //                strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";
        //                Filename++;
        //            }

        //            else {
        //                strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
        //            }
        //            strFormId += "</div>";
        //            strFormId += "</div>";
        //            if (i == res.data.length && res.data.length > 1) {
        //                strFormId += "</div>";
        //            }
        //        }
        //        $("#FormDetail" + FormID).html(strFormId);
           systemSeting_Combo(FormID);
        //    }
        //}, true);
    }

    function intiFormQrid(FormID = null, Name = null, RequestId = null) {

        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var strFormId = '';
                var Filename = 1;

                for (var i = 0; i < res.data.length; i++) {

                    if (i == 0) {
                        strFormId += "<div class='col-lg-6'>";
                    } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
                        strFormId += "</div><div class='col-lg-6'>";
                    }

                    strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><form id='frmFrom" + Name + (i) + "'> <input type='hidden' id='FormID' name='FormID' value='" + FormID + "' />";
                    strFormId += "<input type='hidden' id='DataFormQuestionID' name='DataFormQuestionID' value='" + res.data[i].dataFormQuestionId + "' />";

                    strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";


                    strFormId += "<label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
                    if (res.data[i].questionType == 'select') {
                        strFormId += "<select name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control select2' ></select>";
                    } else if (res.data[i].questionType == 'textarea') {
                        strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
                    }
                    else if (res.data[i].questionType == 'checkbox') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
                    } else if (res.data[i].questionType == 'file') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";

                    }

                    else {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
                    }
                    strFormId += "<button title='ثبت' class='btn btn-default fontForAllPage' type='button' onclick='Web.FurtherInfo.SavesingleForm(this," + '"' + Name + (i) + '"' + ")'> ثبت </button ></form>";

                    strFormId += "</div>";
                    strFormId += "</div>";
                    if (i == res.data.length && res.data.length > 1) {
                        strFormId += "</div>";
                    }


                }
                $("#FormDetail" + FormID).html(strFormId);
                systemSeting_Combo(FormID);
            }
        }, true);
    }

    function getCorporateGovernance(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/FurtherInfo/Get_CorporateGovernances/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    $("#CorporateGovernanceId").val(res.data.corporateGovernanceId);
                    $("#RequestId").val(res.data.requestId);
                    $("#CompanyWebSite").val(res.data.companyWebSite);
                    $("#HighProductKnowledge").val(res.data.highProductKnowledge);
                    $("#HaveRepresentativeStr").prop("checked", res.data.haveRepresentative);
                   // $("#HaveRepresentative").val(res.data.haveRepresentative);
                    $("#HaveAuditCommitteeStr").prop("checked",res.data.haveAuditCommittee);
                   
                    if (res.data.organazationChart != null && res.data.organazationChart != "") {
                        $("#DivOrganazationChart").html("<a class='btn btn-info' href='" + res.data.organazationChartFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.organizationalDuties != null && res.data.organizationalDuties != "") {
                        $("#DivOrganizationalDuties").html("<a class='btn btn-info' href='" + res.data.organizationalDutiesFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.riskManagementGuidelines != null && res.data.riskManagementGuidelines != "") {
                        $("#DivRiskManagementGuidelines").html("<a class='btn btn-info' href='" + res.data.riskManagementGuidelinesFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.transactionRegulations != null && res.data.transactionRegulations != "") {
                        $("#DivTransactionRegulations").html("<a class='btn btn-info' href='" + res.data.transactionRegulationsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.deductionTaxAccount != null && res.data.deductionTaxAccount != "") {
                        $("#DivDeductionTaxAccount").html("<a class='btn btn-info' href='" + res.data.deductionTaxAccountFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.crmSoftwareContract != null && res.data.crmSoftwareContract != "") {
                        $("#DivCrmSoftwareContract").html("<a class='btn btn-info' href='" + res.data.crmSoftwareContractFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.crmSoftwareContract != null && res.data.crmSoftwareContract != "") {
                        $("#DivCrmSoftwareContract").html("<a class='btn btn-info' href='" + res.data.crmSoftwareContractFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.representativeFile != null && res.data.representativeFile != "") {
                        $("#DivRepresentativeFile").html("<a class='btn btn-info' href='" + res.data.representativeFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.letterOfCommendation != null && res.data.letterOfCommendation != "") {
                        $("#DivLetterOfCommendation").html("<a class='btn btn-info' href='" + res.data.letterOfCommendationFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.proceedings != null && res.data.proceedings != "") {
                        $("#DivProceedings").html("<a class='btn btn-info' href='" + res.data.proceedingsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.inovationFile != null && res.data.inovationFile != "") {
                        $("#DivInovationFile").html("<a class='btn btn-info' href='" + res.data.inovationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    
                }

            }, true);
        }
    }

    function getValueChain(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/FurtherInfo/Get_ValueChain/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    $("#ValueChainId").val(res.data.valueChainId);
                    $("#ValueChainId1").val(res.data.valueChainId);
                    $("#ValueChainId2").val(res.data.valueChainId);
                    $("#ValueChainId3").val(res.data.valueChainId);
                    $("#RequestId").val(res.data.requestId);
                   

                    if (res.data.vc1 != null && res.data.vc1 != "") {
                        $("#DivVc1").html("<a class='btn btn-info' href='" + res.data.vc1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc2 != null && res.data.vc2 != "") {
                        $("#DivVc2").html("<a class='btn btn-info' href='" + res.data.vc2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc3 != null && res.data.vc3 != "") {
                        $("#DivVc3").html("<a class='btn btn-info' href='" + res.data.vc3Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc4 != null && res.data.vc4 != "") {
                        $("#DivVc4").html("<a class='btn btn-info' href='" + res.data.vc4Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc4 != null && res.data.vc4 != "") {
                        $("#DivVc4").html("<a class='btn btn-info' href='" + res.data.vc4Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc5 != null && res.data.vc5 != "") {
                        $("#DivVc5").html("<a class='btn btn-info' href='" + res.data.vc5Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc6 != null && res.data.vc6 != "") {
                        $("#DivVc6").html("<a class='btn btn-info' href='" + res.data.vc6Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc7 != null && res.data.vc7 != "") {
                        $("#DivVc7").html("<a class='btn btn-info' href='" + res.data.vc7Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc8 != null && res.data.vc8 != "") {
                        $("#DivVc8").html("<a class='btn btn-info' href='" + res.data.vc8Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc9 != null && res.data.vc9 != "") {
                        $("#DivVc9").html("<a class='btn btn-info' href='" + res.data.vc9Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc10 != null && res.data.vc10 != "") {
                        $("#DivVc10").html("<a class='btn btn-info' href='" + res.data.vc10Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc11 != null && res.data.vc11 != "") {
                        $("#DivVc11").html("<a class='btn btn-info' href='" + res.data.vc11Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc12 != null && res.data.vc12 != "") {
                        $("#DivVc12").html("<a class='btn btn-info' href='" + res.data.vc12Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc13 != null && res.data.vc13 != "") {
                        $("#DivVc13").html("<a class='btn btn-info' href='" + res.data.vc13Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc14 != null && res.data.vc14 != "") {
                        $("#DivVc14").html("<a class='btn btn-info' href='" + res.data.vc14Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc15 != null && res.data.vc15 != "") {
                        $("#DivVc15").html("<a class='btn btn-info' href='" + res.data.vc15Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc16 != null && res.data.vc16 != "") {
                        $("#DivVc16").html("<a class='btn btn-info' href='" + res.data.vc16Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc17 != null && res.data.vc17 != "") {
                        $("#DivVc17").html("<a class='btn btn-info' href='" + res.data.vc17Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc18 != null && res.data.vc18 != "") {
                        $("#DivVc18").html("<a class='btn btn-info' href='" + res.data.vc18Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc19 != null && res.data.vc19 != "") {
                        $("#DivVc19").html("<a class='btn btn-info' href='" + res.data.vc19Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc20 != null && res.data.vc20 != "") {
                        $("#DivVc20").html("<a class='btn btn-info' href='" + res.data.vc20Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc21 != null && res.data.vc21 != "") {
                        $("#DivVc21").html("<a class='btn btn-info' href='" + res.data.vc21Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc22 != null && res.data.vc22 != "") {
                        $("#DivVc22").html("<a class='btn btn-info' href='" + res.data.vc22Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc23 != null && res.data.vc23 != "") {
                        $("#DivVc23").html("<a class='btn btn-info' href='" + res.data.vc23Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc24 != null && res.data.vc24 != "") {
                        $("#DivVc24").html("<a class='btn btn-info' href='" + res.data.vc24Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc25 != null && res.data.vc25!= "") {
                        $("#DivVc25").html("<a class='btn btn-info' href='" + res.data.vc25Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                }

            }, true);
        }
    }



    function getFurtherInfo(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/FurtherInfo/Get_FurtherInfo/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#FurtherInfoId").val(res.data.furtherInfoId);

                    if (res.data.lastAuditingTaxList != null && res.data.lastAuditingTaxList != "") {
                        $("#divDownloadLastAuditingTaxList").html(GetFullFilePath(res.data.lastAuditingTaxListFull));
                    }
                    if (res.data.statementTaxList != null && res.data.statementTaxList != "") {
                        $("#divDownloadStatementTaxList").html(GetFullFilePath(res.data.statementTaxListFull));
                    }
                    if (res.data.lastChangeOfficialNewspaper != null && res.data.lastChangeOfficialNewspaper != "") {
                        $("#divDownloadLastChangeOfficialNewspaper").html(GetFullFilePath(res.data.lastChangeOfficialNewspaperFull));
                    }
                    if (res.data.statuteDoc != null && res.data.statuteDoc != "") {
                        $("#divDownloadStatuteDoc").html(GetFullFilePath(res.data.statuteDocFull));
                    }
                    if (res.data.officialNewspaper != null && res.data.officialNewspaper != "") {
                        $("#divDownloadOfficialNewspaper").html(GetFullFilePath(res.data.officialNewspaperFull));
                    }
                }

            }, true);
        }
    }


    function getPublicActivities(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/customer/FurtherInfo/Get_PublicActivities/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#IsPublicActivityFileStr").prop("checked", res.data.isPublicActivityFile);
                    $("#Investment").val(res.data.investment);
                    $("#EmploymentDisabled").val(res.data.employmentDisabled);
                    $("#PublicActivitiesID").val(res.data.publicActivitiesID);
                   
                }

            }, true);
        }
    }

    function intiFormQuestion(FormID = null, Name = null, RequestId = null) {

        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var strFormId = '';
                var Filename = 1;

                for (var i = 0; i < res.data.length; i++) {

                    if (i == 0) {
                        strFormId += "<div class='col-lg-6'>";
                    } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
                        strFormId += "</div><div class='col-lg-6'>";
                    }

                    strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><form id='frmFrom" + Name + (i) + "'> <input type='hidden' id='FormID' name='FormID' value='" + FormID + "' />";
                    strFormId += "<input type='hidden' id='DataFormQuestionID' name='DataFormQuestionID' value='" + res.data[i].dataFormQuestionId + "' />";

                    strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";


                    strFormId += "<label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
                    if (res.data[i].questionType == 'select') {
                        strFormId += "<select name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control select2' ></select>";
                    } else if (res.data[i].questionType == 'textarea') {
                        strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
                    }
                    else if (res.data[i].questionType == 'checkbox') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
                    } else if (res.data[i].questionType == 'file') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";

                    }

                    else {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
                    }
                    strFormId += "<button title='ثبت' class='btn btn-default fontForAllPage' type='button' onclick='Web.FurtherInfo.SavesingleForm(this," + '"' + Name + (i) + '"' + ")'> ثبت </button ></form>";

                    strFormId += "</div>";
                    strFormId += "</div>";
                    if (i == res.data.length && res.data.length > 1) {
                        strFormId += "</div>";
                    }


                }
                $("#FormDetail" + FormID).html(strFormId);
                systemSeting_Combo(FormID);
            }
        }, true);
    }

    function intiFormSingelAnswer(FormID = null, Id = null) {
        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFromAnswerss", JSON.stringify({ FormId: FormID, RequestId: Id, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                if (FormID == 14) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 87:
                                $("#IsPublicActivityFile").prop("checked", res.data[i].answer == "false" ? false : true);
                                break;
                            case 91:
                                $("#Investment").val(res.data[i].answer);
                                break;
                            case 94:
                                $("#EmploymentDisabled").val(res.data[i].answer);
                                break;
                        }
                    }

                }
                if (FormID == 11) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 79:
                                if (res.data[i].fileName != "" && res.data[i].fileName!=null) {
                                    $("#DivHumanResourcesFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivHumanResourcesFile").html("");
                                }
                                break;
                        }
                    }

                }
                if (FormID == 7) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 47:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1!=null) {
                                    $("#DivVc1").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc1").html("");
                                }
                                break;
                            case 48:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc2").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc2").html("");
                                }
                                break;
                            case 49:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc3").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc3").html("");
                                }
                                break;
                            case 50:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc4").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc4").html("");
                                }
                                break;

                        }
                    }

                }
                if (FormID == 18) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 51:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc5").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc5").html("");
                                }
                                break;
                            case 52:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc6").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc6").html("");
                                }
                                break;
                            case 53:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc7").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc7").html("");
                                }
                                break;
                            case 54:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc8").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc8").html("");
                                }
                                break;
                            case 55:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc9").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc9").html("");
                                }
                                break;
                            case 56:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc10").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc10").html("");
                                }
                                 break;
                            case 57:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc11").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc11").html("");
                                }
                                break;
                            case 58:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc12").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc12").html("");
                                }
                                break;

                        }
                    }

                }
                if (FormID == 19) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 59:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc13").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc13").html("");
                                }
                                break;
                            case 60:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc14").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc14").html("");
                                }
                                break;
                            case 61:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc15").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc15").html("");
                                }
                                break;
                            case 62:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc16").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc16").html("");
                                }
                                break;
                            case 63:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc17").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc17").html("");
                                }
                                break;
                            case 64:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc18").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc18").html("");
                                }
                                break;
                            case 65:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc19").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc19").html("");
                                }
                                break;
                            case 66:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc20").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc20").html("");
                                }
                               break;
                            case 67:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc21").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc21").html("");
                                }
                                break;

                        }
                    }

                }
                if (FormID == 20) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 68:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc22").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc22").html("");
                                }
                                 break;
                            case 69:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc23").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc23").html("");
                                }
                               break;
                            case 70:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc24").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc24").html("");
                                }
                                break;
                            case 71:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc25").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc25").html("");
                                }
                                break;
                        }
                    }

                }
                if (FormID == 25) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 28:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivOrganazationChart").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivOrganazationChart").html("");
                                }
                                break;
                            case 29:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivOrganizationalDuties").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivOrganizationalDuties").html("");
                                }
                                //  $("#DivOrganizationalDuties").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 30:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivRiskManagementGuidelines").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivRiskManagementGuidelines").html("");
                                }
                                break;
                            case 31:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivTransactionRegulations").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivTransactionRegulations").html("");
                                }
                               break;
                            case 31:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivTransactionRegulations").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                break;
                            case 32:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivDeductionTaxAccount").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivDeductionTaxAccount").html("");
                                }
                               break;
                            case 33:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivCrmSoftwareContract").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivCrmSoftwareContract").html("");
                                }
                                break;
                            case 35:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivRepresentativeFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivRepresentativeFile").html("");
                                }
                                break;
                            case 36:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivletterOfCommendation").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivletterOfCommendation").html("");
                                }
                                break;
                            case 37:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivInovationFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivInovationFile").html("");
                                }
                                break;
                            case 40:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivProceedings").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivProceedings").html("");
                                }
                                 break;
                            //
                        }
                    }

                }
                if (FormID == 2) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 97:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivLastAuditingTaxList").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivLastAuditingTaxList").html("");
                                }
                                // $("#DivLastAuditingTaxList").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 98:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivLastChangeOfficialNewspaper").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                } else {
                                    $("#DivLastChangeOfficialNewspaper").html("");
                                }
                                // $("#DivLastChangeOfficialNewspaper").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 99:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivstatuteDoc").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                } else {
                                    $("#DivstatuteDoc").html("");
                                }
                                // $("#DivstatuteDoc").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 100:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivOfficialNewspaper").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                } else {
                                    $("#DivOfficialNewspaper").html("");
                                }
                                // $("#DivOfficialNewspaper").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;

                        }
                    }

                }
            }

        }, true);
    }

    function intiFormAnswer(FormID = null, ColumNum = null, RequestId = null) {

        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormAnswerTabless", JSON.stringify({ FormId: FormID, RequestId: RequestId, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var separatedArray = ColumNum.split(',');
                let strFormAnswer = '';
                for (let i = 0; i < res.data.length; i++) {

                    strFormAnswer += "<tr><td>" + (i + 1) + "</td><td>";

                    for (var j = 0; j < separatedArray.length; j++) {

                        switch (separatedArray[j]) {
                            case "1":
                                strFormAnswer += res.data[i].answer1 + "</td><td>";
                                break;
                            case "2":
                                strFormAnswer += res.data[i].answer2 + "</td><td>";
                                break;
                            case "3":
                                strFormAnswer += res.data[i].answer3 + "</td><td>";
                                break;
                            case "4":
                                strFormAnswer += res.data[i].answer4 + "</td><td>";
                                break;
                            case "5":
                                strFormAnswer += res.data[i].answer5 + "</td><td>";
                                break;
                            case "6":
                                strFormAnswer += res.data[i].answer6 + "</td><td>";
                                break;
                            case "7":
                                strFormAnswer += res.data[i].answer7 + "</td><td>";
                                break;
                            case "8":
                                strFormAnswer += res.data[i].answer8 + "</td><td>";
                                break;
                            case "9":
                                strFormAnswer += res.data[i].answer6 + "</td><td>";
                                break;
                            case "10":
                                strFormAnswer += res.data[i].answer6 + "</td><td>";
                                break;
                            case "11":
                               
                                strFormAnswer += ((res.data[i].fileName1 != null && res.data[i].fileName1 !="") ? "<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>" : "") + "</td><td>";
                              
                                break;
                            case "12":
                                strFormAnswer += ((res.data[i].fileName2 != null && res.data[i].fileName1 != "")? "<a href='" + res.data[i].fileName2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>" : "") + "</td><td>";
                              break;
                        }
                    }

                    strFormAnswer += "<button title='ویرایش' class='btn btn-warring fontForAllPage' type='button' onclick='Web.FurtherInfo.GetFormAnswer(" + FormID + "," + res.data[i].answerTableId + ")' ><i class='fa fa-edit'></i></button>";
                    if ($("#sdfcddf").val()=="1") {
                        strFormAnswer += "<button style='margin-right:5px' type='button' title='حذف' class='btn btn-warrnig fontForAllPage changeData' onclick='Web.FurtherInfo.Delete_DataFormAnswerTables(" + FormID + ',"' + ColumNum + '",' + res.data[i].answerTableId + ");'><i class='fa fa-remove'></i></button>";
                    }
                    strFormAnswer += "</td></tr>";
                }
                $("#FormDetailAnswer" + FormID).html(strFormAnswer);
            }
        }, true);
    }

    function getFormAnswer(FormID = null, AnswerTableId = null) {
        var RequestId = $("#RequestIdForms").val();

        AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormAnswerTabless", JSON.stringify({ FormId: FormID, AnswerTableId: AnswerTableId, RequestId: RequestId, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                // $("#RequestId").val(res.data[0].requestId);
                for (var i = 0; i < res.data.length; i++) {

                    $('#frmFrom' + FormID).find('input[name=AnswerTableId]').val(res.data[0].answerTableId);
                    if (FormID == 1) {

                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);

                        $('#MemberPostID').val(res.data[0].answer2Val);
                        comboBoxWithSearchUpdateText("MemberPostID", res.data[0].answer2);

                        $('#MemberEductionID').val(res.data[0].answer3Val);
                        comboBoxWithSearchUpdateText("MemberEductionID", res.data[0].answer3);

                        $('#UniversityID').val(res.data[0].answer4Val);
                        comboBoxWithSearchUpdateText("UniversityID", res.data[0].answer4);

                       
                        if (res.data[0].answer6!=null) {
                            if (res.data[0].answer6 == "on") {
                                $('#frmFrom' + FormID).find('input[name=Answer6]').prop("checked", true);
                            } else {
                                $('#frmFrom' + FormID).find('input[name=Answer6]').prop("checked", false);
                            }
                        } else {
                            $('#frmFrom' + FormID).find('input[name=Answer6]').prop("checked", false);
                        }
                        $('#frmFrom' + FormID).find('input[name=Answer5]').val(res.data[0].answer5);
                        $('#frmFrom' + FormID).find('input[name=Answer6]').val(res.data[0].answer6);
                        $('#frmFrom' + FormID).find('input[name=Answer7]').val(res.data[0].answer7);
                        $('#frmFrom' + FormID).find('input[name=Answer8]').val(res.data[0].answer8);
                        $('#frmFrom' + FormID).find('input[name=Answer9]').val(res.data[0].answer9);
                        $('#frmFrom' + FormID).find('input[name=Answer10]').val(res.data[0].answer10);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivAcademicDegreePicture").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        if (res.data[0].fileName2 != null && res.data[0].fileName2 != "") {
                            $("#DivPicture2").html("<a href='" + res.data[i].fileName2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        if (res.data[0].fileName3 != null && res.data[0].fileName3 != "") {
                            $("#DivPicture3").html("<a href='" + res.data[i].fileName3Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        if (res.data[0].fileName4 != null && res.data[0].fileName4 != "") {
                            $("#DivPicture4").html("<a href='" + res.data[i].fileName4Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform1").html("ویرایش");
                    }
                    else if (FormID == 3) {
                        //1,3,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);

                        $('#IsGuideLineOrProcess').val(res.data[0].answer3Val);
                        comboBoxWithSearchUpdateText("IsGuideLineOrProcess", res.data[0].answer3);

                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivGuidelinesAndRegulationsFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else {
                            $("#DivGuidelinesAndRegulationsFile").html("");
                        }
                        $("#btnform3").html("ویرایش");

                    } else if (FormID == 4) {

                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivCertificateAndPermitAndStandardFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificateAndPermitAndStandardFile").html("");
                        }
                        $("#btnform4").html("ویرایش");
                    }
                    else if (FormID == 5) {

                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivAwardsFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivAwardsFile").html("");
                        }
                        $("#btnform5").html("ویرایش");
                    }

                    else if (FormID == 8) {
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivSwotFile1").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivSwotFile1").html("");
                        }
                        if (res.data[0].fileName2 != null && res.data[0].fileName1 != "") {
                            $("#DivSwotFile2").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivSwotFile2").html("");
                        }
                        $("#btnform8").html("ویرایش");
                    }
                    else if (FormID == 9) {
                        //1,2,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#DegreeOfEducation2').val(res.data[0].answer2Val);
                        comboBoxWithSearchUpdateText("DegreeOfEducation2", res.data[0].answer2);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivDegreeFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivDegreeFile").html("");
                        }
                        $("#btnform9").html("ویرایش");
                    }
                    else if (FormID == 10) {
                        //1,2,11
                        $('#ReportTitle').val(res.data[0].answer1);

                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivReportFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivReportFile").html("");
                        }
                        $("#btnform10").html("ویرایش");
                    }
                    else if (FormID == 12) {
                        //1,2,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1!="") {
                            $("#DivCertificationCourses2").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificationCourses2").html("");
                        }
                        $("#btnform12").html("ویرایش");
                    }
                    else if (FormID == 13) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#PostInSociety').val(res.data[0].answer3Val);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1!= "") {
                            $("#DivCertificationSociety").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificationSociety").html("");
                        }
                        comboBoxWithSearchUpdateText("PostInSociety", res.data[0].answer3);
                        $("#btnform13").html("ویرایش");
                    }
                    else if (FormID == 15) {
                        //1,2,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1!="") {
                            $("#DivPublicActivityFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivPublicActivityFile").html("");
                        }
                        $("#btnform15").html("ویرایش");
                    }
                    else if (FormID == 16) {
                        //1,2,3
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#DegreeOfEducation').val(res.data[0].answer2Val);
                        comboBoxWithSearchUpdateText("DegreeOfEducation", res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $("#btnform16").html("ویرایش");
                    }

                    else if (FormID == 17) {
                        //6,'1,2
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $("#btnform17").html("ویرایش");

                    } else if (FormID == 22) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivInvestmentFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivInvestmentFile").html("");
                        }
                        $("#btnform22").html("ویرایش");
                    }
                    else if (FormID == 24) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivEmploymentDisabledFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivEmploymentDisabledFile").html("");
                        }
                        $("#btnform24").html("ویرایش");
                    }
                    else if (FormID == 26) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);

                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivCertificationCourses").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificationCourses").html("");
                        }
                        if (res.data[0].fileName2 != null && res.data[0].fileName2 != "") {
                            $("#DivCertificationCoursesAttach").html("<a href='" + res.data[i].fileName2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificationCoursesAttach").html("");
                        }
                        $("#btnform26").html("ویرایش");
                    }


                }

            }
        }, true);
    }


    function delete_DataFormAnswerTables(FormID = null, ColumNum = null, AnswerTableId = null) {


        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/customer/FurtherInfo/Delete_DataFormAnswerTables/" + (isEmpty(AnswerTableId) ? '0' : AnswerTableId), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        intiFormShow(FormID, ColumNum, $("#RequestIdForms").val());
                        $('#frmFrom' + FormID).find('input[name=AnswerTableId]').val('0');
                        alertB("", result.message, "success");
                        if (FormID==1) {
                            clearFormDetail1();
                        } else if (FormID == 26) {
                            clearFormDetail26();
                        }
                        else if (FormID == 3) {
                            clearFormDetail3();
                        }
                        else if (FormID == 4) {
                            clearFormDetail4();
                        }
                        else if (FormID == 5) {
                            clearFormDetail5();
                        }
                        else if (FormID == 16) {
                            clearFormDetail16();
                        }
                        else if (FormID == 17) {
                            clearFormDetail17();
                        }
                        else if (FormID == 8) {
                            clearFormDetail8();
                        }
                        else if (FormID == 9) {
                            clearFormDetail9();
                        }
                        else if (FormID == 10) {
                            clearFormDetail10();
                        }
                        else if (FormID == 12) {
                            clearFormDetail12();
                        }
                        else if (FormID == 13) {
                            clearFormDetail13();
                        }
                        else if (FormID == 15) {
                            clearFormDetail15();
                        }
                        else if (FormID == 22) {
                            clearFormDetail22();
                        }
                        else if (FormID == 24) {
                            clearFormDetail24();
                        }
                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }



    function saveForm(e, FormId = null, ColumnNum = null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/FurtherInfo/Save_DataFormAnswerTabless", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFrom" + FormId), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                $('#frmFrom' + FormId).find('input[name=AnswerTableId]').val('0');
                if (FormId == 1) {
                    clearFormDetail1();
                    initFurtherInfo($("#RequestIdForms").val());
                }
                else {

                    intiFormShow(FormId, ColumnNum, $("#RequestIdForms").val());
                    $(e).html('افزودن');
                }
                if (FormId == 26) {
                    clearFormDetail26();
                } else if (FormId == 3) {
                    clearFormDetail3();
                }
                else if (FormId == 4) {
                    clearFormDetail4();
                }
                else if (FormId == 5) {
                    clearFormDetail5();
                }
                else if (FormId == 16) {
                    clearFormDetail16();
                }
                else if (FormId == 17) {
                    clearFormDetail17();
                }
                else if (FormId == 8) {
                    clearFormDetail8();
                }
                else if (FormId == 9) {
                    clearFormDetail9();
                }
                else if (FormId == 10) {
                    clearFormDetail10();
                }
                else if (FormId == 12) {
                    clearFormDetail12();
                }
                else if (FormId == 13) {
                    clearFormDetail13();
                }
                else if (FormId == 15) {
                    clearFormDetail15();
                }
                else if (FormId == 22) {
                    clearFormDetail22();
                } else if (FormID == 24) {
                    clearFormDetail24();
                }
                document.getElementById("frmFrom" + FormId).reset();
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function savesingleForm(e, FormId = null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/FurtherInfo/Save_DataFromAnswers", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFrom" + FormId), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveFurtherInfo(e) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/FurtherInfo/Save_FurtherInfo", fill_AjaxCallActionPostSaveFormWithUploadFile("FormDe2"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
               // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                intiTab(1);
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveCorporateGovernance(e,id=null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/FurtherInfo/Save_CorporateGovernance", fill_AjaxCallActionPostSaveFormWithUploadFile("FormDe6"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                getCorporateGovernance(id);
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveValueChain(e,FormName=null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/FurtherInfo/Save_ValueChain", fill_AjaxCallActionPostSaveFormWithUploadFile(FormName), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                intiTab(7);
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function savePublicActivities(e) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/customer/FurtherInfo/Save_PublicActivities", fill_AjaxCallActionPostSaveFormWithUploadFile("FormPublicActivities"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveFormDetailTab14(e) {
        try {

            saveSingelAnswerForm(e, 14, String($("#IsPublicActivityFile").prop('checked')), 87);
            saveSingelAnswerForm(e, 14, $('#EmploymentDisabled').val(), 94);
            saveSingelAnswerForm(e, 14, $('#Investment').val(), 91);
            alertB("ثبت", "اطلاعات ثبت شد", "success");
        } catch (e) {

        }

    }


    function saveForm25(e) {
        saveSingelAnswerForm(e, 6, String($("#HaveRepresentative").prop('checked')), 34);
        saveSingelAnswerForm(e, 6, $('#CompanyWebSite').val(), 94);
        saveSingelAnswerForm(e, 6, $('#HighProductKnowledge').val(), 38);
        saveSingelAnswerForm(e, 6, String($("#HaveAuditCommittee").prop('checked')), 39);
        alertB("ثبت", "اطلاعات ثبت شد", "success");

    }

    function initReferral(id = null) {

        AjaxCallAction("GET", "/api/Customer/RequestForRating/InitReferral/" + id, null, true, function (res) {

            if (res.isSuccess) {

                $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(id.toString(), keyMaker()));
                $("#sdklsslks3498sjdkxhjsd_823sdel").val(res.data[0].sendUser);
                var htmlB = "";
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[0].levelStepIndex == 7 && res.data[0].levelStepAccessRole==5) {
                        htmlB += "<button type='button' id='btnreq' style='margin:5px' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);'" + "data-SIndex='" + res.data[i].levelStepSettingIndexId +"' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "' data-SC='" + encrypt(res.data[i].smsContent, keyMaker()) + "' data-ST='" + res.data[i].smsType + "' data-DLSIB='" + encrypt(res.data[i].destLevelStepIndexButton, keyMaker()) + "'>" + res.data[i].destLevelStepIndexButton + "</button>";

                    } 
                }
                $("#bLLSS").html(htmlB);
                $("#sdfcddf").val(1);
                
            } else {
                $(".changeData").remove();
                $("#EndfurtherInfo").html("اطلاعات شما برای پارس کیان جهت بررسی و ارزیابی ارسال شده است و قابل ویرایش نمی باشد.");
                
            }
           

        }, true);

    }

    function saveSingelAnswerForm(e, formId = null, answer = null, dataFormQuestionId = null) {

        $(e).attr("disabled", "");
        var requestId = $("#RequestId").val();
        AjaxCallAction("POST", "/api/customer/FurtherInfo/Save_DataFromAnswers", JSON.stringify({
            Answer: answer,
            FormID: formId,
            RequestId: requestId,
            DataFormQuestionID: dataFormQuestionId,

        }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                //  alertB("ثبت", res.message, "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    //function validate() {

    //    $("form[id='frmFrom1']").validate({
    //        // Specify validation rules
    //        rules: {
    //            "Answer1": {
    //                required: function () {
    //                    return true;
    //                },
    //                minlength: 5,
    //                maxlength: 50
    //            },

    //        },
    //        // Specify validation error messages
    //        messages: {
    //            "Answer1": {
    //                required: function () {
    //                    return "  لطفا نام و نام خانوادگی را را وارد کنید";
    //                },
    //                minlength: " باید حداقل 5 حرف باشد",
    //                maxlength: " باید حداکثر 50 حرف باشد"
    //            },

    //        },
    //        // Make sure the form is submitted to the destination defined
    //        // in the "action" attribute of the form when valid
    //        submitHandler: function (form) {
    //            Web.FurtherInfo.SaveForm("#btnform1", 1, '1,2,7,8');
    //        }
    //    });

    //    }
    $("#frmFrom1 input,textarea").on("focusout", function () {

        $(this).valid();

    });

    $(document).ready(function () {

        $("form[id='frmFrom1']").validate({
            // Specify validation rules
            rules: {
                "Answer1": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },
                "Answer2": {
                    required: function () {
                        return true;
                    },
                    minlength:2,
                    maxlength: 50
                },
                "Answer3": {
                    required: function () {
                        return $("#MemberEductionID").val() != "223";
                    },
                },

            },
            // Specify validation error messages
            messages: {
                "Answer1": {
                    required: function () {
                        return "لطفا نام و نام خانوادگی را وارد کنید";
                    },
                    minlength: " باید حداقل 5 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
                "Answer2": {
                    required: function () {
                        return "لطفا پست سازمانی را وارد کنید";
                    },
                    minlength: " باید حداقل 3 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
                "Answer3": {
                    required: function () {
                        return "لطفا آخرین مدرک تحصیلی را انتخاب کنید";
                    },
                },

            },
            // Make sure the form is submitted to the destination defined
            // in the "action" attribute of the form when valid
            submitHandler: function (form) {
                Web.FurtherInfo.SaveForm("#btnform1", 1, '1,2,7,8');
            }
        });

        $("form[id='frmFrom26']").validate({
            // Specify validation rules
            rules: {
                "Answer1": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },
                "Answer2": {
                    required: function () {
                        return true;
                    },
                    minlength: 2,
                    maxlength: 50
                },
              
            },
            // Specify validation error messages
            messages: {
                "Answer1": {
                    required: function () {
                        return "لطفا نام و نام خانوادگی را وارد کنید";
                    },
                    minlength: " باید حداقل 5 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
                "Answer2": {
                    required: function () {
                        return "لطفا نام دوره را وارد کنید";
                    },
                    minlength: " باید حداقل 5 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
               

            },
            // Make sure the form is submitted to the destination defined
            // in the "action" attribute of the form when valid
            submitHandler: function (form) {
                Web.FurtherInfo.SaveForm(this, 26, '1,2,3,4,11');
            }
        });

        $("form[id='frmFrom3']").validate({
            // Specify validation rules
            rules: {
                "Answer1": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },
              

            },
            // Specify validation error messages
            messages: {
                "Answer1": {
                    required: function () {
                        return "لطفا عنوان دستورالعمل ها و آیین نامه ها یا روش اجرایی را وارد کنید";
                    },
                    minlength: " باید حداقل 5 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
              

            },
            // Make sure the form is submitted to the destination defined
            // in the "action" attribute of the form when valid
            submitHandler: function (form) {
                Web.FurtherInfo.SaveForm(this, 3, '1,3,11');
            }
        });
       
    });

    function initCustomer(dir = 'rtl') {

        ComboBoxWithSearch('.select2', dir);

        AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {


            if (res != null) {
                $("#CutomerName").html("<h4> فرم اطلاعات تکمیلی " + res.companyName+"</h4>");
            }

        }, true);

    }
    function clearFormDetail1() {
        $('#btnform1').html('افزودن');       
        $('#frmFrom1').find('input[name=AnswerTableId]').val(0);
        $('#DivPicture2').html('');
        $('#DivPicture3').html('');
        $('#DivPicture4').html('');
        $('#DivAcademicDegreePicture').html('');
        $('#frmFrom1').get(0).reset();
    }
    function clearFormDetail26() {
        $('#btnform26').html('افزودن');
        $('#frmFrom26').find('input[name=AnswerTableId]').val(0);
        $('#DivCertificationCourses').html('');
        $('#DivCertificationCoursesAttach').html('');
        $('#frmFrom26').get(0).reset();
    }
    function clearFormDetail3() {
        $('#btnform3').html('افزودن');
        $('#DivGuidelinesAndRegulationsFile').html('');
        $('#frmFrom3').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom3').get(0).reset();
    }
    function clearFormDetail4() {
        $('#btnform4').html('افزودن');
        $('#DivCertificateAndPermitAndStandardFile').html('');
        $('#frmFrom4').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom4').get(0).reset();
    }
    function clearFormDetail5() {
         $('#DivAwardsFile').html(''); 
        $('#btnform5').html('افزودن');       
        $('#frmFrom5').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom5').get(0).reset();
    }
    function clearFormDetail16() {      
        $('#btnform16').html('افزودن');
        $('#frmFrom16').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom16').get(0).reset();
    }
    function clearFormDetail17() {
        $('#btnform17').html('افزودن');
        $('#frmFrom17').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom17').get(0).reset();
    }
    function clearFormDetail8() {
        $('#btnform8').html('افزودن');
        $('#DivSwotFile2').html('');
        $('#DivSwotFile1').html('');
        $('#frmFrom8').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom8').get(0).reset();
    }
    function clearFormDetail9() {
        $('#btnform9').html('افزودن');
        $('#DivDegreeFile').html(''); 
        $('#frmFrom9').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom9').get(0).reset();
    }
    function clearFormDetail10() {
        $('#btnform10').html('افزودن');
        $('#DivReportFile').html('');
        $('#frmFrom10').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom10').get(0).reset();
    }
    function clearFormDetail12() {
        $('#btnform12').html('افزودن');
        $('#DivCertificationCourses2').html('');
        $('#frmFrom12').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom12').get(0).reset();
    }
    function clearFormDetail13() {
        $('#btnform13').html('افزودن');
        $('#DivCertificationSociety').html('');
        $('#frmFrom13').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom13').get(0).reset();
    }
    function clearFormDetail15() {
        $('#btnform15').html('افزودن');
        $('#DivPublicActivityFile').html('');
        $('#frmFrom15').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom15').get(0).reset();
    }
    function clearFormDetail22() {
        $('#btnform22').html('افزودن');
        $('#DivInvestmentFile').html('');
        $('#frmFrom22').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom22').get(0).reset();
    }
    function clearFormDetail24() {
        $('#btnform24').html('افزودن');
        $('#DivEmploymentDisabledFile').html('');
        $('#frmFrom24').find('input[name=AnswerTableId]').val(0);
        $('#frmFrom24').get(0).reset();
    }
    
    web.FurtherInfo = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        InitFurtherInfo: initFurtherInfo,
        SystemSeting_Combo: systemSeting_Combo,
        IntiForm: intiForm,
        IntiFormAnswer: intiFormAnswer,
        IntiFormShow: intiFormShow,
        IntiTab: intiTab,
        IntiFormSingelAnswer: intiFormSingelAnswer,
        SaveForm: saveForm,
        SaveSingelAnswerForm: saveSingelAnswerForm,
        SaveFormDetailTab14: saveFormDetailTab14,
        GetFormAnswer: getFormAnswer,
        Delete_DataFormAnswerTables: delete_DataFormAnswerTables,
        SavesingleForm: savesingleForm,
        IntiFormQuestion: intiFormQuestion,
        SaveForm25: saveForm25,
        IntiFormQrid: intiFormQrid,
        SaveFurtherInfo: saveFurtherInfo,
        SaveCorporateGovernance: saveCorporateGovernance,
        GetFurtherInfo: getFurtherInfo,
        SaveValueChain: saveValueChain,
        InitReferral: initReferral,
        GetCorporateGovernance: getCorporateGovernance,
        GetValueChain: getValueChain,
        SavePublicActivities: savePublicActivities,
        GetPublicActivities: getPublicActivities,
        InitCustomer: initCustomer,
        ClearFormDetail1: clearFormDetail1,
        ClearFormDetail26: clearFormDetail26,
        ClearFormDetail3: clearFormDetail3,
        ClearFormDetail4: clearFormDetail4,
        ClearFormDetail5: clearFormDetail5,
        ClearFormDetail16: clearFormDetail16,
        ClearFormDetail17: clearFormDetail17,
        ClearFormDetail8: clearFormDetail8,
        ClearFormDetail9: clearFormDetail9,
        ClearFormDetail10: clearFormDetail10,
        ClearFormDetail12: clearFormDetail12,
        ClearFormDetail13: clearFormDetail13,
        ClearFormDetail15: clearFormDetail15,
        ClearFormDetail22: clearFormDetail22,
        ClearFormDetail24: clearFormDetail24
    };

})(Web, jQuery);
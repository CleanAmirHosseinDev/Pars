





(function (web, $) {

    //Document Ready              

    function signOutForExitToLogin() {

        AjaxCallActionWithotHeading("POST", "/api/Securitys/SignOutForExitToLogin", JSON.stringify({ Userid: getlstor("userID"), AreaName: getlstor("roleDesc") }), true, function (res) {
            debugger;
            if (res.isSuccess) {

                localStorage.removeItem("token");

                //dellstor("menu");
                localStorage.removeItem("menu");

                dellstor("fullName");
                dellstor("userID");
                dellstor("loginName");
                dellstor("roleDesc");
                goToUrl("/Account/LoginUser");

            }

        }, false);

    }

    function initLayout() {

        if (isEmpty(localStorage.getItem("token")) || isEmpty(localStorage.getItem("menu"))) goToUrl("/Account/LoginUser");
        else {

            $(".fullNameInLayout").html(getlstor("fullName"));

            /*var menu = JSON.parse(getlstor("menu"));*/
            var menu = JSON.parse(localStorage.getItem("menu"));

            var strMenu = "<li><a href='/'><img src='/css/GlobalAreas/dist/img/Logo/hnet.com-image.png' class='' style='width: 20px; height: 20px;' /> <span>سامانه پارس کیان</span></a></li><li class='active'><a href='/Admin'><i class='fa fa-dashboard'></i> <span>داشبورد</span></a></li>";

            if (menu != null && menu.length > 0) {

                menu = menu.filter(p => p.link != "");

                var groupByList = groupBy(menu, "labelGroup");

                for (var i = 0; i < groupByList.length; i++) {

                    strMenu += "<li class='treeview'><a href='#'><i class='" + groupByList[i][1][0].icon + "'></i> <span>" + groupByList[i][0] + "</span><span class='pull-left-container'><i class='fa fa-angle-right pull-left'></i></span></a><ul class='treeview-menu'>";

                    var qL = menu.filter(o => o.labelGroup == groupByList[i][0]);

                    qL.forEach(function (itemC, iC) {

                        strMenu += "<li><a href='" + itemC.link + "'><i class='fa fa-plus'></i>" + itemC.group_Item + "</a></li>";

                    });
                    strMenu += "</ul></li>";

                }

            }

            strMenu += "<li><a href='#' onclick='Web.Layout.SignOutForExitToLogin();'><i class='fa fa-sign-out'></i> <span>خروج</span></a></li>";
            $("#ulMenuMain").html(strMenu);

        }

    }

    web.Layout = {

        SignOutForExitToLogin: signOutForExitToLogin,
        InitLayout: initLayout

    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/admin/City/Get_Citys", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>" + res.data[i].state.stateName+"</td><td>" + res.data[i].cityName + "</td><td><a title='ویرایش' href='/Admin/City/EditCity?id=" + res.data[i].cityId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a></td></tr>";

                }
                $("#tBodyList").html(strM);

            }

        }, true);

    }

    function getStatesList() {

        AjaxCallAction("POST", "/api/admin/City/Get_States_Combo", JSON.stringify({ PageIndex: 0, PageSize:0}), true, function (res) {

            if (res.isSuccess) {

                var strM = '';
                for (var i = 0; i < res.data.length; i++) {
                        strM += " <option value=" + res.data[i].stateId + ">" + res.data[i].stateName + "</option>"; 
                }
                $("#StateId").html(strM);
            }
        }, true);

    }

    function saveCity(e) {

        $(e).attr("disabled", "");

        
        AjaxCallAction("POST", "/api/admin/City/Save_City", JSON.stringify({ CityName: $("#CityName").val(), CityId: $("#CityId").val(), StateId: $("#StateId").val() }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                goToUrl("/Admin/City/Index");

            }
         else {

            alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function initCity(id = null, dir = 'rtl') {

        ComboBoxWithSearch('.select2', dir);
        
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/admin/City/Get_City/" + id, null, true, function (res) {                
               
                if (res != null) {
                    getStatesList();
                    $("#CityId").val(res.cityId);
                    $("#CityName").val(res.cityName);                   
                    $("#StateId").val(res.stateId);
                    comboBoxWithSearchUpdateText("StateId", res.state.stateName);

                }
            }, true);

        } else {
            getStatesList();
        }

    }

    web.City = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        FilterGrid: filterGrid,
        SaveCity: saveCity,
        InitCity: initCity,
        GetStatesList: getStatesList
    };

})(Web, jQuery);

(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/admin/State/Get_States", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>" + res.data[i].stateName + "</td><td><a title='ویرایش' href='/Admin/State/EditState?id=" + res.data[i].stateId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a></td></tr>";

                }
                $("#tBodyList").html(strM);

            }

        }, true);

    }

    function saveState(e) {

        $(e).attr("disabled", "");

        AjaxCallAction("POST", "/api/admin/State/Save_State", JSON.stringify({ StateName: $("#StateName").val(), StateId: $("#StateId").val() }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                goToUrl("/Admin/State/Index");

            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function initState(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/admin/State/Get_State/" + id, null, true, function (res) {                

                if (res != null) {

                    $("#StateId").val(res.stateId);
                    $("#StateName").val(res.stateName);

                }

            }, true);

        }

    }

    web.State = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        FilterGrid: filterGrid,
        SaveState: saveState,
        InitState: initState
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/admin/SystemSeting/Get_SystemSetings", JSON.stringify({  ParentCode: !isEmpty($("#SystemSetingID").val()) ? $("#SystemSetingID").val() : null, Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {

                var strM = '';

                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>" + res.data[i].label + "</td><td><a title='ویرایش' href='/Admin/SystemSeting/EditSystemSeting?id=" + res.data[i].systemSetingId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a></td></tr>";

                }
                $("#tBodyList").html(strM);

            }

        }, true);

    }

    function initSystemSeting(id = null) {
        
        systemSetingList("ParentCode");
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/admin/SystemSeting/Get_SystemSeting/" + id, null, true, function (res) {

                if (res != null) {
                   $("#SystemSetingID").val(res.systemSetingId);                    
                   $("#Label").val(res.label);
                   $("#ParentCode").val(res.parentCode);                   
                    comboBoxWithSearchUpdateText("ParentCode", res.parenLabel);
                    systemSetingListSub("SubCodes", res.systemSetingId);
                }
            }, true);
        }

    }   

    function systemSetingList(ComboName) {

        ComboBoxWithSearch('.select2', 'rtl');

        AjaxCallAction("POST", "/api/admin/SystemSeting/Get_SystemSetings", JSON.stringify({  ParentCode:null, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

               // var resA = new Array();

                var strM = '<option value="">انتخاب کنید</option>';
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                for (var i = 0; i < res.data.length; i++) {

                    //  var q = resA.filter(p => p.ParentCode == res.data[i].labeCode);
                    //  if (q.length > 0) continue;
                    if (res.data[i].parentCode == null) {
                      //  resA.push(res.data[i]);
                        strM += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                  
                }
                $("#" + ComboName).html(strM);
            }

        }, true);
    }

    function systemSetingListSub(ComboName,PC=null) {

        ComboBoxWithSearch('.select2', 'rtl');

        AjaxCallAction("POST", "/api/admin/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCode: PC, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strM ="";

                for (var i = 0; i < res.data.length; i++) {

                        strM += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";                   

                }
                $("#" + ComboName).html(strM);
            }

        }, true);
    }

    function saveSystemSeting(e) {

        $(e).attr("disabled", "");
       
        AjaxCallAction("POST", "/api/admin/SystemSeting/Save_SystemSeting", JSON.stringify({ NewLabel: $("#NewLabel").val(), SystemSetingID: $("#SystemSetingID").val(), Label: $("#Label").val(), ParentCode: $("#ParentCode").val() }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {               
                var o = new Option($("#NewLabel").val(), "");
                $(o).html($("#NewLabel").val());
                $("#SubCodes").append(o);
                $("#NewLabel").val("");
                // goToUrl("/Admin/SystemSeting/EditSystemSeting?id=" + $("#SystemSetingID").val());

                alertB("", res.message, "success");

            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }


    web.SystemSeting = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        FilterGrid: filterGrid,
        InitSystemSeting: initSystemSeting,
        SystemSetingList: systemSetingList,
        SaveSystemSeting: saveSystemSeting,
        SystemSetingListSub: systemSetingListSub,
         
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready  
    

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        ComboBoxWithSearch('.select2', 'dir');
        get_Roles_Combo();

        AjaxCallAction("POST", "/api/admin/Users/Get_Userss", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), RoleId: isEmpty($("#RoleId").val()) ? null : $("#RoleId").val(), }), true, function (res) {

            if (res.isSuccess) {

                var strM = '';
                $("#TotalRowRep").text("جستجو در "+res.rows+" مورد");
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].user.userName == "admin" || res.data[i].role.roleDesc == "مشتری") {
                        strM += "<tr><td>" + (i + 1) + "</td><td>" + (res.data[i].user.realName != null ? res.data[i].user.realName:"") + "</td><td>" + res.data[i].user.userName + "</td><td>" + res.data[i].role.roleDesc + "</td><td>" + (res.data[i].user.status == true ? "فعال" : "غیر فعال") + "</td><td>" + res.data[i].user.mobile + "</td><td><a title='ویرایش' href='/Admin/Users/EditUser?id=" + res.data[i].userId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a><a title='حذف' class='btn btn-danger fontForAllPage' onclick='Web.Users.Delete_Users(" + res.data[i].userId + ");'><i class='fa fa-remove'></i></a>" + "</td></tr>";

                    } else {
                        //<a title='حذف' class='btn btn-danger fontForAllPage' onclick='Web.Users.Delete_Users(" + res.data[i].userId + ");'><i class='fa fa-remove'></i></a>
                        strM += "<tr><td>" + (i + 1) + "</td><td>" + res.data[i].user.realName + "</td><td>" + res.data[i].user.userName + "</td><td>" + res.data[i].role.roleDesc + "</td><td>" + (res.data[i].user.status == true ? "فعال" : "غیر فعال") + "</td><td>" + res.data[i].user.mobile + "</td><td><a title='ویرایش' href='/Admin/Users/EditUser?id=" + res.data[i].userId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a>" + "<a style='margin-right:5px' Title='تنظیمات دسترسی کاربر' href='/Admin/Users/EditUserAccessLevel?id=" + res.data[i].userId + "' class='btn btn-info fontForAllPage'><i class='fa fa-cog'></i></a>" + "</td></tr>";
                    }
                  }
                $("#tBodyList").html(strM);
            }
        }, true);

    }

    function saveUser(e) {

        $(e).attr("disabled", "");

        let status = null;
        if ($('#Status').is(":checked")) {
             status = true;
        }

        else {
             status = false;
        }         

        AjaxCallAction("POST", "/api/admin/Users/Save_Users", JSON.stringify({ Id: $("#Id").val(), RoleId: $("#RoleId").val(), UserID: $("#UserId").val(), User: { RealName: $("#RealName").val(), UserName: $("#UserName").val(), Password: $("#Password").val(), Mobile: $("#Mobile").val(), Email: $("#Email").val(), Status: status} }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                
                goToUrl("/Admin/Users/Index");
            } else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveUserAccessLevel(e) {
        try {
            $(e).attr("disabled", "");
            
                
                var val1 = [];
                $('select[name="SuperVisorRoles_Arr[]"] option:selected').each(function () {
                    val1.push($(this).val());
                });

                AjaxCallAction("POST", "/api/admin/Users/Save_AccessLevels", JSON.stringify({ Roles: val1.join(","), UserId: $("#UserId").val() }), true, function (res) {
                    $(e).removeAttr("disabled");

                    if (res.isSuccess) {

                        goToUrl("/Admin/Users/Index");
                    } else {

                        alertB("خطا", res.message, "error");
                    }
                }, true);            

        } catch (e) {

        }
    }

    function get_Roles_Combo() {

        AjaxCallAction("POST", "/api/admin/Users/Get_Roles_Combo", JSON.stringify({ PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

               
                var strM = '<option value="">انتخاب کنید</option>';
                for (var i = 0; i < res.data.length; i++) {
                    strM += " <option value=" + res.data[i].roleId + ">" + res.data[i].roleDesc + "</option>";
                }
                $("#RoleId").html(strM);
            }
        }, true);

    }

    function initUser(id = null, dir = 'rtl') {

        ComboBoxWithSearch('.select2', 'dir');
        get_Roles_Combo();
        
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/admin/Users/Get_Users/" + id, null, true, function (res) {

                if (res != null) {
                    $("#Id").val(res.id);
                    $("#UserId").val(res.userId);
                    $("#RoleId").val(res.roleId);
                    comboBoxWithSearchUpdateText("RoleId", res.role.roleDesc);
                    $("#RealName").val(res.user.realName);
                    $("#UserName").val(res.user.userName);
                    $("#Mobile").val(res.user.mobile);
                    $("#Email").val(res.user.email);
                    $("#Status").prop('checked', res.user.status);
                   
                    getGetAccessLevels(id,dir);
                  
                }
            }, true);
        }
        else ComboBoxWithSearch('.select2', dir);
       
    }

    function initUserAccessLevel(id = null, dir = 'rtl') {

        
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/admin/Users/Get_Users/" + id, null, true, function (res) {

                if (res != null) {
                    $("#Id").val(res.id);
                    $("#UserId").val(res.userId);
                    $("#RoleId").val(res.roleId);                 
                    $("#RealName").val(res.user.realName);                   
                    getGetAccessLevels(id, dir);

                }
            }, true);
        }

    }

    function getGetAccessLevels(id = null,dir) {
        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("GET", "/api/admin/Users/GetAccessLevels/" + id, null, true, function (res) {


                var strAccessPanel = "<div class='container mt-3'><div id='accordion'>";

                if (res != null && res.length > 0) {

                    var groupByList = groupBy(res, "labelGroup");

                   
                    for (var i = 0; i < groupByList.length; i++) {

                        //======================== سطح اول =========================================

                        strAccessPanel += "<div class='col-md-12'>";
                        //strAccessPanel += "<div class='panel panel-primary'>";
                        //strAccessPanel += "<div class='panel-heading'>" + groupByList[i][0] + "</div>";
                        //strAccessPanel += "<div class='panel-body' >";
                        
                        strAccessPanel += "<div class='card'><div class='card-header'><a class='collapsed btn' data-bs-toggle='collapse' href='#Collaps" + i + "'><i class='fa fa-plus-square-o' aria-hidden='true'></i>&nbsp;&nbsp;" + groupByList[i][0] + "</a></div>";
                        strAccessPanel += "<div id='Collaps" + i+"' class='collapse' data-bs-parent='#accordion'><div class='card-body'>";

                        var groupByList2 = groupBy(res, "group_Item");
                        for (var j = 0; j < groupByList2.length; j++) {
                            if (groupByList[i][0] === groupByList2[j][1][0].labelGroup) {


                                //====================== سطح دوم ======================= 
                                strAccessPanel += "<div class='col-md-4'>";
                                strAccessPanel += "<div class='panel panel-primary'>";
                                strAccessPanel += "<div class='panel-heading'>" + groupByList2[j][1][0].group_Item + "</div>";
                                strAccessPanel += "<div class='panel-body' style='height:100px;overflow-y:scroll;'>";
                                //========= گزینه ها ========= 
                                strAccessPanel += "<select multiple='multiple' class='multi-select' id='SuperVisorRoles_Arr' name='SuperVisorRoles_Arr[]'>";
                                for (var z = 0; z < groupByList2[j][1].length; z++) {
                                    strAccessPanel += "<option id='" + groupByList2[j][1][z].value + "' value='" + groupByList2[j][1][z].value + "'" + (groupByList2[j][1][z].selected ? "selected" : "") + ">" + groupByList2[j][1][z].text + "</option>";
                                }
                                strAccessPanel += "</select>";
                                //===============================
                                strAccessPanel += "</div>";
                                strAccessPanel += "</div>";
                                strAccessPanel += "</div>";
                            }
                            //=======================================================
                        }
                        strAccessPanel += "</div>";
                        strAccessPanel += "</div>";
                        strAccessPanel += "</div>";
                        strAccessPanel += "</div>";
                         //==========================================================================
                    }
                }
                strAccessPanel += "</div></div>";
                $("#AccessPanel").html(strAccessPanel);
                ComboBoxWithSearch('.select2', dir);
                MultiSelect(".multi-select");
            }, true);
        }
    }

    function delete_Users(id) {

        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/admin/Users/Delete_Users/" + (isEmpty(id) ? '0' : id), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        filterGrid();

                        alertB("", result.message, "success");

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }

    function updatePass() {

        AjaxCallAction("POST", "/api/admin/Users/UpdatePass_Users", JSON.stringify({ OldPassword: $("#OldPassword").val(), NewPassword: $("#NewPassword").val(), ConfirmPassword: $("#ConfirmPassword").val() }), true, function (result) {

            debuggerWeb();

            if (result.isSuccess) {                

                alertB("", result.message, "success");

            }
            else {

                alertB("خطا", result.message, "error");

            }

        }, true);

    }
    
    web.Users = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        FilterGrid: filterGrid,
        SaveUser: saveUser,
        Get_Roles_Combo: get_Roles_Combo,
        InitUser: initUser,
        GetGetAccessLevels: getGetAccessLevels,
        SaveUserAccessLevel: saveUserAccessLevel,
        InitUserAccessLevel: initUserAccessLevel,
        Delete_Users: delete_Users,
        UpdatePass: updatePass
      
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/admin/Activity/Get_Activitys", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>" + (res.data[i].activityTitleNavigation != null ? res.data[i].activityTitleNavigation.label : '') + "</td><td><a title='ویرایش' href='/Admin/Activity/EditActivity?id=" + res.data[i].activityId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a><a title='حذف' class='btn btn-danger fontForAllPage' onclick='Web.Activity.Delete_Activity(" + res.data[i].activityId + ");'><i class='fa fa-remove'></i></a></td></tr>";

                }
                $("#tBodyList").html(strM);

            }

        }, true);

    }

    function saveActivity(e) {

        $(e).attr("disabled", "");

        AjaxCallAction("POST", "/api/admin/Activity/Save_Activity", JSON.stringify({
            ActivityTitle: $("#ActivityTitle").val(),
            ActivityId: $("#ActivityId").val(),
            ActivityComment: getDataCkeditor("ActivityComment"),
            Result_Final_Picture1: $("#hid_Picture1").val(),
            Result_Final_Picture2: $("#hid_Picture2").val(),
        }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                goToUrl("/Admin/Activity/Index");

            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function initActivity(id = null) {

        ComboBoxWithSearch('.select2', 'dir');

        AjaxCallAction("GET", "/api/admin/Activity/Get_Activity/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

            if (res != null) {

                $("#ActivityId").val(res.activityId);               
                $("#ActivityComment").val(res.activityComment);
                Ckeditor("ActivityComment");
                $("#imgUpload_Picture1").attr("src", res.picture1Full);
                $("#imgUpload_Picture2").attr("src", res.picture2Full);
                systemSeting_Combo(!isEmpty(id) && id != 0 ? res : null);
            }

        }, true);

    }

    function systemSeting_Combo(resSingle) {

        AjaxCallAction("POST", "/api/admin/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "150", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strActivityTitle = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {

                    strActivityTitle += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";

                }

                $("#ActivityTitle").html(strActivityTitle);
                if (resSingle != null) {
                    $("#ActivityTitle").val(resSingle.activityTitle);

                }



            }
        }, true);
    }

    function delete_Activity(id) {

        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/admin/Activity/Delete_Activity/" + (isEmpty(id) ? '0' : id), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        filterGrid();

                        alertB("", result.message, "success");

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }

    web.Activity = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        FilterGrid: filterGrid,
        SaveActivity: saveActivity,
        InitActivity: initActivity,
        SystemSeting_Combo: systemSeting_Combo,
        Delete_Activity: delete_Activity
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/admin/Companies/Get_Companiess", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>" + res.data[i].companyName + "</td><td>" + res.data[i].kindOfCompanyNavigation.label + "</td><td>" + res.data[i].companyGroup.label + "</td><td><a title='ویرایش' href='/Admin/Companies/EditCompanies?id=" + res.data[i].companiesId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a><a title='حذف' class='btn btn-danger fontForAllPage' onclick='Web.Companies.Delete_Companies(" + res.data[i].companiesId + ");'><i class='fa fa-remove'></i></a></td></tr>";

                }
                $("#tBodyList").html(strM);

            }

        }, true);

    }

    function saveCompanies(e) {

        $(e).attr("disabled", "");

        AjaxCallAction("POST", "/api/admin/Companies/Save_Companies", JSON.stringify({
            CompanyName: $("#CompanyName").val(),
            CompaniesId: $("#CompaniesId").val(),
            KindOfCompany: $("#KindOfCompany").val(),
            CompanyGroupId: $("#CompanyGroupID").val()

        }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                goToUrl("/Admin/Companies/Index");

            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function initCompanies(id = null) {

        ComboBoxWithSearch('.select2', 'dir');

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/admin/Companies/Get_Companies/" + id, null, true, function (res) {

                if (res != null) {
                    
                    $("#CompaniesId").val(res.companiesId);
                    $("#CompanyName").val(res.companyName);                    //
                    systemSeting_Combo(res);
                }

            }, true);

        }
        else {
            systemSeting_Combo(null);
        }

    }

    function systemSeting_Combo(resSingle) {

        AjaxCallAction("POST", "/api/admin/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "27,126", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';
                var strCompanyGroupID = '<option value="">انتخاب کنید</option>';
               
                  
                for (var i = 0; i < res.data.length; i++) {

                    if (res.data[i].parentCode == 27) {
                        strKindOfCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 126) {
                        strCompanyGroupID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";

                    }
                }

                        $("#KindOfCompany").html(strKindOfCompany);
                $("#CompanyGroupID").html(strCompanyGroupID);
                if (resSingle!=null) {
                    $("#KindOfCompany").val(resSingle.kindOfCompany);
                    $("#CompanyGroupID").val(resSingle.companyGroupId);
                }
                     


            }
        }, true);
    }

    function delete_Companies(id) {

        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/admin/Companies/Delete_Companies/" + (isEmpty(id) ? '0' : id), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        filterGrid();

                        alertB("", result.message, "success");

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }

    web.Companies = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        FilterGrid: filterGrid,
        SaveCompanies: saveCompanies,
        InitCompanies: initCompanies,
        SystemSeting_Combo: systemSeting_Combo,
        Delete_Companies: delete_Companies
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/admin/ServiceFee/Get_ServiceFees", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>" + res.data[i].kindOfServiceNavigation.label +
                        "</td><td>" + res.data[i].fromCompanyRange + "</td><td>" + res.data[i].toCompanyRange +
                        "</td><td>" + moneyCommaSepWithReturn(res.data[i].fixedCost.toString()) + "</td><td>" + moneyCommaSepWithReturn(res.data[i].variableCost.toString()) +
                        "</td><td><a title='ویرایش' href='/Admin/ServiceFee/EditServiceFee?id=" +
                        res.data[i].serviceFeeId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a><a title='حذف' class='btn btn-danger fontForAllPage' onclick='Web.ServiceFee.Delete_ServiceFee(" + res.data[i].serviceFeeId + ");'><i class='fa fa-remove'></i></a></td></tr>";

                }
                $("#tBodyList").html(strM);

            }

        }, true);

    }

    function saveServiceFee(e) {

        $(e).attr("disabled", "");

        RemoveAllCharForPrice("FixedCost");
        RemoveAllCharForPrice("VariableCost");
        RemoveAllCharForPrice("Fee1");
        RemoveAllCharForPrice("Fee2");

        AjaxCallAction("POST", "/api/admin/ServiceFee/Save_ServiceFee", JSON.stringify({
           
            ServiceFeeId: $("#ServiceFeeId").val(),
           // ServiceFeeComment: $("#ServiceFeeComment").val(),
            FromCompanyRange: $("#FromCompanyRange").val(),
            ToCompanyRange: $("#ToCompanyRange").val(),
            FixedCost: $("#FixedCost").val(),
            VariableCost: $("#VariableCost").val(),
            KindOfService: $("#KindOfService").val(),
            Fee1: $("#Fee1").val(),
            Fee2: $("#Fee2").val(),
            StartDate: $("#StartDate").val()


        }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                goToUrl("/Admin/ServiceFee/Index");

            }
            else {

                $("#FixedCost").val(moneyCommaSepWithReturn($("#FixedCost").val()));
                $("#VariableCost").val(moneyCommaSepWithReturn($("#VariableCost").val()));
                $("#Fee1").val(moneyCommaSepWithReturn($("#Fee1").val()));
                $("#Fee2").val(moneyCommaSepWithReturn($("#Fee2").val()));

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function initServiceFee(id = null) {
        ComboBoxWithSearch('.select2', 'dir');
        PersianDatePicker(".DatePicker");

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/admin/ServiceFee/Get_ServiceFee/" + id, null, true, function (res) {

                if (res != null) {

                    $("#StartDate").val(res.startDate);
                    $("#ServiceFeeId").val(res.serviceFeeId);                   
                    $("#FromCompanyRange").val(res.fromCompanyRange);
                    $("#ToCompanyRange").val(res.toCompanyRange);
                    $("#FixedCost").val(moneyCommaSepWithReturn(res.fixedCost.toString()));
                    $("#VariableCost").val(moneyCommaSepWithReturn(res.variableCost.toString()));
                    $("#Fee1").val(moneyCommaSepWithReturn(!isEmpty(res.fee1) ? res.fee1.toString() : ''));
                    $("#Fee2").val(moneyCommaSepWithReturn(!isEmpty(res.fee2) ? res.fee2.toString() : ''));

                    systemSeting_Combo(res);
                }

            }, true);

        }
        else {
            systemSeting_Combo(null);
        }

    }

    function systemSeting_Combo(resSingle) {

        AjaxCallAction("POST", "/api/admin/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfService = '<option value="">انتخاب کنید</option>';
               
                for (var i = 0; i < res.data.length; i++) {
                   
                    strKindOfService += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";                    
                }
             
                $("#KindOfService").html(strKindOfService);
                if (resSingle!=null) {
                    $("#KindOfService").val(resSingle.kindOfService);
                } 
            }
        }, true);
    }

    function delete_ServiceFee(id) {

        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/admin/ServiceFee/Delete_ServiceFee/" + (isEmpty(id) ? '0' : id), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        filterGrid();

                        alertB("", result.message, "success");

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }

    web.ServiceFee = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        FilterGrid: filterGrid,
        SaveServiceFee: saveServiceFee,
        InitServiceFee: initServiceFee,
        SystemSeting_Combo: systemSeting_Combo,
        Delete_ServiceFee: delete_ServiceFee
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/admin/Contract/Get_Contracts", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>" + res.data[i].kinfOfRequestNavigation.label + "</td><td><a title='پیش نمایش' href='/Admin/Contract/ContractPrint?id=" + res.data[i].contractId + "' class='btn btn-info fontForAllPage'><i class='fa fa-print'></i></a><a title='ویرایش' href='/Admin/Contract/EditContract?id=" + res.data[i].contractId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a><a title='حذف' class='btn btn-danger fontForAllPage' onclick='Web.Contract.Delete_Contract(" + res.data[i].contractId + ");'><i class='fa fa-remove'></i></a></td></tr>";

                }
                $("#tBodyList").html(strM);

            }

        }, true);

    }

    function saveContract(e) {

        $(e).attr("disabled", "");

        AjaxCallAction("POST", "/api/admin/Contract/Save_Contract", JSON.stringify({
            ContractText: getDataCkeditor("ContractText"),
            KinfOfRequest: $("#KinfOfRequest").val(),
            ContractId: $("#ContractId").val(),

        }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                goToUrl("/Admin/Contract/Index");

            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function initContract(id = null) {
        ComboBoxWithSearch('.select2', 'dir');        

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/admin/Contract/Get_Contract/" + id, null, true, function (res) {

                if (res != null) {

                    $("#ContractId").val(res.contractId);
                    $("#ContractText").val(res.contractText);
                    Ckeditor("ContractText");
                    systemSeting_Combo(res);
                }

            }, true);

        }
        else {
            Ckeditor("ContractText");
            systemSeting_Combo(null);
        }

    }

    function printContract(id=null) {

        goToUrl("/admin/Contract/ContractPrint/" + id);
    }
    

    function printContracting(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/admin/Contract/Get_Contract/" + id, null, true, function (res) {

                if (res != null) {
                   
                    $("#SaveDate").html("1401/01/01");
                    $("#ContractCode").html("11111");
                    $("#ContractShow").html(res.contractText);
                    $('input[type="text"], textarea').each(function () {
                        //  $(this).attr('readonly', 'readonly');
                        // var text_classname = $(this).attr('name');
                        var value = $(this).val();
                        var new_html = ('<storang>' + value + '</storang>');
                        $(this).replaceWith(new_html);
                    });
                    window.print();
                }

            }, true);

        }

       
    }



    function systemSeting_Combo(resSingle) {

        AjaxCallAction("POST", "/api/admin/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKinfOfRequest = '<option value="">انتخاب کنید</option>';
               
                for (var i = 0; i < res.data.length; i++) {
                   
                    strKinfOfRequest+= " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    
                }
             
                $("#KinfOfRequest").html(strKinfOfRequest);
                if (resSingle != null) {
                    $("#KinfOfRequest").val(resSingle.kinfOfRequest);

                }
            


            }
        }, true);
    }

    function delete_Contract(id) {

        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/admin/Contract/Delete_Contract/" + (isEmpty(id) ? '0' : id), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        filterGrid();

                        alertB("", result.message, "success");

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }

    web.Contract = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        FilterGrid: filterGrid,
        SaveContract: saveContract,
        InitContract: initContract,
        SystemSeting_Combo: systemSeting_Combo,
        Delete_Contract: delete_Contract,
        PrintContract: printContract,
        PrintContracting: printContracting
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/admin/LicensesAndHonors/Get_LicensesAndHonorss", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>" + res.data[i].title + "</td><td><img src=" + res.data[i].pictureFull + " style='max-width:50px'/></td><td><a title='ویرایش' href='/Admin/LicensesAndHonors/EditLicensesAndHonors?id=" + res.data[i].licensesAndHonorsId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a><a title='حذف' class='btn btn-danger fontForAllPage' onclick='Web.LicensesAndHonors.Delete_LicensesAndHonors(" + res.data[i].licensesAndHonorsId + ");'><i class='fa fa-remove'></i></a></td></tr>";

                }
                $("#tBodyList").html(strM);

            }

        }, true);

    }

    function saveLicensesAndHonors(e) {

        $(e).attr("disabled", "");

        AjaxCallAction("POST", "/api/admin/LicensesAndHonors/Save_LicensesAndHonors", JSON.stringify({
            Title: $("#Title").val(),
            LicensesAndHonorsId: $("#LicensesAndHonorsId").val(),
            Result_Final_Picture: $("#hid_Picture").val(),
           
        }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                goToUrl("/Admin/LicensesAndHonors/Index");

            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function initLicensesAndHonors(id = null) {
            AjaxCallAction("GET", "/api/admin/LicensesAndHonors/Get_LicensesAndHonors/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res != null) {
                    
                    $("#LicensesAndHonorsId").val(res.licensesAndHonorsId);
                    $("#Title").val(res.title);
                    $("#imgUpload_Picture").attr("src", res.pictureFull);
                }

            }, true);
    }

    function delete_LicensesAndHonors(id) {

        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/admin/LicensesAndHonors/Delete_LicensesAndHonors/" + (isEmpty(id) ? '0' : id), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        filterGrid();

                        alertB("", result.message, "success");

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }
  
    web.LicensesAndHonors = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        FilterGrid: filterGrid,
        SaveLicensesAndHonors: saveLicensesAndHonors,
        InitLicensesAndHonors: initLicensesAndHonors,
        Delete_LicensesAndHonors: delete_LicensesAndHonors
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function saveAboutUs(e) {

        $(e).attr("disabled", "");

        AjaxCallAction("POST", "/api/admin/AboutUs/Save_AboutUs", JSON.stringify({
            CompanyName: $("#CompanyName").val(),
            AboutUsId: $("#AboutUsId").val(),            
            AboutUsComment: $("#AboutUsComment").val(),            
            Address: $("#Address").val(),
            Subject:$("#Subject").val(),           
            Tel1: $("#Tel1").val(),
            Tel2: $("#Tel2").val(),
            Tel3:$("#Tel3").val(),
            tel4: $("#Tel4").val(),
            Tel5:$("#Tel5").val(),
            Mobile1: $("#Mobile1").val(),
            Mobile2:$("#Mobile2").val(),
            FaxNumber:$("#FaxNumber").val(),
            Email: $("#Email").val(),
            Instagram:$("#Instagram").val(),
            Whatsapp: $("#Whatsapp").val(),
            Facebook: $("#Facebook").val(),
            Telegram: $("#Telegram").val(),
            Moto1: $("#Moto1").val(),
            Moto2: $("#Moto2").val(),
            Moto3:$("#Moto3").val(),
            Moto4:$("#Moto4").val(),
            Moto5: $("#Moto5").val(),
            OrganazationChart: getDataCkeditor("OrganazationChart"),
            AboutUSContent:    getDataCkeditor("AboutUSContent"),
            VisionAndMission:  getDataCkeditor("VisionAndMission"),
        }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                alertB("", res.message, "success");

            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function initAboutUs() {
      
        AjaxCallAction("GET", "/api/admin/AboutUs/Get_AboutUs/", null, true, function (res) {

            if (res != null) {

                $("#AboutUsId").val(res.aboutUsId);
                $("#AboutUsComment").val(res.aboutUsComment);
                $("#CompanyName").val(res.companyName);
                $("#Address").val(res.address);
                $("#Subject").val(res.subject);
                $("#AboutUSContent").val(res.aboutUscontent);
                Ckeditor("AboutUSContent");
                $("#Tel1").val(res.tel1);
                $("#Tel2").val(res.tel2);
                $("#Tel3").val(res.tel3);
                $("#Tel4").val(res.tel4);
                $("#Tel5").val(res.tel5);
                $("#Mobile1").val(res.mobile1);
                $("#Mobile2").val(res.mobile2);
                $("#FaxNumber").val(res.faxNumber);
                $("#Email").val(res.email);
                $("#Instagram").val(res.instagram);
                $("#Whatsapp").val(res.whatsapp);
                $("#Facebook").val(res.facebook);
                $("#Telegram").val(res.telegram);
                $("#VisionAndMission").val(res.visionAndMission);
                Ckeditor("VisionAndMission");
                $("#OrganazationChart").val(res.organazationChart);
                Ckeditor("OrganazationChart");
                $("#Moto1").val(res.moto1);
                $("#Moto2").val(res.moto2);
                $("#Moto3").val(res.moto3);
                $("#Moto4").val(res.moto4);
                $("#Moto5").val(res.moto5);
                //

            }

        }, true);

    }

  
    web.AboutUs = {
        TextSearchOnKeyDown: textSearchOnKeyDown,       
        SaveAboutUs: saveAboutUs,
        InitAboutUs: initAboutUs,
       
    };

})(Web, jQuery);

(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/admin/ManagerOfParsKyan/Get_ManagerOfParsKyans", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>" + res.data[i].nameOfManager + "</td><td>" + res.data[i].title.label + "</td><td>" + res.data[i].position.label + "</td><td><a title='ویرایش' href='/Admin/ManagerOfParsKyan/EditManagerOfParsKyan?id=" + res.data[i].managersId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a><a title='حذف' class='btn btn-danger fontForAllPage' onclick='Web.ManagerOfParsKyan.Delete_ManagerOfParsKyan(" + res.data[i].managersId + ");'><i class='fa fa-remove'></i></a></td></tr>";

                }
                $("#tBodyList").html(strM);

            }

        }, true);

    }

    function saveManagerOfParsKyan(e) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/admin/ManagerOfParsKyan/Save_ManagerOfParsKyan", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                goToUrl("/Admin/ManagerOfParsKyan/Index");

            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function initManagerOfParsKyan(id = null, dir = 'rtl') {

        ComboBoxWithSearch('.select2', dir);

        AjaxCallAction("GET", "/api/admin/ManagerOfParsKyan/Get_ManagerOfParsKyan/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

            if (res != null) {

                $("#ManagersId").val(res.managersId);
                $("#NameOfManager").val(res.nameOfManager);
                $("#TwitterId").val(res.twitterId);
                $("#ResumeSummary").val(res.resumeSummary);
                $("#imgUpload_Picture").attr("src", res.pictureFull);
                $("#EmailAddress").val(res.emailAddress);
                
                $("#divDownload").html("<a href='" + res.resumeFileFull +"' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                systemSeting_Combo(!isEmpty(id) && id != 0 ? res : null);
            }

        }, true);



    }    

    function systemSeting_Combo(resSingle) {

        AjaxCallAction("POST", "/api/admin/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "1,142", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strPositionID = '<option value="">انتخاب کنید</option>';
                var strTitleID = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].parentCode == 1) {
                        strPositionID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 142) {
                        strTitleID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                }

                $("#PositionID").html(strPositionID);
                $("#TitleID").html(strTitleID);
                if (resSingle != null) {
                    $("#PositionID").val(resSingle.positionId);
                    $("#TitleID").val(resSingle.titleId);
                }
            }
        }, true);
    }

    function delete_ManagerOfParsKyan(id) {

        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/admin/ManagerOfParsKyan/Delete_ManagerOfParsKyan/" + (isEmpty(id) ? '0' : id), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        filterGrid();

                        alertB("", result.message, "success");

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }

    web.ManagerOfParsKyan = {        
        TextSearchOnKeyDown: textSearchOnKeyDown,
        FilterGrid: filterGrid,
        SaveManagerOfParsKyan: saveManagerOfParsKyan,
        InitManagerOfParsKyan: initManagerOfParsKyan,
        Delete_ManagerOfParsKyan: delete_ManagerOfParsKyan
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        ComboBoxWithSearch('.select2', 'dir');

        AjaxCallAction("POST", "/api/admin/NewsAndContent/Get_NewsAndContents", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), KindOfContent: !isEmpty($("#KindOfContent").val()) ? $("#KindOfContent").val() : null }), true, function (res) {

            if (res.isSuccess) {

                var strM = '';
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                for (var i = 0; i < res.data.length; i++) {

                    let rlink = "";
                    if (res.data[i].directLink != null && res.data[i].directLink.length>0) {
                        rlink = "/Page/" + res.data[i].directLink;
                    } else {
                        rlink = "/Page/" + res.data[i].contentId;
                    }
                    strM += `<tr><td>${(i + 1)}</td > <td>${res.data[i].contentId}</td > <td>${res.data[i].title}</td ><td>${(res.data[i].kindOfContentNavigation != null ? res.data[i].kindOfContentNavigation.label : '')}</td><td>${res.data[i].directLink == null ? "<span style='color: gray; '> - </span>" : res.data[i].directLink}</td ><td><a title='ویرایش' href='/Admin/NewsAndContent/EditNewsAndContent?id=${res.data[i].contentId}' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a><a title='مشاهده' href='javascript:void(0)' onclick="window.open('${rlink}', '_blank')" class='btn btn-primary fontForAllPage'><i class='fa fa-eye'></i></a><a title='حذف' class='btn btn-danger fontForAllPage' onclick='Web.NewsAndContent.Delete_NewsAndContent(${res.data[i].contentId});'><i class='fa fa-remove'></i></a></td></tr> `;

                }
                $("#tBodyList").html(strM);                

            }

        }, true);

    }

    function delete_NewsAndContent(id) {

        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/admin/NewsAndContent/Delete_NewsAndContent/" + (isEmpty(id) ? '0' : id), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        filterGrid();

                        alertB("", result.message, "success");

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }

    function saveNewsAndContent(e) {

        $(e).attr("disabled", "");

        AjaxCallAction("POST", "/api/admin/NewsAndContent/Save_NewsAndContent", JSON.stringify({
            ContentId: $("#ContentId").val(),
            Title: $("#Title").val(),
            Body: getDataCkeditor("Body"),
            KindOfContent: $("#KindOfContent").val(),
            Keywords: $("#Keywords").val(),
            Summary: $("#Summary").val(),
            MeteDesc: $("#MeteDesc").val(),
            DirectLink: $("#DirectLink").val(),
            Result_Final_ContentPic: $("#hid_ContentPic").val()
        }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                goToUrl("/Admin/NewsAndContent/Index");

            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function initNewsAndContent(id = null) {

        ComboBoxWithSearch('.select2', 'dir');        

        if (isEmpty(id) || id == 0) {

            Ckeditor("Body");

            Tagsinput("Keywords");

        }

        AjaxCallAction("GET", "/api/admin/NewsAndContent/Get_NewsAndContent/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

            if (res != null) {

                $("#ContentId").val(res.contentId);
                $("#Title").val(res.title);
                $("#Body").val(res.body);
                Ckeditor("Body");
                $("#KindOfContent").val(res.kindOfContent);
                $("#imgUpload_ContentPic").attr("src", res.contentPicFull);
                $("#Summary").val(res.summary);
                $("#MeteDesc").val(res.meteDesc);
                $("#DirectLink").val(res.directLink);

                $("#Keywords").val(res.keywords);
                Tagsinput("Keywords");

                systemSeting_Combo(!isEmpty(id) && id != 0 ? res : null);
            }

        }, true);

    }

    function systemSeting_Combo(resSingle) {

        AjaxCallAction("POST", "/api/admin/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "60", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfContent = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strKindOfContent += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";

                }
                $("#KindOfContent").html(strKindOfContent);
                if (resSingle != null) {

                    $("#KindOfContent").val(resSingle.kindOfContent);
                }
            }
        }, true);
    }

    web.NewsAndContent = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        FilterGrid: filterGrid,
        SaveNewsAndContent: saveNewsAndContent,
        InitNewsAndContent: initNewsAndContent,
        Delete_NewsAndContent: delete_NewsAndContent,
        SystemSeting_Combo: systemSeting_Combo
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/admin/RankingOfCompanies/Get_RankingOfCompaniess", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

            if (res.isSuccess) {
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");

                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + (i + 1) + "</td><td>" + (res.data[i].comany != null ? res.data[i].comany.companyName : '') + "</td><td>" + res.data[i].publishDate + "</td><td>" + res.data[i].longTermRating + "</td><td>" + res.data[i].shortTermRating + "</td><td><a title='ویرایش' href='/Admin/RankingOfCompanies/EditRankingOfCompanies?id=" + res.data[i].rankingId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a><a title='حذف' class='btn btn-danger fontForAllPage' onclick='Web.RankingOfCompanies.Delete_RankingOfCompanies(" + res.data[i].rankingId + ");'><i class='fa fa-remove'></i></a></td></tr>";

                }
                $("#tBodyList").html(strM);

            }

        }, true);

    }

    function saveRankingOfCompanies(e) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/admin/RankingOfCompanies/Save_RankingOfCompanies", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                goToUrl("/Admin/RankingOfCompanies/Index");

            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function initRankingOfCompanies(id = null) {
        PersianDatePicker(".DatePicker");
        ComboBoxWithSearch('.select2', 'dir');
        AjaxCallAction("GET", "/api/admin/RankingOfCompanies/Get_RankingOfCompanies/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

            if (res != null) {
                $("#TradingSymbol").val(res.tradingSymbol);
                $("#ComanyId").val(res.ComanyId);
                $("#PublishDate").val(res.publishDate);
                $("#LongTermRating").val(res.longTermRating);
                $("#ShortTermRating").val(res.shortTermRating);
                $("#Vision").val(res.Vision);
                $("#RankingId").val(res.rankingId);
                $("#StatusText").val(res.statusText);
                $("#RankingTypeText").val(res.rankingTypeText);
                $("#divDownload").html("<a href='" + res.pressReleaseFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                $("#divDownload_SummaryRanking").html("<a href='" + res.summaryRankingFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                systemSeting_Combo(!isEmpty(id) && id != 0 ? res : null);
            }
        }, true);

    }

    function systemSeting_Combo(resSingle) {

        AjaxCallAction("POST", "/api/admin/Companies/Get_Companiess", JSON.stringify({ Search: null, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strCompany = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strCompany += " <option value=" + res.data[i].companiesId + ">" + res.data[i].companyName + "</option>";
                }

                $("#ComanyId").html(strCompany);

                if (resSingle != null) {
                    $("#ComanyId").val(resSingle.comanyId);
                }
            }

        }, true);

    }

    function delete_RankingOfCompanies(id) {

        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/admin/RankingOfCompanies/Delete_RankingOfCompanies/" + (isEmpty(id) ? '0' : id), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        filterGrid();

                        alertB("", result.message, "success");

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }


    web.RankingOfCompanies = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        FilterGrid: filterGrid,
        SaveRankingOfCompanies: saveRankingOfCompanies,
        InitRankingOfCompanies: initRankingOfCompanies,
        SystemSeting_Combo: systemSeting_Combo,
        Delete_RankingOfCompanies: delete_RankingOfCompanies
    };

})(Web, jQuery);

var divPageingList_pageG = 1;
function successCallBack_divPageingList (res) {

    if (res.isSuccess) {

        var strM = '';
        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + (i + 1) + "</td>";
            strM += "<td>" + (isEmpty(res.data[i].companyName) ? '' : res.data[i].companyName) + "</td>";
            strM += "<td>" + (isEmpty(res.data[i].nationalCode) ? '' : res.data[i].nationalCode) + "</td>";
            strM += "<td>" + (isEmpty(res.data[i].agentName) ? '' : res.data[i].agentName) + "</td>";
            strM += "<td>" + (isEmpty(res.data[i].agentMobile) ? '' : res.data[i].agentMobile) + "</td>";
            strM += "<td>" + res.data[i].saveDateStr + "</td>";
            strM += "<td>" + (res.data[i].isProfileComplete ? 'ثبت درخواست' : 'عدم ثبت درخواست') + "</td>";
            strM += "<td>";
            strM += "<a title='ویرایش'  href='/Admin/Customers/EditCustomers?id=" + res.data[i].customerId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-edit'></i></a>";
            strM += "<a title='حذف' class='btn btn-danger style='margin-left:5px' fontForAllPage' onclick='Web.Customer.Delete_Customers(" + res.data[i].customerId + ");'><i class='fa fa-remove'></i></a>";
            strM += "<a title='نمایش لیست درخواست های مشتری' style='margin-left:5px'  class='btn btn-info fontForAllPage' href='/Admin/RequestForRating/Index/" + res.data[i].customerId + "'><i class='fa fa-line-chart'></i></a>";
            strM += "</td></tr>";
        }
        $("#tBodyList").html(strM);

    }

}

(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function saveCustomer(e) {

        $(e).attr("disabled", "");
        RemoveAllCharForPrice("AmountOsLastSales");
        AjaxCallActionPostSaveFormWithUploadFile("/api/admin/Customers/Save_Customers", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                /*alertB("ثبت", res.message, "success");*/
                /*$("SeeAllRequest").show();*/
                goToUrl("/Admin/Customers/Index");

            } else {

                $("#AmountOsLastSales").val(moneyCommaSepWithReturn($("#AmountOsLastSales").val()));
                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function systemSeting_Combo(resSingle) {

        AjaxCallAction("POST", "/api/admin/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "126,63,27,56,221", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';
                var strHowGetKnowCompany = '<option value="">انتخاب کنید</option>';
                var strTypeGroupCompanies = '<option value="">انتخاب کنید</option>';
                var strCustomerPersonalityType = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].parentCode == 56) {
                        strHowGetKnowCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 27) {
                        strKindOfCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                    else if (res.data[i].parentCode == 126) {
                        strTypeGroupCompanies += "<option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                    else if (res.data[i].parentCode == 221) {
                        strCustomerPersonalityType += "<option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                }

                $("#CustomerPersonalityType").html(strCustomerPersonalityType);
                $("#CustomerPersonalityType").val(resSingle.customerPersonalityType);

                $("#CustomerPersonalityType").change();

                $("#TypeGroupCompanies").html(strTypeGroupCompanies);
                $("#TypeGroupCompanies").val(resSingle.typeGroupCompanies);

                $("#KindOfCompanyId").html(strKindOfCompany);
                $("#HowGetKnowCompanyId").html(strHowGetKnowCompany);

                $("#HowGetKnowCompanyId").val(resSingle.howGetKnowCompanyId);
                $("#KindOfCompanyId").val(resSingle.kindOfCompanyId);

            }
        }, true);
    }

    function initCustomer(id, dir = 'rtl') {

        ComboBoxWithSearch('.select2', dir);
        AjaxCallAction("GET", "/api/admin/Customers/Get_Customers/" + (isEmpty(id) ? '0' : id), null, true, function (res) {


            if (res != null) {

                $("#CustomerId").val(res.customerId);
                $("#AddressCompany").val(res.addressCompany);
                $("#CompanyName").val(res.companyName);
                $("#CeoName").val(res.ceoName);
                $("#EconomicCode").val(res.economicCode);
                $("#NationalCode").val(res.nationalCode);
                $("#CeoNationalCode").val(res.ceoNationalCode);
                $("#CeoMobile").val(res.ceoMobile);
                $("#AgentMobile").val(res.agentMobile);
                $("#AgentName").val(res.agentName);
                $("#NamesAuthorizedSignatories").val(res.namesAuthorizedSignatories);
                $("#CountOfPersonal").val(res.countOfPersonal);
                $("#Email").val(res.email);
                $("#Tel").val(res.tel);
                $("#EconomicCodeReal").val(res.economicCodeReal);
                $("#PostalCode").val(res.postalCode);
                $("#AmountOsLastSales").val(moneyCommaSepWithReturn(!isEmpty(res.amountOsLastSales) ? res.amountOsLastSales.toString() : ''));

                $("#EmailRepresentative").val(res.emailRepresentative);
                $("#NationalCodeRepresentative").val(res.nationalCodeRepresentative);

                if (res.lastInsuranceList != null && res.lastInsuranceList != "") {
                    $("#divDownload").html("<a class='btn btn-success' href='" + res.lastInsuranceListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                }
                if (res.auditedFinancialStatements != null && res.auditedFinancialStatements != "") {
                    $("#divDownload_AuditedFinancialStatements").html("<a class='btn btn-success' href='" + res.auditedFinancialStatementsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                }
                $("input[name='ScanCustomerNationalCard']").val(res.scanCustomerNationalCard);
                $("input[name='ScanManagerNationalCard']").val(res.scanManagerNationalCard);
                if (res.scanCustomerNationalCard != null && res.scanCustomerNationalCard != "") {
                    $("#divDownload_ScanCustomerNationalCard").html("<a class='btn btn-success' href='" + res.scanCustomerNationalCardFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                }
                if (res.scanManagerNationalCard != null && res.scanManagerNationalCard != "") {
                    $("#divDownload_ScanManagerNationalCard").html("<a class='btn btn-success' href='" + res.scanManagerNationalCardFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                }
                systemSeting_Combo(res);
            }

        }, true);

    }
        
    function filterGrid() {

        pageingGrid("divPageingList", "/api/admin/Customers/Get_Customerss", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }));

    }

    function delete_Customers(id) {

        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/admin/Customers/Delete_Customers/" + (isEmpty(id) ? '0' : id), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        filterGrid();

                        alertB("", result.message, "success");

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }

    function onChangeCustomerPersonalityType(e) {

        if ($(e).val() == "223") {

            $(".form-group").hide();
            $(".form-group.FormIsShow").show();
            $(".NotShowRequiredLabel").hide();
            $("#LabelTypeGroupCompanies").html("نوع فعالیت");
            $("#LabelEconomicCode").html("شماره کارت بازرگانی");

            $("#spanScanCustomerNationalCardReq").show();
            $("#spanScanManagerNationalCardReq").hide();
        }
        else {

            $(".form-group").show();
            $(".NotShowRequiredLabel").show();
            $("#LabelTypeGroupCompanies").html("نوع گروه شرکتها");
            $("#LabelEconomicCode").html("شماره ثبت");

            $("#spanScanCustomerNationalCardReq").hide();
            $("#spanScanManagerNationalCardReq").hide();
        }

    }

    web.Customer = {                
        FilterGrid: filterGrid,
        TextSearchOnKeyDown: textSearchOnKeyDown,
        SaveCustomer: saveCustomer,
        InitCustomer: initCustomer,
        SystemSeting_Combo: systemSeting_Combo,
        Delete_Customers: delete_Customers,
        OnChangeCustomerPersonalityType: onChangeCustomerPersonalityType
    };

})(Web, jQuery);


var divPageingList_RequestForRatingsAdmin_pageG = 1;
function successCallBack_divPageingList_RequestForRatingsAdmin(res) {

    
    if (res.isSuccess) {
        var n = getlstor("loginName");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            var st = "", st2 = "";
            if (res.data[i].destLevelStepAccessRole == "10" && res.data[i].destLevelStepIndex == "7") {

                st2 = "<span style='font-size:1.5em'> &#128194;</span> ";
            }

            strM += "<tr><td>" + (i + 1) + "</td><td>"
                + res.data[i].requestNo + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + res.data[i].agentMobile + "</td><td>"
                + res.data[i].dateOfRequestStr + "</td>";

            strM += "<td>" + res.data[i].reciveUserName + "</td>"

            strM += "<td>";

            if (!isEmpty(res.data[i].assessment)) {

                var qe = res.data[i].assessment.split(",");

                if (qe.length == 1) {

                    strM += generateAssessment(qe[0]);

                }
                else if (qe.length == 2) {

                    strM += generateAssessment(qe[0]);

                    strM += "\n" + "<hr/>";

                    switch (qe[1]) {

                        case "0":

                            strM += "<span>امتیاز</span>";

                            break;
                        case "1":

                            strM += "<span>مدت زمان فرایند</span>";

                            break;
                        case "2":

                            strM += "<span>کارشناس ارزیابی</span>";

                            break;
                        case "3":

                            strM += "<span>فرایند صدور قرارداد</span>";

                            break;
                        case "4":

                            strM += "<span>فرایند صدور فاکتور</span>";

                            break;

                    }

                }

            }

            strM += "</td>";

            strM += "<td>";

            if (!isEmpty(res.data[i].reasonAssessment1)) {

                strM += res.data[i].reasonAssessment1;

            }

            strM += "</td>"

            if (res.data[i].levelStepSettingIndexID == "29") {
                strM += "<td>" + "<span style='color:red'>&#10060;" + "عدم تایید قرارداد" + "</span>" + "</td><td>";
            } else if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                strM += "<td>" + "<span style='color:red'> &#10060; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
            }
            else {
                strM += "<td>" + st2
                    + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                    + res.data[i].levelStepStatus + "</td><td>";
            }
            if (res.data[i].destLevelStepIndex == "3") {
                strM += "<a title='حذف درخواست' class='btn btn-danger style='margin-left:5px' fontForAllPage' onclick='Web.RequestForRating.CancelRequest(" + res.data[i].requestId + ");'><i class='fa fa-remove'></i></a>";
            }

            strM += "<a style='margin-right:5px; color:black' href='/admin/RequestForRating/RequestReferences?id=" + res.data[i].requestId + "'" + " class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title='مشاهده گردش کار'>  </a>"
            strM += "</td></tr>";

        }

        $("#tBodyList").html(strM);



    }
    

}

function generateAssessment(qe) {

    switch (qe) {

        case "0":
            /*return "<i class='far fa-laugh-beam' style='color:#006400;' title='خیلی خوشحال'></i>";*/
            return "خیلی خوشحال";
        case "1":
            /*return "<i class='far fa-grin-beam' style='color:#006400;' title='خوشحال'></i>";*/
            return "خوشحال";
        case "2":
            /*return "<i class='far fa-meh' style='color:#006400;' title='معمولی'></i>";*/
            return "معمولی";
        case "3":
            /*return "<i class='far fa-flushed' style='color:#006400;' title='غمگین'></i>";*/
            return "غمگین";
        case "4":
            /*return "<i class='far fa-angry' style='color:#006400;' title='افسرده'></i>";*/
            return "افسرده";
    }

}

(function (web, $) {
    

    function filterGrid() {

        ComboBoxWithSearch('.select2', 'rtl');

        pageingGrid("divPageingList_RequestForRatingsAdmin", "/api/admin/RequestForRating/Get_RequestForRatings", JSON.stringify({ PageIndex: 1, PageSize: $("#cboSelectCount").val(), Search: $("#txtSearch").val(), DestLevelStepIndex: isEmpty($("#cboSelectLS").val()) ? null : $("#cboSelectLS").val(), KindOfRequest: !isEmpty($("#cboKindOfRequest").val()) ? $("#cboKindOfRequest").val() : null }));

    }

    function cancelRequest(id) {

        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/admin/RequestForRating/Delete_RequestForRating/" + (isEmpty(id) ? '0' : id), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        filterGrid();

                        alertB("", result.message, "success");

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }

    function initRequestReferences(id = null) {

        AjaxCallAction("POST", "/api/admin/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1, RequestId: id }), true, function (res) {

            if (res.isSuccess) {
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].isFinished) {
                        createTimeLine(id, true);
                    } else {
                        createTimeLine(id, false);
                    }
                }
            }

        }, true);

    }

    function createTimeLine(id = null, isFinish) {

        AjaxCallAction("POST", "/api/admin/RequestForRating/Get_RequestReferencessService", JSON.stringify({ RequestId: id }), true, function (res) {

            if (res != null) {
                var strTimeLine = '';
                var left = false;

                for (var i = 0; i < res.data.length; i++) {

                    var bgColor = i == 0 ? "bg-secondary" : "bg-info";

                    strTimeLine += "<article class='timeline-entry " + (left ? " left-aligned" : "") + "'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";

                    strTimeLine += "<time class='timeline-time' datetime=''>";
                    strTimeLine += "</time>";

                    strTimeLine += "<div class='timeline-icon " + bgColor + "'>";
                    strTimeLine += "<i class='entypo-feather'></i>";
                    strTimeLine += "</div>";

                    strTimeLine += "<div class='timeline-label'>";
                    if (i == 0) {
                        strTimeLine += "<span class='smallFontSize' style='font-weight:bold'>";
                        strTimeLine += (res.data[i].agentName == null ? res.data[i].companyName : res.data[i].agentName) + " : [" + res.data[i].kindOfRequestName + "]</span >";

                        strTimeLine += "<div style='float:left;color:green'><span class='date smallFontSize'>( تاریخ: " + res.data[i].sendTimeStr + "</span>";
                        strTimeLine += "<span class='LTRDirection smallFontSize'> ساعت: " + res.data[i].sendTimeTimeStr + " )</span></div>";

                    }
                    else {
                        if (res.data[i].sendUser == null) {
                            strTimeLine += "<span class='boxCounter'>" + i.toString() + "</span>"
                                + (res.data[i].levelStepSettingIndexID == "29" ? " &#x274C; " : "")
                                + (res.data[i].levelStepSettingIndexID == "7" ? " &#x2705; " : "")
                                + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                                + "<span class='sender'>ارجاع از: مشتری" + (res.data[i].agentName == null ? " (" + res.data[i].companyName + ")" : " (" + res.data[i].agentName + ")") + "</span><br/>";
                            strTimeLine += " <span>به: " + res.data[i].roleDesReciver + " </span>";
                            strTimeLine += "<span class='sender'>" + " (" + res.data[i].reciverName + ")" + "</span>";
                        }
                        else if (res.data[i].reciverName == null) {
                            strTimeLine += "<span class='boxCounter'>" + i.toString() + "</span>"
                                + (res.data[i].levelStepSettingIndexID == "4" ? " &#x1F4DD;" : "")
                                + (res.data[i].levelStepSettingIndexID == "11" ? " &#x1F4C2;" : "")
                                + (res.data[i].levelStepSettingIndexID == "26" ? " &#x2705;" : "")
                                + " <span> ارجاع از:  " + res.data[i].userRoleDes + " (" + res.data[i].realName + ")"
                                + " </span><br/>";
                            strTimeLine += " <span>به: " + "مشتری" + " </span>";
                            strTimeLine += "<span class='sender'>" + (res.data[i].agentName == null ? " (" + res.data[i].companyName + ")" : " (" + res.data[i].agentName + ")") + "</span>";
                        }
                        else {
                            strTimeLine += "<span class='boxCounter'>" + i.toString() + "</span>"
                                + (res.data[i].levelStepSettingIndexID == "17" ? " &#x2705;" : "")
                                + (res.data[i].levelStepSettingIndexID == "28" ? " &#x274C;" : "")
                                + (res.data[i].levelStepSettingIndexID == "23" ? " &#x1F4CA;" : "")
                                + (res.data[i].roleDesReciver != null ? " <span> ارجاع از:  " + res.data[i].userRoleDes + " (" + res.data[i].realName + ")"
                                    + " </span><br/>" : "");
                            strTimeLine += " <span>به: " + res.data[i].roleDesReciver + " </span>";
                            strTimeLine += "<span class='sender'>" + " (" + res.data[i].reciverName + ")" + "</span>";
                        }
                        strTimeLine += "<br/>";
                        strTimeLine += "<span class='smallFontSize'>";
                        strTimeLine += "[" + res.data[i].destLevelStepIndexButton + "]";
                        // strTimeLine += "[ جهت اقدام] <span >[ خوانده شده ] </span><span class='greenColor'>1401/09/21  3:34</span>";
                        strTimeLine += "</span>";
                        strTimeLine += "<div style='float:left;color:green'><span class='date smallFontSize'>( تاریخ: " + res.data[i].sendTimeStr + "</span>";
                        strTimeLine += "<span class='LTRDirection smallFontSize'> ساعت: " + res.data[i].sendTimeTimeStr + ")</span></div>";


                    }
                    strTimeLine += "<span></span>";
                    if (i != 0) {
                        if (res.data[i].comment != null && res.data[i].comment != "") {

                            strTimeLine += "<div class='customDiv'>توضیحات<hr/>";
                            strTimeLine += "<span class='Transcript'>" + res.data[i].comment + "</span>";
                            strTimeLine += "</div>";
                        }
                    }
                    strTimeLine += "</div>";
                    //res.data[i].kindOfRequestName

                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                    left = !left;


                }
                if (isFinish) {
                    strTimeLine += "<article class='timeline-entry " + (left ? " left-aligned" : "") + "'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";
                    strTimeLine += "<time class='timeline-time' datetime='2014-01-10T03:45'></time>";
                    strTimeLine += "<div class='timeline-icon bg-secondary'><i class='entypo-feather'></i></div>";
                    strTimeLine += "<div class='timeline-label'>";
                    strTimeLine += "<h2>";
                    strTimeLine += "<span>تایید نهایی و اختتام درخواست </span>";
                    // strTimeLine += "<span class='sender''>مهندس</span>";
                    strTimeLine += "</h2>";
                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                } else {
                    strTimeLine += "<article class='timeline-entry begin'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";
                    strTimeLine += "<div class='timeline-icon' style='-webkit-transform: rotate(-90deg); -moz-transform: rotate(-90deg);'>";
                    strTimeLine += "<i class='entypo-flight'></i>";
                    strTimeLine += "</div>";
                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                }

                $("#TimeLine").html(strTimeLine);

            }

        }, true);

    }

    function fillComboLevelStepSettingList() {

        AjaxCallAction("POST", "/api/admin/RequestForRating/Get_LevelStepSetings", JSON.stringify({ PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strKindOfCompany += " <option value=" + res.data[i].levelStepIndex + ">" + res.data[i].levelStepStatus + "</option>";
                }

                $("#cboSelectLS").html(strKindOfCompany);



            }

            AjaxCallAction("POST", "/api/admin/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63", PageIndex: 0, PageSize: 0 }), true, function (res) {

                if (res.isSuccess) {
                    var strKindOfRequest = '<option value="">انتخاب کنید</option>';

                    for (var i = 0; i < res.data.length; i++) {
                        strKindOfRequest += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }

                    $("#cboKindOfRequest").html(strKindOfRequest);

                }
            }, true);

        }, true);

    }

    function onchangeKindOfRequest(e) {

        AjaxCallAction("POST", "/api/admin/RequestForRating/Get_LevelStepSetings", JSON.stringify({ PageIndex: 0, PageSize: 0, KindOfRequest: !isEmpty($(e).val()) ? $(e).val() : null }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strKindOfCompany += " <option value=" + res.data[i].levelStepIndex + ">" + res.data[i].levelStepStatus + "</option>";
                }

                $("#cboSelectLS").html(strKindOfCompany);



            }

        }, true);

    }

    web.RequestForRating = {
        FillComboLevelStepSettingList: fillComboLevelStepSettingList,
        FilterGrid: filterGrid,
        CancelRequest: cancelRequest,
        InitRequestReferences: initRequestReferences,
        CreateTimeLine: createTimeLine,
        OnchangeKindOfRequest: onchangeKindOfRequest

    };

})(Web, jQuery);


var divPageingList_TotalNumberCustomersApprovedContract_pageG = 1;
function successCallBack_divPageingList_TotalNumberCustomersApprovedContract(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + (i + 1) + "</td><td>"
                + res.data[i].requestNo + "</td><td>"
                + res.data[i].dateOfRequestStr + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + (!isEmpty(res.data[i].agentName) ? res.data[i].agentName : '') + "</td><td>"
                + res.data[i].nationalCode + "</td><td>"
                + res.data[i].agentMobile + "</td><td>" + res.data[i].finalPriceContract + "</td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var divPageingList_TotalNumberCustomersWithoutRegistration_pageG = 1;
function successCallBack_divPageingList_TotalNumberCustomersWithoutRegistration(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + (i + 1) + "</td><td>"
                + res.data[i].customerID + "</td><td>"
                + res.data[i].saveDateStr + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + (!isEmpty(res.data[i].agentName) ? res.data[i].agentName : '') + "</td><td>"
                + res.data[i].nationalCode + "</td><td>"
                + res.data[i].agentMobile + "</td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var divPageingList_TotalNumberApplicationsAssessmentMinistryPrivacy_pageG = 1;
function successCallBack_divPageingList_TotalNumberApplicationsAssessmentMinistryPrivacy(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + (i + 1) + "</td><td>"
                + res.data[i].requestNo + "</td><td>"
                + res.data[i].dateOfRequestStr + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + (!isEmpty(res.data[i].agentName) ? res.data[i].agentName : '') + "</td><td>"
                + res.data[i].nationalCode + "</td><td>"
                + res.data[i].agentMobile + "</td><td>" + res.data[i].finalPriceContract + "</td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var divPageingList_NumberCodedFiles_pageG = 1;
function successCallBack_divPageingList_NumberCodedFiles(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + (i + 1) + "</td><td>"
                + res.data[i].requestNo + "</td><td>"
                + res.data[i].dateOfRequestStr + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + (!isEmpty(res.data[i].agentName) ? res.data[i].agentName : '') + "</td><td>"
                + res.data[i].nationalCode + "</td><td>"
                + res.data[i].agentMobile + "</td><td>"                 + (!isEmpty(res.data[i].finalPriceContract) ? res.data[i].finalPriceContract : '0') + "</td><td>"
                + (!isEmpty(res.data[i].codalDate) ? res.data[i].codalDate : '') + "</td><td>"
                + (!isEmpty(res.data[i].codalNumber) ? res.data[i].codalNumber : '') + "</td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


var divPageingList_PerformanceReportEvaluationStaffInDetail_ReportOne_Admin_pageG = 1;
function successCallBack_divPageingList_PerformanceReportEvaluationStaffInDetail_ReportOne_Admin(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + res.data[i].row + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + res.data[i].dateOfRequestStr + "</td><td>"
                + res.data[i].lastDateReferrals + "</td><td>"
                + res.data[i].lastSituation + "</td><td>"
                + res.data[i].waitingTimeInThisSituation + "</td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var divPageingList_PerformanceReportEvaluationStaffInDetail_ReportOne2_Admin_pageG = 1;
function successCallBack_divPageingList_PerformanceReportEvaluationStaffInDetail_ReportOne2_Admin(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + res.data[i].row + "</td><td>"
                + (!isEmpty(res.data[i].userName) ? res.data[i].userName : '') + "</td><td>"
                + (!isEmpty(res.data[i].roleName) ? res.data[i].roleName : '') + "</td><td>"
                + res.data[i].numberCompletedRequests + "</td><td>"
                + res.data[i].numberOpenAndCurrentRequests + "</td><td>"
                + res.data[i].averageResponseTimeRequestsStageSendingAdditionalInformationCustomer + "</td><td><a class='btn btn-info' href='/Admin/Report/PerformanceReportEvaluationStaffInDetail_ReportOne?id=" + res.data[i].reciveUser + "' target='_blank' title='گزارش 1'><i class='fa fa-eye'></i></a></td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}

(function (web, $) {

    //Document Ready  


    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function fillComboFitterList() {


        AjaxCallAction("GET", "/api/Admin/RequestForRating/Get_UsersByRole/0", null, true, function (resGet) {

            var qD = '<option value="0" data-FieldSelectReciveUser="">انتخاب کنید</option>';
            if (resGet.isSuccess) {

                for (var i = 0; i < resGet.data.length; i++) {

                    qD += "<option value='" + resGet.data[i].userId + "' data-FieldSelectReciveUser='ReciveUserStatus' >" + (!isEmpty(resGet.data[i].user) ? resGet.data[i].user.realName : '') + "</option>";

                }

                $("#cboReciveUser").html(qD);
            }

            AjaxCallAction("POST", "/api/Admin/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "126", PageIndex: 0, PageSize: 0 }), true, function (res) {

                if (res.isSuccess) {
                    var strCompanyGroup = '<option value="0" data-FieldSelectStatusTypeGroupCompanies="">انتخاب کنید</option>';

                    for (var i = 0; i < res.data.length; i++) {
                        strCompanyGroup += " <option value=" + res.data[i].systemSetingId + " data-FieldSelectStatusTypeGroupCompanies='CompanyGroupStatus'>" + res.data[i].label + "</option>";
                    }

                    $("#cboTypeGroupCompanies").html(strCompanyGroup);

                }
            }, true);

        }, true);

    }

    function filterReportGrid() {
        PersianDatePicker(".DatePicker");
        ComboBoxWithSearch('.select2', 'rtl');

        AjaxCallAction("POST", "/api/Admin/RequestForRating/Get_ReportRequestForRatings", JSON.stringify({ PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val(), ReciveUser: $("#cboReciveUser").val(), TypeGroupCompanies: $("#cboTypeGroupCompanies").val() }), true, function (res) {

            if (res.isSuccess) {
                var n = getlstor("loginName");
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    var st = "", st2 = "";
                    if (res.data[i].destLevelStepAccessRole == "10" && res.data[i].destLevelStepIndex == "7") {

                        st2 = "<span style='font-size:1.5em'> &#128194;</span> ";
                    }

                    strM += "<tr><td>" + (i + 1) + "</td><td>"
                        + res.data[i].requestNo + "</td><td>"
                        + res.data[i].dateOfRequestStr + "</td><td>"
                        + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                        + (!isEmpty(res.data[i].agentName) ? res.data[i].agentName : '') + "</td><td>"
                        + res.data[i].nationalCode + "</td><td>"
                        + res.data[i].agentMobile + "</td><td>";

                    strM += (!isEmpty(res.data[i].evaluationExpert) ? res.data[i].evaluationExpert : '') + "</td>"

                    if (res.data[i].levelStepSettingIndexID == "29") {
                        strM += "<td>" + "<span style='color:red'>&#10060;" + "عدم تایید قرارداد" + "</span>" + "</td><td>";
                    } else if (res.data[i].levelStepSettingIndexID == "2") {
                        strM += "<td>" + "<span style='color:red'> &#10060; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
                    }
                    else if (res.data[i].levelStepSettingIndexID == "28") {
                        strM += "<td>" + "<span style='color:red'> &#10060; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
                    }
                    else if (res.data[i].levelStepSettingIndexID == "17") {
                        strM += "<td>" + "<span style='color:blue'> &#x2705; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
                    }
                    else if (res.data[i].levelStepSettingIndexID == "26") {
                        strM += "<td>" + "<span style='color:green'> &#x2705; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
                    }
                    else {
                        strM += "<td>" + st2
                            + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                            + res.data[i].destLevelStepIndexButton + "</td><td></tr>";
                    }
                }

                $("#tBodyList").html(strM);
            }

        }, true);

    }

    function printReport(e) {

        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        goToUrl("/Admin/RequestForRating/ContractPrint/" + id);
    }

    function printContracting(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/Admin/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#ContractShow").html(res.data.contentContract);
                    if (res.data.contractCode != null && res.data.contractCode != "") {
                        $('.PageContractFirst').find('input[name=SaveDate]').val(res.data.saveDateStr);
                        $('.PageContractFirst').find('input[name=ContractCode]').val(res.data.contractCode);


                    } else {
                        $("#ptr").html("<p> این نسخه قرارداد اصلی نمی باشد.</p>");
                    }
                    //$("#SaveDate").html(res.data.saveDateStr);
                    $("#ContractCode").html(res.data.contractCode);
                    $('input[type="text"], textarea').each(function () {
                        //  $(this).attr('readonly', 'readonly');
                        var text_classname = $(this).attr('name');
                        var value = $(this).val();
                        if (text_classname == "NamesAuthorizedSignatories") {
                            var new_html = ('<p style="text-align:center">' + value + '</p>');
                        } else if (text_classname == "NamesAuthorizedSignatories") {

                        }
                        else {
                            var new_html = ('<storang >' + value + '</storang>');
                        }
                        $(this).replaceWith(new_html);
                    });

                }

            }, true);
        }
    }

    function ComboBoxWithSearch(selector = '.select2', dir = 'rtl') {

        try {

            $(selector).select2({
                dir: dir,
                language: {
                    noResults: function (term) {
                        return "نتیجه ای پیدا نشد";
                    }
                }
            });

        } catch (e) {

        }

    }

    function excelUserReport() {

        try {
            window.open('/Admin/Report/getexcell?FromDateStr=' + $("#FromDateStr").val() + '&ToDateStr=' + $("#ToDateStr").val() + '&TypeGroupCompanies=' + $("#cboTypeGroupCompanies option:selected").val() + '&ReciveUser=' + $("#cboReciveUser option:selected").val(), '_blank');

        } catch (e) {

        }



    }

    function indexBoxAdmin() {

        AjaxCallAction("POST", "/Admin/Report/IndexBoxAdmin", {}, true, function (res) {

            $("#TotalNumberCustomersApprovedContract").html(res.totalNumberCustomersApprovedContract);

            $("#TotalNumberCustomersWithoutRegistration").html(res.totalNumberCustomersWithoutRegistration);

            $("#TotalNumberApplicationsAssessmentMinistryPrivacy").html(res.totalNumberApplicationsAssessmentMinistryPrivacy);

            $("#NumberCodedFiles").html(res.numberCodedFiles);

        }, true);

    }

    function excelTotalNumberCustomersApprovedContract() {

        window.open('/Admin/Report/GetTotalNumberCustomersApprovedContract1?FromDateStr=' + $("#FromDateStr").val() + '&ToDateStr=' + $("#ToDateStr").val() + "&Search=" + $("#txtSearch").val(), '_blank');

    }

    function filterReportGrid_TotalNumberCustomersApprovedContract() {

        pageingGrid("divPageingList_TotalNumberCustomersApprovedContract", "/Admin/Report/GetTotalNumberCustomersApprovedContract", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val() }));

    }

    function init_TotalNumberCustomersApprovedContract() {

        PersianDatePicker(".DatePicker");

        filterReportGrid_TotalNumberCustomersApprovedContract();
    }

    function init_TotalNumberCustomersWithoutRegistration() {

        PersianDatePicker(".DatePicker");

        filterReportGrid_TotalNumberCustomersWithoutRegistration();

    }

    function filterReportGrid_TotalNumberCustomersWithoutRegistration() {

        pageingGrid("divPageingList_TotalNumberCustomersWithoutRegistration", "/Admin/Report/GetTotalNumberCustomersWithoutRegistration", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val() }));

    }

    function excelTotalNumberCustomersWithoutRegistration() {

        window.open('/Admin/Report/GetTotalNumberCustomersWithoutRegistration1?FromDateStr=' + $("#FromDateStr").val() + '&ToDateStr=' + $("#ToDateStr").val() + "&Search=" + $("#txtSearch").val(), '_blank');

    }

    function init_TotalNumberApplicationsAssessmentMinistryPrivacy() {

        PersianDatePicker(".DatePicker");

        filterReportGrid_TotalNumberApplicationsAssessmentMinistryPrivacy();

    }

    function filterReportGrid_TotalNumberApplicationsAssessmentMinistryPrivacy() {

        pageingGrid("divPageingList_TotalNumberApplicationsAssessmentMinistryPrivacy", "/Admin/Report/GetTotalNumberApplicationsAssessmentMinistryPrivacy", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val() }));

    }

    function excelTotalNumberApplicationsAssessmentMinistryPrivacy() {

        window.open('/Admin/Report/GetTotalNumberApplicationsAssessmentMinistryPrivacy1?FromDateStr=' + $("#FromDateStr").val() + '&ToDateStr=' + $("#ToDateStr").val() + "&Search=" + $("#txtSearch").val(), '_blank');

    }

    function init_NumberCodedFiles() {

        PersianDatePicker(".DatePicker");

        filterReportGrid_NumberCodedFiles();

    }

    function filterReportGrid_NumberCodedFiles() {

        pageingGrid("divPageingList_NumberCodedFiles", "/Admin/Report/GetNumberCodedFiles", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val() }));

    }

    function excelNumberCodedFiles() {

        window.open('/Admin/Report/GetNumberCodedFiles1?FromDateStr=' + $("#FromDateStr").val() + '&ToDateStr=' + $("#ToDateStr").val() + "&Search=" + $("#txtSearch").val(), '_blank');

    }

    function initPerformanceReportEvaluationStaffInDetail_ReportOne(id = 0) {

        AjaxCallAction("GET", "/api/admin/RequestForRating/Get_UsersByRole/0", null, true, function (resGet) {

            var qD = '<option value="0">انتخاب کنید</option>';
            if (resGet.isSuccess) {

                for (var i = 0; i < resGet.data.length; i++) {

                    qD += "<option value='" + resGet.data[i].userId + "' >" + (!isEmpty(resGet.data[i].user) ? resGet.data[i].user.realName : '') + "</option>";

                }

                $("#cboReciveUser").html(qD);
                $("#cboReciveUser").val(id);

                PersianDatePicker(".DatePicker");
                ComboBoxWithSearch('.select2', 'rtl');
                filterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne();

                fillComboLevelStepSettingList();

            }

        }, true);

    }

    function filterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne() {

        pageingGrid("divPageingList_PerformanceReportEvaluationStaffInDetail_ReportOne_Admin", "/Admin/Report/GetPerformanceReportEvaluationStaffInDetail_ReportOne", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val(), ReciveUser: $("#cboReciveUser").val(), FromLastDateReferrals: $("#FromLastDateReferrals").val(), ToLastDateReferrals: $("#ToLastDateReferrals").val(), cboSelectLS: $("#cboSelectLS").val() }));

    }

    /////////////////////////////////////////////////////////////////////////////////////////////////////////////

    function initPerformanceReportEvaluationStaffInDetail_ReportOne2() {

        PersianDatePicker(".DatePicker");
        filterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne2();

    }

    function filterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne2() {

        pageingGrid("divPageingList_PerformanceReportEvaluationStaffInDetail_ReportOne2_Admin", "/Admin/Report/GetPerformanceReportEvaluationStaffInDetail_ReportOne2", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val() }));

    }

    function fillComboLevelStepSettingList() {

        AjaxCallAction("POST", "/api/admin/RequestForRating/Get_LevelStepSetings", JSON.stringify({ PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strKindOfCompany += " <option value=" + res.data[i].levelStepIndex + ">" + res.data[i].levelStepStatus + "</option>";
                }

                $("#cboSelectLS").html(strKindOfCompany);



            }

            AjaxCallAction("POST", "/api/admin/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63", PageIndex: 0, PageSize: 0 }), true, function (res) {

                if (res.isSuccess) {
                    var strKindOfRequest = '<option value="">انتخاب کنید</option>';

                    for (var i = 0; i < res.data.length; i++) {
                        strKindOfRequest += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }

                    $("#cboKindOfRequest").html(strKindOfRequest);

                }
            }, true);

        }, true);

    }

    function onchangeKindOfRequest(e) {

        AjaxCallAction("POST", "/api/admin/RequestForRating/Get_LevelStepSetings", JSON.stringify({ PageIndex: 0, PageSize: 0, KindOfRequest: !isEmpty($(e).val()) ? $(e).val() : null }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strKindOfCompany += " <option value=" + res.data[i].levelStepIndex + ">" + res.data[i].levelStepStatus + "</option>";
                }

                $("#cboSelectLS").html(strKindOfCompany);



            }

        }, true);

    }

    web.Report = {
        OnchangeKindOfRequest: onchangeKindOfRequest,
        FillComboLevelStepSettingList: fillComboLevelStepSettingList,
        FillComboFitterList: fillComboFitterList,
        FilterReportGrid: filterReportGrid,
        TextSearchOnKeyDown: textSearchOnKeyDown,
        PrintReport: printReport,
        PrintContracting: printContracting,
        ExcelUserReport: excelUserReport,
        IndexBoxAdmin: indexBoxAdmin,
        ExcelTotalNumberCustomersApprovedContract: excelTotalNumberCustomersApprovedContract,
        FilterReportGrid_TotalNumberCustomersApprovedContract: filterReportGrid_TotalNumberCustomersApprovedContract,
        Init_TotalNumberCustomersApprovedContract: init_TotalNumberCustomersApprovedContract,
        Init_TotalNumberCustomersWithoutRegistration: init_TotalNumberCustomersWithoutRegistration,
        FilterReportGrid_TotalNumberCustomersWithoutRegistration: filterReportGrid_TotalNumberCustomersWithoutRegistration,
        ExcelTotalNumberCustomersWithoutRegistration: excelTotalNumberCustomersWithoutRegistration,
        Init_TotalNumberApplicationsAssessmentMinistryPrivacy: init_TotalNumberApplicationsAssessmentMinistryPrivacy,
        FilterReportGrid_TotalNumberApplicationsAssessmentMinistryPrivacy: filterReportGrid_TotalNumberApplicationsAssessmentMinistryPrivacy,
        ExcelTotalNumberApplicationsAssessmentMinistryPrivacy: excelTotalNumberApplicationsAssessmentMinistryPrivacy,
        Init_NumberCodedFiles: init_NumberCodedFiles,
        FilterReportGrid_NumberCodedFiles: filterReportGrid_NumberCodedFiles,
        ExcelNumberCodedFiles: excelNumberCodedFiles,
        InitPerformanceReportEvaluationStaffInDetail_ReportOne: initPerformanceReportEvaluationStaffInDetail_ReportOne,
        FilterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne: filterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne,
        InitPerformanceReportEvaluationStaffInDetail_ReportOne2: initPerformanceReportEvaluationStaffInDetail_ReportOne2,
        FilterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne2: filterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne2

    };

})(Web, jQuery);

(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function initLoginLog() {

        PersianDatePicker(".DatePicker");

    }

    function filterGrid() {

        AjaxCallAction("POST", "/api/admin/LoginLog/Get_LoginLogs", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val() }), true, function (res) {

            if (res.isSuccess) {
                $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                var strM = '';
                for (var i = 0; i < res.data.length; i++) {

                    strM += "<tr><td>" + res.data[i].fullName + "</td><td>" + res.data[i].loginDateStr + " - " + res.data[i].loginTimeStr + "</td><td>" + res.data[i].signOutDateStr + " - " + res.data[i].signOutTimeStr + "</td><td>" + res.data[i].ip + "</td><td>" + res.data[i].areaName+"</td></tr>";

                }
                $("#tBodyList").html(strM);

            }

        }, true);

    }

    web.LoginLog = {
        FilterGrid: filterGrid,
        InitLoginLog: initLoginLog,
        TextSearchOnKeyDown: textSearchOnKeyDown
    };

})(Web, jQuery);
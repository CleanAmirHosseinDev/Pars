





(function (web, $) {

    //Document Ready              

    function signOutForExitToLogin() {


        AjaxCallActionWithotHeading("POST", "/api/Securitys/SignOutForExitToLogin", JSON.stringify({ Userid: getlstor("userID"), AreaName: getlstor("roleDesc") }), true, function (res) {
            debugger;
            if (res.isSuccess) {

                localStorage.removeItem("token");

                dellstor("fullName");
                dellstor("userID");
                dellstor("loginName");

                //dellstor("menu");
                //localStorage.removeItem("menu");

                dellstor("roleDesc");

                goToUrl("/Account/LoginUser");

            }

        }, false);

    }

    function initLayout() {

        if (isEmpty(localStorage.getItem("token"))) goToUrl("/Account/LoginUser");
        else {

            if (getlstor("roleDesc") == "ارزیاب") $("a[href='/SuperVisor/Customers/Index']").hide();
            
            $(".fullNameInLayout").html(getlstor("fullName"));
            $(".roleDescNameElementLayout").html(getlstor("roleDesc"));            

        }

    }

    web.Layout = {

        SignOutForExitToLogin: signOutForExitToLogin,
        InitLayout: initLayout

    };

})(Web, jQuery);
function changeInput(el, showItemID) {
    let value = el.value;
    $("#" + showItemID).text(value);
}

//AjaxCallAction("POST", "/api/superVisor/Corporate/Get_CustomerDataFormReport", JSON.stringify({ RequestId: 1328 }), true, function (res) {
//    console.log(res);
//}, false)

(function (web, $) {
    var DataFormList = "";
    var progresDynamicBar = []
    var userAccessSaveForm = true
    var questionsReturnCustomer = null;
    var _DataAnswer;
    var _DataAllQuestion;
    var _DataAllReport;
    var QuestionVersion = null;
    var VersionQuestion = null; // تعیین ورژن سوالات
    //Document Ready


    function makeLiProgresBar(progresDynamicBar) {
        let _strM = "";
        for (let i = 0; i < progresDynamicBar.length; i++) {
            if (i == 0)
                _strM += "<li class='active' id='payment'><strong>" + progresDynamicBar[i].label + "</strong></li>";
            else {
                _strM += "<li class='' id='payment'><strong>" + progresDynamicBar[i].label + "</strong></li>";
            }
        }
        _strM += "<li id='confirm'><strong>بارگذاری مدارک</strong></li>";
        return _strM;
    }

    function makeFieldset(fieldId, isFirst = true) {
        let str_M = "";
        if (isFirst) {
            str_M += "<fieldset><button type='button' name='next' class='next action-button' style='border:none;width:90px'>فرم بعدی <i class='fa fa-arrow-left'></i></button>";
            str_M += "<div class='form-card'><div class='row'><div class='col-md-12'><div class='nav-tabs-custom'><ul class='nav nav-tabs' id='TargetTabs" + fieldId + "'></ul>";
            str_M += "<div class='tab-content' id='TabPaneTargetTabs" + fieldId + "'></div></div></div></div></div>";
            str_M += "<button type='button' name='next' class='next action-button' style='border:none;width:90px'>فرم بعدی <i class='fa fa-arrow-left'></i></button></fieldset>";
        } else {
            str_M += "<fieldset><button type='button' name='previous' class='previous action-button-previous' style='border:none;width:90px'><i class='fa fa-arrow-right'></i> فرم قبلی </button>";
            str_M += "<button type='button' name='next' class='next action-button' style='border:none;width:90px'>فرم بعدی <i class='fa fa-arrow-left'></i></button>";
            str_M += "<div class='form-card'><div class='row'><div class='col-md-12'><div class='nav-tabs-custom'><ul class='nav nav-tabs' id='TargetTabs" + fieldId + "'></ul>";
            str_M += "<div class='tab-content' id='TabPaneTargetTabs" + fieldId + "'></div></div></div></div></div>";
            str_M += "<button type='button' name='previous' class='previous action-button-previous' style='border:none;width:90px'><i class='fa fa-arrow-right'></i> فرم قبلی </button>";
            str_M += "<button type='button' name='next' class='next action-button' style='border:none;width:90px'>فرم بعدی <i class='fa fa-arrow-left'></i></button></fieldset>";
        }
        return str_M;
    }

    function makeTabProgresDynamic() {
        if (progresDynamicBar.length == 0)
            AjaxCallAction("POST", "/api/superVisor/SystemSeting/Get_SystemSetings/", JSON.stringify({
                PageIndex: 0, PageSize: 0, ParentCode: 286, SortOrder: "Value_D",
            }), false, function (result) { progresDynamicBar = result.data; }, false);
        let _strM = "";
        if (progresDynamicBar.length > 1)
            for (let i = 0; i < progresDynamicBar.length; i++) {
                if (i == 0)
                    _strM += makeFieldset(progresDynamicBar[i].systemSetingId, true);
                else {
                    _strM += makeFieldset(progresDynamicBar[i].systemSetingId, false);
                }
            }
        let _strLi = makeLiProgresBar(progresDynamicBar);
        $("#progressbar").html(_strLi);
        $("#progressbar").after(_strM);
        $(".next").click(function () {

            current_fs = $(this).parent();
            next_fs = $(this).parent().next();

            //Add Class Active
            $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

            //show the next fieldset
            next_fs.show();
            //hide the current fieldset with style
            current_fs.animate({ opacity: 0 }, {
                step: function (now) {
                    // for making fielset appear animation
                    opacity = 1 - now;

                    current_fs.css({
                        'display': 'none',
                        'position': 'relative'
                    });
                    next_fs.css({ 'opacity': opacity });
                },
                duration: 600
            });
        });

        $(".previous").click(function () {
            current_fs = $(this).parent();
            previous_fs = $(this).parent().prev();

            //Remove class active
            $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

            //show the previous fieldset
            previous_fs.show();

            //hide the current fieldset with style
            current_fs.animate({ opacity: 0 }, {
                step: function (now) {
                    // for making fielset appear animation
                    opacity = 1 - now;

                    current_fs.css({
                        'display': 'none',
                        'position': 'relative'
                    });
                    previous_fs.css({ 'opacity': opacity });
                },
                duration: 600
            });
        });
    }
    function initCorporate(id = null, makeQuestionForm = true) {
        PersianDatePicker(".DatePicker");
        $("#RequestIdForms").val(id);

        AjaxCallAction("POST", "/api/customer/RequestForRating/Get_CustomerRequestInformations/", JSON.stringify({
            RequestId: $("#RequestIdForms").val(),
        }), false, function (result) {
            QuestionVersion = result.questionLevelId;
            VersionQuestion = result.questionLevelId;
        }, false);

        // دریافت همه زیر دسته های اصلی
        if (isEmpty(DataFormList))
            AjaxCallAction("POST", "/api/superVisor/Corporate/Get_DataForms", JSON.stringify({ PageIndex: 0, PageSize: 0, DataFormType: 2, SortOrder: "FormCode_A", }), false, function (res) {
                if (res.isSuccess) {
                    DataFormList = res.data;
                }
            }, true);

        // دربافت همه سوالات ثبت شده در دیتا بیس
        AjaxCallAction("POST", "/api/superVisor/Corporate/Get_DataFormQuestionss", JSON.stringify({
            PageIndex: 0, PageSize: 0, DataFormType: 2, IsActive: 15, Version: QuestionVersion,
        }), true, function (res) {
            if (res.isSuccess) {
                _DataAllQuestion = res.data;
                
            }
        }, true);

        // دریافت همه سوالاتی که به سمت مشتری بازگشت داده شده است
        AjaxCallAction("POST", "/api/superVisor/Corporate/Get_DataFormReportChecks", JSON.stringify({
            RequestId: id, PageIndex: 0, PageSize: 0,
        }), false, function (res) {
            if (!isEmpty(res)) {
                questionsReturnCustomer = res.data;
            }
        }, false);

        // دریافت همه پاسخ های کاربر
        AjaxCallAction("POST", "/api/superVisor/Corporate/Get_DataFromAnswerss", JSON.stringify({
            PageIndex: 0, PageSize: 0, RequestId: id, IsActive: 15,
        }), false, function (res) {
            if (res.isSuccess) {
                _DataAnswer = res.data;
            }
        }, true);

        // دریافت همه ریپورت ها
        AjaxCallAction("POST", "/api/superVisor/Corporate/Get_DataFormReports/", JSON.stringify({
            PageIndex: 0, PageSize: 0, RequestId: id,
        }), false, function (res) {
            if (res != null) {
                _DataAllReport = res.data;
            }
        }, true);

        makeTabProgresDynamic();
        if (makeQuestionForm) {
            makeDynamicForm("A", "TargetTabs287", true, "TabPaneTargetTabs287");

            makeDynamicForm("B", "TargetTabs290", true, "TabPaneTargetTabs290");

            makeDynamicForm("C", "TargetTabs291", true, "TabPaneTargetTabs291");

            makeDynamicForm("D", "TargetTabs288", true, "TabPaneTargetTabs288");

            makeDynamicForm("E", "TargetTabs289", true, "TabPaneTargetTabs289");

            makeDynamicForm("F", "TargetTabs292", true, "TabPaneTargetTabs292");

            makeDynamicForm("G", "TargetTabs293", true, "TabPaneTargetTabs293");

            makeDynamicForm("H", "TargetTabs294", true, "TabPaneTargetTabs294");

            makeDynamicDocumentForm("ducument_save", "document_save_pane");
        }
        $(".confrimForm").on("click", function () {
            alertB("موفقیت", "فرم با موفقیت ثبت شد جهت ادامه فرایند به مشاهده و اقدام مراجعه فرمایید", "success", "بله متوجه شدم", function () {

                goToUrl("/SuperVisor/RequestForRating/Referral/" + id);

            });

        });
    }

    function getCustomerInfo(id = null) {
        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {
                if (res.isSuccess) {
                    for (var i = 0; i < res.data.length; i++) {
                        initCustomer(res.data[i].customerId);
                    }
                }
            }, true);
        }
    }

    function initCustomer(id, dir = 'rtl') {
        AjaxCallAction("GET", "/api/superVisor/Customers/Get_Customers/" + (isEmpty(id) ? '0' : id), null, true, function (res) {
            if (res != null) {
                $("#CutomerName").html("<h4> فرم پاسخ های حاکمیت شرکتی " + res.companyName + "</h4>");
            }
        }, true);
    }

    function intiForm(FormID = null, RequestId = null) {
        let strFormId = "";
        AjaxCallAction("POST", "/api/superVisor/Corporate/Get_DataFormQuestionss", JSON.stringify({
            DataFormId: FormID, PageIndex: 0, PageSize: 0, DataFormType: 2, IsActive: 15
        }), true, function (res) {
            if (res.isSuccess) {
                strFormId = generate_strFormId(res.data, RequestId, FormID);
                $("#FormDetail" + FormID).html(strFormId);
            }
        }, true);
    }


    const createDiv = (className, innerHTML) => {
        const div = document.createElement('div');
        div.className = className;
        div.innerHTML = innerHTML;
        return div;
    };

    const createLabel = (text) => {
        const label = document.createElement('label');
        label.textContent = text;
        return label;
    };

    const createParagraph = (text) => {
        const p = document.createElement('p');
        p.style.display = 'inline-block';
        p.style.marginRight = '20px';
        p.textContent = text;
        return p;
    };

    const createInputRange = (name, min, max, value, disabled) => {
        const input = document.createElement('input');
        input.className = 'form-control';
        input.name = name;
        input.type = 'range';
        input.min = min;
        input.max = max;
        input.value = value;
        input.disabled = disabled;
        return input;
    };

    const createTextarea = (name, rows, cols, value) => {
        const textarea = document.createElement('textarea');
        textarea.className = 'form-control';
        textarea.name = name;
        textarea.rows = rows;
        textarea.cols = cols;
        textarea.textContent = value;
        return textarea;
    };



    function generate_strFormId(QuestionData, RequestId, FormID) {
        var _str_tag = "";

        for (let i = 0; QuestionData.length > i; i++) {
            let questionIsNotInReturnCustomer = false;
            let question = null;
            // بررسی اینکه آیا سوال به مشتری بازگردانده شده است یا خیر
                question = questionsReturnCustomer.find(it => it.formId === FormID && it.questionId === QuestionData[i].dataFormQuestionId)

            if (!isEmpty(question)) {
                questionIsNotInReturnCustomer = true;
            }
            
            var answer = _DataAnswer.find(o => o.formId === FormID && o.dataFormQuestionId === QuestionData[i].dataFormQuestionId)

            var dataFormQuestionScore = 0;
            let findQuestion;
            if (!isEmpty(answer)) {
                var report = _DataAllReport.find(o => o.dataFormAnswerId === answer.answerId);

                findQuestion = _DataAllQuestion.find(o => o.dataFormQuestionId === answer.dataFormQuestionId)

                if (!isEmpty(findQuestion))
                    dataFormQuestionScore = findQuestion.score

                if (findQuestion.questionType == 'select')
                    AjaxCallAction("GET", "/api/superVisor/Corporate/Get_Option/" + answer.answer.split("_")[0], null, false, function (datares) {
                        if (!isEmpty(datares)) {
                            dataFormQuestionScore = dataFormQuestionScore * datares.ratio;
                        }
                    }, true);
            }
            var formDate = {
                "formCode": "0",
                "categoryId": "0",
            }

            let dataForm = DataFormList.find(o => o.formId === FormID)
            if (!isEmpty(dataForm))
                formDate = dataForm;

            if (!isEmpty(report)) {
                let value = !isEmpty(question) ? question.superVisorDescription : "ندارد ...";
                let value_manager_report = !isEmpty(report.managerReport) ? report.managerReport : "ندارد ...";
                if (questionIsNotInReturnCustomer) {
                    _str_tag += "<div class='form-group' style='border: 2px solid red;padding: 10px;'><div class='col-12'><h4 style='line-height: 1.5;'>" + (i + 1) + " - " + QuestionData[i].questionText;
                    if (!isEmpty(QuestionData[i].helpText))
                        _str_tag += " <span title='" + QuestionData[i].helpText + "'><i class='fa'></i></span>"
                    _str_tag += "</h4></div><div class='col-12'>"
                }
                else {
                    _str_tag += "<div class='form-group'><div class='col-12'><h4 style='line-height: 1.5;'>" + (i + 1) + " - " + QuestionData[i].questionText;
                    if (!isEmpty(QuestionData[i].helpText))
                        _str_tag += " <span title='" + QuestionData[i].helpText + "'><i class='fa'></i></span>"
                    _str_tag += "</h4></div><div class='col-12'>"
                }
                _str_tag += "<div class='col-12'>";
                _str_tag += "<label>پاسخ مشتری : </label><p style='display: inline-block;margin-right: 20px;'>";
                _str_tag += answer.answer == "Yes" || answer.answer == "No" ? answer.answer : answer.answer.split("_")[1]
                _str_tag += "</p></div><div class='col-12'><label>توضیحات: </label><p style='display: inline-block;margin-right: 20px;'>" + answer.description;
                _str_tag += "</p></div><div class='col-12'><label>امتیاز سیستم: </label><p style='display: inline-block;margin-right: 20px;'>" + dataFormQuestionScore;
                _str_tag += "</p></div><div class='col-12'><label>امتیاز کارشناس:</label>";
                _str_tag += "<p style='display: inline-block;margin-right: 20px;'><input style='width: 500px;height: 50px; ' name='AnalizeScore_" + answer.answerId + "' ";
                if (getlstor("loginName") == "11") {
                    _str_tag += "type='range' disabled='disabled' "
                }
                else {
                    _str_tag += "type='range' oninput='changeInput(this, \"range_" + answer.answerId + "\")' "
                }
                if (QuestionData[i].score > 0) {
                    _str_tag += "min='0' max='" + QuestionData[i].score + "' value='" + report.analizeScore + "' >";
                }
                else {
                    _str_tag += "max='0' min='" + QuestionData[i].score + "' value='" + report.analizeScore + "' >";
                }
                _str_tag += "<span style='padding:5px;' id='range_" + answer.answerId + "'>" + report.analizeScore + "</span></p></div>"
                _str_tag += "<div class='col-12'><label>توضیحات کارشناس به مشتری :</label>";
                _str_tag += "<br><textarea rows='3' cols='100' type='text' class='form-control' name='descriptoin_" + report.dataReportId + "' id='descriptoin_" + report.dataReportId + "'>" + value + "</textarea>";
                _str_tag += "<br/><label>توضیحات مدیر به کارشناس:</label>";
                if (value_manager_report == "ندارد ...") {
                    _str_tag += "<br/><textarea rows='3' cols='100' type='text' class='form-control' name='managerReport_" + report.dataReportId + "_AnalizeScore_" + answer.answerId + "'>" + value_manager_report + "</textarea>";
                } else {
                    _str_tag += "<br/><textarea style='border: blue 5px dotted;' rows='3' cols='100' type='text' class='form-control' name='managerReport_" + report.dataReportId + "_AnalizeScore_" + answer.answerId + "'>" + value_manager_report + "</textarea>";
                }
                if (getlstor("loginName") == 12) {
                    _str_tag += '<div class="col-12"><a class="btn btn-warning" style="margin-top:20px" onclick="return Web.CorporateSuperVisor.ReturnToCustomer(this,';
                    _str_tag += QuestionData[i].dataFormQuestionId + "," + answer.answerId + "," + FormID + "," + RequestId + "," + formDate.categoryId + ", '";
                    _str_tag += formDate.formCode + "', '" + QuestionData[i].questionType + "', '" + answer.answer + "'," + "''" + "," + dataFormQuestionScore + ",";
                    _str_tag += report.dataReportId + ", '" + answer.description + "'," + "''";
                    _str_tag += ');">بازگشت به مشتری برای اصلاح</a></div>'
                }
                _str_tag += "</div><input type='hidden' name='QuestionScore' value='" + QuestionData[i].score + "'></div><hr></div>";
            }

        }
        return _str_tag;
    }

    function makeDynamicForm(SubCategoryName, PutPlace, FirstItemActive = true, PutTabPane) {
        let ID = $("#RequestIdForms").val();
        let is_first = FirstItemActive;
        let li_option = "";
        let tabPane = "";
        for (let i = 0; i < DataFormList.length; i++) {
            if (DataFormList[i].formCode.slice(0, 1) === SubCategoryName) {
                if (is_first) {
                    li_option += "<li class='active'><a href='#FormDetailTab" + DataFormList[i].formCode + "' data-toggle='tab' aria-expanded='false' >" + DataFormList[i].formCode + "</a></li>";
                    tabPane += makeTabPane(DataFormList[i].formCode, DataFormList[i].formTitle, DataFormList[i].formId, ID, is_first)
                    is_first = false;
                }
                else {
                    tabPane += makeTabPane(DataFormList[i].formCode, DataFormList[i].formTitle, DataFormList[i].formId, ID, is_first)
                    li_option += "<li class=''><a href='#FormDetailTab" + DataFormList[i].formCode + "' data-toggle='tab' aria-expanded='false' >" + DataFormList[i].formCode + "</a></li>";
                }

            }
        }
        $("#" + PutPlace).append(li_option);
        $("#" + PutTabPane).append(tabPane);

        for (let i = 0; i < DataFormList.length; i++) {
            if (DataFormList[i].formCode.slice(0, 1) === SubCategoryName) {
                intiForm(DataFormList[i].formId, ID);
            }
        }
    }
    function makeDynamicDocumentForm(PutPlace, PutTabPane) {
        var DataFormDocumentList = [];
        let ID = $("#RequestIdForms").val();
        AjaxCallAction("POST", "/api/superVisor/Corporate/Get_DataFormDocuments", JSON.stringify({
            PageIndex: 0, PageSize: 0, IsActive: 15, SortOrder: "DataFormDocumentId_A",
        }), false, function (res) {
            if (res.isSuccess) {
                DataFormDocumentList = res.data;
            }
        }, true);
        let li_option = "";
        let tabPane = "";
        li_option += "<li class='active'><a href='#FormDocumentTabDocument287' data-toggle='tab' aria-expanded='true' >بارگذاری مدارک</a></li>";
        //li_option += "<li class='active'><a href='#FormDocumentTabDocument287' data-toggle='tab' aria-expanded='true' >سهامداران</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument288' data-toggle='tab' aria-expanded='false' >نقش ذینفعان</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument289' data-toggle='tab' aria-expanded='false' >افشاء و شفافیت</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument290' data-toggle='tab' aria-expanded='false' >هیئت مدیره</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument291' data-toggle='tab' aria-expanded='false' >اطلاعات نهایی و اشخاص وابسته</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument292' data-toggle='tab' aria-expanded='false' >صورت های مالی و حسابرسی</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument293' data-toggle='tab' aria-expanded='false' >کمیته ها</a></li>";
        //li_option += "<li class=''><a href='#FormDocumentTabDocument294' data-toggle='tab' aria-expanded='false' >سایر</a></li>";

        $("#" + PutPlace).append(li_option);

        tabPane += makeDocumentTabPane("Document287", "سهامداران", ID, true);
        tabPane += makeDocumentTabPane("Document288", "نقش ذینفعان", ID, true);
        tabPane += makeDocumentTabPane("Document289", "افشاء و شفافیت", ID, true);
        tabPane += makeDocumentTabPane("Document290", "هیئت مدیره", ID, true);
        tabPane += makeDocumentTabPane("Document291", "اطلاعات نهایی و اشخاص وابسته", ID, true);
        tabPane += makeDocumentTabPane("Document292", "صورت های مالی و حسابرسی", ID, true);
        tabPane += makeDocumentTabPane("Document293", "کمیته ها", ID, true);
        tabPane += makeDocumentTabPane("Document294", "سایر", ID, true);

        $("#" + PutTabPane).append(tabPane);
        let _str287 = "";
        let _str288 = "";
        let _str289 = "";
        let _str290 = "";
        let _str291 = "";
        let _str292 = "";
        let _str293 = "";
        let _str294 = "";
        for (let i = 0; i < DataFormDocumentList.length; i++) {
            let title = DataFormDocumentList[i].title;
            let formId = "Doc" + DataFormDocumentList[i].dataFormDocumentId;
            let helpText = DataFormDocumentList[i].helpText;
            let categoryId = DataFormDocumentList[i].categoryId;
            let isRequierd = DataFormDocumentList[i].isRequierd
            switch (DataFormDocumentList[i].categoryId) {
                case 287:
                    _str287 += makeFileInput(title, formId, helpText, categoryId, DataFormDocumentList[i].dataFormDocumentId, isRequierd);
                    break;
                case 288:
                    _str288 += makeFileInput(title, formId, helpText, categoryId, DataFormDocumentList[i].dataFormDocumentId, isRequierd);
                    break;
                case 289:
                    _str289 += makeFileInput(title, formId, helpText, categoryId, DataFormDocumentList[i].dataFormDocumentId, isRequierd);
                    break;
                case 290:
                    _str290 += makeFileInput(title, formId, helpText, categoryId, DataFormDocumentList[i].dataFormDocumentId, isRequierd);
                    break;
                case 291:
                    _str291 += makeFileInput(title, formId, helpText, categoryId, DataFormDocumentList[i].dataFormDocumentId, isRequierd);
                    break;
                case 292:
                    _str292 += makeFileInput(title, formId, helpText, categoryId, DataFormDocumentList[i].dataFormDocumentId, isRequierd);
                    break;
                case 293:
                    _str293 += makeFileInput(title, formId, helpText, categoryId, DataFormDocumentList[i].dataFormDocumentId, isRequierd);
                    break;
                case 294:
                    _str294 += makeFileInput(title, formId, helpText, categoryId, DataFormDocumentList[i].dataFormDocumentId, isRequierd);
                    break;
                default:
                    break;
            }
        }
        $("#FormDocumentDocument287").append(_str287);
        $("#FormDocumentDocument288").append(_str288);
        $("#FormDocumentDocument289").append(_str289);
        $("#FormDocumentDocument290").append(_str290);
        $("#FormDocumentDocument291").append(_str291);
        $("#FormDocumentDocument292").append(_str292);
        $("#FormDocumentDocument293").append(_str293);
        $("#FormDocumentDocument294").append(_str294);

        AjaxCallAction("POST", "/api/superVisor/Corporate/Get_DataFromAnswersDocuments", JSON.stringify({
            PageIndex: 0, PageSize: 0, FormID: null, RequestId: ID, DataFormQuestionId: null
        }), false, function (res) {
            if (res.isSuccess) {
                LoadedDataFromDb = res.data;
                for (let i = 0; i < LoadedDataFromDb.length; i++) {
                    try {
                        $("#Download_" + LoadedDataFromDb[i].dataFormDocumentId).prop("href", LoadedDataFromDb[i].fileName1Full);
                        $("#Download_" + LoadedDataFromDb[i].dataFormDocumentId).css("display", 'inline-block');
                    } catch (e) { }

                }
            }
        }, true);

    }
    function makeFileInput(inputTitle, inputName, helpText, categoryId, documentId, isRequierd = true) {
        let RequestId = $("#RequestIdForms").val();
        var _DataAnswerDoc;
        AjaxCallAction("POST", "/api/superVisor/Corporate/Get_DataFromAnswerss", JSON.stringify({
            PageIndex: 0, PageSize: 0, FormID: null, RequestId: RequestId
        }), false, function (res) {
            if (res.isSuccess) {
                _DataAnswerDoc = res.data;
            }
        }, true);
        var answer = _DataAnswerDoc.find(o => o.requestId == RequestId && o.dataFormDocumentId == documentId)
        if (isEmpty(answer)) {
            answer = {
                "description": "",
                "fileName1Full": "",
            }
        }
        var DocumentIsNotInReturnCustomer = false;
        let value = "";
        // بررسی اینکه آیا سوال به مشتری بازگردانده شده است یا خیر
        try {
            AjaxCallAction("POST", "/api/superVisor/Corporate/Get_DataFormReportCheck", JSON.stringify({
                RequestId: RequestId, DocumentId: documentId
            }), false, function (res) {
                if (res.isActive == 15 && res.requestId != 0 && res.checkId != 0) {
                    DocumentIsNotInReturnCustomer = true;
                    value = res.superVisorDescription;
                }
            }, true);
        } catch (e) {

        }
        let _str = "";
        value != "" ? value : "ندارد ..."
        _str += "<div class='form-group'><div class='col-12' style='margin-bottom:10px'><label class='control-label'>" + inputTitle;
        if (!isEmpty(helpText))
            _str += " <span title='" + helpText + "'><i class='fa'></i></span>";
        if (isRequierd)
            _str += "<span style='font-size: 25px;color: red;padding: 10px;'>*</span>"
        _str += "</label><a class='btn btn-success' style='margin-right: 10px;display:none;' target='_blank' id='Download_" + inputName.slice(3, inputName.length) + "'>";
        _str += "<i class='fa fa-download'></i> &nbsp;دانلود</a></div>";
        if (DocumentIsNotInReturnCustomer)
            _str += "<div class='col-12' style='border: 2px solid red;'><label>توضیحات کارشناس به مشتری</label>";
        else {
            _str += "<div class='col-12'><label>توضیحات کارشناس به مشتری</label>";
        }
        _str += "<input style='width: 100%;margin: 10px;' type='text' id='descriptoinDoc_" + inputName.slice(3, inputName.length) + "' name='descriptoinDoc_" + inputName.slice(3, inputName.length) + "' ";
        _str += 'value="' + value + '" onfocus="select();">';
        if (getlstor("loginName") == 12) {
            _str += '<a style="margin: 10px;" class="btn btn-warning" onclick="return Web.CorporateSuperVisor.ReturnToCustomerDoc(this,'
            _str += 0 + "," + 0 + "," + 0 + "," + RequestId + "," + categoryId + ",";
            _str += documentId + "," + "''," + "''," + "''," + "'', '" + answer.fileName1Full + "'," + 0 + "," + inputName.slice(3, inputName.length) + "," + "'',";
            _str += "'', ";
            _str += ');">بازگشت به مشتری برای اصلاح</a>'
        }
        
        _str += "</div></div>"
        return _str;
    }
    function makeTabPane(FormCode, FormTitle, FormId, RequestId, FirstItemActive = true) {
        let is_first = FirstItemActive;
        let strM = "";
        if (is_first) {
            strM = "<div class='tab-pane active' id='FormDetailTab" + FormCode + "'>";
        }
        else {
            strM = "<div class='tab-pane' id='FormDetailTab" + FormCode + "'>";
        }
        strM += "<div style='display:flex;justify-content: space-between;align-items: center;'>";
        strM += "<h2 class='fs-title'>" + FormTitle + "</h2>";
        if (userAccessSaveForm) {
            strM += "<a class='btn btn-success' style='height: 35px;' onclick='Web.CorporateSuperVisor.SaveSerializedForm(" + FormId + ");'>ذخیره تغییرات " + FormCode + "</a>";
        }
        strM += "</div><div style=' border: 2px solid #00c0ef; padding: 30px; border-radius: 5px; margin-bottom: 20px'><form id='frmFrom";
        strM += FormId + "' class='changeData'>";
        strM += "<input type='hidden' id='FormID' name='FormID' value='" + FormId + "' />";
        strM += "<input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "' />";
        strM += "<div class='row' id='FormDetail" + FormId + "'></div></form></div></div>";
        return strM
    }
    function makeDocumentTabPane(FormCode, FormTitle, RequestId, FirstItemActive = true) {
        let is_first = FirstItemActive;
        let strM = "";
        if (is_first) {
            strM = "<div class='tab-pane active' id='FormDocumentTab" + FormCode + "'>";
        }
        else {
            strM = "<div class='tab-pane' id='FormDocumentTab" + FormCode + "'>";
        }
        strM += "<div style='display:flex;justify-content: space-between;align-items: center;'>";
        strM += "<h2 class='fs-title'>" + FormTitle + "</h2></div>";
        strM += "<div style=' border: 2px solid #00c0ef; padding: 30px; border-radius: 5px; margin-bottom: 20px'><form id='frmFrom";
        strM += FormCode + "' class='changeData'>";
        strM += "<input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "' />";
        strM += "<div class='row' id='FormDocument" + FormCode + "'></div></form></div></div>";
        return strM
    }
    function save_AnswersAnalize(el, FormName) {
        let requestId = $("#RequestIdForms").val();
        $(el).attr("disabled", "");
        let fileInp = document.getElementById("Inp" + FormName.slice(6, FormName.length))
        if (fileInp.files.length != 0) {
            AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/Corporate/Save_DataFromAnswersUpload", fill_AjaxCallActionPostSaveFormWithUploadFile(FormName), true, function (res) {
                $(el).removeAttr("disabled");
                if (res.isSuccess) {
                    if (res.dataId != 0)
                        // ذخیره سوال در جدول آنالیز نمره
                        AjaxCallAction("POST", "/api/customer/Corporate/Save_DataFromReport", JSON.stringify({
                            RequestId: requestId,
                            DataFormAnswerId: res.dataId,
                            SystemScore: 0,
                            AnalizeScore: 0,
                            IsActive: 15,
                        }), true, function (reee) { }, true);
                    alertB("ثبت", "اطلاعات ثبت شد", "success");
                }
                else {
                    alertB("خطا", "ذخیره موفقیت آمیز نبود مجددا تلاش فرماید", "error");
                }
            }, true);
        }
        else {
            alertB("خطا", "ابتدا فایل را انتخاب نمایید!", "error");
            $(el).removeAttr("disabled");
        }
        return false;
    }
    function saveSerializedForm(FormId) {
        let SerializerForm = $("#frmFrom" + FormId).serialize().split('&');
        let formId = SerializerForm[0].split("=")[1];
        let ListOfAnswers = SerializerForm.slice(2, SerializerForm.length);
        let counter = ListOfAnswers.length;
        showWait();
        try {
            if (getlstor("loginName") == 11) {
                for (let i = 0; i < counter && counter % 3 == 0; i += 3) {
                    let SingleQuestion = ListOfAnswers.slice(0, 3);
                    let question_score = SingleQuestion[2].split("=")[1]
                    let report_id = SingleQuestion[1].split("=")[0].split("_")[1]
                    let description = decodeURIComponent(SingleQuestion[0].split("=")[1]);
                    let answer_id = SingleQuestion[1].split("_")[3].split("=")[0];
                    let score = null;
                    let manager_report = decodeURIComponent(SingleQuestion[1].split("=")[1]);
                    ListOfAnswers = ListOfAnswers.slice(3, ListOfAnswers.length)
                    saveSingelAnswerForm(formId, answer_id, score, question_score, description, report_id, manager_report);
                }
            }
            else if (getlstor("loginName") == 12) {
                for (let i = 0; i < counter && counter % 4 == 0; i += 4) {
                    let SingleQuestion = ListOfAnswers.slice(0, 4);
                    let question_score = SingleQuestion[3].split("=")[1]
                    let report_id = SingleQuestion[1].split("=")[0].split("_")[1]
                    let description = decodeURIComponent(SingleQuestion[1].split("=")[1]);
                    let answer_id = SingleQuestion[0].split("=")[0].split("_")[1]
                    let score = SingleQuestion[0].split("=")[1]
                    let manager_report = decodeURIComponent(SingleQuestion[2].split("=")[1]);
                    ListOfAnswers = ListOfAnswers.slice(4, ListOfAnswers.length)
                    if (!isEmpty(score)) {
                        saveSingelAnswerForm(formId, answer_id, score, question_score, description, report_id, manager_report);
                    }
                }
            }
            hideWait();
            alertB("ثبت", "ثبت فرم با موفقیت انجام شد", "success");
        }
        catch (e) {
            hideWait();
            alertB("خطا", "عملیات ذخیره سازی با خطا مواجه شد", "error");
        }
        hideWait();
    }
    function saveSingelAnswerForm(formId, answer_id, score, question_score, description, reportId, manager_report) {
        var requestId = $("#RequestId").val();
        // ذخیره سوال در جدول آنالیز نمره
        AjaxCallAction("POST", "/api/superVisor/Corporate/Save_DataFromReport", JSON.stringify({
            DataReportId: reportId,
            RequestId: requestId,
            DataFormAnswerId: answer_id,
            AnalizeScore: score,
            SystemScore: question_score,
            IsActive: 15,
            Description: description,
            ManagerReport: manager_report,
        }), true, function (data) { }, true);

    }

    function returnToCustomer(el,
        QuestionId, AnswerId, FormId, RequestId, CategoryId,
        FormCode, QuestionType, AnswerBeforEdit, AnswerAfterEdit, SystemScore,
        DataReportId, CostumerDescriptionBeforEdit, CostumerDescriptionAfterEdit
    ) {
        try {
            const p = $($(el).parent().parent().parent());
            confirmB("", "آیا از بازگرداندن سوال به مشتری مطمئن هستید؟", 'error', function () {
                let SuperVisorDescription = $('#descriptoin_' + DataReportId).val();
                AjaxCallAction("POST", "/api/superVisor/Corporate/Save_DataFormReportCheck", JSON.stringify({
                    QuestionId: QuestionId,
                    AnswerId: AnswerId,
                    FormId: FormId,
                    RequestId: RequestId,
                    CategoryId: CategoryId,
                    FormCode: FormCode,
                    QuestionType: QuestionType,
                    AnswerBeforEdit: AnswerBeforEdit,
                    AnswerAfterEdit: AnswerAfterEdit,
                    SystemScore: SystemScore,
                    SuperVisorDescription: SuperVisorDescription,
                    CostumerDescriptionBeforEdit: CostumerDescriptionBeforEdit,
                    CostumerDescriptionAfterEdit: CostumerDescriptionAfterEdit,
                    IsActive: 15,
                }), true, function (data) { p.css('border', 'solid red 2px'); }, true);
                alertB("ثبت", "بعد از تایید نهایی سوالات انتخاب شده به مشتری باز گردانده خواهد شد", "success");
            }, function () {
            }, ["خیر", "بلی"]);
        }
        catch (e) {
            alertB("خطا", "ذخیره موفقیت آمیز نبود مجددا تلاش فرماید", "error");
        }
        return false
    }

    function returnToCustomerDoc(el,
        QuestionId, AnswerId, FormId, RequestId, CategoryId, DocumentId,
        FormCode, QuestionType, AnswerBeforEdit, AnswerAfterEdit, _Document, SystemScore,
        DataReportId, CostumerDescriptionBeforEdit, CostumerDescriptionAfterEdit
    ) {
        try {
            const p = $($(el).parent().parent());
            confirmB("", "آیا از بازگرداندن به مشتری مطمئن هستید؟", 'error', function () {
                let SuperVisorDescription = $('#descriptoinDoc_' + DataReportId).val();
                AjaxCallAction("POST", "/api/superVisor/Corporate/Save_DataFormReportCheck", JSON.stringify({
                    QuestionId: QuestionId,
                    AnswerId: AnswerId,
                    FormId: FormId,
                    RequestId: RequestId,
                    CategoryId: CategoryId,
                    DocumentId: DocumentId,
                    FormCode: FormCode,
                    QuestionType: QuestionType,
                    AnswerBeforEdit: AnswerBeforEdit,
                    AnswerAfterEdit: AnswerAfterEdit,
                    _Document: _Document,
                    SystemScore: SystemScore,
                    SuperVisorDescription: SuperVisorDescription,
                    CostumerDescriptionBeforEdit: CostumerDescriptionBeforEdit,
                    CostumerDescriptionAfterEdit: CostumerDescriptionAfterEdit,
                    IsActive: 15,
                }), true, function (data) { p.css('border', 'solid red 2px'); }, true);
                alertB("ثبت", "بعد از تایید نهایی سوالات انتخاب شده به مشتری باز گردانده خواهد شد", "success");
            }, function () {
            }, ["خیر", "بلی"]);
        }
        catch (e) {
            alertB("خطا", "ذخیره موفقیت آمیز نبود مجددا تلاش فرماید", "error");
        }
        return false
    }


    function initCorporateScore(id) {
        let sum_score = 0;
        let all_score = 0;

        AjaxCallAction("POST", "/api/superVisor/Corporate/Get_DataFormQuestionss", JSON.stringify({
            PageIndex: 0,
            PageSize: 0,
            IsActive: 15,
            DataFormType: 2,
            Version: null,
            QuestionLevel: VersionQuestion,
        }), false, function (res) {
            for (let i = 0; i < res.data.length; i++) {
                all_score += res.data[i].score;
            }
        }, false);

        AjaxCallAction("POST", "/api/superVisor/Corporate/Get_DataFormReports", JSON.stringify({
            PageIndex: 0,
            PageSize: 0,
            IsActive: 15,
            RequestId: id
        }), false, function (res) {
            if (res.isSuccess) {
                console.log(res)
                for (let i = 0; i < res.data.length; i++) {
                    sum_score += res.data[i].analizeScore;
                }
            }
        }, true);
        $("#msform").html('<p>نمره نهایی شما برابر است با ' + sum_score + ' از ' + all_score + ' نمره</p><br/>')
        getDocumentScore(id);
    }
    function getDocumentScore(id = null) {
        if (!isEmpty(id) && id != 0) {

            if (!isEmpty(id) && id != 0) {

                AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                    if (res.isSuccess) {
                        if (res.data.evaluationFile != null && res.data.evaluationFile != "") {
                            $("#divDownload_EvaluationFile").html("<a class='btn btn-success' href='" + res.data.evaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else {
                            $("#divDownload_EvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                        }
                    }

                }, true);
            }



        }
    }


    web.CorporateSuperVisor = {
        IntiForm: intiForm,
        InitCorporate: initCorporate,
        InitCustomer: initCustomer,
        MakeDynamicForm: makeDynamicForm,
        MakeDynamicDocumentForm: makeDynamicDocumentForm,
        SaveSerializedForm: saveSerializedForm,
        Save_AnswersAnalize: save_AnswersAnalize,
        ReturnToCustomer: returnToCustomer,
        ReturnToCustomerDoc: returnToCustomerDoc,
        InitCorporateScore: initCorporateScore,
        GetDocumentScore: getDocumentScore
    };

})(Web, jQuery);
var divPageingList_RequestForRatingsSupervisor_pageG = 1;
function successCallBack_divPageingList_RequestForRatingsSupervisor(res) {


    if (res.isSuccess) {
        var n = getlstor("loginName");
        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            var st = "", st2 = "";
            if (res.data[i].destLevelStepAccessRole == "10" && res.data[i].destLevelStepIndex == "7") {

                st2 = "<span style='font-size:1.5em'> &#128194;</span> ";
            }

            strM += "<tr><td>" + (i + 1) + "</td><td>"
                + res.data[i].requestNo + "</td><td>" 
                + res.data[i].kindOfRequestName + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + res.data[i].nationalCode + "</td><td>"

                + res.data[i].agentMobile + "</td><td>"

                + res.data[i].dateOfRequestStr + "</td>";

            strM += "<td>" + res.data[i].reciveUserName + "</td>"

            if (res.data[i].levelStepSettingIndexID == "29") {
                strM += "<td>" + "<span style='color:red'>&#10060;" + "عدم تایید قرارداد" + "</span>" + "</td><td>";
            } else if (res.data[i].levelStepSettingIndexID == "2") {
                strM += "<td>" + "<span style='color:red'> &#10060; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
            }
            else if (res.data[i].levelStepSettingIndexID == "28") {
                strM += "<td>" + "<span style='color:red'> &#10060; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
            }
            else if (res.data[i].levelStepSettingIndexID == "17") {
                strM += "<td>" + "<span style='color:blue'> &#x2705; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
            }
            else if (res.data[i].levelStepSettingIndexID == "26") {
                strM += "<td>" + "<span style='color:green'> &#x2705; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
            }
            else {
                strM += "<td>" + st2
                    + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                    + res.data[i].destLevelStepIndexButton + "</td><td>";
            }

            strM += "<a style='margin-right:5px; color:black' href='/superVisor/RequestForRating/RequestReferences?id=" + res.data[i].requestId + "'" + " class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title='مشاهده گردش کار'>  </a>"
                + (getlstor("loginName") === res.data[i].destLevelStepAccessRole
                    && getlstor("userID") == res.data[i].reciveUser
                    ? "<a style='margin-right:5px;color:black' title='مشاهده و اقدام' class='btn btn-edit fontForAllPage' href='/SuperVisor/RequestForRating/Referral/"
                    + res.data[i].requestId + "'> <i class='fa fa-mail-forward' style='color:black'></i>  </a>" : "<a style='color:black;margin-right:5px; ><i class='fa fa-eye'></i> </a>");

            //if ((n == res.data[i].destLevelStepAccessRole && res.data[i].destLevelStepAccessRole == "5") || (n == "5" && res.data[i].destLevelStepAccessRole == "10" && res.data[i].destLevelStepIndex == "7")) {
            //    strM += "<a style='margin-right:5px;color:black' title='مشاهده اطلاعات تکمیلی' class='btn btn-default fontForAllPage' href='/SuperVisor/FutherInfo/Index/" + res.data[i].requestId + "'><i class='fa fa-file'></i> </a>";
            //}
            if ((n == 8 || n == 1 || n == 5 || n == 4 || n == 9) && Number(res.data[i].levelStepSettingIndexID) >= 12 && Number(res.data[i].levelStepSettingIndexID) != 31 && Number(res.data[i].levelStepSettingIndexID) != 29 && res.data[i].kindOfRequest=="66") {
                strM += "<a style='margin-right:5px;color:black' title='مشاهده اطلاعات تکمیلی' class='btn btn-default fontForAllPage' href='/SuperVisor/FutherInfo/Index/" + res.data[i].requestId + "'><i class='fa fa-id-card-o'></i> </a>";
            }
            if ((n == 12 || n == 11) && Number(res.data[i].levelStepSettingIndexID) > 39 && res.data[i].kindOfRequest == "254") {
                if (Number(res.data[i].levelStepSettingIndexID) >=43) {
                    strM += "<a style='margin-right:5px;color:black' title='خروجی اکسل' class='btn btn-default fontForAllPage' href='/SuperVisor/corporate/Excel_CustomerDataFormReport/" + res.data[i].requestId + "'><i class='fa fa-file-excel-o'></i> </a>";

                }
                strM += "<a style='margin-right:5px;color:black' title='مشاهده پرسشنامه' class='btn btn-default fontForAllPage' href='/SuperVisor/corporate/Index/" + res.data[i].requestId + "'><i class='fa fa-id-card-o'></i> </a>";
            }
            //if ((n == 8 || n == 1 || n == 4 || n == 6 || n == 9) && res.data[i].destLevelStepIndex >= "4" && getlstor("loginName") != res.data[i].destLevelStepAccessRole) {
            else if (res.data[i].kindOfRequest == "254" && res.data[i].destLevelStepIndex >= 102 ) {

                strM += "<a style='margin-right:5px;color:black' title='اسناد مشتری' class='btn btn-success fontForAllPage' href='/SuperVisor/RequestForRating/RequestDocument/" + res.data[i].requestId + "'><i class='fa fa-file-pdf-o'></i> </a>";
            } else if ((res.data[i].kindOfRequest == "66") && (res.data[i].levelStepSettingIndexID >= 4)) {
                strM += "<a style='margin-right:5px;color:black' title='اسناد مشتری' class='btn btn-success fontForAllPage' href='/SuperVisor/RequestForRating/RequestDocument/" + res.data[i].requestId + "'><i class='fa fa-file-pdf-o'></i> </a>";

            }
            if (res.data[i].levelStepSettingIndexID >= 43 && (n=="12" || n=="11")) {
                strM += "<a style='margin-right:5px;color:black' title='نمایش امتیازها' class='btn btn-success fontForAllPage' href='/SuperVisor/corporate/ShowScore/" + res.data[i].requestId + "'><i class='fa fa-star'></i> </a>";
            }
            //  }
            strM += "</td></tr>";
            //if (res.data[i].levelStepIndex >= 7) {


            // }
        }

        $("#tBodyList").html(strM);



    }


}

var divPageingList_RequestForRatingsASuperVisor_pageG = 1;
function successCallBack_divPageingList_RequestForRatingsASuperVisor(res) {


    if (res.isSuccess) {
        var n = getlstor("loginName");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            var st = "", st2 = "";
            if (res.data[i].destLevelStepAccessRole == "10" && res.data[i].destLevelStepIndex == "7") {

                st2 = "<span style='font-size:1.5em'> &#128194;</span> ";
            }

            strM += "<tr><td>" + (i + 1) + "</td><td>"
                + res.data[i].requestNo + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + res.data[i].agentMobile + "</td><td>"
                + res.data[i].dateOfRequestStr + "</td>";

            strM += "<td>" + res.data[i].reciveUserName + "</td>"
            strM += "<td>" + res.data[i].sendTimeStr + "</td>"
            strM += "<td>";

            if (!isEmpty(res.data[i].assessment)) {

                var qe = res.data[i].assessment.split(",");

                if (qe.length == 1) {

                    strM += generateAssessment(qe[0]);

                }
                else if (qe.length == 2) {

                    strM += generateAssessment(qe[0]);

                    strM += "\n" + "<hr/>";

                    switch (qe[1]) {

                        case "0":

                            strM += "<span>امتیاز</span>";

                            break;
                        case "1":

                            strM += "<span>مدت زمان فرایند</span>";

                            break;
                        case "2":

                            strM += "<span>کارشناس ارزیابی</span>";

                            break;
                        case "3":

                            strM += "<span>فرایند صدور قرارداد</span>";

                            break;
                        case "4":

                            strM += "<span>فرایند صدور فاکتور</span>";

                            break;

                    }

                }

            }

            strM += "</td>";

            strM += "<td>";

            if (!isEmpty(res.data[i].reasonAssessment1)) {

                strM += res.data[i].reasonAssessment1;

            }

            strM += "</td>"

            if (res.data[i].levelStepSettingIndexID == "29") {
                strM += "<td>" + "<span style='color:red'>&#10060;" + "عدم تایید قرارداد" + "</span>" + "</td><td>";
            } else if (res.data[i].destLevelStepIndexButton == "ارجاع به مشتری جهت اصلاح مشخصات اولیه توسط مشتری") {
                strM += "<td>" + "<span style='color:red'> &#10060; " + res.data[i].destLevelStepIndexButton + "</span>" + "</td><td>";
            }
            else {
                strM += "<td>" + st2
                    + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                    + res.data[i].levelStepStatus + "</td><td>";
            }
            //if (res.data[i].destLevelStepIndex == "2") {
            //    strM += "<a title='حذف درخواست' class='btn btn-danger style='margin-left:5px' fontForAllPage' onclick='Web.RequestForRating.CancelRequest(" + res.data[i].requestId + ");'><i class='fa fa-remove'></i></a>";
            //}

            strM += "<a style='margin-right:5px; color:black' href='/superVisor/RequestForRating/RequestReferencesA?id=" + res.data[i].requestId + "'" + " class='btn btn-info fontForAllPage'> <img src='/css/GlobalAreas/dist/img/timeline-icon.png' style='width:20px' title='مشاهده گردش کار'>  </a>"
            strM += "</td></tr>";

        }

        $("#tBodyList").html(strM);



    }


}

(function (web, $) {

    //Document Ready  

    function filterGridA() {

        ComboBoxWithSearch('.select2', 'rtl');
        PersianDatePicker(".DatePicker");
        pageingGrid("divPageingList_RequestForRatingsASuperVisor", "/api/superVisor/RequestForRating/Get_RequestForRatingsA", JSON.stringify({
            PageIndex: 1,
            PageSize: $("#cboSelectCount").val(),
            Search: $("#txtSearch").val(),
            DestLevelStepIndex: isEmpty($("#cboSelectLS").val()) ? null : $("#cboSelectLS").val(),
            FromDateStr: $("#FromDateStr").val(),
            ToDateStr: $("#ToDateStr").val(),
            FromSendTimeDateStr: $("#FromSendTimeDateStr").val(),
            ToSendTimeDateStr: $("#ToSendTimeDateStr").val(),
        }));

    }

    function excelTotalFilterGridA() {
        window.open('/SuperVisor/Report/Get_RequestForRatingsA1?FromDateStr=' + $("#FromDateStr").val() +
            '&ToDateStr=' + $("#ToDateStr").val() +
            '&PageIndex=1' +
            '&PageSize=' + $("#cboSelectCount").val() +
            '&DestLevelStepIndex=' + isEmpty($("#cboSelectLS").val()) ? null : $("#cboSelectLS").val() +
            "&Search=" + $("#txtSearch").val(), '_blank');

    }

    function onchangeKindOfRequest(e) {

        AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_LevelStepSetings", JSON.stringify({
            PageIndex: 0, PageSize: 0, KindOfRequest: !isEmpty($(e).val()) ? $(e).val() : null
        }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strKindOfCompany += " <option value=" + res.data[i].levelStepIndex + ">" + res.data[i].levelStepStatus + "</option>";
                }

                $("#cboSelectLS").html(strKindOfCompany);



            }

        }, true);

    }

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function fillComboLevelStepSettingList() {
        let requestKind = 0;
        let CorporateAccess = ["11", "12"];
        let ContractAccess = ["4", "9"];

        if (CorporateAccess.includes(getlstor("loginName"))) {
            requestKind = 254;
        }
        else if (ContractAccess.includes(getlstor("loginName"))) {
            requestKind = 1;
        }
        AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_LevelStepSetings", JSON.stringify({ PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';
                if (requestKind == 0) {
                    for (var i = 0; i < res.data.length; i++) {
                        if (res.data[i].kindOfRequest != 254 || res.data[i].kindOfRequest != "254")
                            strKindOfCompany += " <option value=" + res.data[i].levelStepIndex + ">" + res.data[i].levelStepStatus + "</option>";
                    }
                }
                if (requestKind == 1) {
                    for (var i = 0; i < res.data.length; i++) {
                        strKindOfCompany += " <option value=" + res.data[i].levelStepIndex + ">" + res.data[i].levelStepStatus + "</option>";
                    }
                }
                else if (requestKind == 254) {
                    for (var i = 0; i < res.data.length; i++) {
                        if (res.data[i].kindOfRequest == 254 || res.data[i].kindOfRequest == "254")
                            strKindOfCompany += " <option value=" + res.data[i].levelStepIndex + ">" + res.data[i].levelStepStatus + "</option>";
                    }
                }

                $("#cboSelectLS").html(strKindOfCompany);

            }

            AjaxCallAction("POST", "/api/superVisor/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63", PageIndex: 0, PageSize: 0 }), true, function (res) {

                if (res.isSuccess) {
                    var strKindOfRequest = '<option value="">انتخاب کنید</option>';
                    if (requestKind == 0) {
                        for (var i = 0; i < res.data.length; i++) {
                            if (res.data[i].systemSetingId != 254 || res.data[i].systemSetingId != "254")
                                strKindOfRequest += "<option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                        }
                    }
                    else if (requestKind == 1) {
                        for (var i = 0; i < res.data.length; i++) {
                            strKindOfRequest += "<option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                        }
                    }
                    else if (requestKind == 254) {
                        for (var i = 0; i < res.data.length; i++) {
                            if (res.data[i].systemSetingId == 254 || res.data[i].systemSetingId == "254")
                                strKindOfRequest += "<option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                        }
                    }

                    $("#cboKindOfRequest").html(strKindOfRequest);

                }
            }, true);

        }, true);
    }

    function filterGrid() {

        ComboBoxWithSearch('.select2', 'rtl');
        let requestKind = 1;
        let CorporateAccess = ["11", "12"];
        let ContractAccess = ["4", "9"];

        if (CorporateAccess.includes(getlstor("loginName"))) {
            requestKind = 254;
        }
        else if (ContractAccess.includes(getlstor("loginName"))) {
            requestKind = 1;
        }
        console.log(!isEmpty($("#cboKindOfRequest").val()) ? $("#cboKindOfRequest").val() : requestKind == 254 ? 254 : requestKind == 1 ? null : null)
        pageingGrid("divPageingList_RequestForRatingsSupervisor", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify(
            {
                Search: $("#txtSearch").val(),
                PageIndex: 1,
                PageSize: $("#cboSelectCount").val(),
                DestLevelStepIndex: isEmpty($("#cboSelectLS").val()) ? null : $("#cboSelectLS").val(),
                IsMyRequests: $('#IsMyRequests').is(":checked"),
                KindOfRequest: !isEmpty($("#cboKindOfRequest").val()) ? $("#cboKindOfRequest").val() : requestKind == 254 ? 254 : requestKind == 1? null:null
            }));
    }

    function initReferral(id = null) {

        AjaxCallAction("GET", "/api/superVisor/RequestForRating/InitReferral/" + id, null, true, function (res) {

            if (res.isSuccess) {

                getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Referral.html", function (resG) {

                    $("#divMAS").html(resG);

                    ComboBoxWithSearch('.select2', 'rtl');

                    $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(id.toString(), keyMaker()));
                    $("#phch").show();
                    var m = getlstor("loginName");
                    if (getlstor("loginName") === "9" || getlstor("loginName") === "8") {
                        $("#svisorShowContract").remove();
                    }

                    if (getlstor("loginName") === "6" || getlstor("loginName") === "5") {
                        $("#svisorShowContract").remove();
                        $("#svisorShowDocument").remove();

                    }

                    if (res.data[0].destLevelStepIndex <= 2 || getlstor("loginName") === "5") {

                        $("#svisorShowDocument").remove();
                    }
                    if (!(getlstor("loginName") === "5"  ||getlstor("loginName") === "8" || getlstor("loginName") === "6" || (getlstor("loginName") === "1" && res.data[0].levelStepIndex >= 8))
                       ) {
                        $("#svisorShowEvaluationFile").remove();
                    }
                    if (((getlstor("loginName") !== "12" && getlstor("loginName") !== "11") || res.data[0].levelStepSettingIndexId <= 39))
                    {
                        $("#svisorShowScore").remove();
                    }
                    var htmlB = "";
                    for (var i = 0; i < res.data.length; i++) {
                        $("#sdklsslks3498sjdkxhjsd_823sb").val(res.data[0].levelStepIndex);
                        htmlB += "<button type='button'  style='margin:5px;border:none;background-color:" + res.data[i].colorButton + "' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveRequestForRating(this);' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "' data-SC='" + encrypt(res.data[i].smsContent, keyMaker()) + "' data-ST='" + res.data[i].smsType + "' data-DLSIB='" + encrypt(res.data[i].destLevelStepIndexButton, keyMaker()) + "' data-LSSII='" + res.data[i].levelStepSettingIndexId + "'>" + res.data[i].destLevelStepIndexButton + "</button>";

                    }

                    $("#bLLSS").html(htmlB);
                    Ckeditor("ReferralExplanation");
                    showCustomerInfo();
                });


            }
            else {

                $("#divMAS").html("<div class='alert alert-error text-center' style='font-size: 20px;'>" + (isEmpty(res.message) ? "شما اجازه انجام این عملیات را ندارید" : res.message) + "</div>");
                $("#phch").hide();
                $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt('0', keyMaker()));
                $("#bLLSS").html("");
                Ckeditor("ReferralExplanation");
            }

        }, true);
        //  Ckeditor("ReferralExplanation");


    }

    function printContract(e) {

        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        goToUrl("/superVisor/RequestForRating/ContractPrint/" + id);
    }

    function printContracting(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#ContractShow").html(res.data.contentContract);
                    if (res.data.contractCode != null && res.data.contractCode != "") {
                        $('.PageContractFirst').find('input[name=SaveDate]').val(res.data.saveDateStr);
                        $('.PageContractFirst').find('input[name=ContractCode]').val(res.data.contractCode);


                    } else {
                        $("#ptr").html("<p> این نسخه قرارداد اصلی نمی باشد.</p>");
                    }
                    //$("#SaveDate").html(res.data.saveDateStr);
                    $("#ContractCode").html(res.data.contractCode);
                    $('input[type="text"], textarea').each(function () {
                        //  $(this).attr('readonly', 'readonly');
                        var text_classname = $(this).attr('name');
                        var value = $(this).val();
                        if (text_classname == "NamesAuthorizedSignatories") {
                            var new_html = ('<p style="text-align:center">' + value + '</p>');
                        } else if (text_classname == "NamesAuthorizedSignatories") {

                        }
                        else {
                            var new_html = ('<storang >' + value + '</storang>');
                        }
                        $(this).replaceWith(new_html);
                    });

                }

            }, true);
        }
    }

    function showCustomerInfo() {

        getCustomerInfo();
    }

    function showContract() {

        getContractInfo();
    }

    function initContract(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#FinancialID").val(res.data.financialId);
                    $("#RequestID").val(res.data.requestID);
                    $("#PriceContract").val(moneyCommaSepWithReturn(res.data.priceContract == null ? "" : res.data.priceContract.toString()));
                    $("#FinalPriceContract").val(moneyCommaSepWithReturn(res.data.finalPriceContract == null ? "" : res.data.finalPriceContract.toString()));
                    // $("#FinancialDocument").val(res.data.financialDocument);
                    // $("#ContractDocument").val(res.data.contractDocument);
                    $("#btnDelContract").removeAttr("disabled");
                    $("#DisCountMoney").val(moneyCommaSepWithReturn(res.data.disCountMoney == null ? "" : res.data.disCountMoney.toString()));
                    $("#DicCountPerecent").val(res.data.dicCountPerecent);
                    $("#ContractCode").val(res.data.contractCode);
                    $("#SaveDate").val(res.data.contractCode != null ? res.data.saveDateStr : "");
                    $("#CanSeePreFactorStr").prop("checked", res.data.canSeePreFactor);
                    if (getlstor("loginName") === "1" || getlstor("loginName") === "4") {
                        if (res.data.contractDocumentCustomer != null && res.data.contractDocumentCustomer != "") {
                            $("#divDownloadContractDocumentCustomer").html("<a  href='" + res.data.contractDocumentCustomerFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#ContentCKeditor").html("<textarea name='ContentContract' id='ContentContract'>" + res.data.contentContract + "</textarea>");
                        Ckeditor("ContentContract");

                    }
                    else {

                        $("#ContractShow").addClass("ContractShowStyle");
                        $("#ContractShow").html(res.data.contentContract);
                        $('input[type="text"], textarea').each(function () {
                            //  $(this).attr('readonly', 'readonly');
                            // var text_classname = $(this).attr('name');
                            var value = $(this).val();
                            var new_html = ('<storang id="' + text_classname + '">' + value + '</storang>')
                            $(this).replaceWith(new_html);
                        });
                        $(".hClass").remove();
                    }

                }
                else {

                    initContractNew(id);
                }
            }, true);
        }
    }



    function getCustomerInfo() {

        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());

        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {

                    getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Customer.html", function (resG) {

                        $("#customerInfo").html(resG);
                        for (var i = 0; i < res.data.length; i++) {

                            initCustomer(res.data[i].customerId);
                        }

                    });

                }

            }, true);
        }
    }

    function getContractInfo() {

        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());

        if (!isEmpty(id) && id != 0) {

            if ((getlstor("loginName") === "1") || (getlstor("loginName") === "4")) {
                getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Contract-moa.html", function (resG) {

                    $("#contractInfo").html(resG);
                    //if (getlstor("loginName") === "4" || $("#sdklsslks3498sjdkxhjsd_823sb").val() > 2) {
                    //    $('#FinalPriceContract').prop('readonly', true);
                    //    $('#DisCountMoney').prop('readonly', true);
                    //    $('#DicCountPerecent').prop('readonly', true);

                    //}
                    if (getlstor("loginName") === "1") {
                        $("#ContractUp").hide();
                    }
                    initContract(id);
                });
            } else {
                getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Contract.html", function (resG) {

                    $("#contractInfo").html(resG);
                    // initContract(id);

                });
            }

        }
    }

    function showEditContract() {
        if (getlstor("loginName") == "1" || getlstor("loginName") == "4") {

            var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());

            if (!isEmpty(id) && id != 0) {

                if ((getlstor("loginName") === "1") || (getlstor("loginName") === "4")) {
                    getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Contract-moaEdit.html", function (resG) {

                        //$("#contractInfo").html(resG);
                        //if (getlstor("loginName") === "4" || $("#sdklsslks3498sjdkxhjsd_823sb").val() > 2) {
                        //    $('#FinalPriceContract').prop('readonly', true);

                        //}
                        if (getlstor("loginName") === "1") {
                            $("#ContractUp").hide();
                        }
                        initContract(id);
                    });
                } else {
                    getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Contract.html", function (resG) {

                        $("#contractInfo").html(resG);
                        // initContract(id);

                    });
                }

            }
        }
    }

    function initCustomer(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/Customers/Get_Customers/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res != null) {

                    if (res.customerPersonalityType == "223") {

                        $(".FormIsNotShow").hide();
                        $(".form-group.FormIsShow").show();
                        $(".NotShowRequiredLabel").hide();
                        $("#LabelEconomicCode").html("شماره کارت بازرگانی");
                        $("#LabelTypeGroupCompanies").html("نوع فعالیت");
                        $("#Span_Label_AgentMobile").html("شماره موبایل");

                        $(".divMainScanCustomerNationalCard").show();
                        $(".divMainScanManagerNationalCard").hide();
                    }
                    else {

                        $(".FormIsNotShow").show();
                        $("#LabelEconomicCode").html("شماره ثبت");
                        $(".NotShowRequiredLabel").show();
                        $("#LabelTypeGroupCompanies").html("نوع گروه شرکتها");
                        $("#Span_Label_AgentMobile").html("شماره نماینده");

                        $(".divMainScanCustomerNationalCard").show();
                        $(".divMainScanManagerNationalCard").show();
                    }
                    $("#CutomerName").html("<h4> فرم اطلاعات" + res.companyName == null ? res.agentName : res.companyName + "</h4>");


                    $("#AddressCompany").val(res.addressCompany);
                    $("#CompanyName").val(res.companyName);
                    $("#CeoName").val(res.ceoName);
                    $("#EconomicCode").val(res.economicCode);
                    $("#EconomicCodeReal").val(res.economicCodeReal);
                    $("#NationalCode").val(res.nationalCode);
                    $("#CeoNationalCode").val(res.ceoNationalCode);
                    $("#CeoMobile").val(res.ceoMobile);
                    $("#AgentMobile").val(res.agentMobile);
                    $("#AgentName").val(res.agentName);
                    $("#NamesAuthorizedSignatories").val(res.namesAuthorizedSignatories);
                    $("#CountOfPersonal").val(res.countOfPersonal);
                    $("#Email").val(res.email);
                    $("#Tel").val(res.tel);
                    $("#PostalCode").val(res.postalCode);

                    $("#EmailRepresentative").val(res.emailRepresentative);
                    $("#NationalCodeRepresentative").val(res.nationalCodeRepresentative);

                    $("#AmountOsLastSales").val(moneyCommaSepWithReturn(!isEmpty(res.amountOsLastSales) ? res.amountOsLastSales.toString() : ''));
                    if (res.lastInsuranceList != null && res.lastInsuranceList != "") {
                        $("#divDownload").html("<a class='btn btn-success' href='" + res.lastInsuranceListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                    }
                    if (res.auditedFinancialStatements != null && res.auditedFinancialStatements != "") {
                        $("#divDownload_AuditedFinancialStatements").html("<a class='btn btn-success' href='" + res.auditedFinancialStatementsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                    }
                    if (res.scanCustomerNationalCard != null && res.scanCustomerNationalCard != "") {
                        $("#divDownload_ScanCustomerNationalCard").html("<a class='btn btn-success' href='" + res.scanCustomerNationalCardFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                    }
                    if (res.scanManagerNationalCard != null && res.scanManagerNationalCard != "") {
                        $("#divDownload_ScanManagerNationalCard").html("<a class='btn btn-success' href='" + res.scanManagerNationalCardFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                    }

                    $("#TypeGroupCompanies").val(res.typeGroupCompaniesName);
                    systemSeting_Combo(res);


                }


            }, true);
        }
    }

    function systemSeting_Combo(resSingle) {

        AjaxCallAction("POST", "/api/superVisor/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63,27,56", PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';
                var strHowGetKnowCompany = '<option value="">انتخاب کنید</option>';
                var strTypeServiceRequestedId = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].parentCode == 56) {
                        strHowGetKnowCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 63) {
                        strTypeServiceRequestedId += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    } else if (res.data[i].parentCode == 27) {
                        strKindOfCompany += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }
                }

                $("#KindOfCompany").html(strKindOfCompany);
                $("#HowGetKnowCompany").html(strHowGetKnowCompany);
                $("#TypeServiceRequestedId").html(strTypeServiceRequestedId);

                $("#HowGetKnowCompany").val(resSingle.howGetKnowCompanyId);
                $("#KindOfCompany").val(resSingle.kindOfCompanyId);
                $("#TypeServiceRequestedId").val(resSingle.typeServiceRequestedId);

            }
        }, true);
    }

    function initContractNew(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ServiceFeeAndCustomerByRequest/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res != null) {
                    $("#btnDelContract").attr("disabled", "");

                    if (res.contract == null) {
                        alertB("خطا", "متن قرارداد وجود ندارد", "error");
                    }
                    else {
                        if (getlstor("loginName") === "1" || (getlstor("loginName") === "4")) {
                            $("#RequestID").val(id);
                            $("#ContentCKeditor").html("<textarea name='ContentContract' id='ContentContract'>" + res.contract.contractText + "</textarea>");
                            var m = res.contract.contractText;
                            // $("#PriceContract").val(removeComaForString($(m).find('input[name="ServiceFeePrice"]').val()));
                            var p = removeComaForString($(m).find('input[name="ServiceFeePrice"]').val());
                            var mm = p.toString().slice(-5);
                            var u = p - mm;
                            $("#FinalPriceContract").val(moneyCommaSepWithReturn(u.toString()));

                            // var my = jQuery.parseHTML(getDataCkeditor("ContentContract"));
                            $("#PriceContract").val($(m).find('input[name="ServiceFeePrice"]').val());
                            $("#ContractShow").hide();
                            $("#ContractShow").html(m);

                            $('input[type="text"], textarea').each(function () {
                                if ($(this).attr("name") == "ServiceFeePrice") {
                                    var new_html = ('<input type="text" name="ServiceFeePrice"' + 'value="' + moneyCommaSepWithReturn(u.toString()) + '"/>');
                                    $(this).replaceWith(new_html);
                                }
                            });
                            Ckeditor("ContentContract");
                            var elements = $("#ContractShow").html();
                            setDataCkeditor('ContentContract', elements);

                            if (res.serviceFee == null) {
                                alertB("خطا", "نرخی برای شرایط مشتری پیدا نشد", "error");
                            }
                        }
                    }


                }

            }, true);

        }


    }
    function initContractNewText() {

        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        $("#EditStatuse").val("7");
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ServiceFeeAndCustomerByRequest/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res != null) {
                    $("#btnDelContract").attr("disabled", "");

                    if (res.contract == null) {
                        alertB("خطا", "متن قرارداد وجود ندارد", "error");
                    }
                    else {
                        if (getlstor("loginName") === "1" || (getlstor("loginName") === "4")) {
                            $("#RequestID").val(id);
                            $("#ContentCKeditor").html("<textarea name='ContentContract' id='ContentContract'>" + res.contract.contractText + "</textarea>");
                            var m = res.contract.contractText;
                            $("#PriceContract").val($(m).find('input[name="ServiceFeePrice"]').val());
                            $("#ContractShow").hide();
                            $("#ContractShow").html(m);

                            $('input[type="text"], textarea').each(function () {
                                if ($(this).attr("name") == "ServiceFeePrice") {
                                    var new_html = ('<input type="text" name="ServiceFeePrice"' + 'value="' + moneyCommaSepWithReturn($("#FinalPriceContract").val()) + '"/>');
                                    $(this).replaceWith(new_html);
                                }
                            });
                            Ckeditor("ContentContract");
                            var elements = $("#ContractShow").html();
                            setDataCkeditor('ContentContract', elements);

                            if (res.serviceFee == null) {
                                alertB("خطا", "نرخی برای شرایط مشتری پیدا نشد", "error");
                            }
                        }
                    }


                }

            }, true);

        }


    }


    function getContractCustomer(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#ContractShow").addClass("ContractShowStyle");
                    $("#ContractShow").html(res.data[0].contentContract);
                    $('input[type="text"], textarea').each(function () {
                        //  $(this).attr('readonly', 'readonly');
                        var text_classname = $(this).attr('name');
                        var value = $(this).val();
                        var new_html = ('<label for="' + text_classname + '" id="' + '">' + value + '</label>');
                        $(this).replaceWith(new_html);
                    });
                }

            }, true);

        }


    }

    function updateContract(e) {
        $(e).attr("disabled", "");
        $("#EditStatuse").val("8");
        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmContract"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                $("#btnreq").click();
                alertB("ثبت", "مدارک با موفقیت ثبت شد.", "success");

            } else {

                $("#AmountOsLastSales").val(moneyCommaSepWithReturn($("#AmountOsLastSales").val()));

                alertB("خطا", res.message, "error");
            }

        }, true);
    }

    function saveRequestForRating(e) {


        if ((decrypt($(e).attr("data-LSAR"), keyMaker()) == '10' ||
            decrypt($(e).attr("data-DLSI"), keyMaker()) == '15' || decrypt($(e).attr("data-DLSI"), keyMaker()) == '0'  ) && $(e).attr("data-LSSII") != "26") {

            $("#hidSeSIRR").val(decrypt($(e).attr("data-LSAR"), keyMaker()));
            $("#SUIRS").html('');
            objE = e;
            tempSaveRFR(e);

        }
        else if ($(e).attr("data-LSSII") == "26") {
            temgetCodalInfo(e)
        }
        else temojsdkjsdjsdkjkjsdjksd(e);
    }


    var objE;
    function temojsdkjsdjsdkjkjsdjksd(e) {


        if ($("#hidSeSIRR").val() != decrypt($(e).attr("data-LSAR"), keyMaker())) {

            $(".ButtonOpperationLSSlss").attr("disabled", "");

            $("#hidSeSIRR").val(decrypt($(e).attr("data-LSAR"), keyMaker()));

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_UsersByRole/" + decrypt($(e).attr("data-LSAR"), keyMaker()), null, true, function (resGet) {

                $(".ButtonOpperationLSSlss").removeAttr("disabled");

                var qD = "<option value=''>انتخاب کاربر</option>";
                if (resGet.isSuccess) {

                    for (var i = 0; i < resGet.data.length; i++) {

                        qD += "<option value='" + resGet.data[i].userId + "'>" + (!isEmpty(resGet.data[i].user) ? resGet.data[i].user.realName : '') + "</option>";
                    }

                    var qContent = "<div class='row'><div class='col-md-12'><div class='form-group'><label class='control-label col-md-3'>انتخاب کاربر</label><div class='col-md-9'><select class='form-control select2' style='width: 100% !important;' name='SUIRS' id='SUIRS'>";
                    qContent += qD;
                    qContent += "</select></div></div></div></div>";
                    objE = e;
                    InitModal_Withot_Par('برای ارجاع کاربر را انتخاب کنید', qContent, "Web.RequestForRating.TempSaveRFR();", false, 'width:40%;', 'ارجاع');

                    ComboBoxWithSearchAndModal();

                }


            });

        }
        else ShowModal();


    }

    function temgetCodalInfo(e) {


        $(".ButtonOpperationLSSlss").attr("disabled", "");

        $("#hidSeSIRR").val(decrypt($(e).attr("data-LSAR"), keyMaker()));

        var qContent = "<div><h3>لطفا مشخصات کدال را وارد نمایید.</h3><label for='CodalNumber'>کد رهگیری:</label><br>";
        qContent += "<input type='text' id='CodalNumber' name='CodalNumber' class='form-control' ><br>";
        qContent += "<label for='CodalDate'>تاریخ کدال:</label><br>";
        qContent += "<input type='text' id='CodalDate' name='CodalDate' class='form-control DatePicker'></div>";

        // $(e).attr("data-LSSII") = "26";
        objE = e;
        InitModal_Withot_Par('مشخصات کدال را وارد نمایید.', qContent, "Web.RequestForRating.TempSaveRFR();", false, 'width:40%;', 'اختتام');

        ShowModal();
        PersianDatePicker(".DatePicker");

    }

    function tempSaveRFR(e) {


        if ($(objE).attr("data-LSSII") == 26 || $(objE).attr("data-LSSII") != 11) {

        }
        else if (isEmpty($('#SUIRS').find(":selected").val()) &&
            decrypt($(objE).attr("data-LSAR"), keyMaker()) != '10' &&
            decrypt($(objE).attr("data-DLSI"), keyMaker()) != '15') {

            alertB("هشدار", "کاربر را انتخاب کنید", "warning");
            return;
        }


        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (!res.isSuccess && ($(objE).attr("data-LSSII") != "2" && (($(objE).attr("data-LSSII") == "4" || $(objE).attr("data-LSSII") == "34")))) {
                    alertB("خطا", " کاربر گرامی شما قرارداد را تایید نکرده اید", "error");
                } else {
                    $(".ButtonOpperationLSSlss").attr("disabled", "");

                    var objJ = {};
                    objJ.DestLevelStepIndex = decrypt($(objE).attr("data-DLSI"), keyMaker());
                    objJ.Comment = getDataCkeditor("ReferralExplanation");
                    objJ.LevelStepAccessRole = decrypt($(objE).attr("data-LSAR"), keyMaker());
                    objJ.LevelStepStatus = decrypt($(objE).attr("data-LSS"), keyMaker());
                    objJ.ReciveUser = !isEmpty($('#SUIRS').find(":selected").val()) ? $('#SUIRS').val() : null;
                    objJ.CodalDate = !isEmpty($('#CodalDate').val()) ? $('#CodalDate').val() : null;
                    objJ.CodalNumber = !isEmpty($('#CodalNumber').val()) ? $('#CodalNumber').val() : null;
                    objJ.Request = {};
                    objJ.Request.Requestid = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
                    objJ.Request.KindOfRequest = 0;
                    objJ.SmsContent = decrypt($(objE).attr("data-SC"), keyMaker());
                    objJ.SmsType = !isEmpty($(objE).attr("data-ST")) ? $(objE).attr("data-ST") === 'true' : null;
                    objJ.DestLevelStepIndexButton = decrypt($(objE).attr("data-DLSIB"), keyMaker());
                    objJ.levelStepSettingIndexId = $(objE).attr("data-LSSII");

                    AjaxCallAction("POST", "/api/superVisor/RequestForRating/Save_Request", JSON.stringify(objJ), true, function (res) {

                        $(".ButtonOpperationLSSlss").removeAttr("disabled");

                        if (res.isSuccess) {
                            //if (objJ.DestLevelStepIndex == "3") {
                            //    var m = getDataCkeditor("ContractText");
                            //    var FeePrice = $(m).find('input[name="ServiceFeePrice"]').val();// 
                            //    // var Price = RemoveAllCharForPrice(FeePrice);
                            //   // saveContractAndFinancialDocuments(objJ.Request.Requestid, getDataCkeditor("ContractText"), FeePrice);
                            //}

                            goToUrl("/SuperVisor/RequestForRating/Index");

                        }
                        else {

                            alertB("هشدار", res.message, "warning");

                        }

                    }, true);

                }

            }, true);
        }


    }

    function showEvaluationFile() {
        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        $("#ContractBox").remove();
        //var stepIndex = decrypt($(e).attr("data-DLSI"), keyMaker());

        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {
                    for (var i = 0; i < res.data.length; i++) {

                        if (res.data[i].destLevelStepIndex >= 3) {
                            getShowEvaluationFile(id, res);
                        }
                    }
                }

            }, true);
        }


    }

    function showScoreFile() {
        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
       
        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {
                    for (var i = 0; i < res.data.length; i++) {

                        if (res.data[i].destLevelStepIndex >= 3) {
                            getShowScoreFile(id, res);
                        }
                    }
                }

            }, true);
        }


    }

    function showDocument() {
        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        //var stepIndex = decrypt($(e).attr("data-DLSI"), keyMaker());

        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {
                    for (var i = 0; i < res.data.length; i++) {

                        if (res.data[i].destLevelStepIndex >= 3) {
                            getShowDoument(id);
                        }
                    }
                }

            }, true);
        }



    }
    function showEditDocument(id = null) {

        $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(id.toString(), keyMaker()));
        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatingsA", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {
                    for (var i = 0; i < res.data.length; i++) {

                        if (res.data[i].destLevelStepIndex >= 2) {
                            getShowDoument(id);
                        }
                    }
                }

            }, true);
        }



    }


    function getShowDoument(id = null) {
        if (!isEmpty(id) && id != 0) {
            getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Document.html", function (resG) {

                $("#showDocument").html(resG);
                getDocument(id);

            });
        }
    }

    function getShowEvaluationFile(id = null, res = null) {
        if (!isEmpty(id) && id != 0) {
            getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_EvaluationFile.html", function (resG) {

                $("#showEvaluationFile").html(resG);
                if (res.data[0].levelStepAccessRole == "9" || getlstor("loginName") === "1" || getlstor("loginName") === "8") {
                    $("#frmFormMain2").remove();

                }
                if (getlstor("loginName") === "5") {
                    $("#frmFormMain4").remove();
                    $("#frmFormMain3").remove();
                }
                if (getlstor("loginName") === "1") {
                    $("#frmFormMain2").remove();
                    $("#frmFormMain3").remove();
                }
                if (getlstor("loginName") === "8") {
                    $("#frmFormMain4").remove();
                    $("#frmFormMain2").remove();
                }
                if (getlstor("loginName") === "6") {
                    $("#frmFormMain3").remove();
                    $("#frmFormMain4").remove();
                    $("#frmFormMain2").remove();
                }
                getDocument(id);

            });
        }
    }

    function getDocument(id = null) {
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    $("#FinancialID").val(res.data.financialId);
                    $("#RequestID").val(res.data.requestID);
                    if ((res.data.committeeEvaluationFile != null && res.data.committeeEvaluationFile != "") || res.data.confirmCommitteeEvaluation === "True") {
                        $("#frmFormMain2").remove();
                        $("#frmFormMain4").remove();
                    } else {
                        $("#ConfirmCommitteeEvaluation").val(res.data.confirmCommitteeEvaluation);
                    }
                    if (getlstor("loginName") === "8") {
                        $("#EvaluationFile").val(res.data.evaluationFile);
                    }
                    if (getlstor("loginName") === "6") {
                        $("div.result").remove();
                    }
                    if ((getlstor("loginName") !== "4" && getlstor("loginName") !== "9"  )) {
                        $("#ShowRemainingMoney").remove();

                    } else {
                        $("#RemainingMoney").html(moneyCommaSepWithReturn(!isEmpty(res.data.remainingMoney) ? res.data.remainingMoney.toString() : '0') +" ریال ");
                    }


                    if (res.data.financialDocument != null && res.data.financialDocument != "") {
                        $("#divDownloadFinancialDocument").html("<a class='btn btn-success' href='" + res.data.financialDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownloadFinancialDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.financialDocument2 != null && res.data.financialDocument2 != "") {
                        $("#divDownloadFinancialDocument2").html("<a class='btn btn-success' href='" + res.data.financialDocument2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownloadFinancialDocument2").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.contractDocument != null && res.data.contractDocument != "") {
                        $("#divDownload_ContractDocument").html("<a class='btn btn-success' href='" + res.data.contractDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_ContractDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.evaluationFile != null && res.data.evaluationFile != "") {
                        $("#divDownload_EvaluationFile").html("<a class='btn btn-success' href='" + res.data.evaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_EvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.committeeEvaluationFile != null && res.data.committeeEvaluationFile != "") {
                        $("#divDownload_CommitteeEvaluationFile").html("<a class='btn btn-success' href='" + res.data.committeeEvaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_CommitteeEvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.lastFinancialDocument != null && res.data.lastFinancialDocument != "") {
                        $("#divDownload_LastFinancialDocument").html("<a class='btn btn-success' href='" + res.data.lastFinancialDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_LastFinancialDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.leaderEvaluationFile != null && res.data.leaderEvaluationFile != "") {
                        $("#divDownload_LeaderEvaluationFile").html("<a class='btn btn-success' href='" + res.data.leaderEvaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_LeaderEvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                }

            }, true);
        }
    }

     function getDocumentScore(id = null) {
        if (!isEmpty(id) && id != 0) {
            $("#RequestID").val(id);
            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#FinancialID").val(res.data.financialId);                  
                 //   $("#EvaluationFile").val(res.data.evaluationFile);
                    if (res.data.evaluationFile != null && res.data.evaluationFile != "") {
                        $("#divDownload_EvaluationFile").html("<a class='btn btn-success' href='" + res.data.evaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_EvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                   
                }

            }, true);
        }
    }


    function getDocumentArzyab(id = null) {
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    $("#FinancialID").val(res.data.financialId);
                    $("#RequestID").val(res.data.requestID);
                    $("#ContentContract").val(res.data.contentContract);
                    $("#PriceContract").val(res.data.priceContract);
                    $("#Tax").val(res.data.tax);
                    // $("#EvaluationFile").val(res.data.evaluationFile);
                    $("#DisCountMoney").val(res.data.disCountMoney);
                    $("#DicCountPerecent").val(res.data.dicCountPerecent);
                    $("#FinalPriceContract").val(res.data.finalPriceContract);
                    $("#ContractDocumentCustomer").val(res.data.contractDocumentCustomer);
                    $("#ContractMainCode").val(res.data.contractMainCode);
                    $("#FinancialDocument").val(res.data.financialDocument);
                    $("#FinancialDocument2").val(res.data.financialDocument2);

                    $("#ContractDocument").val(res.data.contractDocument);
                    $("#ContractCode").val(res.data.contractCode);

                    if (res.data.financialDocument != null && res.data.financialDocument != "") {
                        $("#divDownloadFinancialDocument").html("<a class='btn btn-success' href='" + res.data.financialDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownloadFinancialDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.financialDocument2 != null && res.data.financialDocument2 != "") {
                        $("#divDownloadFinancialDocument2").html("<a class='btn btn-success' href='" + res.data.financialDocument2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownloadFinancialDocument2").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.contractDocument != null && res.data.contractDocument != "") {
                        $("#divDownload_ContractDocument").html("<a class='btn btn-success' href='" + res.data.contractDocumentFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_ContractDocument").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.evaluationFile != null && res.data.evaluationFile != "") {
                        $("#divDownload_EvaluationFile").html("<a class='btn btn-success' href='" + res.data.evaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_EvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                    if (res.data.committeeEvaluationFile != null && res.data.committeeEvaluationFile != "") {
                        $("#divDownload_CommitteeEvaluationFile").html("<a class='btn btn-success' href='" + res.data.committeeEvaluationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    } else {
                        $("#divDownload_CommitteeEvaluationFile").html("<p style='color:silver'>فایلی وجود ندارد</p>");
                    }
                }

            }, true);
        }
    }

    function saveContractAndFinancialDocuments(e, IsShowMsg = null) {

        $(e).attr("disabled", "");

        RemoveAllCharForPrice("DisCountMoney");
        $("#ContentContract").val(getDataCkeditor("ContentContract"));
        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmContract"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                if (IsShowMsg) {
                    $("#btnDelContract").removeAttr("disabled");
                    $("#DisCountMoney").val(moneyCommaSepWithReturn($("#DisCountMoney").val()));
                    $("#FinalPriceContract").val(moneyCommaSepWithReturn($("#FinalPriceContract").val()));
                    $("#PriceContract").val(moneyCommaSepWithReturn($("#PriceContract").val()));

                    alertB("ثبت", " با موفقیت ثبت شد.", "success");
                    initContract(decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker()));
                }
                else {

                    var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
                    goToUrl("/superVisor/RequestForRating/ContractPrint/" + id);
                }

            } else {

                $("#DisCountMoney").val(moneyCommaSepWithReturn($("#DisCountMoney").val()));

                alertB("خطا", res.message, "error");
            }

        }, true);
    }

    function saveContractAndFinancialDocumentsArzyab(e) {

        if (document.getElementById("EvaluationFile").files.length == 0) {
            alertB("هشدار", "فایل اکسل را انتخاب نکرده اید!.", "warning");
        } else {


            $(e).attr("disabled", "");


            AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain2"), true, function (res) {

                $(e).removeAttr("disabled");

                if (res.isSuccess) {
                    showEvaluationFile();
                    alertB("ثبت", " با موفقیت ثبت شد.", "success");


                } else {

                    alertB("خطا", res.message, "error");
                }

            }, true);
        }
    }
    function saveContractAndFinancialDocumentsCommittee(e) {

        if (document.getElementById("CommitteeEvaluationFile").files.length == 0) {
            alertB("هشدار", "فایل اکسل را انتخاب نکرده اید!.", "warning");
        } else {
            $(e).attr("disabled", "");

            AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain3"), true, function (res) {

                $(e).removeAttr("disabled");

                if (res.isSuccess) {
                    showEvaluationFile();
                    alertB("ثبت", " با موفقیت ثبت شد.", "success");


                } else {

                    alertB("خطا", res.message, "error");
                }

            }, true);
        }
    }

    function saveContractAndFinancialDocumentsLeader(e) {

        var fileInput = $.trim($("#LeaderEvaluationFile").val());
        if (fileInput.length == 0) {
            // if (document.getElementById("LeaderEvaluationFile").files.length == 0) {
            alertB("هشدار", "فایل اکسل را انتخاب نکرده اید!.", "warning");
        } else {
            $(e).attr("disabled", "");
            AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFormMain4"), true, function (res) {

                $(e).removeAttr("disabled");

                if (res.isSuccess) {
                    showEvaluationFile();
                    alertB("ثبت", " با موفقیت ثبت شد.", "success");


                } else {

                    alertB("خطا", res.message, "error");
                }

            }, true);
        }
    }
    //function saveContractAndFinancialDocuments(RequestID = null, ContentContract = null, FeePrice = null, DicCountPerecent = null, DisCountMoney=null) {

    //    AjaxCallAction("POST", "/api/superVisor/RequestForRating/Save_ContractAndFinancialDocuments", JSON.stringify({ RequestID: RequestID, ContentContract: ContentContract, PriceContractStr: FeePrice }), true, function (res) {

    //        if (res.isSuccess) {

    //            // goToUrl("/SuperVisor/RequestForRating/Index");

    //        }
    //        else {

    //            alertB("هشدار", res.message, "warning");

    //        }

    //    }, true);

    //}


    function createTimeLine(id = null, isFinish) {

        AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestReferencessService", JSON.stringify({ RequestId: id }), true, function (res) {

            if (res != null) {
                var strTimeLine = '';
                var left = false;

                for (var i = 0; i < res.data.length; i++) {

                    var bgColor = i == 0 ? "bg-secondary" : "bg-info";

                    strTimeLine += "<article class='timeline-entry " + (left ? " left-aligned" : "") + "'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";

                    strTimeLine += "<time class='timeline-time' datetime=''>";
                    strTimeLine += "</time>";

                    strTimeLine += "<div class='timeline-icon " + bgColor + "'>";
                    strTimeLine += "<i class='entypo-feather'></i>";
                    strTimeLine += "</div>";

                    strTimeLine += "<div class='timeline-label'>";
                    if (i == 0) {
                        var titleText = res.data[i].companyName == null ? res.data[i].agentName : res.data[i].companyName;
                        //var titleTextAgentMobile = res.data[i].agentMobile == null;

                        $("#CutomerName").html("<h3 style='font-size:20px;font-weight:bold;text-align:right;margin:10px'>گردش کار - " + titleText + "</h3>");
                        //$("#AgentMobile").html("<h4 style='font-size:20px;font-weight:bold;text-align:right;margin:10px'> " + titleTextAgentMobile + "</h4>");

                        strTimeLine += "<span class='smallFontSize' style='font-weight:bold'>";
                        strTimeLine += (res.data[i].agentName == null ? res.data[i].companyName : res.data[i].agentName) + " : [" + res.data[i].kindOfRequestName + "]</span >";

                        strTimeLine += "<div style='float:left;color:green'><span class='date smallFontSize'>( تاریخ: " + res.data[i].sendTimeStr + "</span>";
                        strTimeLine += "<span class='LTRDirection smallFontSize'> ساعت: " + res.data[i].sendTimeTimeStr + " )</span></div>";
                    }
                    else {
                        if (res.data[i].sendUser == null) {
                            strTimeLine += "<span class='boxCounter'>" + i.toString() + "</span>"
                                + (res.data[i].levelStepSettingIndexID == "29" ? " &#x274C; " : "")
                                + (res.data[i].levelStepSettingIndexID == "7" ? " &#x2705; " : "")
                                + (res.data[i].levelStepSettingIndexID == "13" ? " &#x2705; " : "")
                                + "<span class='sender'>ارجاع از: مشتری" + (res.data[i].agentName == null ? " (" + res.data[i].companyName + ")" : " (" + res.data[i].agentName + ")") + "</span><br/>";
                            strTimeLine += " <span>به: " + res.data[i].roleDesReciver + " </span>";
                            strTimeLine += "<span class='sender'>" + " (" + res.data[i].reciverName + ")" + "</span>";
                        }
                        else if (res.data[i].reciverName == null) {
                            strTimeLine += "<span class='boxCounter'>" + i.toString() + "</span>"
                                + (res.data[i].levelStepSettingIndexID == "4" ? " &#x1F4DD;" : "")
                                + (res.data[i].levelStepSettingIndexID == "11" ? " &#x1F4C2;" : "")
                                + (res.data[i].levelStepSettingIndexID == "26" ? " &#x2705;" : "")
                                + " <span> ارجاع از:  " + res.data[i].userRoleDes + " (" + res.data[i].realName + ")"
                                + " </span><br/>";
                            strTimeLine += " <span>به: " + "مشتری" + " </span>";
                            strTimeLine += "<span class='sender'>" + (res.data[i].agentName == null ? " (" + res.data[i].companyName + ")" : " (" + res.data[i].agentName + ")") + "</span>";
                        }
                        else {
                            strTimeLine += "<span class='boxCounter'>" + i.toString() + "</span>"
                                + (res.data[i].levelStepSettingIndexID == "17" ? " &#x2705;" : "")
                                + (res.data[i].levelStepSettingIndexID == "28" ? " &#x274C;" : "")
                                + (res.data[i].levelStepSettingIndexID == "23" ? " &#x1F4CA;" : "")
                                + (res.data[i].roleDesReciver != null ? " <span> ارجاع از:  " + res.data[i].userRoleDes + " (" + res.data[i].realName + ")"
                                    + " </span><br/>" : "");
                            strTimeLine += " <span>به: " + res.data[i].roleDesReciver + " </span>";
                            strTimeLine += "<span class='sender'>" + " (" + res.data[i].reciverName + ")" + "</span>";
                        }
                        strTimeLine += "<br/>";
                        strTimeLine += "<span class='smallFontSize'>";
                        strTimeLine += "[" + res.data[i].destLevelStepIndexButton + "]";
                        // strTimeLine += "[ جهت اقدام] <span >[ خوانده شده ] </span><span class='greenColor'>1401/09/21  3:34</span>";
                        strTimeLine += "</span>";
                        strTimeLine += "<div style='float:left;color:green'><span class='date smallFontSize'>( تاریخ: " + res.data[i].sendTimeStr + "</span>";
                        strTimeLine += "<span class='LTRDirection smallFontSize'> ساعت: " + res.data[i].sendTimeTimeStr + ")</span></div>";


                    }
                    strTimeLine += "<span></span>";
                    if (i != 0) {
                        if (res.data[i].comment != null && res.data[i].comment != "") {

                            strTimeLine += "<div class='customDiv'>توضیحات<hr/>";
                            strTimeLine += "<span class='Transcript'>" + res.data[i].comment + "</span>";
                            strTimeLine += "</div>";
                        }
                    }
                    strTimeLine += "</div>";
                    //res.data[i].kindOfRequestName

                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                    left = !left;


                }
                if (isFinish) {
                    strTimeLine += "<article class='timeline-entry " + (left ? " left-aligned" : "") + "'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";
                    strTimeLine += "<time class='timeline-time' datetime='2014-01-10T03:45'></time>";
                    strTimeLine += "<div class='timeline-icon bg-secondary'><i class='entypo-feather'></i></div>";
                    strTimeLine += "<div class='timeline-label'>";
                    strTimeLine += "<h2>";
                    strTimeLine += "<span>تایید نهایی و اختتام درخواست </span>";
                    // strTimeLine += "<span class='sender''>مهندس</span>";
                    strTimeLine += "</h2>";
                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                } else {
                    strTimeLine += "<article class='timeline-entry begin'>";
                    strTimeLine += "<div class='timeline-entry-inner'>";
                    strTimeLine += "<div class='timeline-icon' style='-webkit-transform: rotate(-90deg); -moz-transform: rotate(-90deg);'>";
                    strTimeLine += "<i class='entypo-flight'></i>";
                    strTimeLine += "</div>";
                    strTimeLine += "</div>";
                    strTimeLine += "</article>";
                }

                $("#TimeLine").html(strTimeLine);

            }

        }, true);

    }

    function initRequestReferences(id = null) {

        AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1, RequestId: id, ForTimeLine: true }), true, function (res) {

            if (res.isSuccess) {
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].isFinished) {
                        createTimeLine(id, true);
                    } else {
                        createTimeLine(id, false);
                    }
                }
            }

        }, true);

    }

    function uploadContractCustomer(e) {
        if (document.getElementById("ContractDocumentCustomer").files.length == 0) {
            alertB("هشدار", "فایلی قرارداد را انتخاب نکرده اید!.", "warning");
        } else {
            disconut(e, true);
        }

    }

    function calDisPerecent(e) {

        if (event.key === 'Enter') {
            var disPerecent = $('#DicCountPerecent').val();
            var m = jQuery.parseHTML(getDataCkeditor("ContentContract"));

            var FeePrice = removeComaForString($("#PriceContract").val());// $('#DicCountPerecent').val();//removeComaForString($(m).find('input[name="ServiceFeePrice"]').val());
            if (disPerecent != null && disPerecent != "") {
                let disprice = (((FeePrice * disPerecent) / 100).toFixed(0)).toString();
                var m = FeePrice - disprice;
                var mi = m.toString().slice(-5);
                m = m - mi;
                $('#DisCountMoney').val(moneyCommaSepWithReturn(disprice.toString()));
                $("#FinalPriceContract").val(moneyCommaSepWithReturn(m.toString()));
                // $("#lblDicCountPerecent").html(moneyCommaSepWithReturn(disprice));
                var m = jQuery.parseHTML(getDataCkeditor("ContentContract"));
                $("#ContractShow").hide();
                $("#ContractShow").html(m);
                $('input[type="text"], textarea').each(function () {
                    if ($(this).attr("name") == "ServiceFeePrice") {
                        var new_html = ('<input type="text" name="ServiceFeePrice"' + 'value="' + $("#FinalPriceContract").val() + '"/>');
                        $(this).replaceWith(new_html);
                    }
                });

                var elements = $("#ContractShow").html();
                setDataCkeditor('ContentContract', elements);
            } else {

                $("#lblDicCountPerecent").html(0);
            }
        }
    }

    function calDisRiyal(e) {

        $("#lblDicCountPerecent").html('');
        if (event.key === 'Enter') {
            var disRiyal = removeComaForString($('#DisCountMoney').val());

            var FeePrice = removeComaForString($("#PriceContract").val());// $('#DicCountPerecent').val();//removeComaForString($(m).find('input[name="ServiceFeePrice"]').val());
            if (disRiyal != null && disRiyal != "") {
                var m = FeePrice - disRiyal;
                var mi = m.toString().slice(-5);
                m = m - mi;
                var tr = (disRiyal * 100) / FeePrice;
                $('#DicCountPerecent').val((tr.toFixed(2)).toString());
                $("#FinalPriceContract").val(moneyCommaSepWithReturn(m.toString()));
                $("#RequestID").val(decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker()));
                var my = jQuery.parseHTML(getDataCkeditor("ContentContract"));
                $("#ContractShow").hide();
                $("#ContractShow").html(my);
                $('input[type="text"], textarea').each(function () {
                    if ($(this).attr("name") == "ServiceFeePrice") {
                        var new_html = ('<input type="text" name="ServiceFeePrice"' + 'value="' + $("#FinalPriceContract").val() + '"/>');
                        $(this).replaceWith(new_html);
                    }
                });

                var elements = $("#ContractShow").html();
                setDataCkeditor('ContentContract', elements);

            }
        }
    }

    function disconut(e, ShowMsg = true) {

        $("#FinalPriceContract").val(removeComaForString($("#FinalPriceContract").val()));
        $('#DisCountMoney').val(removeComaForString($('#DisCountMoney').val()));
        $('#DicCountPerecent').val(removeComaForString($('#DicCountPerecent').val()));

        $("#RequestID").val(decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker()));

        saveContractAndFinancialDocuments(e, ShowMsg);
        $("#FinalPriceContract").val(moneyCommaSepWithReturn($("#FinalPriceContract").val()));
        $("#DisCountMoney").val(moneyCommaSepWithReturn($("#DisCountMoney").val()));
        $("#DicCountPerecent").val($("#DicCountPerecent").val());

    }

    function deleteContract(e) {

        let id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف قرارداد دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/superVisor/RequestForRating/Delete_ContractAndFinancialDocuments/" + id, null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {
                        getContractInfo();
                        alertB("", "کاربر گرامی در نظر داشته باشید قرارداد حذف گردید و قرارداد جدید به صورت اتوماتیک با شرایط جدید برای شما نشان داده می شود . در نظر داشته باشید تار زمانیکه مشتری پروفایل خود را کامل نکرده شما دکمه ثبت را نزنید و در صورت اطمینان از تغییرات مشتری دکمه ثبت قرارداد را بزنید. ", "success");
                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }
    }

    function deleteContractText() {
        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());

        if (!isEmpty(id) && id != 0) {

            if ((getlstor("loginName") === "1") || (getlstor("loginName") === "4")) {
                getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Contract-moaEdit.html", function (resG) {

                    $("#contractInfo").html(resG);
                    //if (getlstor("loginName") === "4" || $("#sdklsslks3498sjdkxhjsd_823sb").val() > 2) {
                    //    $('#FinalPriceContract').prop('readonly', true);
                    //    $('#DisCountMoney').prop('readonly', true);
                    //    $('#DicCountPerecent').prop('readonly', true);

                    //}
                    if (getlstor("loginName") === "1") {
                        $("#ContractUp").hide();
                    }
                    initContractNew(id);
                });
            } else {
                getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Contract.html", function (resG) {

                    $("#contractInfo").html(resG);
                    // initContract(id);

                });
            }

        }
    }

    $("#frmFrom1 input,textarea").on("focusout", function () {

        $(this).valid();

    });

    function printPerFactoring(e) {

        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        goToUrl("/superVisor/RequestForRating/PrintFactor/" + id);
    }

    function printPerFactor(id = null) {
        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/RequestForRating/Get_ContractAndFinancialDocuments/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#SaveDate").html(res.data.saveDateStr);
                    $("#PriceFee1").html(moneyCommaSepWithReturn(res.data.finalPriceContract.toString()));
                    $("#PriceFee2").html(moneyCommaSepWithReturn(res.data.finalPriceContract.toString()));
                    $("#PriceFee3").html(moneyCommaSepWithReturn(res.data.finalPriceContract.toString()));
                    $("#TaxPrice1").html(moneyCommaSepWithReturn(res.data.tax.toString()));
                    $("#TaxPrice2").html(moneyCommaSepWithReturn(res.data.tax.toString()));
                    $("#TotalPrice").html(moneyCommaSepWithReturn((res.data.finalPriceContract + res.data.tax).toString()));
                    $("#TotalPrice2").html(moneyCommaSepWithReturn((res.data.finalPriceContract + res.data.tax).toString()));
                    $("#TotalPrice3").html(moneyCommaSepWithReturn((res.data.finalPriceContract + res.data.tax).toString()));
                    $("#City").html(res.data.cityName);

                    getCustomerInfoFactor(id);
                }

            }, true);
        }
    }

    function getCustomerInfoFactor(id = null) {

        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {
                    for (var i = 0; i < res.data.length; i++) {

                        initCustomerFactor(res.data[i].customerId);
                    }
                }

            }, true);
        }
    }


    function initCustomerFactor(id = null) {

        AjaxCallAction("GET", "/api/superVisor/Customers/Get_Customers/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

            if (res != null) {
                $("#CustomerName2").html(res.companyName);
                $("#CustomerName").html(res.companyName);
                $("#CustomerName3").html(res.companyName);
                $("#EconomicCode").html(res.economicCode);
                $("#EconomicCodeReal").html(res.economicCodeReal);
                $("#NationalCode").html(res.nationalCode);
                $("#PostalCode").html(res.postalCode);
                $("#AddressCompany").html(res.addressCompany);
                $("#Tel").html(res.tel);
$("#City").html(res.city.cityName);
            }
        }, true);

    }

    function initRequestReferencesA(id = null) {

        AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatingsA", JSON.stringify({ Search: null, PageIndex: 1, PageSize: 1, RequestId: id }), true, function (res) {

            if (res.isSuccess) {
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[i].isFinished) {
                        createTimeLine(id, true);
                    } else {
                        createTimeLine(id, false);
                    }
                }
            }

        }, true);

    }

    function getShowScoreFile(id = null, res = null) {
        if (!isEmpty(id) && id != 0) {
            getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Score.html", function (resG) {

                $("#showScore").html(resG);
                if (getlstor("loginName") === "11") {
                    $("#frmFormMain2").remove();
                }
                getDocumentScore(id);

            });
        }
    }

    function getCustomerRequestInformation(id) {
        if (getlstor("loginName") !== "4") {
            $("#frmRemaining").remove();
        }
        AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_CustomerRequestInformationsDto", JSON.stringify(
            { RequestId: id}
        ), true, function (res) {
            if (!isEmpty(res)) {
                $("#CountOfPersonal1").val(res.countOfPersonel);
                $("#AmountOsLastSales1").val(moneyCommaSepWithReturn(!isEmpty(res.amountOfLastSale) ? res.amountOfLastSale.toString() : ''));
                if (res.lastInsuranceListFull != "/FileUpload/Customers/no-photo.png")
                    $("#divDownload1").html("<a class='btn btn-success' href='" + res.lastInsuranceListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                if (res.lastAuditingTaxListFull != "/FileUpload/Customers/no-photo.png")
                    $("#divDownload_AuditedFinancialStatements1").html("<a class='btn btn-success' href='" + res.lastAuditingTaxListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
            }
        }, true);
    }


    function showCustomerRequestInformation() {
        var id = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());
        getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_CustomerRequestInformation.html", function (resG) {
            $("#showCustomerRequestInformation").html(resG);
            getCustomerRequestInformation(id);
        });
    }


    function saveRemainingMoney(e) {
        if ($("#Remaining").val() == null || $("#Remaining").val() == "" ) {
            alertB("هشدار", "لطفا مبلغ را وارد نمایید.", "warning");
        } else {
            
            $(e).attr("disabled", "");
            var objJ = {};           
            objJ.Requestid = decrypt($("#sdklsslks3498sjdkxhjsd_823sa").val(), keyMaker());           
            objJ.RemainingMoney = $("#Remaining").val();
            AjaxCallAction("POST", "/api/superVisor/RequestForRating/Save_Remaining", JSON.stringify(objJ), true, function (res) {

                $(e).removeAttr("disabled");
                if (res.isSuccess) {
                    alertB("ثبت", " با موفقیت ثبت شد.", "success");
                }
                else {
                    alertB("هشدار", res.message, "warning");
                }

            }, true);
        }
    }

    web.RequestForRating = {
        GetShowScoreFile: getShowScoreFile,
        GetDocumentScore: getDocumentScore,
        ShowScoreFile: showScoreFile,
        TempSaveRFR: tempSaveRFR,
        FilterGrid: filterGrid,
        TextSearchOnKeyDown: textSearchOnKeyDown,
        InitReferral: initReferral,
        SaveRequestForRating: saveRequestForRating,
        InitRequestReferences: initRequestReferences,
        InitRequestReferencesA: initRequestReferencesA,
        ShowCustomerInfo: showCustomerInfo,
        GetCustomerInfo: getCustomerInfo,
        GetContractInfo: getContractInfo,
        InitCustomer: initCustomer,
        ShowContract: showContract,
        InitContract: initContract,
        CreateTimeLine: createTimeLine,
        SaveContractAndFinancialDocuments: saveContractAndFinancialDocuments,
        GetContractCustomer: getContractCustomer,
        ShowDocument: showDocument,
        GetDocument: getDocument,
        GetShowDoument: getShowDoument,
        ShowEvaluationFile: showEvaluationFile,
        GetShowEvaluationFile: getShowEvaluationFile,
        Disconut: disconut,
        InitContractNew: initContractNew,
        PrintContract: printContract,
        PrintContracting: printContracting,
        UploadContractCustomer: uploadContractCustomer,
        SaveContractAndFinancialDocumentsArzyab: saveContractAndFinancialDocumentsArzyab,
        SaveContractAndFinancialDocumentsCommittee: saveContractAndFinancialDocumentsCommittee,
        SaveContractAndFinancialDocumentsLeader: saveContractAndFinancialDocumentsLeader,
        GetDocumentArzyab: getDocumentArzyab,
        FillComboLevelStepSettingList: fillComboLevelStepSettingList,
        CalDisPerecent: calDisPerecent,
        CalDisRiyal: calDisRiyal,
        PrintPerFactor: printPerFactor,
        PrintPerFactoring: printPerFactoring,
        InitCustomerFactor: initCustomerFactor,
        GetCustomerInfoFactor: getCustomerInfoFactor,
        DeleteContract: deleteContract,
        ShowEditDocument: showEditDocument,
        ShowEditContract: showEditContract,
        DeleteContractText: deleteContractText,
        InitContractNewText: initContractNewText,
        UpdateContract: updateContract,
        OnchangeKindOfRequest: onchangeKindOfRequest,
        FilterGridA: filterGridA,
        ExcelTotalFilterGridA: excelTotalFilterGridA,
        SaveRemainingMoney: saveRemainingMoney,
        ShowCustomerRequestInformation: showCustomerRequestInformation,

    };

})(Web, jQuery);

(function (web, $) {

    //Document Ready              

    function filterGrid() {

        if (getlstor("roleDesc") != "ارزیاب") {
            AjaxCallAction("POST", "/api/superVisor/Customers/Get_Customerss", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val() }), true, function (res) {

                if (res.isSuccess) {
                    $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
                    var strM = '';
                    for (var i = 0; i < res.data.length; i++) {

                        strM += "<tr><td>" + (i + 1) + "</td><td>" + (isEmpty(res.data[i].companyName) ? '' : res.data[i].companyName)
                            + "</td><td>" + (isEmpty(res.data[i].nationalCode) ? '' : res.data[i].nationalCode)
                            + "</td><td>" + (isEmpty(res.data[i].agentName) ? '' : res.data[i].agentName)
                            + "</td><td>" + (isEmpty(res.data[i].agentMobile) ? '' : res.data[i].agentMobile)
                            + "</td><td>" + res.data[i].saveDateStr
                            + "</td><td>" + (res.data[i].haveRequest ? 'ثبت درخواست' : 'عدم ثبت درخواست')
                            + "</td><td><a title='نمایش' href='/SuperVisor/Customers/ShowCustomers?id=" + res.data[i].customerId + "' class='btn btn-edit fontForAllPage'><i class='fa fa-eye'></i></a></td></tr>";

                    }
                    $("#tBodyList").html(strM);

                }

            }, true);
        }
        else {
            $(".content-header").hide();
            $("#divMainIndexCustomersList").html("<div class='container'><div class='row'><div class='col-md-12'><div class='alert alert-warning text-center'>شما مجوز انجام عملیات را ندارید</div></div></div></div>");
        }

    }

    function initCustomer(id, dir = 'rtl') {

        if (getlstor("roleDesc") != "ارزیاب") {
            AjaxCallAction("GET", "/api/superVisor/Customers/Get_Customers/" + (isEmpty(id) ? '0' : id), null, true, function (res) {


                if (res != null) {


                    if (res.customerPersonalityType == "223") {

                        $(".form-group").hide();
                        $(".form-group.FormIsShow").show();
                        $(".NotShowRequiredLabel").hide();
                        $("#LabelTypeGroupCompanies").html("نوع فعالیت");
                        $("#LabelEconomicCode").html("شماره کارت بازرگانی");
                        $("#LabelCompanyName").html("نام و نام خانوادگی");
                        $("#Span_Label_AgentMobile").html("شماره موبایل/ شماره موبایل نماینده");
                        $("#divMainScanCustomerNationalCard").show();
                        $("#divMainScanManagerNationalCard").hide();
                    }
                    else {

                        $(".form-group").show();
                        $(".NotShowRequiredLabel").show();
                        $("#LabelTypeGroupCompanies").html("نوع فعالیت شرکتها");
                        $("#LabelEconomicCode").html("شماره ثبت");
                        $("#LabelCompanyName").html("نام شرکت");
                        $("#Span_Label_AgentMobile").html("شماره نماینده");
                        $("#divMainScanCustomerNationalCard").show();
                        $("#divMainScanManagerNationalCard").show();
                    }


                    $("#AddressCompany").html(res.addressCompany);
                    $("#CompanyName").html(res.companyName);
                    $("#CeoName").html(res.ceoName);
                    $("#EconomicCode").html(res.economicCode);
                    $("#EconomicCodeReal").html(res.economicCodeReal);
                    $("#NationalCode").html(res.nationalCode);
                    $("#CeoNationalCode").html(res.ceoNationalCode);
                    $("#CeoMobile").html(res.ceoMobile);
                    $("#AgentMobile").html(res.agentMobile);
                    $("#AgentName").html(res.agentName);
                    $("#NamesAuthorizedSignatories").html(res.namesAuthorizedSignatories);
                    $("#CountOfPersonal").html(res.countOfPersonal);
                    $("#Email").html(res.email);
                    $("#Tel").html(res.tel);
                    $("#PostalCode").html(res.postalCode);

                    $("#EmailRepresentative").html(res.emailRepresentative);
                    $("#NationalCodeRepresentative").html(res.nationalCodeRepresentative);

                    $("#AmountOsLastSales").html(moneyCommaSepWithReturn(!isEmpty(res.amountOsLastSales) ? res.amountOsLastSales.toString() : ''));

                    $("#HowGetKnowCompanyId").html(res.howGetKnowCompany != null ? res.howGetKnowCompany.label : '');

                    $("#KindOfCompanyId").html(res.kindOfCompany != null ? res.kindOfCompany.label : '');

                    if (res.lastInsuranceList != null && res.lastInsuranceList != "") {
                        $("#divDownload").html("<a class='btn btn-success' href='" + res.lastInsuranceListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                    }
                    if (res.auditedFinancialStatements != null && res.auditedFinancialStatements != "") {
                        $("#divDownload_AuditedFinancialStatements").html("<a class='btn btn-success' href='" + res.auditedFinancialStatementsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                    }
                    if (res.scanCustomerNationalCard != null && res.scanCustomerNationalCard != "") {
                        $("#divDownload_ScanCustomerNationalCard").html("<a class='btn btn-success' href='" + res.scanCustomerNationalCardFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                    }
                    if (res.scanManagerNationalCard != null && res.scanManagerNationalCard != "") {
                        $("#divDownload_ScanManagerNationalCard").html("<a class='btn btn-success' href='" + res.scanManagerNationalCardFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                    }

                    $("#TypeGroupCompanies").text(res.typeGroupCompaniesName);

                }


            }, true);
        }
        else {
            $(".content-header").hide();
            $("#divMainIndexCustomersSingleCustomer").html("<div class='container'><div class='row'><div class='col-md-12'><div class='alert alert-warning text-center'>شما مجوز انجام عملیات را ندارید</div></div></div></div>");
        }

    }

    web.Customer = {
        FilterGrid: filterGrid,
        InitCustomer: initCustomer
    };

})(Web, jQuery);







(function (web, $) {

    //Document Ready      

    function updatePass() {

        AjaxCallAction("POST", "/api/superVisor/Users/UpdatePass_Users", JSON.stringify({ OldPassword: $("#OldPassword").val(), NewPassword: $("#NewPassword").val(), ConfirmPassword: $("#ConfirmPassword").val() }), true, function (result) {

            debuggerWeb();

            if (result.isSuccess) {

                alertB("", result.message, "success");

            }
            else {

                alertB("خطا", result.message, "error");

            }

        }, true);

    }

    web.Users = {
        UpdatePass: updatePass
    };

})(Web, jQuery);

(function (web, $) {

    //Document Ready              

    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    var current_fs, next_fs, previous_fs; //fieldsets
    var opacity;

    $(".next").click(function () {

        var countform = Number($("#FormLoadCode").val()) + 1;
        $("#FormLoadCode").val(countform);

        intiTab(countform);

        current_fs = $(this).parent();
        next_fs = $(this).parent().next();

        //Add Class Active
        $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

        //show the next fieldset
        next_fs.show();
        //hide the current fieldset with style
        current_fs.animate({ opacity: 0 }, {
            step: function (now) {
                // for making fielset appear animation
                opacity = 1 - now;

                current_fs.css({
                    'display': 'none',
                    'position': 'relative'
                });
                next_fs.css({ 'opacity': opacity });
            },
            duration: 600
        });
    });



    $(".previous").click(function () {

        var countform = Number($("#FormLoadCode").val()) - 1;
        $("#FormLoadCode").val(countform);

        current_fs = $(this).parent();
        previous_fs = $(this).parent().prev();

        //Remove class active
        $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

        //show the previous fieldset
        previous_fs.show();

        //hide the current fieldset with style
        current_fs.animate({ opacity: 0 }, {
            step: function (now) {
                // for making fielset appear animation
                opacity = 1 - now;

                current_fs.css({
                    'display': 'none',
                    'position': 'relative'
                });
                previous_fs.css({ 'opacity': opacity });
            },
            duration: 600
        });
    });

    $('.radio-group .radio').click(function () {
        $(this).parent().find('.radio').removeClass('selected');
        $(this).addClass('selected');
    });

    $(".submit").click(function () {
        return false;
    });



    function intiTab(TabId = null) {
        var ID = $("#RequestIdForms").val();

        switch (TabId) {
            case 1:
                intiFormShow(1, "1,2,7,8", ID);
                getFurtherInfo(ID);
                intiFormShow(26, '1,2,3,4,11,12', ID);

                break;
            case 2:
                intiFormShow(3, "1,3,11", ID);

                break;
            case 3:
                getCorporateGovernance(ID);
                intiFormShow(16, "1,2,3", ID);
                intiFormShow(17, "1,2,3", ID);

                break;
            case 4:
                intiForm(11);
                intiFormSingelAnswer(11, ID);

                break;
            case 5:
                intiFormShow(13, "1,2,3,11", ID);

                break;
            case 7:
                getValueChain(ID);
            //intiFormQuestion(7, "D");
            //intiFormSingelAnswer(7, ID);
            //intiFormQuestion(18, "D");
            //intiFormSingelAnswer(18, ID);
            //intiFormQuestion(19, "D");
            //intiFormSingelAnswer(18, ID);
            //intiFormQuestion(20, "D");
            //intiFormSingelAnswer(20, ID);

            case 9:
                intiFormShow(9, '1,2,11', ID);
                intiFormShow(10, '1,11', ID);

                break;
            case 14:

                //intiForm(14);
                //intiFormSingelAnswer(14, ID);
                getPublicActivities(ID);
                intiFormShow(15, '1,2,11', ID);
                intiFormShow(22, '1,11', ID);
                intiFormShow(24, '1,11', ID);

                break;

        }

    }

    function systemSeting_Combo(FormId = null) {

        if (FormId == 1 || FormId == 3 || FormId == 16 || FormId == 9 || FormId == 13) {
            var PC = '';
            switch (FormId) {
                case 1:
                    PC = '9,20,30,125';
                    break;
                case 3:
                    PC = '250';
                    break;
                case 16:
                    PC = '9';
                    break;
                case 9:
                    PC = '9';
                    break;

            }

            AjaxCallAction("POST", "/api/superVisor/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: PC, PageIndex: 0, PageSize: 0 }), true, function (res) {

                if (res.isSuccess) {
                    if (FormId == 1) {
                        var strMemberPostID = '<option value="">انتخاب کنید</option>';
                        var strMemberEductionID = '<option value="">انتخاب کنید</option>';
                        var strUniversityID = '<option value="">انتخاب کنید</option>';
                        var strCompanyDocument = 'option value="">انتخاب کنید</option>';

                        for (var i = 0; i < res.data.length; i++) {
                            if (res.data[i].parentCode == 9) {
                                strMemberEductionID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                            } else if (res.data[i].parentCode == 20) {
                                strUniversityID += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                            }

                        }
                        $("#MemberEductionID").html(strMemberEductionID);
                        $("#UniversityID").html(strUniversityID);
                        $("#CompanyDocument").html(strCompanyDocument);

                    }
                    else if (FormId == 3) {
                        var strIsGuideLineOrProcess = '<option value="">انتخاب کنید</option>';

                        for (var i = 0; i < res.data.length; i++) {
                            strIsGuideLineOrProcess += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                        }

                        $("#IsGuideLineOrProcess").html(strIsGuideLineOrProcess);

                    }
                    else if (FormId == 16 || FormId == 9) {
                        var strDegreeOfEducation = strDegreeOfEducation2 = '<option value="">انتخاب کنید</option>';

                        for (var i = 0; i < res.data.length; i++) {
                            strDegreeOfEducation += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                        }

                        $("#DegreeOfEducation").html(strDegreeOfEducation);
                        $("#DegreeOfEducation2").html(strDegreeOfEducation);
                    }

                }
            }, true);

            ComboBoxWithSearch('.select2', 'rtl');
        }
    }

    //function getCustomer() {

    //    AjaxCallAction("GET", "/api/customer/Customers/Get_Customers/", null, true, function (res) {
    //        if (res != null) {               
    //            $("#CanSeeFurtherInfo").val(res.tel);
    //        }
    //    }, true);
    //}

    function initFurtherInfo(id = null) {
        PersianDatePicker(".DatePicker");
        $("#RequestIdForms").val(id);
        initReferral(id);
        getCustomerInfo(id);
        intiTab(1);
    }

    function intiFormShow(Id = null, Columns = null, RequestId = null) {

        intiForm(Id, RequestId);
        intiFormAnswer(Id, Columns, RequestId);


    }


    function intiForm(FormID = null, RequestId = null) {

        //AjaxCallAction("POST", "/api/customer/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

        //    if (res.isSuccess) {

        //        var strFormId = '';
        //        var Filename = 1;
        //        for (var i = 0; i < res.data.length; i++) {
        //            if (i == 0) {
        //                strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";
        //            }

        //            if (i == 0) {
        //                strFormId += "<div class='col-lg-6'>";
        //            } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
        //                strFormId += "</div><div class='col-lg-6'>";
        //            }

        //            strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
        //            if (res.data[i].questionType == 'select') {
        //                strFormId += "<select name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control select2' ></select>";
        //            } else if (res.data[i].questionType == 'textarea') {
        //                strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
        //            }
        //            else if (res.data[i].questionType == 'checkbox') {
        //                strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
        //            } else if (res.data[i].questionType == 'file') {
        //                strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";
        //                Filename++;
        //            }

        //            else {
        //                strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
        //            }
        //            strFormId += "</div>";
        //            strFormId += "</div>";
        //            if (i == res.data.length && res.data.length > 1) {
        //                strFormId += "</div>";
        //            }
        //        }
        //        $("#FormDetail" + FormID).html(strFormId);
        systemSeting_Combo(FormID);
        //    }
        //}, true);
    }

    function intiFormQrid(FormID = null, Name = null, RequestId = null) {

        AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var strFormId = '';
                var Filename = 1;

                for (var i = 0; i < res.data.length; i++) {

                    if (i == 0) {
                        strFormId += "<div class='col-lg-6'>";
                    } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
                        strFormId += "</div><div class='col-lg-6'>";
                    }

                    strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><form id='frmFrom" + Name + (i) + "'> <input type='hidden' id='FormID' name='FormID' value='" + FormID + "' />";
                    strFormId += "<input type='hidden' id='DataFormQuestionID' name='DataFormQuestionID' value='" + res.data[i].dataFormQuestionId + "' />";

                    strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";


                    strFormId += "<label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
                    if (res.data[i].questionType == 'select') {
                        strFormId += "<select name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control select2' ></select>";
                    } else if (res.data[i].questionType == 'textarea') {
                        strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
                    }
                    else if (res.data[i].questionType == 'checkbox') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
                    } else if (res.data[i].questionType == 'file') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";

                    }

                    else {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
                    }
                    strFormId += "<button title='ثبت' class='btn btn-default fontForAllPage' type='button' onclick='Web.FurtherInfo.SavesingleForm(this," + '"' + Name + (i) + '"' + ")'> ثبت </button ></form>";

                    strFormId += "</div>";
                    strFormId += "</div>";
                    if (i == res.data.length && res.data.length > 1) {
                        strFormId += "</div>";
                    }


                }
                $("#FormDetail" + FormID).html(strFormId);
                systemSeting_Combo(FormID);
            }
        }, true);
    }

    function getCorporateGovernance(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/FurtherInfo/Get_CorporateGovernances/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    $("#CorporateGovernanceId").val(res.data.corporateGovernanceId);
                    $("#RequestId").val(res.data.requestId);
                    $("#CompanyWebSite").val(res.data.companyWebSite);
                    $("#HighProductKnowledge").val(res.data.highProductKnowledge);
                    $("#HaveRepresentativeStr").prop("checked", res.data.haveRepresentative);
                    // $("#HaveRepresentative").val(res.data.haveRepresentative);
                    $("#HaveAuditCommitteeStr").prop("checked", res.data.haveAuditCommittee);

                    if (res.data.organazationChart != null && res.data.organazationChart != "") {
                        $("#DivOrganazationChart").html("<a class='btn btn-info' href='" + res.data.organazationChartFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.organizationalDuties != null && res.data.organizationalDuties != "") {
                        $("#DivOrganizationalDuties").html("<a class='btn btn-info' href='" + res.data.organizationalDutiesFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.riskManagementGuidelines != null && res.data.riskManagementGuidelines != "") {
                        $("#DivRiskManagementGuidelines").html("<a class='btn btn-info' href='" + res.data.riskManagementGuidelinesFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.transactionRegulations != null && res.data.transactionRegulations != "") {
                        $("#DivTransactionRegulations").html("<a class='btn btn-info' href='" + res.data.transactionRegulationsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.deductionTaxAccount != null && res.data.deductionTaxAccount != "") {
                        $("#DivDeductionTaxAccount").html("<a class='btn btn-info' href='" + res.data.deductionTaxAccountFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.crmSoftwareContract != null && res.data.crmSoftwareContract != "") {
                        $("#DivCrmSoftwareContract").html("<a class='btn btn-info' href='" + res.data.crmSoftwareContractFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.crmSoftwareContract != null && res.data.crmSoftwareContract != "") {
                        $("#DivCrmSoftwareContract").html("<a class='btn btn-info' href='" + res.data.crmSoftwareContractFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.representativeFile != null && res.data.representativeFile != "") {
                        $("#DivRepresentativeFile").html("<a class='btn btn-info' href='" + res.data.representativeFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.letterOfCommendation != null && res.data.letterOfCommendation != "") {
                        $("#DivLetterOfCommendation").html("<a class='btn btn-info' href='" + res.data.letterOfCommendationFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.proceedings != null && res.data.proceedings != "") {
                        $("#DivProceedings").html("<a class='btn btn-info' href='" + res.data.proceedingsFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.inovationFile != null && res.data.inovationFile != "") {
                        $("#DivInovationFile").html("<a class='btn btn-info' href='" + res.data.inovationFileFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                }

            }, true);
        }
    }

    function getValueChain(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/FurtherInfo/Get_ValueChain/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {
                    $("#ValueChainId").val(res.data.valueChainId);
                    $("#ValueChainId1").val(res.data.valueChainId);
                    $("#ValueChainId2").val(res.data.valueChainId);
                    $("#ValueChainId3").val(res.data.valueChainId);
                    $("#RequestId").val(res.data.requestId);


                    if (res.data.vc1 != null && res.data.vc1 != "") {
                        $("#DivVc1").html("<a class='btn btn-info' href='" + res.data.vc1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc2 != null && res.data.vc2 != "") {
                        $("#DivVc2").html("<a class='btn btn-info' href='" + res.data.vc2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc3 != null && res.data.vc3 != "") {
                        $("#DivVc3").html("<a class='btn btn-info' href='" + res.data.vc3Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc4 != null && res.data.vc4 != "") {
                        $("#DivVc4").html("<a class='btn btn-info' href='" + res.data.vc4Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                    if (res.data.vc4 != null && res.data.vc4 != "") {
                        $("#DivVc4").html("<a class='btn btn-info' href='" + res.data.vc4Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc5 != null && res.data.vc5 != "") {
                        $("#DivVc5").html("<a class='btn btn-info' href='" + res.data.vc5Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc6 != null && res.data.vc6 != "") {
                        $("#DivVc6").html("<a class='btn btn-info' href='" + res.data.vc6Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc7 != null && res.data.vc7 != "") {
                        $("#DivVc7").html("<a class='btn btn-info' href='" + res.data.vc7Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc8 != null && res.data.vc8 != "") {
                        $("#DivVc8").html("<a class='btn btn-info' href='" + res.data.vc8Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc9 != null && res.data.vc9 != "") {
                        $("#DivVc9").html("<a class='btn btn-info' href='" + res.data.vc9Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc10 != null && res.data.vc10 != "") {
                        $("#DivVc10").html("<a class='btn btn-info' href='" + res.data.vc10Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc11 != null && res.data.vc11 != "") {
                        $("#DivVc11").html("<a class='btn btn-info' href='" + res.data.vc11Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc12 != null && res.data.vc12 != "") {
                        $("#DivVc12").html("<a class='btn btn-info' href='" + res.data.vc12Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc13 != null && res.data.vc13 != "") {
                        $("#DivVc13").html("<a class='btn btn-info' href='" + res.data.vc13Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc14 != null && res.data.vc14 != "") {
                        $("#DivVc14").html("<a class='btn btn-info' href='" + res.data.vc14Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc15 != null && res.data.vc15 != "") {
                        $("#DivVc15").html("<a class='btn btn-info' href='" + res.data.vc15Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc16 != null && res.data.vc16 != "") {
                        $("#DivVc16").html("<a class='btn btn-info' href='" + res.data.vc16Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc17 != null && res.data.vc17 != "") {
                        $("#DivVc17").html("<a class='btn btn-info' href='" + res.data.vc17Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc18 != null && res.data.vc18 != "") {
                        $("#DivVc18").html("<a class='btn btn-info' href='" + res.data.vc18Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc19 != null && res.data.vc19 != "") {
                        $("#DivVc19").html("<a class='btn btn-info' href='" + res.data.vc19Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc20 != null && res.data.vc20 != "") {
                        $("#DivVc20").html("<a class='btn btn-info' href='" + res.data.vc20Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc21 != null && res.data.vc21 != "") {
                        $("#DivVc21").html("<a class='btn btn-info' href='" + res.data.vc21Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc22 != null && res.data.vc22 != "") {
                        $("#DivVc22").html("<a class='btn btn-info' href='" + res.data.vc22Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc23 != null && res.data.vc23 != "") {
                        $("#DivVc23").html("<a class='btn btn-info' href='" + res.data.vc23Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc24 != null && res.data.vc24 != "") {
                        $("#DivVc24").html("<a class='btn btn-info' href='" + res.data.vc24Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.vc25 != null && res.data.vc25 != "") {
                        $("#DivVc25").html("<a class='btn btn-info' href='" + res.data.vc25Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }

                }

            }, true);
        }
    }



    function getFurtherInfo(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/FurtherInfo/Get_FurtherInfo/" + (isEmpty(id) ? '0' : id), null, true, function (res) {
               
                if (res.isSuccess) {
                    $("#FurtherInfoId").val(res.data.furtherInfoId);

                    if (res.data.lastAuditingTaxList != null && res.data.lastAuditingTaxList != "") {
                        $("#divDownloadLastAuditingTaxList").html("<a class='btn btn-info' href='" + res.data.lastAuditingTaxListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.statementTaxList != null && res.data.statementTaxList != "") {
                        $("#divDownloadStatementTaxList").html("<a class='btn btn-info' href='" + res.data.statementTaxListFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.lastChangeOfficialNewspaper != null && res.data.lastChangeOfficialNewspaper != "") {
                        $("#divDownloadLastChangeOfficialNewspaper").html("<a class='btn btn-info' href='" + res.data.lastChangeOfficialNewspaperFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.statuteDoc != null && res.data.statuteDoc != "") {
                        $("#divDownloadStatuteDoc").html("<a class='btn btn-info' href='" + res.data.statuteDocFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                    if (res.data.officialNewspaper != null && res.data.officialNewspaper != "") {
                        $("#divDownloadOfficialNewspaper").html("<a class='btn btn-info' href='" + res.data.officialNewspaperFull + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                    }
                }

            }, true);
        }
    }


    function getPublicActivities(id = null) {

        if (!isEmpty(id) && id != 0) {

            AjaxCallAction("GET", "/api/superVisor/FurtherInfo/Get_PublicActivities/" + (isEmpty(id) ? '0' : id), null, true, function (res) {

                if (res.isSuccess) {

                    $("#IsPublicActivityFileStr").prop("checked", res.data.isPublicActivityFile);
                    $("#Investment").val(res.data.investment);
                    $("#EmploymentDisabled").val(res.data.employmentDisabled);
                    $("#PublicActivitiesID").val(res.data.publicActivitiesID);

                }

            }, true);
        }
    }

    function intiFormQuestion(FormID = null, Name = null, RequestId = null) {

        AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Get_DataFormQuestionss", JSON.stringify({ DataFormId: FormID, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var strFormId = '';
                var Filename = 1;

                for (var i = 0; i < res.data.length; i++) {

                    if (i == 0) {
                        strFormId += "<div class='col-lg-6'>";
                    } else if (i == Math.round((res.data.length) / 2) && res.data.length > 1) {
                        strFormId += "</div><div class='col-lg-6'>";
                    }

                    strFormId += "<div class='form-group'><div class='col-md-12' style='margin-bottom:10px'><form id='frmFrom" + Name + (i) + "'> <input type='hidden' id='FormID' name='FormID' value='" + FormID + "' />";
                    strFormId += "<input type='hidden' id='DataFormQuestionID' name='DataFormQuestionID' value='" + res.data[i].dataFormQuestionId + "' />";

                    strFormId += "<Input type='hidden' id='RequestId' name='RequestId' value='" + RequestId + "'/>";


                    strFormId += "<label class='control-label'  for=''>" + res.data[i].questionText + "<span class='RequiredLabel'>*</span></label>";
                    if (res.data[i].questionType == 'select') {
                        strFormId += "<select name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control select2' ></select>";
                    } else if (res.data[i].questionType == 'textarea') {
                        strFormId += "<textarea name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' class='form-control' ></textarea>";
                    }
                    else if (res.data[i].questionType == 'checkbox') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' style='text-align:right; width: 30px' />";
                    } else if (res.data[i].questionType == 'file') {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Result_Final_FileName" + Filename + "' id='" + res.data[i].questionName + "' /><div id='Div" + res.data[i].questionName + "'></div>";

                    }

                    else {
                        strFormId += "<input type='" + res.data[i].questionType + "' name='Answer" + res.data[i].questionOrder + "' id='" + res.data[i].questionName + "' placeholder='" + res.data[i].questionText + "' class='form-control' />";
                    }
                    strFormId += "<button title='ثبت' class='btn btn-default fontForAllPage' type='button' onclick='Web.FurtherInfo.SavesingleForm(this," + '"' + Name + (i) + '"' + ")'> ثبت </button ></form>";

                    strFormId += "</div>";
                    strFormId += "</div>";
                    if (i == res.data.length && res.data.length > 1) {
                        strFormId += "</div>";
                    }


                }
                $("#FormDetail" + FormID).html(strFormId);
                systemSeting_Combo(FormID);
            }
        }, true);
    }

    function intiFormSingelAnswer(FormID = null, Id = null) {
        AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Get_DataFromAnswerss", JSON.stringify({ FormId: FormID, RequestId: Id, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                if (FormID == 14) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 87:
                                $("#IsPublicActivityFile").prop("checked", res.data[i].answer == "false" ? false : true);
                                break;
                            case 91:
                                $("#Investment").val(res.data[i].answer);
                                break;
                            case 94:
                                $("#EmploymentDisabled").val(res.data[i].answer);
                                break;
                        }
                    }

                }
                if (FormID == 11) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 79:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivHumanResourcesFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivHumanResourcesFile").html("");
                                }
                                break;
                        }
                    }

                }
                if (FormID == 7) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 47:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc1").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc1").html("");
                                }
                                break;
                            case 48:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc2").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc2").html("");
                                }
                                break;
                            case 49:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc3").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc3").html("");
                                }
                                break;
                            case 50:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc4").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc4").html("");
                                }
                                break;

                        }
                    }

                }
                if (FormID == 18) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 51:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc5").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc5").html("");
                                }
                                break;
                            case 52:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc6").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc6").html("");
                                }
                                break;
                            case 53:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc7").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc7").html("");
                                }
                                break;
                            case 54:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc8").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc8").html("");
                                }
                                break;
                            case 55:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc9").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc9").html("");
                                }
                                break;
                            case 56:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc10").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc10").html("");
                                }
                                break;
                            case 57:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc11").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc11").html("");
                                }
                                break;
                            case 58:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc12").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc12").html("");
                                }
                                break;

                        }
                    }

                }
                if (FormID == 19) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 59:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc13").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc13").html("");
                                }
                                break;
                            case 60:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc14").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc14").html("");
                                }
                                break;
                            case 61:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc15").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc15").html("");
                                }
                                break;
                            case 62:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc16").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc16").html("");
                                }
                                break;
                            case 63:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc17").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc17").html("");
                                }
                                break;
                            case 64:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc18").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc18").html("");
                                }
                                break;
                            case 65:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc19").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc19").html("");
                                }
                                break;
                            case 66:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc20").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc20").html("");
                                }
                                break;
                            case 67:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc21").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc21").html("");
                                }
                                break;

                        }
                    }

                }
                if (FormID == 20) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 68:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc22").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc22").html("");
                                }
                                break;
                            case 69:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc23").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc23").html("");
                                }
                                break;
                            case 70:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc24").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc24").html("");
                                }
                                break;
                            case 71:
                                if (res.data[i].fileName1 != "" && res.data[i].fileName1 != null) {
                                    $("#DivVc25").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                else {
                                    $("#DivVc25").html("");
                                }
                                break;
                        }
                    }

                }
                if (FormID == 25) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 28:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivOrganazationChart").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivOrganazationChart").html("");
                                }
                                break;
                            case 29:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivOrganizationalDuties").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivOrganizationalDuties").html("");
                                }
                                //  $("#DivOrganizationalDuties").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 30:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivRiskManagementGuidelines").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivRiskManagementGuidelines").html("");
                                }
                                break;
                            case 31:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivTransactionRegulations").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivTransactionRegulations").html("");
                                }
                                break;
                            case 31:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivTransactionRegulations").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                }
                                break;
                            case 32:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivDeductionTaxAccount").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivDeductionTaxAccount").html("");
                                }
                                break;
                            case 33:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivCrmSoftwareContract").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivCrmSoftwareContract").html("");
                                }
                                break;
                            case 35:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivRepresentativeFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivRepresentativeFile").html("");
                                }
                                break;
                            case 36:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivletterOfCommendation").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivletterOfCommendation").html("");
                                }
                                break;
                            case 37:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivInovationFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivInovationFile").html("");
                                }
                                break;
                            case 40:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivProceedings").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                } else {
                                    $("#DivProceedings").html("");
                                }
                                break;
                            //
                        }
                    }

                }
                if (FormID == 2) {
                    for (var i = 0; i < res.data.length; i++) {
                        switch (res.data[i].dataFormQuestionId) {
                            case 97:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivLastAuditingTaxList").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                }
                                else {
                                    $("#DivLastAuditingTaxList").html("");
                                }
                                // $("#DivLastAuditingTaxList").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 98:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivLastChangeOfficialNewspaper").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                } else {
                                    $("#DivLastChangeOfficialNewspaper").html("");
                                }
                                // $("#DivLastChangeOfficialNewspaper").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 99:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivstatuteDoc").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                } else {
                                    $("#DivstatuteDoc").html("");
                                }
                                // $("#DivstatuteDoc").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;
                            case 100:
                                if (res.data[i].fileName1 != null && res.data[i].fileName1 != "") {
                                    $("#DivOfficialNewspaper").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");

                                } else {
                                    $("#DivOfficialNewspaper").html("");
                                }
                                // $("#DivOfficialNewspaper").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                                break;

                        }
                    }

                }
            }

        }, true);
    }

    function intiFormAnswer(FormID = null, ColumNum = null, RequestId = null) {

        AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Get_DataFormAnswerTabless", JSON.stringify({ FormId: FormID, RequestId: RequestId, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                var separatedArray = ColumNum.split(',');
                let strFormAnswer = '';
                for (let i = 0; i < res.data.length; i++) {

                    strFormAnswer += "<tr><td>" + (i + 1) + "</td><td>";

                    for (var j = 0; j < separatedArray.length; j++) {

                        switch (separatedArray[j]) {
                            case "1":
                                strFormAnswer += res.data[i].answer1 + "</td><td>";
                                break;
                            case "2":
                                strFormAnswer += res.data[i].answer2 + "</td><td>";
                                break;
                            case "3":
                                strFormAnswer += res.data[i].answer3 + "</td><td>";
                                break;
                            case "4":
                                strFormAnswer += res.data[i].answer4 + "</td><td>";
                                break;
                            case "5":
                                strFormAnswer += res.data[i].answer5 + "</td><td>";
                                break;
                            case "6":
                                strFormAnswer += res.data[i].answer6 + "</td><td>";
                                break;
                            case "7":
                                strFormAnswer += res.data[i].answer7 + "</td><td>";
                                break;
                            case "8":
                                strFormAnswer += res.data[i].answer8 + "</td><td>";
                                break;
                            case "9":
                                strFormAnswer += res.data[i].answer6 + "</td><td>";
                                break;
                            case "10":
                                strFormAnswer += res.data[i].answer6 + "</td><td>";
                                break;
                            case "11":
                                strFormAnswer += ((res.data[i].fileName1 != null && res.data[i].fileName1 != "") ? "<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>" : "") + "</td><td>";

                                break;
                            case "12":
                                strFormAnswer += ((res.data[i].fileName2 != null && res.data[i].fileName1 != "") ? "<a href='" + res.data[i].fileName2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>" : "") + "</td><td>";
                                break;
                        }
                    }

                    strFormAnswer += "<button title='ویرایش' class='btn btn-warring fontForAllPage' type='button' onclick='Web.FurtherInfo.GetFormAnswer(" + FormID + "," + res.data[i].answerTableId + ")' ><i class='fa fa-edit'></i></button>";
                   
                    strFormAnswer += "</td></tr>";
                }
                $("#FormDetailAnswer" + FormID).html(strFormAnswer);
            }
        }, true);
    }

    function getFormAnswer(FormID = null, AnswerTableId = null) {
        var RequestId = $("#RequestIdForms").val();

        AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Get_DataFormAnswerTabless", JSON.stringify({ FormId: FormID, AnswerTableId: AnswerTableId, RequestId: RequestId, PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {

                // $("#RequestId").val(res.data[0].requestId);
                for (var i = 0; i < res.data.length; i++) {

                    $('#frmFrom' + FormID).find('input[name=AnswerTableId]').val(res.data[0].answerTableId);
                    if (FormID == 1) {

                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);

                        $('#MemberPostID').val(res.data[0].answer2Val);
                        comboBoxWithSearchUpdateText("MemberPostID", res.data[0].answer2);

                        $('#MemberEductionID').val(res.data[0].answer3Val);
                        comboBoxWithSearchUpdateText("MemberEductionID", res.data[0].answer3);

                        $('#UniversityID').val(res.data[0].answer4Val);
                        comboBoxWithSearchUpdateText("UniversityID", res.data[0].answer4);


                        if (res.data[0].answer6 != null) {
                            if (res.data[0].answer6 == "on") {
                                $('#frmFrom' + FormID).find('input[name=Answer6]').prop("checked", true);
                            } else {
                                $('#frmFrom' + FormID).find('input[name=Answer6]').prop("checked", false);
                            }
                        } else {
                            $('#frmFrom' + FormID).find('input[name=Answer6]').prop("checked", false);
                        }
                        $('#frmFrom' + FormID).find('input[name=Answer5]').val(res.data[0].answer5);
                        $('#frmFrom' + FormID).find('input[name=Answer6]').val(res.data[0].answer6);
                        $('#frmFrom' + FormID).find('input[name=Answer7]').val(res.data[0].answer7);
                        $('#frmFrom' + FormID).find('input[name=Answer8]').val(res.data[0].answer8);
                        $('#frmFrom' + FormID).find('input[name=Answer9]').val(res.data[0].answer9);
                        $('#frmFrom' + FormID).find('input[name=Answer10]').val(res.data[0].answer10);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivAcademicDegreePicture").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        if (res.data[0].fileName2 != null && res.data[0].fileName2 != "") {
                            $("#DivPicture2").html("<a href='" + res.data[i].fileName2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        if (res.data[0].fileName3 != null && res.data[0].fileName3 != "") {
                            $("#DivPicture3").html("<a href='" + res.data[i].fileName3Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        if (res.data[0].fileName4 != null && res.data[0].fileName4 != "") {
                            $("#DivPicture4").html("<a href='" + res.data[i].fileName4Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        $("#btnform1").html("ویرایش");
                    }
                    else if (FormID == 3) {
                        //1,3,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);

                        $('#IsGuideLineOrProcess').val(res.data[0].answer3Val);
                        comboBoxWithSearchUpdateText("IsGuideLineOrProcess", res.data[0].answer3);

                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivGuidelinesAndRegulationsFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        } else {
                            $("#DivGuidelinesAndRegulationsFile").html("");
                        }
                        $("#btnform3").html("ویرایش");

                    } else if (FormID == 4) {

                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivCertificateAndPermitAndStandardFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificateAndPermitAndStandardFile").html("");
                        }
                        $("#btnform4").html("ویرایش");
                    }
                    else if (FormID == 5) {

                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivAwardsFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivAwardsFile").html("");
                        }
                        $("#btnform5").html("ویرایش");
                    }

                    else if (FormID == 8) {
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivSwotFile1").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivSwotFile1").html("");
                        }
                        if (res.data[0].fileName2 != null && res.data[0].fileName1 != "") {
                            $("#DivSwotFile2").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivSwotFile2").html("");
                        }
                        $("#btnform8").html("ویرایش");
                    }
                    else if (FormID == 9) {
                        //1,2,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#DegreeOfEducation2').val(res.data[0].answer2Val);
                        comboBoxWithSearchUpdateText("DegreeOfEducation2", res.data[0].answer2);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivDegreeFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivDegreeFile").html("");
                        }
                        $("#btnform9").html("ویرایش");
                    }
                    else if (FormID == 10) {
                        //1,2,11
                        $('#ReportTitle').val(res.data[0].answer1);

                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivReportFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivReportFile").html("");
                        }
                        $("#btnform10").html("ویرایش");
                    }
                    else if (FormID == 12) {
                        //1,2,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivCertificationCourses2").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificationCourses2").html("");
                        }
                        $("#btnform12").html("ویرایش");
                    }
                    else if (FormID == 13) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#PostInSociety').val(res.data[0].answer3Val);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivCertificationSociety").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificationSociety").html("");
                        }
                        comboBoxWithSearchUpdateText("PostInSociety", res.data[0].answer3);
                        $("#btnform13").html("ویرایش");
                    }
                    else if (FormID == 15) {
                        //1,2,11
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivPublicActivityFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivPublicActivityFile").html("");
                        }
                        $("#btnform15").html("ویرایش");
                    }
                    else if (FormID == 16) {
                        //1,2,3
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#DegreeOfEducation').val(res.data[0].answer2Val);
                        comboBoxWithSearchUpdateText("DegreeOfEducation", res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $("#btnform16").html("ویرایش");
                    }

                    else if (FormID == 17) {
                        //6,'1,2
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $("#btnform17").html("ویرایش");

                    } else if (FormID == 22) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivInvestmentFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivInvestmentFile").html("");
                        }
                        $("#btnform22").html("ویرایش");
                    }
                    else if (FormID == 24) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivEmploymentDisabledFile").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivEmploymentDisabledFile").html("");
                        }
                        $("#btnform24").html("ویرایش");
                    }
                    else if (FormID == 26) {
                        $('#frmFrom' + FormID).find('input[name=Answer1]').val(res.data[0].answer1);
                        $('#frmFrom' + FormID).find('input[name=Answer2]').val(res.data[0].answer2);
                        $('#frmFrom' + FormID).find('input[name=Answer3]').val(res.data[0].answer3);
                        $('#frmFrom' + FormID).find('input[name=Answer4]').val(res.data[0].answer4);

                        if (res.data[0].fileName1 != null && res.data[0].fileName1 != "") {
                            $("#DivCertificationCourses").html("<a href='" + res.data[i].fileName1Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificationCourses").html("");
                        }
                        if (res.data[0].fileName2 != null && res.data[0].fileName2 != "") {
                            $("#DivCertificationCoursesAttach").html("<a href='" + res.data[i].fileName2Full + "' target='_blank'><i class='fa fa-download'></i>&nbsp;دانلود</a>");
                        }
                        else {
                            $("#DivCertificationCoursesAttach").html("");
                        }
                        $("#btnform26").html("ویرایش");
                    }


                }

            }
        }, true);
    }


    function delete_DataFormAnswerTables(FormID = null, ColumNum = null, AnswerTableId = null) {


        try {

            debuggerWeb();

            confirmB("", "آیا تمایل به حذف دارید؟", 'error', function () {

                AjaxCallAction("GET", "/api/superVisor/FurtherInfo/Delete_DataFormAnswerTables/" + (isEmpty(AnswerTableId) ? '0' : AnswerTableId), null, true, function (result) {

                    debuggerWeb();

                    if (result.isSuccess) {

                        intiFormShow(FormID, ColumNum, $("#RequestIdForms").val());
                        $('#frmFrom' + FormID).find('input[name=AnswerTableId]').val('0');
                        alertB("", result.message, "success");
                        $("#btnform" + FormID).html('افزودن');

                    }
                    else {

                        alertB("خطا", result.message, "error");

                    }

                }, true);

            }, function () {

            }, ["خیر", "بلی"]);

        } catch (e) {

        }

    }



    function saveForm(e, FormId = null, ColumnNum = null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_DataFormAnswerTabless", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFrom" + FormId), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                $('#frmFrom' + FormId).find('input[name=AnswerTableId]').val('0');
                if (FormId == 1) {
                    initFurtherInfo($("#RequestIdForms").val());
                } else {

                    intiFormShow(FormId, ColumnNum, $("#RequestIdForms").val());
                    $(e).html('افزودن');
                }
                document.getElementById("frmFrom" + FormId).reset();
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function savesingleForm(e, FormId = null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_DataFromAnswers", fill_AjaxCallActionPostSaveFormWithUploadFile("frmFrom" + FormId), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveFurtherInfo(e) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_FurtherInfo", fill_AjaxCallActionPostSaveFormWithUploadFile("FormDe2"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                intiTab(1);
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveCorporateGovernance(e, id = null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_CorporateGovernance", fill_AjaxCallActionPostSaveFormWithUploadFile("FormDe6"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                getCorporateGovernance(id);
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveValueChain(e, FormName = null) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_ValueChain", fill_AjaxCallActionPostSaveFormWithUploadFile(FormName), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                intiTab(7);
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function savePublicActivities(e) {

        $(e).attr("disabled", "");

        AjaxCallActionPostSaveFormWithUploadFile("/api/superVisor/FurtherInfo/Save_PublicActivities", fill_AjaxCallActionPostSaveFormWithUploadFile("FormPublicActivities"), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {
                // intiFormSingelAnswer(FormId, $("#RequestIdForms").val());
                alertB("ثبت", "اطلاعات ثبت شد", "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    function saveFormDetailTab14(e) {
        try {

            saveSingelAnswerForm(e, 14, String($("#IsPublicActivityFile").prop('checked')), 87);
            saveSingelAnswerForm(e, 14, $('#EmploymentDisabled').val(), 94);
            saveSingelAnswerForm(e, 14, $('#Investment').val(), 91);
            alertB("ثبت", "اطلاعات ثبت شد", "success");
        } catch (e) {

        }

    }


    function saveForm25(e) {
        saveSingelAnswerForm(e, 6, String($("#HaveRepresentative").prop('checked')), 34);
        saveSingelAnswerForm(e, 6, $('#CompanyWebSite').val(), 94);
        saveSingelAnswerForm(e, 6, $('#HighProductKnowledge').val(), 38);
        saveSingelAnswerForm(e, 6, String($("#HaveAuditCommittee").prop('checked')), 39);
        alertB("ثبت", "اطلاعات ثبت شد", "success");

    }

    function initReferral(id = null) {

        AjaxCallAction("GET", "/api/superVisor/RequestForRating/InitReferral/" + id, null, true, function (res) {

            if (res.isSuccess) {

                $("#sdklsslks3498sjdkxhjsd_823sa").val(encrypt(id.toString(), keyMaker()));
                var htmlB = "";
                for (var i = 0; i < res.data.length; i++) {
                    if (res.data[0].levelStepIndex == 7 && res.data[0].levelStepAccessRole == 5) {
                        htmlB += "<button type='button' id='btnreq' style='margin:5px' class='btn btn-info ButtonOpperationLSSlss' onclick='Web.RequestForRating.SaveReferralRequestForRating(this);' data-DLSI='" + encrypt(res.data[i].destLevelStepIndex, keyMaker()) + "' data-LSAR='" + encrypt(res.data[i].levelStepAccessRole, keyMaker()) + "' data-LSS='" + encrypt(res.data[i].levelStepStatus, keyMaker()) + "' data-SC='" + encrypt(res.data[i].smsContent, keyMaker()) + "' data-ST='" + res.data[i].smsType + "' data-DLSIB='" + encrypt(res.data[i].destLevelStepIndexButton, keyMaker()) + "'>" + res.data[i].destLevelStepIndexButton + "</button>";

                    }
                }
                $("#bLLSS").html(htmlB);
                $("#sdfcddf").val(1);

            } else {
                $(".changeData").remove();
                $("#EndfurtherInfo").html("اطلاعات شما برای پارس کیان جهت بررسی و ارزیابی ارسال شده است و قابل ویرایش نمی باشد.");

            }


        }, true);

    }

    function saveSingelAnswerForm(e, formId = null, answer = null, dataFormQuestionId = null) {

        $(e).attr("disabled", "");
        var requestId = $("#RequestId").val();
        AjaxCallAction("POST", "/api/superVisor/FurtherInfo/Save_DataFromAnswers", JSON.stringify({
            Answer: answer,
            FormID: formId,
            RequestId: requestId,
            DataFormQuestionID: dataFormQuestionId,

        }), true, function (res) {

            $(e).removeAttr("disabled");

            if (res.isSuccess) {

                //  alertB("ثبت", res.message, "success");
            }
            else {

                alertB("خطا", res.message, "error");
            }

        }, true);

    }

    //function validate() {

    //    $("form[id='frmFrom1']").validate({
    //        // Specify validation rules
    //        rules: {
    //            "Answer1": {
    //                required: function () {
    //                    return true;
    //                },
    //                minlength: 5,
    //                maxlength: 50
    //            },

    //        },
    //        // Specify validation error messages
    //        messages: {
    //            "Answer1": {
    //                required: function () {
    //                    return "  لطفا نام و نام خانوادگی را را وارد کنید";
    //                },
    //                minlength: " باید حداقل 5 حرف باشد",
    //                maxlength: " باید حداکثر 50 حرف باشد"
    //            },

    //        },
    //        // Make sure the form is submitted to the destination defined
    //        // in the "action" attribute of the form when valid
    //        submitHandler: function (form) {
    //            Web.FurtherInfo.SaveForm("#btnform1", 1, '1,2,7,8');
    //        }
    //    });

    //    }
    $("#frmFrom1 input,textarea").on("focusout", function () {

        $(this).valid();

    });

    $(document).ready(function () {

        $("form[id='frmFrom1']").validate({
            // Specify validation rules
            rules: {
                "Answer1": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },
                "Answer2": {
                    required: function () {
                        return true;
                    },
                    minlength: 2,
                    maxlength: 50
                },
                "Answer3": {
                    required: function () {
                        return $("#MemberEductionID").val() != "223";
                    },
                },

            },
            // Specify validation error messages
            messages: {
                "Answer1": {
                    required: function () {
                        return "لطفا نام و نام خانوادگی را وارد کنید";
                    },
                    minlength: " باید حداقل 5 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
                "Answer2": {
                    required: function () {
                        return "لطفا پست سازمانی را وارد کنید";
                    },
                    minlength: " باید حداقل 3 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
                "Answer3": {
                    required: function () {
                        return "لطفا آخرین مدرک تحصیلی را انتخاب کنید";
                    },
                },

            },
            // Make sure the form is submitted to the destination defined
            // in the "action" attribute of the form when valid
            submitHandler: function (form) {
                Web.FurtherInfo.SaveForm("#btnform1", 1, '1,2,7,8');
            }
        });

        $("form[id='frmFrom26']").validate({
            // Specify validation rules
            rules: {
                "Answer1": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },
                "Answer2": {
                    required: function () {
                        return true;
                    },
                    minlength: 2,
                    maxlength: 50
                },

            },
            // Specify validation error messages
            messages: {
                "Answer1": {
                    required: function () {
                        return "لطفا نام و نام خانوادگی را وارد کنید";
                    },
                    minlength: " باید حداقل 5 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },
                "Answer2": {
                    required: function () {
                        return "لطفا نام دوره را وارد کنید";
                    },
                    minlength: " باید حداقل 5 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },


            },
            // Make sure the form is submitted to the destination defined
            // in the "action" attribute of the form when valid
            submitHandler: function (form) {
                Web.FurtherInfo.SaveForm(this, 26, '1,2,3,4,11');
            }
        });

        $("form[id='frmFrom3']").validate({
            // Specify validation rules
            rules: {
                "Answer1": {
                    required: function () {
                        return true;
                    },
                    minlength: 5,
                    maxlength: 50
                },


            },
            // Specify validation error messages
            messages: {
                "Answer1": {
                    required: function () {
                        return "لطفا عنوان دستورالعمل ها و آیین نامه ها یا روش اجرایی را وارد کنید";
                    },
                    minlength: " باید حداقل 5 حرف باشد",
                    maxlength: " باید حداکثر 50 حرف باشد"
                },


            },
            // Make sure the form is submitted to the destination defined
            // in the "action" attribute of the form when valid
            submitHandler: function (form) {
                Web.FurtherInfo.SaveForm(this, 3, '1,3,11');
            }
        });

    });

    function initCustomer(id, dir = 'rtl') {

        AjaxCallAction("GET", "/api/superVisor/Customers/Get_Customers/" + (isEmpty(id) ? '0' : id), null, true, function (res) {
                if (res != null) {
                    $("#CutomerName").html("<h4> فرم اطلاعات تکمیلی " + res.companyName + "</h4>");
                }
        }, true);

    }

    function getCustomerInfo(id=null) {

       
        if (!isEmpty(id) && id != 0) {
            AjaxCallAction("POST", "/api/superVisor/RequestForRating/Get_RequestForRatings", JSON.stringify({ RequestId: id, Search: null, PageIndex: 1, PageSize: 1, }), true, function (res) {

                if (res.isSuccess) {

                    getU("/css/GlobalAreas/Views/SuperVisor/RequestForRating/P_Customer.html", function (resG) {

                        $("#customerInfo").html(resG);
                        for (var i = 0; i < res.data.length; i++) {

                            initCustomer(res.data[i].customerId);
                        }

                    });

                }

            }, true);
        }
    }


    web.FurtherInfo = {
        TextSearchOnKeyDown: textSearchOnKeyDown,
        InitFurtherInfo: initFurtherInfo,
        SystemSeting_Combo: systemSeting_Combo,
        IntiForm: intiForm,
        IntiFormAnswer: intiFormAnswer,
        IntiFormShow: intiFormShow,
        IntiTab: intiTab,
        IntiFormSingelAnswer: intiFormSingelAnswer,
        SaveForm: saveForm,
        SaveSingelAnswerForm: saveSingelAnswerForm,
        SaveFormDetailTab14: saveFormDetailTab14,
        GetFormAnswer: getFormAnswer,
        Delete_DataFormAnswerTables: delete_DataFormAnswerTables,
        SavesingleForm: savesingleForm,
        IntiFormQuestion: intiFormQuestion,
        SaveForm25: saveForm25,
        IntiFormQrid: intiFormQrid,
        SaveFurtherInfo: saveFurtherInfo,
        SaveCorporateGovernance: saveCorporateGovernance,
        GetFurtherInfo: getFurtherInfo,
        SaveValueChain: saveValueChain,
        InitReferral: initReferral,
        GetCorporateGovernance: getCorporateGovernance,
        GetValueChain: getValueChain,
        SavePublicActivities: savePublicActivities,
        GetPublicActivities: getPublicActivities,
        InitCustomer: initCustomer,
        GetCustomerInfo: getCustomerInfo
    };

})(Web, jQuery);

var divPageingList_TotalNumberCustomersApprovedContractSupervisor_pageG = 1;
function successCallBack_divPageingList_TotalNumberCustomersApprovedContractSupervisor(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + (i + 1) + "</td><td>"
                + res.data[i].requestNo + "</td><td>"

                + res.data[i].sendTimeStr + "</td><td>"
                + res.data[i].dateOfRequestStr + "</td><td>"                
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + (!isEmpty(res.data[i].agentName) ? res.data[i].agentName : '') + "</td><td>"
                + res.data[i].nationalCode + "</td><td>"
                + res.data[i].agentMobile + "</td><td>" + res.data[i].finalPriceContract + "</td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var divPageingList_TotalNumberCustomersWithoutRegistrationSupervisor_pageG = 1;
function successCallBack_divPageingList_TotalNumberCustomersWithoutRegistrationSupervisor(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + (i + 1) + "</td><td>"
                + res.data[i].customerID + "</td><td>"
                + res.data[i].saveDateStr + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + (!isEmpty(res.data[i].agentName) ? res.data[i].agentName : '') + "</td><td>"
                + res.data[i].nationalCode + "</td><td>"
                + res.data[i].agentMobile + "</td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var divPageingList_TotalNumberApplicationsAssessmentMinistryPrivacySupervisor_pageG = 1;
function successCallBack_divPageingList_TotalNumberApplicationsAssessmentMinistryPrivacySupervisor(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + (i + 1) + "</td><td>"
                + res.data[i].requestNo + "</td><td>"
                + res.data[i].dateOfRequestStr + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + (!isEmpty(res.data[i].agentName) ? res.data[i].agentName : '') + "</td><td>"
                + res.data[i].nationalCode + "</td><td>"
                + res.data[i].agentMobile + "</td><td>" + res.data[i].finalPriceContract + "</td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var divPageingList_TotalNumberCorporateRequest_pageG = 1;
function successCallBack_divPageingList_TotalNumberCorporateRequest(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + (i + 1) + "</td><td>"
                + res.data[i].requestNo + "</td><td>"
                + res.data[i].dateOfRequestStr + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + (!isEmpty(res.data[i].agentName) ? res.data[i].agentName : '') + "</td><td>"
                + res.data[i].nationalCode + "</td><td>"
                + res.data[i].agentMobile + "</td><td>" + res.data[i].finalPriceContract + "</td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var divPageingList_NumberCodedFiles_Supervisor_pageG = 1;
function successCallBack_divPageingList_NumberCodedFiles_Supervisor(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + (i + 1) + "</td><td>"
                + res.data[i].requestNo + "</td><td>"
                + res.data[i].dateOfRequestStr + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + (!isEmpty(res.data[i].agentName) ? res.data[i].agentName : '') + "</td><td>"
                + res.data[i].nationalCode + "</td><td>"
                + res.data[i].agentMobile + "</td><td>"
                + (!isEmpty(res.data[i].finalPriceContract) ? res.data[i].finalPriceContract : '0') + "</td><td>"
                + (!isEmpty(res.data[i].codalDate) ? res.data[i].codalDate : '') + "</td><td>"
                + (!isEmpty(res.data[i].codalNumber) ? res.data[i].codalNumber : '') + "</td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var divPageingList_PerformanceReportEvaluationStaffInDetail_ReportOne_Supervisor_pageG = 1;
function successCallBack_divPageingList_PerformanceReportEvaluationStaffInDetail_ReportOne_Supervisor(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + res.data[i].row + "</td><td>"
                + (!isEmpty(res.data[i].companyName) ? res.data[i].companyName : '') + "</td><td>"
                + res.data[i].dateOfRequestStr + "</td><td>"
                + res.data[i].lastDateReferrals + "</td><td>"
                + res.data[i].lastSituation + "</td><td>"
                + "<a href='~/superVisor/RequestForRating/RequestReferences?id='" + res.data[i].requestID + "'>مشاهده گردش</a></td><td>"
                + res.data[i].waitingTimeInThisSituation + "</td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var divPageingList_PerformanceReportEvaluationStaffInDetail_ReportOne2_Supervisor_pageG = 1;
function successCallBack_divPageingList_PerformanceReportEvaluationStaffInDetail_ReportOne2_Supervisor(res) {

    if (res.isSuccess) {

        $("#TotalRowRep").text("جستجو در " + res.rows + " مورد");
        var strM = '';
        for (var i = 0; i < res.data.length; i++) {

            strM += "<tr><td>" + res.data[i].row + "</td><td>"
                + (!isEmpty(res.data[i].userName) ? res.data[i].userName : '') + "</td><td>"
                + (!isEmpty(res.data[i].roleName) ? res.data[i].roleName : '') + "</td><td>"
                + res.data[i].numberCompletedRequests + "</td><td>"
                + res.data[i].numberOpenAndCurrentRequests + "</td><td>"
                + res.data[i].averageResponseTimeRequestsStageSendingAdditionalInformationCustomer + "</td><td><a href='/Supervisor/Report/PerformanceReportEvaluationStaffInDetail_ReportOne?id=" + res.data[i].reciveUser + "' target='_blank' title='گزارش 1'><i class='fa fa-eye'></i></a></td></tr>";
        }

        $("#tBodyList").html(strM);
    }

}

(function (web, $) {

    //Document Ready  


    function textSearchOnKeyDown(event) {

        if (event.keyCode == 13) $(`button[title='جستجو']`).click();

    }

    function excelTotalNumberCustomersApprovedContract() {

        window.open('/SuperVisor/Report/GetTotalNumberCustomersApprovedContract1?FromDateStr=' + $("#FromDateStr").val() + '&ToDateStr=' + $("#ToDateStr").val() + "&Search=" + $("#txtSearch").val(), '_blank');

    }

    function filterReportGrid_TotalNumberCustomersApprovedContract() {

        pageingGrid("divPageingList_TotalNumberCustomersApprovedContractSupervisor", "/SuperVisor/Report/GetTotalNumberCustomersApprovedContract", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val() }));

    }

    function init_TotalNumberCustomersApprovedContract() {

        PersianDatePicker(".DatePicker");

        filterReportGrid_TotalNumberCustomersApprovedContract();
    }

    function init_TotalNumberCustomersWithoutRegistration() {

        PersianDatePicker(".DatePicker");

        filterReportGrid_TotalNumberCustomersWithoutRegistration();

    }

    function filterReportGrid_TotalNumberCustomersWithoutRegistration() {

        pageingGrid("divPageingList_TotalNumberCustomersWithoutRegistrationSupervisor", "/SuperVisor/Report/GetTotalNumberCustomersWithoutRegistration", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val() }));

    }

    function excelTotalNumberCustomersWithoutRegistration() {

        window.open('/SuperVisor/Report/GetTotalNumberCustomersWithoutRegistration1?FromDateStr=' + $("#FromDateStr").val() + '&ToDateStr=' + $("#ToDateStr").val() + "&Search=" + $("#txtSearch").val(), '_blank');

    }

    function init_TotalNumberApplicationsAssessmentMinistryPrivacy() {

        PersianDatePicker(".DatePicker");

        filterReportGrid_TotalNumberApplicationsAssessmentMinistryPrivacy();

    }

    function filterReportGrid_TotalNumberApplicationsAssessmentMinistryPrivacy() {

        pageingGrid("divPageingList_TotalNumberApplicationsAssessmentMinistryPrivacySupervisor", "/SuperVisor/Report/GetTotalNumberApplicationsAssessmentMinistryPrivacy", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val() }));

    }

    function excelTotalNumberApplicationsAssessmentMinistryPrivacy() {

        window.open('/SuperVisor/Report/GetTotalNumberApplicationsAssessmentMinistryPrivacy1?FromDateStr=' + $("#FromDateStr").val() + '&ToDateStr=' + $("#ToDateStr").val() + "&Search=" + $("#txtSearch").val(), '_blank');

    }

    function init_NumberCodedFiles() {

        PersianDatePicker(".DatePicker");

        filterReportGrid_NumberCodedFiles();

    }

    function filterReportGrid_NumberCodedFiles() {

        pageingGrid("divPageingList_NumberCodedFiles_Supervisor", "/SuperVisor/Report/GetNumberCodedFiles", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val() }));

    }

    function excelNumberCodedFiles() {

        window.open('/SuperVisor/Report/GetNumberCodedFiles1?FromDateStr=' + $("#FromDateStr").val() + '&ToDateStr=' + $("#ToDateStr").val() + "&Search=" + $("#txtSearch").val(), '_blank');

    }

    function indexBoxSupervisor() {
        AjaxCallAction("POST", "/SuperVisor/Report/IndexBoxSuperVisor", {}, true, function (res) {

            $("#TotalNumberCustomersApprovedContract").html(res.totalNumberCustomersApprovedContract);

            $("#TotalNumberCustomersWithoutRegistration").html(res.totalNumberCustomersWithoutRegistration);

            $("#TotalNumberApplicationsAssessmentMinistryPrivacy").html(res.totalNumberApplicationsAssessmentMinistryPrivacy);

            $("#NumberCodedFiles").html(res.numberCodedFiles);

            $("#NumberCorporateCustomer").html(res.numberCorporateCustomer);

        }, true);

        let CorporateAccess = ["11", "12"];
        let ContractAccess = ["4", "9", "11", "12"];

        if (CorporateAccess.includes(getlstor("loginName"))) {
            $("#ShowBoxSamt").remove();
        }
        if (!ContractAccess.includes(getlstor("loginName"))) {
            $("#ShowBoxCorporate").remove();
        }
    }

    function initPerformanceReportEvaluationStaffInDetail_ReportOne(id = 0) {

        AjaxCallAction("GET", "/api/Supervisor/RequestForRating/Get_UsersByRole/0", null, true, function (resGet) {

            var qD = '<option value="0">انتخاب کنید</option>';
            if (resGet.isSuccess) {

                for (var i = 0; i < resGet.data.length; i++) {

                    qD += "<option value='" + resGet.data[i].userId + "' >" + (!isEmpty(resGet.data[i].user) ? resGet.data[i].user.realName : '') + "</option>";

                }

                $("#cboReciveUser").html(qD);
                $("#cboReciveUser").val(id);

                PersianDatePicker(".DatePicker");
                ComboBoxWithSearch('.select2', 'rtl');
                filterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne();

                fillComboLevelStepSettingList();

            }

        }, true);

    }

    function filterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne() {

        pageingGrid("divPageingList_PerformanceReportEvaluationStaffInDetail_ReportOne_Supervisor", "/Supervisor/Report/GetPerformanceReportEvaluationStaffInDetail_ReportOne", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val(), ReciveUser: $("#cboReciveUser").val(), FromLastDateReferrals: $("#FromLastDateReferrals").val(), ToLastDateReferrals: $("#ToLastDateReferrals").val(), cboSelectLS: $("#cboSelectLS").val() }));

    }

    /////////////////////////////////////////////////////////////////////////////////////////////////////////////

    function initPerformanceReportEvaluationStaffInDetail_ReportOne2() {

        PersianDatePicker(".DatePicker");
        filterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne2();

    }

    function filterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne2() {

        pageingGrid("divPageingList_PerformanceReportEvaluationStaffInDetail_ReportOne2_Supervisor", "/Supervisor/Report/GetPerformanceReportEvaluationStaffInDetail_ReportOne2", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val() }));

    }

    function fillComboLevelStepSettingList() {

        AjaxCallAction("POST", "/api/supervisor/RequestForRating/Get_LevelStepSetings", JSON.stringify({ PageIndex: 0, PageSize: 0 }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strKindOfCompany += " <option value=" + res.data[i].levelStepIndex + ">" + res.data[i].levelStepStatus + "</option>";
                }

                $("#cboSelectLS").html(strKindOfCompany);



            }

            AjaxCallAction("POST", "/api/supervisor/SystemSeting/Get_SystemSetings", JSON.stringify({ ParentCodeArr: "63", PageIndex: 0, PageSize: 0 }), true, function (res) {

                if (res.isSuccess) {
                    var strKindOfRequest = '<option value="">انتخاب کنید</option>';

                    for (var i = 0; i < res.data.length; i++) {
                        strKindOfRequest += " <option value=" + res.data[i].systemSetingId + ">" + res.data[i].label + "</option>";
                    }

                    $("#cboKindOfRequest").html(strKindOfRequest);

                }
            }, true);

        }, true);

    }

    function onchangeKindOfRequest(e) {

        AjaxCallAction("POST", "/api/supervisor/RequestForRating/Get_LevelStepSetings", JSON.stringify({ PageIndex: 0, PageSize: 0, KindOfRequest: !isEmpty($(e).val()) ? $(e).val() : null }), true, function (res) {

            if (res.isSuccess) {
                var strKindOfCompany = '<option value="">انتخاب کنید</option>';

                for (var i = 0; i < res.data.length; i++) {
                    strKindOfCompany += " <option value=" + res.data[i].levelStepIndex + ">" + res.data[i].levelStepStatus + "</option>";
                }

                $("#cboSelectLS").html(strKindOfCompany);



            }

        }, true);

    }

    function init_TotalNumberCorporateRequest() {
        PersianDatePicker(".DatePicker");
        filterReportGrid_TotalNumberCorporateRequest();
    }

    function filterReportGrid_TotalNumberCorporateRequest() {
        pageingGrid("divPageingList_TotalNumberCorporateRequest", "/SuperVisor/Report/GetTotalNumberCorporateRequest", JSON.stringify({ Search: $("#txtSearch").val(), PageIndex: 1, PageSize: $("#cboSelectCount").val(), FromDateStr: $("#FromDateStr").val(), ToDateStr: $("#ToDateStr").val() }));
    }

    function excelTotalNumberCorporateRequest() {
        window.open('/SuperVisor/Report/GetExcelTotalNumberCorporateRequest?FromDateStr=' + $("#FromDateStr").val() + '&ToDateStr=' + $("#ToDateStr").val() + "&Search=" + $("#txtSearch").val(), '_blank');
    }

    web.Report = {
        OnchangeKindOfRequest: onchangeKindOfRequest,
        FillComboLevelStepSettingList: fillComboLevelStepSettingList,
        TextSearchOnKeyDown: textSearchOnKeyDown,
        ExcelTotalNumberCustomersApprovedContract: excelTotalNumberCustomersApprovedContract,
        FilterReportGrid_TotalNumberCustomersApprovedContract: filterReportGrid_TotalNumberCustomersApprovedContract,
        Init_TotalNumberCustomersApprovedContract: init_TotalNumberCustomersApprovedContract,
        Init_TotalNumberCustomersWithoutRegistration: init_TotalNumberCustomersWithoutRegistration,
        FilterReportGrid_TotalNumberCustomersWithoutRegistration: filterReportGrid_TotalNumberCustomersWithoutRegistration,
        ExcelTotalNumberCustomersWithoutRegistration: excelTotalNumberCustomersWithoutRegistration,
        Init_TotalNumberApplicationsAssessmentMinistryPrivacy: init_TotalNumberApplicationsAssessmentMinistryPrivacy,
        FilterReportGrid_TotalNumberApplicationsAssessmentMinistryPrivacy: filterReportGrid_TotalNumberApplicationsAssessmentMinistryPrivacy,
        ExcelTotalNumberApplicationsAssessmentMinistryPrivacy: excelTotalNumberApplicationsAssessmentMinistryPrivacy,
        Init_NumberCodedFiles: init_NumberCodedFiles,
        FilterReportGrid_NumberCodedFiles: filterReportGrid_NumberCodedFiles,
        ExcelNumberCodedFiles: excelNumberCodedFiles,
        IndexBoxSupervisor: indexBoxSupervisor,
        InitPerformanceReportEvaluationStaffInDetail_ReportOne: initPerformanceReportEvaluationStaffInDetail_ReportOne,
        FilterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne: filterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne,
        InitPerformanceReportEvaluationStaffInDetail_ReportOne2: initPerformanceReportEvaluationStaffInDetail_ReportOne2,
        FilterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne2: filterReportGrid_PerformanceReportEvaluationStaffInDetail_ReportOne2,

        Init_TotalNumberCorporateRequest: init_TotalNumberCorporateRequest,
        FilterReportGrid_TotalNumberCorporateRequest: filterReportGrid_TotalNumberCorporateRequest,
        ExcelTotalNumberCorporateRequest: excelTotalNumberCorporateRequest,
    };

})(Web, jQuery);